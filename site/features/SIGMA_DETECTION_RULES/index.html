
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Modern docs for Huntable CTI Studio (CTIScraper)">
      
      
      
      
        <link rel="prev" href="../OBSERVABLE_EVALUATION_DESIGN/">
      
      
        <link rel="next" href="../../operations/BACKUP_AND_RESTORE/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Sigma Rules - Huntable CTI Studio</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/stackedit.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sigma-detection-rules-system" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Huntable CTI Studio" class="md-header__button md-logo" aria-label="Huntable CTI Studio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Huntable CTI Studio
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Sigma Rules
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Huntable CTI Studio" class="md-nav__button md-logo" aria-label="Huntable CTI Studio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Huntable CTI Studio
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/huntables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Huntables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/pipelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pipelines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/observables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    How-To
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    How-To
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howto/run_locally/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Run locally
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howto/add_feed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Add feed
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howto/extract_observables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Extract observables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howto/generate_sigma/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generate Sigma
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howto/evaluate_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/sigma/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sigma
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/versioning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Versioning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Internals
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Internals
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../internals/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../internals/scoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../internals/chunking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chunking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../internals/qa_loops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QA loops
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Deployment
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Deployment
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deployment/GETTING_STARTED/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deployment/DOCKER_ARCHITECTURE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deployment/TECHNICAL_READOUT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Technical Readout
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_1" >
        
          
          <label class="md-nav__link" for="__nav_8_1" id="__nav_8_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    LLM & Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    LLM & Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LMSTUDIO_INTEGRATION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LMStudio Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Model_Selection_Guide_CTI_Workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Selection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../OpenAI_Chat_Models_Reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OpenAI Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ML & Training
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    ML & Training
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ML_HUNT_SCORING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ML Hunt Scoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../HUNTABLE_WINDOWS_CLASSIFIER/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Huntable Windows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DATABASE_TRAINING_SYSTEM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CONTENT_FILTER_ML_SETUP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Content Filter ML
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3" checked>
        
          
          <label class="md-nav__link" for="__nav_8_3" id="__nav_8_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Features
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Features
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CONTENT_FILTERING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Content Filtering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CMDLINE_ATTENTION_PREPROCESSOR/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cmdline Attention Preprocessor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OS_DETECTION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OS Detection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OBSERVABLE_EVALUATION_DESIGN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observable Evaluation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Sigma Rules
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Sigma Rules
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Flow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Benefits
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rule-generation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rule Generation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rule Generation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Features
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ai-powered-rule-generation" class="md-nav__link">
    <span class="md-ellipsis">
      
        ðŸ¤– AI-Powered Rule Generation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysigma-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        âœ… pySIGMA Validation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iterative-rule-fixing" class="md-nav__link">
    <span class="md-ellipsis">
      
        ðŸ”„ Iterative Rule Fixing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metadata-storage" class="md-nav__link">
    <span class="md-ellipsis">
      
        ðŸ“Š Metadata Storage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conversation-log-display" class="md-nav__link">
    <span class="md-ellipsis">
      
        ðŸ”„ Conversation Log Display
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisites
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generation-process" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generation Process
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Handling
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rule-matching-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rule Matching Pipeline
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rule Matching Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture Components
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-database-schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Database Schema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-sigma-sync-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Sigma Sync Service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-sigma-matching-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Sigma Matching Service
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-single-article" class="md-nav__link">
    <span class="md-ellipsis">
      
        Match Single Article
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batch-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Batch Matching
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-interface-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Web Interface Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cli-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        CLI Commands
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CLI Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#available-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        Available Commands
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#features_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Features
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Reference
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generate-sigma-rules-with-matching-similarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generate SIGMA Rules (with Matching &amp; Similarity)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-existing-matches" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get Existing Matches
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        Environment Variables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai-model-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        AI Model Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity-thresholds" class="md-nav__link">
    <span class="md-ellipsis">
      
        Similarity Thresholds
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#content-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      
        Content Filtering
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Issues
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-key-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Key Errors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedding-generation-failures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Embedding Generation Failures
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysigma-validation-failures" class="md-nav__link">
    <span class="md-ellipsis">
      
        pySIGMA Validation Failures
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generation-failures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generation Failures
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#no-similarity-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        No Similarity Results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slow-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Slow Performance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Import Errors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debug-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        Debug Commands
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monitoring
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maintenance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Maintenance
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Maintenance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#regular-updates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Regular Updates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics-tracked" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metrics Tracked
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#health-checks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Health Checks
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Considerations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-privacy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Privacy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#input-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Input Validation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output Validation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Future Enhancements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Future Enhancements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#planned-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Planned Features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-opportunities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integration Opportunities
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#files-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Files &amp; Components
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Files &amp; Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#created-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Created Files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modified-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Modified Files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependencies
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#support" class="md-nav__link">
    <span class="md-ellipsis">
      
        Support
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_4" >
        
          
          <label class="md-nav__link" for="__nav_8_4" id="__nav_8_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Operations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Operations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/BACKUP_AND_RESTORE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backup & Restore
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/CROSS_MACHINE_RESTORE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cross Machine Restore
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/MEMORY_OPTIMIZATION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory Optimization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/SOURCE_CONFIG_PRECEDENCE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Source Config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operations/VERIFY_ML_VERSIONS_BACKUP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Verify ML Versions Backup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_5" >
        
          
          <label class="md-nav__link" for="__nav_8_5" id="__nav_8_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/DEVELOPMENT_SETUP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/PORT_CONFIGURATION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Port Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/WEB_APP_TESTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web App Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/DATABASE_QUERY_GUIDE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Queries
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/DEBUGGING_TOOLS_GUIDE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debugging Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/ADVANCED_QUALITY_SYSTEM.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Quality System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/ALLURE_REPORTS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Allure Reports
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/DEBUG_EVAL_LMSTUDIO_LOGS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debug Eval Logs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/LIGHTWEIGHT_INTEGRATION_TESTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lightweight Integration Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/MULTI_INSTANCE_SETUP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi Instance Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/MANUAL_CHECKLIST_30MIN/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manual Checklist 30min
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/MANUAL_TEST_CHECKLIST/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manual Test Checklist
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/search-queries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Search Queries
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/boolean-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Boolean Search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/backfill_chunk_analysis_help/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backfill Chunk Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/TROUBLESHOOT_EVAL_PENDING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Troubleshoot Eval Pending
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/WORKFLOW_QUEUE_SETUP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow Queue Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/WebAppDevtestingGuide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web App Dev Testing Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Flow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Benefits
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rule-generation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rule Generation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rule Generation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Features
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ai-powered-rule-generation" class="md-nav__link">
    <span class="md-ellipsis">
      
        ðŸ¤– AI-Powered Rule Generation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysigma-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        âœ… pySIGMA Validation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iterative-rule-fixing" class="md-nav__link">
    <span class="md-ellipsis">
      
        ðŸ”„ Iterative Rule Fixing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metadata-storage" class="md-nav__link">
    <span class="md-ellipsis">
      
        ðŸ“Š Metadata Storage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conversation-log-display" class="md-nav__link">
    <span class="md-ellipsis">
      
        ðŸ”„ Conversation Log Display
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisites
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generation-process" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generation Process
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Error Handling
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rule-matching-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rule Matching Pipeline
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rule Matching Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture Components
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-database-schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Database Schema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-sigma-sync-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Sigma Sync Service
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-sigma-matching-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Sigma Matching Service
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-single-article" class="md-nav__link">
    <span class="md-ellipsis">
      
        Match Single Article
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batch-matching" class="md-nav__link">
    <span class="md-ellipsis">
      
        Batch Matching
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-interface-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        Web Interface Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cli-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        CLI Commands
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CLI Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#available-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        Available Commands
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#features_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Features
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Reference
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generate-sigma-rules-with-matching-similarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generate SIGMA Rules (with Matching &amp; Similarity)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-existing-matches" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get Existing Matches
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        Environment Variables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ai-model-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        AI Model Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity-thresholds" class="md-nav__link">
    <span class="md-ellipsis">
      
        Similarity Thresholds
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#content-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      
        Content Filtering
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Troubleshooting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Issues
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Common Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#api-key-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Key Errors
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedding-generation-failures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Embedding Generation Failures
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pysigma-validation-failures" class="md-nav__link">
    <span class="md-ellipsis">
      
        pySIGMA Validation Failures
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generation-failures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generation Failures
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#no-similarity-results" class="md-nav__link">
    <span class="md-ellipsis">
      
        No Similarity Results
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slow-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Slow Performance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Import Errors
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debug-commands" class="md-nav__link">
    <span class="md-ellipsis">
      
        Debug Commands
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monitoring
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maintenance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Maintenance
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Maintenance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#regular-updates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Regular Updates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics-tracked" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metrics Tracked
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#health-checks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Health Checks
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Considerations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-privacy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Privacy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#input-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Input Validation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output Validation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Future Enhancements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Future Enhancements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#planned-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Planned Features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-opportunities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integration Opportunities
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#files-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Files &amp; Components
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Files &amp; Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#created-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Created Files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modified-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Modified Files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dependencies
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#support" class="md-nav__link">
    <span class="md-ellipsis">
      
        Support
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="sigma-detection-rules-system">SIGMA Detection Rules System</h1>
<p>Comprehensive system for AI-powered SIGMA detection rule generation, matching against SigmaHQ repository, and similarity search.</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#overview">Overview</a></li>
<li><a href="#rule-generation">Rule Generation</a></li>
<li><a href="#rule-matching-pipeline">Rule Matching Pipeline</a></li>
<li><a href="#similarity-search">Similarity Search</a></li>
<li><a href="#technical-architecture">Technical Architecture</a></li>
<li><a href="#usage--examples">Usage &amp; Examples</a></li>
<li><a href="#cli-commands">CLI Commands</a></li>
<li><a href="#api-reference">API Reference</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
</ol>
<hr />
<h2 id="overview">Overview</h2>
<p>The SIGMA Detection Rules System combines three powerful features:</p>
<ol>
<li><strong>AI-Powered Generation</strong>: Automatically creates detection rules from threat intelligence articles</li>
<li><strong>Rule Matching</strong>: Matches articles to existing SigmaHQ rules (3,068+ indexed rules)</li>
<li><strong>Similarity Search</strong>: Compares generated rules against existing community rules to prevent duplication</li>
</ol>
<h3 id="system-flow">System Flow</h3>
<p>There are two entry paths into the SIGMA detection system:</p>
<ul>
<li><strong>Web/API path</strong>: Triggered via <code>POST /api/articles/{id}/analyze</code> â€” Article â†’ Match Existing Rules â†’ Classify Coverage â†’ Generate New Rules â†’ Similarity Check â†’ Store</li>
<li><strong>Agentic Workflow path</strong>: Triggered via LangGraph pipeline â€” OS Detection â†’ Junk Filter â†’ Rank â†’ Extract â†’ Generate SIGMA â†’ Similarity Search â†’ Promote to Queue</li>
</ul>
<pre><code>Article â†’ Match Existing Rules â†’ Classify Coverage â†’ Generate New Rules (if needed) â†’ Similarity Check â†’ Store
</code></pre>
<h3 id="key-benefits">Key Benefits</h3>
<ul>
<li><strong>Prevents Duplication</strong>: Identifies existing coverage before generating new rules</li>
<li><strong>Improves Quality</strong>: Validates rules through pySIGMA and community comparison</li>
<li><strong>Saves Time</strong>: Automates rule creation and coverage analysis</li>
<li><strong>Provides Context</strong>: Shows relationships between articles and detection rules</li>
</ul>
<hr />
<h2 id="rule-generation">Rule Generation</h2>
<h3 id="features">Features</h3>
<h4 id="ai-powered-rule-generation">ðŸ¤– AI-Powered Rule Generation</h4>
<ul>
<li><strong>Multiple AI Models</strong>: Supports ChatGPT (OpenAI) and LMStudio (local LLM)</li>
<li><strong>Content Analysis</strong>: Analyzes article content to extract detection patterns</li>
<li><strong>Context Awareness</strong>: Understands threat techniques and attack patterns</li>
<li><strong>Multiple Rule Generation</strong>: Can generate multiple rules per article</li>
<li><strong>Content Filtering</strong>: ML-based optimization to reduce token usage</li>
<li><strong>Consistent Temperature</strong>: Uses temperature 0.2 for deterministic output</li>
</ul>
<h4 id="pysigma-validation">âœ… pySIGMA Validation</h4>
<ul>
<li><strong>Automatic Validation</strong>: All rules validated using pySIGMA</li>
<li><strong>Compliance Checking</strong>: Ensures SIGMA format requirements</li>
<li><strong>Error Detection</strong>: Identifies syntax errors and missing fields</li>
<li><strong>Warning Detection</strong>: Flags potential issues and best practices</li>
</ul>
<h4 id="iterative-rule-fixing">ðŸ”„ Iterative Rule Fixing</h4>
<ul>
<li><strong>Automatic Retry</strong>: Failed rules retried with error feedback</li>
<li><strong>Up to 3 Attempts</strong>: Maximum 3 generation attempts per rule set</li>
<li><strong>Error Feedback</strong>: AI receives detailed validation errors</li>
<li><strong>Progressive Improvement</strong>: Each attempt incorporates previous results</li>
</ul>
<h4 id="metadata-storage">ðŸ“Š Metadata Storage</h4>
<ul>
<li><strong>Complete Audit Trail</strong>: Stores all generation attempts and validation results</li>
<li><strong>Attempt Tracking</strong>: Records number of attempts made</li>
<li><strong>Validation Results</strong>: Stores detailed errors and warnings</li>
<li><strong>Generation Timestamps</strong>: Tracks when rules were generated</li>
</ul>
<h4 id="conversation-log-display">ðŸ”„ Conversation Log Display</h4>
<ul>
<li><strong>Interactive Visualization</strong>: Shows LLM â†” pySigma validator conversation</li>
<li><strong>Attempt-by-Attempt View</strong>: Each retry in separate card with visual indicators</li>
<li><strong>Collapsible Sections</strong>: Long prompts/responses expandable</li>
<li><strong>Color-Coded Feedback</strong>: Valid (green) and invalid (red) results</li>
<li><strong>Detailed Error Messages</strong>: Specific validation errors from pySigma</li>
<li><strong>Progressive Learning</strong>: See how LLM improves based on feedback</li>
</ul>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>Threat hunting score &lt; 65 shows warning but allows proceeding</li>
<li>(Deprecated: article-level "chosen" classification requirement has been removed.)</li>
<li>AI model configured:</li>
<li><strong>ChatGPT</strong>: OpenAI API key required</li>
<li><strong>LMStudio</strong>: Local server running (no API key)</li>
<li><strong>LM Studio for Embeddings</strong>: Required for SIGMA rule similarity search</li>
<li>Model: intfloat/e5-base-v2 loaded in LM Studio</li>
<li>API: http://localhost:1234/v1/embeddings</li>
<li>Environment variables: <code>LMSTUDIO_EMBEDDING_URL</code> and <code>LMSTUDIO_EMBEDDING_MODEL</code></li>
<li>pySIGMA library installed</li>
</ul>
<h3 id="generation-process">Generation Process</h3>
<ol>
<li><strong>Content Analysis</strong>: AI analyzes article title and content</li>
<li><strong>Content Filtering</strong>: ML-based optimization reduces token usage</li>
<li><strong>Pattern Extraction</strong>: Identifies attack patterns and techniques</li>
<li><strong>Rule Creation</strong>: Generates appropriate SIGMA detection rules</li>
<li><strong>Format Compliance</strong>: Ensures proper YAML structure</li>
<li><strong>Validation</strong>: pySIGMA validates generated rules</li>
<li><strong>Iterative Fixing</strong>: Failed rules trigger retry with feedback (up to 3 attempts)</li>
<li><strong>Storage</strong>: Rules stored in article metadata with audit trail</li>
</ol>
<h3 id="error-handling">Error Handling</h3>
<p><strong>Common Validation Errors:</strong>
- Missing required fields (title, logsource, detection)
- Invalid YAML syntax
- Incorrect field types
- Missing condition statements
- Invalid logsource configurations</p>
<p><strong>Retry Logic:</strong>
- Maximum 3 attempts per rule set
- Error feedback provided to AI model
- Progressive improvement with each attempt
- Graceful failure after max attempts
- Complete conversation log captured for debugging</p>
<hr />
<h2 id="rule-matching-pipeline">Rule Matching Pipeline</h2>
<p>A three-layer pipeline that matches CTI articles to existing Sigma detection rules from SigmaHQ, classifies coverage status, and intelligently generates new rules only when needed.</p>
<h3 id="architecture-components">Architecture Components</h3>
<h4 id="1-database-schema">1. Database Schema</h4>
<p><strong>Tables:</strong>
- <code>sigma_rules</code>: Stores Sigma detection rules with embeddings
  - 768-dimensional pgvector embeddings for semantic search
  - JSONB fields for logsource and detection logic
  - Full metadata (tags, level, status, author, references)
  - Source tracking (file_path, repo_commit_sha)</p>
<ul>
<li><code>article_sigma_matches</code>: Stores article-to-rule matches</li>
<li>Similarity scores and match levels (article/chunk)</li>
<li>Coverage classification (covered/extend/new)</li>
<li>Matched behaviors (discriminators, LOLBAS, intelligence)</li>
</ul>
<p><strong>Indexes:</strong>
- IVFFlat vector index for embedding similarity search
- GIN indexes for JSONB logsource and tags arrays
- BTree indexes for foreign keys and coverage status</p>
<h4 id="2-sigma-sync-service">2. Sigma Sync Service</h4>
<p><strong>File</strong>: <code>src/services/sigma_sync_service.py</code></p>
<p><strong>Features:</strong>
- Clones/pulls SigmaHQ repository (read-only)
- Parses YAML rule files using PyYAML
- Extracts all rule fields (title, description, logsource, detection, tags)
- Generates embeddings from enriched rule text
- Batch indexing with progress tracking
- Incremental updates (only new rules)</p>
<p><strong>Key Methods:</strong>
- <code>clone_or_pull_repository()</code>: Git operations
- <code>find_rule_files()</code>: Recursive file discovery
- <code>parse_rule_file()</code>: YAML parsing and normalization
- <code>create_rule_embedding_text()</code>: Embedding text generation
- <code>index_rules()</code>: Batch indexing with embeddings</p>
<h4 id="3-sigma-matching-service">3. Sigma Matching Service</h4>
<p><strong>File</strong>: <code>src/services/sigma_matching_service.py</code></p>
<p><strong>Features:</strong>
- Article-level semantic search using existing embeddings
- Chunk-level semantic search with on-the-fly embedding generation
- Behavioral novelty scoring for final SIGMA similarity assessment (Atom Jaccard 70% + Logic Shape Similarity 30%)
- Configurable candidate retrieval limits and matching thresholdPgvector cosine similarity queries
- Configurable threshold and limits
- Match storage with full metadata</p>
<p><strong>Key Methods:</strong>
- <code>match_article_to_rules()</code>: Article-level matching
- <code>match_chunks_to_rules()</code>: Chunk-level matching with deduplication
- <code>store_match()</code>: Persist matches to database
- <code>get_article_matches()</code>: Retrieve matches with rule details
- <code>get_coverage_summary()</code>: Aggregate coverage statistics</p>
<p><strong>Candidate Retrieval Pattern (example):</strong>
The system first retrieves a shortlist of candidate rules using pgvector nearest-neighbors, then computes the behavioral novelty score in application code to rank final matches.</p>
<pre><code class="language-sql">-- Retrieve top N candidate rules by embedding distance (pgvector)
SELECT sr.*SQL Query Pattern:**
```sql
SELECT sr.*, 1 - (sr.embedding &lt;=&gt; :embedding::vector) AS similarity
FROM sigma_rules sr
WHERE sr.embedding IS NOT NULL
ORDER BY   AND 1 - (sr.embedding &lt;-=&gt; :embedding::vector
LIMIT :candidate_limit; -- e.g. 50
</code></pre>
<p>The behavioral novelty scorer (Atom Jaccard 70% + Logic Shape Similarity 30%) is applied to these candidates to produce the final similarity ranking.) &gt;= :threshold
ORDER BY similarity DESC
LIMIT :limit</p>
<pre><code>
#### 4. Coverage Classification Service

**File**: `src/services/sigma_coverage_service.py`

**Features:**
- Extracts behaviors from `chunk_analysis_results`
- Compares article behaviors to rule detection patterns
- Classifies as covered/extend/new
- Confidence scoring
- Detailed reasoning generation

**Classification Logic:**
- **Covered** (similarity â‰¥ 0.85, overlap â‰¥ 0.7): Behaviors well represented
- **Extend** (similarity â‰¥ 0.7, overlap â‰¥ 0.3): Partial overlap, room for extension
- **New** (low overlap): Represents new detection opportunity

**Key Methods:**
- `extract_article_behaviors()`: Aggregate discriminators, LOLBAS, intelligence
- `extract_rule_patterns()`: Parse Sigma detection fields
- `calculate_behavior_overlap()`: Compare behaviors to patterns
- `classify_match()`: Full classification with reasoning
- `analyze_article_coverage()`: Overall coverage analysis

### Enhanced Generation Workflow

**File**: `src/web/routes/ai.py`

1. **Match Phase**: Automatically match article to existing rules (threshold 0.7)
2. **Classify Phase**: Classify each match as covered/extend/new
3. **Store Phase**: Persist matches to database
4. **Decision Phase**: 
   - If â‰¥2 rules marked &quot;covered&quot;: Skip generation, return matches
   - Otherwise: Proceed with LLM generation

**New Parameters:**
- `skip_matching`: Boolean to bypass matching phase
- Returns `matched_rules` and `coverage_summary` in all responses

### Embedding Strategy

- **Model**: all-mpnet-base-v2 (768 dimensions)
- **Reuse**: Leverages existing `EmbeddingService`
- **Article embeddings**: Already populated in `articles.embedding`
- **Chunk embeddings**: Generated on-demand from `chunk_analysis_results`
- **Rule embeddings**: Combines title + description + logsource + tags

### Behavior Extraction

**Source**: `chunk_analysis_results` table

**Fields used:**
- `perfect_discriminators_found`: High-confidence indicators
- `good_discriminators_found`: Medium-confidence indicators
- `lolbas_matches_found`: Living-off-the-land binaries
- `intelligence_matches_found`: Intelligence indicators
- `hunt_score`: Threat hunting relevance score

### Coverage Classification

- **Covered**: Article behaviors âŠ† rule detection patterns
- **Extend**: Partial overlap, article has additional behaviors
- **New**: Minimal overlap, new detection opportunity

---

## Similarity Search

Enhances &quot;Generate SIGMA Rules&quot; by comparing proposed/generated rules against indexed SigmaHQ repository using semantic similarity search.

### Purpose

1. **Prevents Duplication**: Identifies if similar rules already exist
2. **Provides Context**: Shows relationship to community rules
3. **Improves Quality**: Helps understand coverage gaps
4. **Saves Time**: Avoids recreating existing rules

### How It Works

</code></pre>
<p>User Request â†’ Generate Sigma Rules (AI) â†’ For Each Generated Rule:
  1. Extract title + description
  2. Generate embedding
  3. Retrieve candidate rules via pgvector nearest-neighbors
  4. Compute behavioral novelty score for each candidate (Atom Jaccard 70% + Logic Shape 30%Query sigma_rules table (cosine similarity)
  54. Return top 5 matches by behavioral novelty (threshold configurable(â‰¥70% similarity)
â†’ Return Response with similar_rules field</p>
<pre><code>
### Embedding Details

- **Model**: intfloat/e5-base-v2 via LM Studio (768 dimensions)
- **Provider**: LM Studio local API server
- **Input**: Enriched rule text (title, description, logsource, detection)
-- **Similarity Metric (SIGMA rules)**: Behavioral novelty score â€” weighted combination:
   - Atom Jaccard (70%): predicate overlap of detection fields
   - Logic Shape Similarity (30%): structural similarity of detection logic (AND/OR/NOT**: Cosine similarity (1 - cosine distance)
-- **Threshold**: Configurable (default 0.7 on normalized behavioral novelty score0.7 (70% similarity minimum)
-- **Performance**: Candidate retrieval via pgvector is fast; behavioral novelty scoring runs on the shortlist (typical overhead ~100-300ms overhead per generated rule)

### Similarity Interpretation

- **High Similarity (&gt;0.9)**: Consider using existing rule instead
- **Medium Similarity (0.7-0.9)**: Review for potential extension
- **No Matches**: Novel detection opportunity

---

## Technical Architecture

### Technology Stack

- **Database**: PostgreSQL with pgvector extension
- **Embeddings**: intfloat/e5-base-v2 via LM Studio API
- **Rule Format**: SIGMA YAML specification
- **Validation**: pySIGMA library
- **Repository**: SigmaHQ official repository
- **API**: FastAPI with async support

### Performance

- **Indexing**: ~5000 rules indexed in 10-15 minutes
- **Matching**: Article-level match ~100ms, chunk-level ~500ms
- **Vector Index**: IVFFlat with 100 lists provides sub-second similarity search
- **Batch Operations**: Process ~100 articles/minute with matching + classification
- **Query Time**: ~50-200ms per rule similarity search
- **Embedding Generation**: ~100-300ms per rule

### Database Infrastructure

- **Records**: 3,068+ indexed Sigma rules with embeddings
- **Index Type**: IVFFlat vector index for fast similarity search
- **Vector Dimension**: 768 (intfloat/e5-base-v2 model)
- **Storage**: JSONB for flexible rule metadata

---

## Usage &amp; Examples

### Initial Setup

```bash
# 1. Sync SigmaHQ repository (first time)
./run_cli.sh sigma sync

# 2. Index all rules (generates embeddings)
./run_cli.sh sigma index

# 3. View statistics
./run_cli.sh sigma stats
</code></pre>
<p><strong>Expected Output:</strong></p>
<pre><code>Sigma Rule Index Statistics
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”“
â”ƒ Metric                 â”ƒ Count â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”©
â”‚ Total Rules            â”‚ 5247  â”‚
â”‚ Rules with Embeddings  â”‚ 5247  â”‚
â”‚ Total Matches          â”‚ 0     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="match-single-article">Match Single Article</h3>
<pre><code class="language-bash">./run_cli.sh sigma match 123 --save
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Matches for Article 123
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Rule ID         â”ƒ Title                                   â”ƒ Similarity â”ƒ Level â”ƒ Coverage â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”©
â”‚ a1b2c3d4...     â”‚ PowerShell Suspicious Script Execution â”‚ 0.875      â”‚ high  â”‚ covered  â”‚
â”‚ e5f6g7h8...     â”‚ Suspicious Process Creation            â”‚ 0.823      â”‚ med   â”‚ extend   â”‚
â”‚ i9j0k1l2...     â”‚ Registry Modification Detection        â”‚ 0.756      â”‚ low   â”‚ new      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 id="batch-matching">Batch Matching</h3>
<pre><code class="language-bash"># Match all articles with embeddings and hunt_score &gt;= 50
./run_cli.sh sigma match-all --min-hunt-score 50 --threshold 0.7
</code></pre>
<h3 id="web-interface-usage">Web Interface Usage</h3>
<ol>
<li>Navigate to any article</li>
<li>Click "Generate SIGMA Rules" button</li>
<li>AI processes article content</li>
<li>System checks for existing coverage</li>
<li>Generates new rules if needed</li>
<li>Shows similarity to existing rules</li>
<li>View conversation log showing LLM â†” pySigma interaction</li>
</ol>
<hr />
<h2 id="cli-commands">CLI Commands</h2>
<p><strong>File</strong>: <code>src/cli/sigma_commands.py</code></p>
<h3 id="available-commands">Available Commands</h3>
<pre><code class="language-bash"># Sync SigmaHQ repository
./run_cli.sh sigma sync

# Index rules with embeddings
./run_cli.sh sigma index [--force]

# Match single article
./run_cli.sh sigma match &lt;article_id&gt; [--save]

# Batch match articles
./run_cli.sh sigma match-all [--limit N] [--min-hunt-score N]

# Show index statistics
./run_cli.sh sigma stats
</code></pre>
<h3 id="features_1">Features</h3>
<ul>
<li>Rich console output with tables</li>
<li>Progress tracking for batch operations</li>
<li>Option to save matches to database</li>
<li>Configurable thresholds</li>
<li>Hunt score filtering for batch operations</li>
</ul>
<hr />
<h2 id="api-reference">API Reference</h2>
<h3 id="generate-sigma-rules-with-matching-similarity">Generate SIGMA Rules (with Matching &amp; Similarity)</h3>
<p><strong>Endpoint</strong>: <code>POST /api/articles/{article_id}/generate-sigma</code></p>
<p><strong>Request:</strong></p>
<pre><code class="language-json">{
  &quot;force_regenerate&quot;: false,
  &quot;include_content&quot;: true,
  &quot;ai_model&quot;: &quot;chatgpt&quot;,
  &quot;api_key&quot;: &quot;your_api_key_here&quot;,
  &quot;author_name&quot;: &quot;CTIScraper User&quot;,
  &quot;temperature&quot;: 0.2,
  &quot;skip_matching&quot;: false,
  &quot;optimization_options&quot;: {
    &quot;useFiltering&quot;: true,
    &quot;minConfidence&quot;: 0.7
  }
}
</code></pre>
<p><strong>Response (Article is Covered):</strong></p>
<pre><code class="language-json">{
  &quot;success&quot;: true,
  &quot;matched_rules&quot;: [
    {
      &quot;rule_id&quot;: &quot;a1b2c3d4-...&quot;,
      &quot;title&quot;: &quot;PowerShell Suspicious Script Execution&quot;,
      &quot;similarity&quot;: 0.875,
      &quot;coverage_status&quot;: &quot;covered&quot;,
      &quot;matched_behaviors&quot;: [&quot;powershell.exe&quot;, &quot;EncodedCommand&quot;, &quot;bypass&quot;]
    }
  ],
  &quot;coverage_summary&quot;: {
    &quot;covered&quot;: 2,
    &quot;extend&quot;: 1,
    &quot;new&quot;: 0,
    &quot;total&quot;: 3
  },
  &quot;generated_rules&quot;: [],
  &quot;similar_rules&quot;: [],
  &quot;recommendation&quot;: &quot;Article behaviors are covered by 2 existing Sigma rule(s). No new rules needed.&quot;,
  &quot;skipped_generation&quot;: true
}
</code></pre>
<p><strong>Response (New Rules Generated):</strong></p>
<pre><code class="language-json">{
  &quot;success&quot;: true,
  &quot;rules&quot;: [
    {
      &quot;title&quot;: &quot;Suspicious PowerShell Execution&quot;,
      &quot;description&quot;: &quot;Detects suspicious PowerShell command execution...&quot;,
      &quot;logsource&quot;: {...},
      &quot;detection&quot;: {...}
    }
  ],
  &quot;similar_rules&quot;: [
    {
      &quot;generated_rule&quot;: {
        &quot;title&quot;: &quot;Suspicious PowerShell Execution&quot;,
        &quot;description&quot;: &quot;Detects suspicious PowerShell command execution...&quot;
      },
      &quot;similar_existing_rules&quot;: [
        {
          &quot;rule_id&quot;: &quot;a1b2c3d4-...&quot;,
          &quot;title&quot;: &quot;PowerShell Execution with Encoded Commands&quot;,
          &quot;similarity&quot;: 0.87,
          &quot;level&quot;: &quot;high&quot;,
          &quot;status&quot;: &quot;stable&quot;,
          &quot;file_path&quot;: &quot;rules/windows/process_creation/proc_creation_win_powershell_encoded_cmd.yml&quot;
        }
      ]
    }
  ],
  &quot;validation_results&quot;: [...],
  &quot;conversation&quot;: [...],
  &quot;validation_passed&quot;: true,
  &quot;attempts_made&quot;: 1,
  &quot;matched_rules&quot;: [],
  &quot;coverage_summary&quot;: {...}
}
</code></pre>
<h3 id="get-existing-matches">Get Existing Matches</h3>
<p><strong>Endpoint</strong>: <code>GET /api/articles/{article_id}/sigma-matches</code></p>
<p><strong>Response:</strong></p>
<pre><code class="language-json">{
  &quot;success&quot;: true,
  &quot;matches&quot;: [
    {
      &quot;rule_id&quot;: &quot;a1b2c3d4-...&quot;,
      &quot;title&quot;: &quot;PowerShell Suspicious Script Execution&quot;,
      &quot;similarity_score&quot;: 0.875,
      &quot;coverage_status&quot;: &quot;covered&quot;,
      &quot;matched_discriminators&quot;: [&quot;powershell.exe&quot;, &quot;EncodedCommand&quot;],
      &quot;matched_lolbas&quot;: [&quot;powershell.exe&quot;, &quot;cmd.exe&quot;],
      &quot;created_at&quot;: &quot;2025-01-16T10:30:00&quot;
    }
  ],
  &quot;coverage_summary&quot;: {
    &quot;covered&quot;: 2,
    &quot;extend&quot;: 1,
    &quot;new&quot;: 0,
    &quot;total&quot;: 3
  }
}
</code></pre>
<hr />
<h2 id="configuration">Configuration</h2>
<h3 id="environment-variables">Environment Variables</h3>
<pre><code class="language-bash"># SIGMA repository and matching
SIGMA_REPO_PATH=./data/sigma-repo
SIGMA_MATCH_THRESHOLD=0.7

# LM Studio embedding configuration (required for SIGMA embeddings)
LMSTUDIO_EMBEDDING_URL=http://localhost:1234/v1/embeddings
LMSTUDIO_EMBEDDING_MODEL=intfloat/e5-base-v2
</code></pre>
<h3 id="ai-model-configuration">AI Model Configuration</h3>
<p><strong>ChatGPT (OpenAI)</strong>
- Model: gpt-4o-mini
- API Key: Required in request body
- Temperature: 0.2 (for consistent output)
- Best for: High-quality rule generation</p>
<p><strong>LMStudio (Local LLM)</strong>
- Model: User-configured (e.g., llama-3.2-1b-instruct)
- API Key: Not required
- Temperature: 0.2 (for consistent output)
- Best for: Local processing, privacy, cost savings</p>
<p><strong>LM Studio for Embeddings</strong> (SIGMA Rule Similarity Search)
- Endpoint: http://localhost:1234/v1/embeddings
- Model: intfloat/e5-base-v2 (must be loaded in LM Studio)
- Dimension: 768
- Purpose: Generate embeddings for SIGMA rule similarity search
- Setup:
  1. Open LM Studio
  2. Download and load model: <code>intfloat/e5-base-v2</code>
  3. Start local server
  4. Verify endpoint is accessible</p>
<h3 id="similarity-thresholds">Similarity Thresholds</h3>
<ul>
<li><strong>Default</strong>: 0.7 (70% similarity)</li>
<li><strong>Covered Classification</strong>: â‰¥ 0.85 similarity, â‰¥ 0.7 overlap</li>
<li><strong>Extend Classification</strong>: â‰¥ 0.7 similarity, â‰¥ 0.3 overlap</li>
<li><strong>New Classification</strong>: Low overlap</li>
</ul>
<h3 id="content-filtering">Content Filtering</h3>
<pre><code class="language-json">{
  &quot;optimization_options&quot;: {
    &quot;useFiltering&quot;: true,      // Enable content filtering
    &quot;minConfidence&quot;: 0.7       // Minimum confidence threshold
  }
}
</code></pre>
<hr />
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="common-issues">Common Issues</h3>
<h4 id="api-key-errors">API Key Errors</h4>
<ul>
<li>Check API key configuration (ChatGPT only)</li>
<li>Verify API quota and billing</li>
<li>Monitor rate limiting</li>
<li>LMStudio requires no API key, verify local server running</li>
</ul>
<h4 id="embedding-generation-failures">Embedding Generation Failures</h4>
<ul>
<li><strong>LM Studio not running</strong>: Ensure LM Studio server is running at configured URL</li>
<li><strong>Model not loaded</strong>: Verify intfloat/e5-base-v2 is loaded in LM Studio</li>
<li><strong>Connection timeout</strong>: Check <code>LMSTUDIO_EMBEDDING_URL</code> environment variable</li>
<li><strong>Invalid model</strong>: Ensure <code>LMSTUDIO_EMBEDDING_MODEL</code> is set to <code>intfloat/e5-base-v2</code></li>
<li><strong>HTTP errors</strong>: Check LM Studio server logs and network connectivity</li>
</ul>
<h4 id="pysigma-validation-failures">pySIGMA Validation Failures</h4>
<ul>
<li>Ensure pySIGMA properly installed</li>
<li>Check rule format compliance</li>
<li>Review validation error messages</li>
<li>Examine conversation log for debugging</li>
</ul>
<h4 id="generation-failures">Generation Failures</h4>
<ul>
<li>Check threat hunting score (warning below 65)</li>
<li>Review AI model availability</li>
<li>Check content filtering settings</li>
</ul>
<h4 id="no-similarity-results">No Similarity Results</h4>
<ol>
<li>Verify SigmaHQ rules indexed with embeddings:
   <code>bash
   ./run_cli.sh sigma stats</code></li>
<li>Check embedding service working:
   <code>bash
   docker-compose exec web python -c "from src.services.embedding_service import EmbeddingService; e = EmbeddingService(); print(len(e.generate_embedding('test')))"</code></li>
<li>Lower similarity threshold temporarily to test</li>
</ol>
<h4 id="slow-performance">Slow Performance</h4>
<ol>
<li>Rebuild vector index:
   <code>sql
   REINDEX INDEX idx_sigma_rules_embedding;</code></li>
<li>Adjust IVFFlat lists parameter</li>
<li>Increase database resources</li>
</ol>
<h4 id="import-errors">Import Errors</h4>
<p>All operations should run inside Docker containers:</p>
<pre><code class="language-bash">docker-compose exec web python -m src.cli.main sigma [command]
</code></pre>
<h3 id="debug-commands">Debug Commands</h3>
<pre><code class="language-bash"># Enable debug logging
LOG_LEVEL=DEBUG

# Check generation logs
docker-compose logs -f web | grep &quot;SIGMA&quot;

# Check service status
docker-compose ps

# Test embedding service
docker-compose exec web python -c &quot;from src.services.embedding_service import EmbeddingService; print('OK')&quot;
</code></pre>
<h3 id="monitoring">Monitoring</h3>
<pre><code class="language-sql">-- Average similarity scores
SELECT AVG(similarity) 
FROM article_sigma_matches 
WHERE match_level = 'article';

-- Distribution of similarity scores
SELECT 
    CASE 
        WHEN similarity &gt;= 0.9 THEN 'Very High (0.9+)'
        WHEN similarity &gt;= 0.8 THEN 'High (0.8-0.9)'
        WHEN similarity &gt;= 0.7 THEN 'Medium (0.7-0.8)'
        ELSE 'Low (&lt;0.7)'
    END as similarity_range,
    COUNT(*) as count
FROM article_sigma_matches
GROUP BY similarity_range;
</code></pre>
<hr />
<h2 id="maintenance">Maintenance</h2>
<h3 id="regular-updates">Regular Updates</h3>
<pre><code class="language-bash"># Update SigmaHQ repository
./run_cli.sh sigma sync

# Re-index rules
./run_cli.sh sigma index --force

# Check statistics
./run_cli.sh sigma stats
</code></pre>
<h3 id="metrics-tracked">Metrics Tracked</h3>
<ul>
<li>Rules generated per day</li>
<li>Validation success rate</li>
<li>Average attempts per generation</li>
<li>Most common validation errors</li>
<li>Generation processing time</li>
<li>Match coverage distribution</li>
</ul>
<h3 id="health-checks">Health Checks</h3>
<ul>
<li>OpenAI API connectivity</li>
<li>pySIGMA validation status</li>
<li>Generation success rates</li>
<li>Average attempts per rule set</li>
<li>Similarity search performance</li>
</ul>
<hr />
<h2 id="security-considerations">Security Considerations</h2>
<h3 id="data-privacy">Data Privacy</h3>
<ul>
<li>Article content sent to AI model for analysis</li>
<li>No sensitive data stored in AI provider logs (ChatGPT)</li>
<li>Rules stored locally in database</li>
<li>LMStudio provides local processing for full privacy</li>
</ul>
<h3 id="input-validation">Input Validation</h3>
<ul>
<li>Article ID validation</li>
<li>Threat score thresholds</li>
<li>(Deprecated: "chosen" classification requirement has been removed.)</li>
<li>Rate limiting on generation requests</li>
<li>API key validation for external models</li>
</ul>
<h3 id="output-validation">Output Validation</h3>
<ul>
<li>pySIGMA validation ensures rule safety</li>
<li>No arbitrary code execution</li>
<li>Structured rule format only</li>
</ul>
<hr />
<h2 id="future-enhancements">Future Enhancements</h2>
<h3 id="planned-features">Planned Features</h3>
<ul>
<li>Custom rule templates</li>
<li>Automatic rule performance optimization</li>
<li>Bulk rule generation</li>
<li>Rule testing with SIEM frameworks</li>
<li>Rule sharing and export</li>
<li>Batch similarity search</li>
<li>Weighted similarity (consider detection logic)</li>
<li>Similarity explanations</li>
<li>Auto-merge suggestions</li>
<li>Cross-platform matching</li>
</ul>
<h3 id="integration-opportunities">Integration Opportunities</h3>
<ul>
<li>SIEM platform integration</li>
<li>Direct PR creation to SigmaHQ</li>
<li>Enhanced TTP extraction and mapping</li>
<li>ML-based rule quality assessment</li>
<li>Periodic automated SigmaHQ sync</li>
<li>Rule suggestions for "extend" matches</li>
<li>Performance optimization with chunk embedding caching</li>
</ul>
<hr />
<h2 id="files-components">Files &amp; Components</h2>
<h3 id="created-files">Created Files</h3>
<ul>
<li><code>init.sql/migrations/20250116_add_sigma_matching_tables.sql</code></li>
<li><code>src/services/sigma_sync_service.py</code></li>
<li><code>src/services/sigma_matching_service.py</code></li>
<li><code>src/services/sigma_coverage_service.py</code></li>
<li><code>src/cli/sigma_commands.py</code></li>
</ul>
<h3 id="modified-files">Modified Files</h3>
<ul>
<li><code>src/database/models.py</code> (added SigmaRuleTable, ArticleSigmaMatchTable)</li>
<li><code>src/web/routes/ai.py</code> (enhanced with match-first logic)</li>
<li><code>src/cli/main.py</code> (registered sigma_group commands)</li>
<li><code>requirements.txt</code> (added GitPython==3.1.43)</li>
</ul>
<h3 id="dependencies">Dependencies</h3>
<ul>
<li><code>GitPython==3.1.43</code>: Repository management</li>
<li><code>pysigma==0.11.23</code>: Rule parsing/validation</li>
<li><code>pgvector&gt;=0.4.0</code>: Vector similarity</li>
<li><code>sentence-transformers&gt;=2.2.2</code>: Embeddings (all-mpnet-base-v2)</li>
</ul>
<hr />
<h2 id="support">Support</h2>
<p>For issues and questions:
- <strong>GitHub Issues</strong>: Report bugs and feature requests
- <strong>Documentation</strong>: Check this guide and API documentation
- <strong>Community</strong>: Join CTI Scraper community discussions</p>
<hr />
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/SigmaHQ/sigma">SigmaHQ Repository</a></li>
<li><a href="https://github.com/SigmaHQ/sigma-specification">Sigma Specification</a></li>
<li><a href="https://github.com/pgvector/pgvector">pgvector</a></li>
<li><a href="https://www.sbert.net/">Sentence Transformers</a>
-- <a href="https://sigmahq-pysigma.readthedocs.io/">pySIGMA Documentation</a>
-- [Behavioral Novelty (algorithm notes)](internal-notes://behavioral_novelCosine Similarity](https://en.wikipedia.org/wiki/Cosine_similarity)</li>
</ul>
<hr />
<p><strong>Status</strong>: âœ… Complete and Functional<br />
<strong>Last Updated</strong>: January 2025</p>
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTkzMTMwODgxNl19
-->












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../js/stackedit.js"></script>
      
    
  </body>
</html>