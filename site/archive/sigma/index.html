
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Modern threat intelligence collection and analysis platform">
      
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Sigma Reference - Huntable CTI Studio</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sigma-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Huntable CTI Studio" class="md-header__button md-logo" aria-label="Huntable CTI Studio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Huntable CTI Studio
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Sigma Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../quickstart/" class="md-tabs__link">
        
  
  
    
  
  Quickstart

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/installation/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../concepts/huntables/" class="md-tabs__link">
          
  
  
  Concepts

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guides/add-feed/" class="md-tabs__link">
          
  
  
  Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../architecture/overview/" class="md-tabs__link">
          
  
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../features/sigma-rules/" class="md-tabs__link">
          
  
  
  Features

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../llm/model-selection/" class="md-tabs__link">
          
  
  
  LLM & Models

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ml-training/hunt-scoring/" class="md-tabs__link">
          
  
  
  ML Training

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/cli/" class="md-tabs__link">
          
  
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../development/setup/" class="md-tabs__link">
          
  
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../prompts/eval-bundle/" class="md-tabs__link">
          
  
  
  Prompts

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../changelog/" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Huntable CTI Studio" class="md-nav__button md-logo" aria-label="Huntable CTI Studio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Huntable CTI Studio
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/first-workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    First Workflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/huntables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Huntables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/pipelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pipelines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/observables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/add-feed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Add a Feed
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/extract-observables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Extract Observables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/generate-sigma/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generate Sigma Rules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/evaluate-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/backup-and-restore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backup & Restore
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/source-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Source Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/memory-tuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory Tuning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Architecture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/workflow-data-flow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow Data Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/scoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/chunking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chunking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/qa-loops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    QA Loops
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Features
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Features
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/sigma-rules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sigma Detection Rules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/content-filtering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Content Filtering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/os-detection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OS Detection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/cmdline-preprocessor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cmdline Preprocessor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/rag-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RAG Search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/observable-evaluation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observable Evaluation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    LLM & Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    LLM & Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llm/model-selection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Selection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llm/lmstudio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LM Studio Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llm/extract-agent-eval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Extract Agent Evaluation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ML Training
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    ML Training
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ml-training/hunt-scoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hunt Scoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ml-training/database-training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Training
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/ml-features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ML Feature Definitions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/versioning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Versioning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing Strategy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/manual-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manual Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/web-app-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web App Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/database-queries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Queries
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/allure-reports/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Allure Reports
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/multi-instance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-Instance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/workflow-queue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow Queue
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/search-queries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Search Queries
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Prompts
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    Prompts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../prompts/eval-bundle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Eval Bundle Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../prompts/huntquery-eval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hunt Query Eval
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../prompts/proctree-eval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Process Tree Eval
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="sigma-reference">Sigma Reference<a class="headerlink" href="#sigma-reference" title="Permanent link">&para;</a></h1>
<p>Sigma generation runs inside the workflow after extraction and is also available via CLI commands. Use this reference alongside <code>../howto/generate_sigma.md</code>.</p>
<h2 id="workflow-and-cli-summary">Workflow and CLI summary<a class="headerlink" href="#workflow-and-cli-summary" title="Permanent link">&para;</a></h2>
<ul>
<li>Workflow trigger: <code>POST /api/workflow/articles/{article_id}/trigger</code> (Sigma agent runs after extraction).</li>
<li>Repository sync: <code>./run_cli.sh sigma sync</code></li>
<li>Index rules into PostgreSQL + pgvector: <code>./run_cli.sh sigma index</code> (use <code>--force</code> to re-index)</li>
<li>Match existing rules to an article: <code>./run_cli.sh sigma match &lt;article_id&gt; --threshold 0.7 --save</code></li>
</ul>
<h2 id="llm-sigma-rule-generation-prompt-template">LLM - SIGMA Rule Generation Prompt Template<a class="headerlink" href="#llm-sigma-rule-generation-prompt-template" title="Permanent link">&para;</a></h2>
<h3 id="system-role">System Role<a class="headerlink" href="#system-role" title="Permanent link">&para;</a></h3>
<p>You are a senior cybersecurity detection engineer specializing in SIGMA rule creation and threat hunting. You have extensive experience with:
- Windows, Linux, and macOS security event analysis
- MITRE ATT&amp;CK framework mapping
- SIEM platforms (Splunk, ELK Stack, QRadar, etc.)
- Malware analysis and reverse engineering
- Threat intelligence analysis</p>
<h2 id="task">Task<a class="headerlink" href="#task" title="Permanent link">&para;</a></h2>
<p>Analyze the provided threat intelligence article and generate high-quality, actionable SIGMA detection rules that security teams can implement immediately. Follow the official <a href="https://github.com/SigmaHQ/sigma/wiki/Rule-Creation-Guide">SigmaHQ Rule Creation Guide</a> best practices.</p>
<h2 id="article-information">Article Information<a class="headerlink" href="#article-information" title="Permanent link">&para;</a></h2>
<p><strong>Title:</strong> {article_title}
<strong>Source:</strong> {source_name}
<strong>URL:</strong> {canonical_url}
<strong>Published:</strong> {published_date}
<strong>Content Length:</strong> {content_length} characters</p>
<h2 id="article-content">Article Content<a class="headerlink" href="#article-content" title="Permanent link">&para;</a></h2>
<p>{article_content}</p>
<h2 id="sigma-rule-generation-guidelines-based-on-official-sigmahq-standards">SIGMA Rule Generation Guidelines (Based on Official SigmaHQ Standards)<a class="headerlink" href="#sigma-rule-generation-guidelines-based-on-official-sigmahq-standards" title="Permanent link">&para;</a></h2>
<h3 id="1-rule-structure-requirements">1. Rule Structure Requirements<a class="headerlink" href="#1-rule-structure-requirements" title="Permanent link">&para;</a></h3>
<p>Each SIGMA rule must include all required fields according to the official specification:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">Short capitalized title with less than 50 characters</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">UUID format</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nt">status</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">experimental</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">Starts with &quot;Detects...&quot; - clear description of what the rule detects and why it&#39;s important</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nt">references</span><span class="p">:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">List of relevant references</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">links to blog posts</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">advisories</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">etc.</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nt">tags</span><span class="p">:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">attack.tactic_id</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">attack.technique_id</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">car.2014-04-003</span><span class="w">  </span><span class="c1"># CAR framework tags when applicable</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">Author name(s) separated by commas</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="nt">date</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">YYYY/MM/DD format</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="nt">logsource</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">  </span><span class="nt">category</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">process_creation/network_connection/file_event/registry_event/etc</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">  </span><span class="nt">product</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">windows/linux/macos</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">  </span><span class="nt">service</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">specific service if applicable</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="nt">detection</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">  </span><span class="nt">selection</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">    </span><span class="p p-Indicator">[</span><span class="nv">specific detection criteria using lowercase field names</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">  </span><span class="nt">filter</span><span class="p">:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">    </span><span class="p p-Indicator">[</span><span class="nv">optional filters to reduce false positives</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="w">  </span><span class="nt">condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">selection and not filter</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="nt">fields</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">list of important fields for investigation</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="nt">falsepositives</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">specific false positive scenarios to help analysts</span><span class="p p-Indicator">]</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">informational/low/medium/high/critical</span><span class="p p-Indicator">]</span>
</code></pre></div>
<h3 id="2-title-best-practices">2. Title Best Practices<a class="headerlink" href="#2-title-best-practices" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>NO prefixes</strong>: Don't use "Detects..." or similar prefixes</li>
<li><strong>Short and specific</strong>: Less than 50 characters</li>
<li><strong>Title case</strong>: Use proper capitalization</li>
<li><strong>Descriptive</strong>: Include threat name or technique</li>
<li><strong>No explanations</strong>: Save details for description</li>
</ul>
<p><strong>Good Examples:</strong>
- Process Injection Using Iexplore.exe
- Suspicious PowerShell Cmdline with JAB
- Certutil Lolbin Decode Use</p>
<p><strong>Bad Examples:</strong>
- Detects a process execution in a Windows folder that shouldn't contain executables
- Detects process injection</p>
<h3 id="3-description-best-practices">3. Description Best Practices<a class="headerlink" href="#3-description-best-practices" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Start with "Detects..."</strong>: Always begin with this phrase</li>
<li><strong>Explain significance</strong>: What does a trigger mean?</li>
<li><strong>Provide context</strong>: Help analysts understand the threat</li>
<li><strong>Be specific</strong>: Don't just repeat the title</li>
</ul>
<p><strong>Good Example:</strong>
"Detects the execution of whoami, which could be part of administrative activity but is also often used by attackers that have exploited some local privilege escalation or remote code execution vulnerability. The command whoami reveals the current user context. Administrators usually know which user they've used to login. Attackers usually need to evaluate the user context after successful exploitation."</p>
<h3 id="4-detection-logic-best-practices">4. Detection Logic Best Practices<a class="headerlink" href="#4-detection-logic-best-practices" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Single element lists</strong>: Don't use lists for single values</li>
<li><strong>Lowercase only</strong>: Use lowercase identifiers</li>
<li><strong>Comments</strong>: Use <code>#</code> for inline comments with 2 spaces separation</li>
<li><strong>Avoid regex</strong>: Use <code>contains</code>, <code>startswith</code>, <code>endswith</code> instead of regex when possible</li>
<li><strong>Field names</strong>: Use exact field names from log source, remove spaces, keep hyphens</li>
<li><strong>No SIEM-specific logic</strong>: Keep detection logic generic</li>
</ul>
<h3 id="5-backslash-handling">5. Backslash Handling<a class="headerlink" href="#5-backslash-handling" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Single backslashes</strong>: Write as plain values (<code>C:\Windows\System32\cmd.exe</code>)</li>
<li><strong>Double backslashes</strong>: Use four backslashes (<code>\\\\foo\bar</code> for <code>\\foo\bar</code>)</li>
<li><strong>Escaping wildcards</strong>: Use <code>\*</code> for plain <code>*</code>, <code>\\*</code> for backslash + wildcard</li>
<li><strong>Regex backslashes</strong>: Use double backslashes in regex patterns</li>
</ul>
<h3 id="6-value-modifiers-best-practices">6. Value Modifiers Best Practices<a class="headerlink" href="#6-value-modifiers-best-practices" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Ordering</strong>: Wildcard modifiers first, then encoding modifiers</li>
<li><strong>Common combinations</strong>:</li>
<li><code>|contains|all</code>: Order-agnostic command line parameters</li>
<li><code>|utf16|base64offset|contains</code>: Base64-encoded UTF16 values</li>
<li><strong>Avoid chaining</strong>: Don't chain arbitrary modifiers</li>
<li><strong>End with encoding</strong>: Character set modifiers should be followed by encoding modifiers</li>
</ul>
<h3 id="7-level-guidelines">7. Level Guidelines<a class="headerlink" href="#7-level-guidelines" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Critical</strong>: Never trigger false positives, high relevance</li>
<li><strong>High</strong>: High relevance threats requiring manual review</li>
<li><strong>Medium</strong>: Suspicious activity and policy violations</li>
<li><strong>Low</strong>: Suspicious activity, baselining required</li>
<li><strong>Informational</strong>: Compliance and correlation purposes</li>
</ul>
<h3 id="8-detection-categories-to-focus-on">8. Detection Categories to Focus On<a class="headerlink" href="#8-detection-categories-to-focus-on" title="Permanent link">&para;</a></h3>
<h4 id="process-creation-rules">Process Creation Rules<a class="headerlink" href="#process-creation-rules" title="Permanent link">&para;</a></h4>
<ul>
<li>Suspicious process executions (PowerShell, cmd, wmic, etc.)</li>
<li>Malware process names and patterns</li>
<li>Command line arguments containing suspicious patterns</li>
<li>Parent-child process relationships</li>
<li>Process injection techniques</li>
<li>LOLBAS (Living Off The Land Binaries and Scripts) usage</li>
</ul>
<h4 id="file-system-rules">File System Rules<a class="headerlink" href="#file-system-rules" title="Permanent link">&para;</a></h4>
<ul>
<li>Suspicious file creations in specific directories</li>
<li>File extensions associated with malware (.exe, .dll, .bat, .ps1, etc.)</li>
<li>File hash detections (if available in the article)</li>
<li>File modification patterns</li>
<li>File deletion patterns</li>
<li>File access patterns</li>
</ul>
<h4 id="network-activity-rules">Network Activity Rules<a class="headerlink" href="#network-activity-rules" title="Permanent link">&para;</a></h4>
<ul>
<li>Command and control (C2) communication patterns</li>
<li>Suspicious domain queries</li>
<li>Malicious IP addresses</li>
<li>Unusual network protocols</li>
<li>Data exfiltration patterns</li>
<li>Network scanning activities</li>
</ul>
<h4 id="registry-rules">Registry Rules<a class="headerlink" href="#registry-rules" title="Permanent link">&para;</a></h4>
<ul>
<li>Persistence mechanisms (Run keys, services, etc.)</li>
<li>Configuration changes</li>
<li>Suspicious registry key modifications</li>
<li>Registry-based malware indicators</li>
<li>Privilege escalation attempts</li>
</ul>
<h4 id="authentication-rules">Authentication Rules<a class="headerlink" href="#authentication-rules" title="Permanent link">&para;</a></h4>
<ul>
<li>Failed login attempts</li>
<li>Privilege escalation</li>
<li>Account creation/modification</li>
<li>Suspicious authentication patterns</li>
<li>Lateral movement indicators</li>
</ul>
<h3 id="9-mitre-attck-mapping">9. MITRE ATT&amp;CK Mapping<a class="headerlink" href="#9-mitre-attck-mapping" title="Permanent link">&para;</a></h3>
<ul>
<li>Map each rule to specific ATT&amp;CK techniques (T####)</li>
<li>Include both tactic and technique IDs</li>
<li>Use official technique names from the ATT&amp;CK framework</li>
<li>Consider sub-techniques when applicable</li>
<li>Use lowercase tags with dots or hyphens as dividers</li>
</ul>
<h3 id="10-references-best-practices">10. References Best Practices<a class="headerlink" href="#10-references-best-practices" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Web links only</strong>: Use links to web pages or documents</li>
<li><strong>No raw content</strong>: Don't link to EVTX files, PCAPs, or raw content</li>
<li><strong>No MITRE links</strong>: Use tags for ATT&amp;CK techniques instead</li>
<li><strong>Include</strong>: Blog posts, advisories, project pages, manual pages, discussions</li>
</ul>
<h3 id="11-false-positive-considerations">11. False Positive Considerations<a class="headerlink" href="#11-false-positive-considerations" title="Permanent link">&para;</a></h3>
<ul>
<li>Document specific false positive scenarios</li>
<li>Include filters where appropriate</li>
<li>Consider legitimate administrative activities</li>
<li>Account for different environments (dev, test, prod)</li>
<li>Provide hints for analysts</li>
</ul>
<h2 id="output-format">Output Format<a class="headerlink" href="#output-format" title="Permanent link">&para;</a></h2>
<p>Generate your response in the following format:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="gh"># SIGMA Detection Rules for [Threat Name/Technique]</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="gu">## Overview</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>Brief description of the threat and detection approach based on the article content.
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="gu">## Rule 1: [Rule Title]</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>```yaml
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>title: [Short, specific title &lt; 50 chars]
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>id: [UUID]
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>status: experimental
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>description: Detects [specific behavior and its significance]
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>references:
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>[relevant reference link]
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>tags:
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>attack.tactic_id
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>attack.technique_id
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>author: [Your name]
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>date: [YYYY/MM/DD]
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>logsource:
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>  category: [category]
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>  product: [product]
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>detection:
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>  selection:
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>    [detection logic]
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>  filter:
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>    [optional filters]
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>  condition: selection and not filter
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>fields:
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>[important investigation fields]
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>falsepositives:
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="w">  </span><span class="k">-</span><span class="w"> </span>[specific false positive scenarios]
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>level: [high/medium/low]
</code></pre></div>
<h2 id="rule-2-rule-title">Rule 2: [Rule Title]<a class="headerlink" href="#rule-2-rule-title" title="Permanent link">&para;</a></h2>
<p>[Continue with additional rules...]</p>
<h2 id="implementation-notes">Implementation Notes<a class="headerlink" href="#implementation-notes" title="Permanent link">&para;</a></h2>
<ul>
<li>Log source requirements</li>
<li>Performance considerations</li>
<li>Tuning recommendations</li>
<li>Additional context for security teams
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>## Additional Requirements
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>1. **Generate 3-5 rules** based on the threat intelligence
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>2. **Focus on high-confidence detections** that can be implemented immediately
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>3. **Include both simple and complex detection logic** where appropriate
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>4. **Provide implementation guidance** for security teams
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>5. **Consider different environments** (enterprise, SMB, etc.)
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>6. **Include relevant threat context** from the article
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>7. **Follow SigmaHQ standards** for all rule components
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>## Example Rule Structure
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>```yaml
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>title: Suspicious PowerShell Execution - Malware Download
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>id: 12345678-1234-1234-1234-123456789012
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>status: experimental
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>description: Detects suspicious PowerShell execution patterns commonly used by malware for downloading and executing payloads. Attackers often use PowerShell with WebClient to download and execute malicious code from remote sources.
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>references:
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>  - https://attack.mitre.org/techniques/T1059/001/
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>tags:
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>  - attack.execution
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>  - attack.t1059.001
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>  - attack.command_and_control
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>author: Detection Engineer
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>date: 2024/01/15
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>logsource:
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>  category: process_creation
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>  product: windows
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>detection:
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>  selection:
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>    process.name: powershell.exe
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>    command_line:
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>      - &#39;*Invoke-Expression*&#39;
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>      - &#39;*IEX*&#39;
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>      - &#39;*DownloadString*&#39;
<a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>      - &#39;*WebClient*&#39;
<a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>  filter:
<a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>    command_line:
<a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>      - &#39;*Get-Help*&#39;
<a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>      - &#39;*Get-Command*&#39;
<a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a>  condition: selection and not filter
<a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>fields:
<a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>  - process.name
<a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a>  - process.command_line
<a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a>  - process.parent.name
<a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a>falsepositives:
<a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>  - Legitimate PowerShell scripts using WebClient for automation
<a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>  - System administration scripts downloading configuration files
<a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a>level: medium
</code></pre></div></li>
</ul>
<p>Generate comprehensive, actionable SIGMA rules based on the threat intelligence provided, following all SigmaHQ best practices.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "navigation.tabs", "navigation.sections", "navigation.expand", "toc.integrate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>