# CTI Scraper Environment Configuration
# Copy this file to .env and fill in your actual values
# Never commit the actual .env file to version control

# =============================================================================
# CORE APPLICATION SETTINGS
# =============================================================================

# Environment (development, staging, production)
ENVIRONMENT=development

# Application secret key (generate a secure random string for production)
SECRET_KEY=your-super-secret-key-change-this-in-production

# Debug mode (set to false in production)
DEBUG=false

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL Database URL
DATABASE_URL=postgresql+asyncpg://cti_user:${POSTGRES_PASSWORD}@postgres:5432/cti_scraper

# Database connection details
POSTGRES_DB=cti_scraper
POSTGRES_USER=cti_user
POSTGRES_PASSWORD=your_secure_postgres_password_change_this
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# Database pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_PRE_PING=true
DB_POOL_RECYCLE=3600

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis URL for caching and Celery
REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379/0

# Redis connection details
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=your_secure_redis_password_change_this
REDIS_DB=0

# =============================================================================
# WEB SERVER CONFIGURATION
# =============================================================================

# Server host and port
HOST=0.0.0.0
PORT=8001

# Worker configuration
WORKERS=4
MAX_WORKERS=8
WORKER_TIMEOUT=300
REQUEST_TIMEOUT=30

# Auto-reload (development only)
RELOAD=false

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Allowed hosts (comma-separated)
ALLOWED_HOSTS=localhost,127.0.0.1,0.0.0.0

# CORS origins (JSON array)
CORS_ORIGINS=["http://localhost:3000", "http://localhost:8001"]

# Trusted hosts
TRUSTED_HOSTS=["localhost", "127.0.0.1", "0.0.0.0"]

# Rate limiting
RATE_LIMIT_PER_MINUTE=100
API_RATE_LIMIT_PER_MINUTE=30

# =============================================================================
# CELERY CONFIGURATION
# =============================================================================

# Celery broker and result backend
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0

# Celery worker settings
CELERY_TASK_ALWAYS_EAGER=false
CELERY_WORKER_CONCURRENCY=4

# =============================================================================
# SOURCE CONFIGURATION
# =============================================================================

# Sources configuration file path
SOURCES_CONFIG=config/sources.yaml

# Source check frequencies (seconds)
DEFAULT_CHECK_FREQUENCY=3600  # 1 hour
TIER1_CHECK_FREQUENCY=900     # 15 minutes
MAX_CONSECUTIVE_FAILURES=5

# =============================================================================
# CONTENT PROCESSING
# =============================================================================

# Content processing limits
MAX_CONTENT_LENGTH=10485760  # 10MB
CONTENT_CLEANUP_ENABLED=true
GARBAGE_DETECTION_ENABLED=true

# Content filtering and scoring
THREAT_HUNTING_KEYWORDS_ENABLED=true
PERFECT_DISCRIMINATOR_ENABLED=true
CONTENT_FILTER_ENABLED=true
CONTENT_FILTERING_ENABLED=false
CONTENT_FILTERING_CONFIDENCE=0.7

# =============================================================================
# LLM CONFIGURATION (OPTIONAL)
# =============================================================================

# Local LLM (Ollama) settings
LLM_API_URL=http://cti_ollama:11434
LLM_MODEL=llama3.2:1b
LLM_TEMPERATURE=0.3
LLM_MAX_TOKENS=2048
OLLAMA_CONTENT_LIMIT=1000000

# OpenAI ChatGPT settings (optional - falls back to Ollama if not set)
CHATGPT_API_URL=https://api.openai.com/v1/chat/completions
CHATGPT_API_KEY=your_openai_api_key_here
CHATGPT_CONTENT_LIMIT=1000000

# Anthropic Claude settings (optional - falls back to Ollama if not set)
ANTHROPIC_API_URL=https://api.anthropic.com/v1/messages
ANTHROPIC_API_KEY=your_anthropic_api_key_here
ANTHROPIC_CONTENT_LIMIT=1000000

# CustomGPT settings (optional - for threat hunting analysis)
CUSTOMGPT_API_URL=https://api.openai.com/v1
CUSTOMGPT_API_KEY=your-customgpt-api-key-here

# LM Studio settings (for LLM chat and SIGMA generation)
LMSTUDIO_API_URL=http://localhost:1234/v1
LMSTUDIO_MODEL=llama-3.2-1b-instruct

# LM Studio Embeddings settings (for SIGMA rule embeddings)
LMSTUDIO_EMBEDDING_URL=http://localhost:1234/v1/embeddings
LMSTUDIO_EMBEDDING_MODEL=text-embedding-e5-base-v2

# =============================================================================
# MONITORING AND LOGGING
# =============================================================================

# Metrics and monitoring
ENABLE_METRICS=true
METRICS_PORT=9090

# Logging configuration
LOG_FORMAT=json
LOG_FILE=logs/cti_scraper.log

# =============================================================================
# BACKUP AND RECOVERY
# =============================================================================

# Backup settings
BACKUP_ENABLED=true
BACKUP_RETENTION_DAYS=30
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================

# Development mode (set to false in production)
DEVELOPMENT_MODE=false
ENABLE_DEBUG_ROUTES=false
ENABLE_PROFILING=false

# =============================================================================
# NOTES
# =============================================================================

# 1. Generate a secure SECRET_KEY for production:
#    python -c "import secrets; print(secrets.token_urlsafe(32))"

# 2. Use strong passwords for POSTGRES_PASSWORD in production

# 3. Set ENVIRONMENT=production and DEBUG=false for production deployment

# 4. Configure proper CORS_ORIGINS for your frontend domain in production

# 5. Set up proper SSL/TLS certificates for production

# 6. Monitor logs and metrics in production

# 7. Regular database backups are essential for production