Filename,Excerpts from DFIR Report,LogSource and Detection
registry_set_special_accounts.yml,"The threat actor created a script that uses the registry key HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList to hide a user account from the login screen. Setting the value to 0 prevents the account from being displayed on the login screen, effectively hiding it from view while still maintaining system access.","logsource:
    category: registry_set
    product: windows
detection:
    selection:
        TargetObject|contains: '\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList'
        Details: 'DWORD (0x00000000)'
    condition: selection"
registry_set_taskcache_entry.yml,"Threat actors created scheduled tasks with GUID-like names as part of their persistence strategy. Tasks were registered in the Windows Task Scheduler cache registry location, allowing for persistent execution of malicious payloads. This technique helps blend malicious tasks with legitimate system tasks.","logsource:
    category: registry_set
    product: windows
detection:
    selection:
        TargetObject|contains:
            - '\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\'
            - '\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\'
    condition: selection"
registry_set_windows_defender_tamper.yml,"Threat actor used PowerShell and registry modifications to disable Windows Defender features including disabling Behavior Monitoring, setting Severe Threat default action to Allow, disabling Real-time Monitoring, and adding exclusion paths. Registry keys were modified to disable various Defender protections and monitoring capabilities.","logsource:
    category: registry_set
    product: windows
detection:
    selection:
        TargetObject|contains:
            - '\SOFTWARE\Microsoft\Windows Defender\'
            - '\SOFTWARE\Policies\Microsoft\Windows Defender\'
        TargetObject|endswith:
            - '\DisableBehaviorMonitoring'
            - '\DisableRealtimeMonitoring'
            - '\DisableAntiSpyware'
            - '\DisableAntiVirus'
            - '\SpynetReporting'
            - '\SubmitSamplesConsent'
            - '\TamperProtection'
        Details: 'DWORD (0x00000001)'
    condition: selection"
sysmon_rclone_execution.yml,"Rclone was used to collect and exfiltrate data from network shares, masquerading as a svchost executable. Three and a half hours into the intrusion, Rclone was used to collect and exfiltrate the contents of network shares for use in a double extortion demand. Data was exfiltrated to a remote server. The attackers carefully disguised the Rclone executable to blend in with normal system processes.","logsource:
    category: process_creation
    product: windows
detection:
    selection:
        - Image|endswith: '\rclone.exe'
        - Description: 'Rsync for cloud storage'
        - CommandLine|contains:
            - '--config'
            - '--no-check-certificate'
            - 'copy'
            - 'sync'
            - 'remote'
    condition: selection"
web_susp_windows_path_uri.yml,"From DFIR reports, threat actors may access Windows system paths via web requests or URI schemes to extract files, execute commands, or gather system information. This can include attempts to access administrative shares, system directories, or other sensitive locations through web-based attacks.","logsource:
    category: webserver
    product: windows
detection:
    selection:
        cs-uri-query|contains:
            - 'c:\windows\'
            - 'c:\users\'
            - 'c:\programdata\'
            - '%systemroot%'
            - '%appdata%'
            - '%temp%'
        cs-uri-query|contains:
            - '.exe'
            - '.dll'
            - '.bat'
            - '.cmd'
            - '.ps1'
    condition: selection"