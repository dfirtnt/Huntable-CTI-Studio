Filename,Excerpts from DFIR Report,LogSource and Detection
proc_creation_win_wmic_susp_execution_via_office_process.yml,"Initial execution involved an xlsm document that used a macro to initiate a wmic command and executed a file via regsvr32. The execution method leveraged Office applications to spawn suspicious child processes through wmic for defense evasion and execution of malicious payloads. This technique is commonly observed in malicious Office documents.","logsource:
    product: windows
    category: process_creation
detection:
    selection_img:
        - Image|endswith: '\wbem\WMIC.exe'
        - OriginalFileName: 'wmic.exe'
    selection_parent:
        ParentImage|endswith:
            - '\winword.exe'
            - '\excel.exe'
            - '\powerpnt.exe'
            - '\msaccess.exe'
            - '\mspub.exe'
            - '\eqnedt32.exe'
            - '\visio.exe'
    condition: all of selection_*"
proc_creation_win_wmic_susp_process_creation.yml,"From DFIR reports, threat actors use WMIC for process creation and execution of malicious payloads. WMIC process call create commands are frequently used to execute files remotely, spawn processes on other systems, and bypass certain detection mechanisms by using legitimate Windows management tools.","logsource:
    category: process_creation
    product: windows
detection:
    selection_img:
        - Image|endswith: '\wmic.exe'
        - OriginalFileName: 'wmic.exe'
    selection_cli:
        CommandLine|contains|all:
            - 'process'
            - 'call'
            - 'create'
    condition: all of selection_*"
proc_creation_win_wmic_uninstall_security_products.yml,"Threat actors used PowerShell to modify Windows Defender settings and disable security products. They may also use WMIC to uninstall security products entirely to reduce their chances of detection. This includes uninstalling antivirus software, security monitoring tools, and other protective measures installed on compromised systems.","logsource:
    category: process_creation
    product: windows
detection:
    selection_img:
        - Image|endswith: '\wmic.exe'
        - OriginalFileName: 'wmic.exe'
    selection_cli:
        CommandLine|contains|all:
            - 'product'
            - 'uninstall'
        CommandLine|contains:
            - 'antivirus'
            - 'defender'
            - 'security'
            - 'firewall'
    condition: all of selection_*"
proc_creation_win_wmiprvse_susp_child_processes.yml,"The BumbleBee malware used WMI and COM function calls to start processes. Processes spawned were not direct child processes of rundll32 but instead children of WmiPrvSE.exe. The malware used CreateRemoteThread to execute code and created named pipes for inter-process communication. This technique helps evade parent/child process heuristics and allows injecting code into legitimate processes.","logsource:
    category: process_creation
    product: windows
detection:
    selection_parent:
        ParentImage|endswith: '\WmiPrvSE.exe'
    selection_img:
        Image|endswith:
            - '\cmd.exe'
            - '\powershell.exe'
            - '\pwsh.exe'
            - '\rundll32.exe'
            - '\regsvr32.exe'
            - '\mshta.exe'
            - '\cscript.exe'
            - '\wscript.exe'
    condition: all of selection_*"
proc_creation_win_wscript_cscript_dropper.yml,"From DFIR reports, threat actors frequently use wscript.exe and cscript.exe to execute VBScript and JScript files as part of their initial access or persistence mechanisms. These scripts often download additional payloads, execute encoded commands, or establish persistence on compromised systems.","logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image|endswith:
            - '\wscript.exe'
            - '\cscript.exe'
        CommandLine|contains:
            - '.vbs'
            - '.js'
            - '.vbe'
            - '.jse'
    condition: selection"